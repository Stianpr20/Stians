(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1022166,      21753]
NotebookOptionsPosition[    987396,      21144]
NotebookOutlinePosition[    987839,      21163]
CellTagsIndexPosition[    987796,      21160]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Stian\[CloseCurlyQuote]s ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " package"
}], "Title",
 CellChangeTimes->{{3.6325088204434223`*^9, 3.632508823522456*^9}, {
   3.655742119951337*^9, 3.655742125247018*^9}, {3.657176107171741*^9, 
   3.657176113595751*^9}, {3.6571965175177727`*^9, 3.657196518139456*^9}, {
   3.667811374858439*^9, 3.667811377601095*^9}, {3.667900351656826*^9, 
   3.667900356531871*^9}, {3.67575821153409*^9, 3.675758245630015*^9}, {
   3.675758564815556*^9, 3.6757585720063353`*^9}, {3.675761843456209*^9, 
   3.6757618470458117`*^9}, 3.675771571582801*^9, {3.761728505027109*^9, 
   3.7617285115370083`*^9}},ExpressionUUID->"7541a7b4-04fa-47dc-b2b7-\
c2bd1fca3320"],

Cell[CellGroupData[{

Cell["Package setup", "Chapter",
 CellChangeTimes->{{3.761729218482874*^9, 
  3.7617292202096367`*^9}},ExpressionUUID->"d0a0010f-a336-45df-a4c7-\
71465c0f9d95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Start", " ", "package", " ", "context", " ", "Stians`"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BeginPackage", "[", "\"\<Stians`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Import", " ", "any", " ", "usage", " ", "messages"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FailureQ", "@", 
         RowBox[{"FindFile", "[", "#", "]"}]}]}], ",", 
       RowBox[{"Get", "@", 
        RowBox[{"FindFile", "[", "#", "]"}]}]}], "]"}], "&"}], "[", 
    "\"\<Stians/Messages.txt\>\"", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}, {3.761730412539352*^9, 3.761730423625965*^9}, {
   3.761731527602811*^9, 3.761731566743567*^9}, {3.761731763091628*^9, 
   3.761731770171471*^9}, 3.7617319540062*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[3]:=",ExpressionUUID->"2c066dd9-52df-42ed-8147-417bdf0ac46d"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Definitions \[Dash] ",
  FontWeight->"Regular"],
 StyleBox["FileOperations",
  FontWeight->"Regular",
  FontSlant->"Italic"]
}], "Chapter",
 CellChangeTimes->{{3.657263896281269*^9, 3.6572639010563383`*^9}, {
  3.667809853233161*^9, 3.667809863671739*^9}, {3.761728827595784*^9, 
  3.761728834114563*^9}, {3.761731647062213*^9, 
  3.761731649661991*^9}},ExpressionUUID->"07229cf0-bbfc-4e92-b7e5-\
091e773089e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Start", " ", "subcontext"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`FileOperations`\>\"", "]"}], ";"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.7190633903591433`*^9, 3.719063390750228*^9}, {
   3.743835321690852*^9, 3.743835323490286*^9}, {3.76172900476154*^9, 
   3.7617290056307497`*^9}, {3.761729067630931*^9, 3.761729086941944*^9}, {
   3.761729117483964*^9, 3.7617291213561687`*^9}, {3.7617303198520613`*^9, 
   3.761730323770122*^9}, {3.761730381681487*^9, 3.761730382209312*^9}, 
   3.761731650782007*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[5]:=",ExpressionUUID->"5e9e07e8-1f40-4fa9-b1c6-804bd4605116"],

Cell[CellGroupData[{

Cell["ChangeExtenstion", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.67577147996329*^9, 
   3.675771483321144*^9}},ExpressionUUID->"2a5a1051-bcd8-480b-b9f4-\
e251f62e61c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[6]:=",ExpressionUUID->"b76214e5-5bd3-4296-aa39-c471e3cc3369"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChangeExtension", "[", 
   RowBox[{"input_", ",", "newext_String"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "path", ",", "file", ",", "extension", ",", "name", ",", "output"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "metadata"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"path", "=", 
      RowBox[{"DirectoryName", "@", "input"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"file", "=", 
      RowBox[{"FileNameTake", "@", "input"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Extracting", " ", "extension", " ", "and", " ", "preparing", " ", 
       "output"}], " ", "*)"}], "\t", 
     RowBox[{"extension", "=", 
      RowBox[{"First", "@", 
       RowBox[{"StringReverse", "@", 
        RowBox[{"StringCases", "[", 
         RowBox[{
          RowBox[{"StringReverse", "@", "file"}], ",", 
          RowBox[{"__", "~~", "\"\<.\>\""}], ",", "1"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"name", "=", 
      RowBox[{"StringDrop", "[", 
       RowBox[{"file", ",", 
        RowBox[{"-", 
         RowBox[{"StringLength", "@", "extension"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"output", "=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"path", "<>", "name", "<>", "\"\<.\>\"", "<>", "newext"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"RenameFile", "[", 
      RowBox[{"input", ",", "output"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.675771492506175*^9, 3.675771509778859*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[7]:=",ExpressionUUID->"a8cd90d2-631c-4a56-b2e5-dc18c97676a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[8]:=",ExpressionUUID->"fe11bf7b-aa2b-436d-a370-db26b99875ad"]
}, Closed]],

Cell[CellGroupData[{

Cell["SyncSpellings", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.67577147996329*^9, 
   3.675771483321144*^9}, {3.675837458971168*^9, 
   3.6758374611222277`*^9}},ExpressionUUID->"5b858855-77dd-48c1-b637-\
daa256a3fe40"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[9]:=",ExpressionUUID->"a405a0de-f70c-4f0e-9be4-113d00815b66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SyncSpellings", "::", "one"}], "=", 
   "\"\<Input consists of only one dictionary.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyncSpellings", "::", "missing"}], "=", 
   "\"\<File \[LeftGuillemet]`1`\[RightGuillemet] was not found.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyncSpellings", "::", "done"}], "=", 
   "\"\<Update`1` completed.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SyncSpellings", "::", "inv"}], "=", 
    "\"\<Invalid input format.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SyncSpellings", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Remove\>\"", "\[Rule]", 
     RowBox[{"{", "}"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, {3.675837485059564*^9, 3.675837499995119*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"f4ae5828-5f42-4b99-90a8-293632c5a91d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[15]:=",ExpressionUUID->"3b53743d-ceb6-4df9-a05e-0f7e5e64420a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SyncSpellings", "[", 
   RowBox[{"input__String", ",", 
    RowBox[{"OptionsPattern", "[", "SyncSpellings", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"checked", ",", "new", ",", "remove", ",", "afterfilter"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Checking", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{"checked", ",", 
       RowBox[{"Goto", "[", "\"\<checked\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "input", "}"}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SyncSpellings", "::", "one"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FileExistsQ", "[", "#", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"SyncSpellings", "::", "missing"}], ",", "#"}], "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], "&"}], "/@", 
      RowBox[{"{", "input", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Merging", " ", "dictionaries"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<checked\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"new", "=", 
      RowBox[{"Sort", "@", 
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringSplit", "@", 
            RowBox[{"Import", "[", 
             RowBox[{"#", ",", "\"\<Text\>\""}], "]"}]}], "&"}], "/@", 
          RowBox[{"{", "input", "}"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Remove", " ", "word", 
        RowBox[{"(", "s", ")"}], " ", "from", " ", "the", " ", 
        "dictionary"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
         RowBox[{"remove", "=", 
          RowBox[{"{", "#", "}"}]}], ",", 
         RowBox[{"remove", "=", "#"}]}], "]"}], "&"}], "@", 
      RowBox[{"OptionValue", "[", "\"\<Remove\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"afterfilter", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"new", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"remove", ",", "x"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Rewriting", " ", "the", " ", "old", " ", "files", " ", "with", " ", 
       "the", " ", "new", " ", "version"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{"#", ",", "afterfilter", ",", "\"\<Text\>\""}], "]"}], "&"}], 
      "/@", 
      RowBox[{"{", "input", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"SyncSpellings", "::", "done"}], ",", "\"\<\>\""}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.675771492506175*^9, 3.675771509778859*^9}, {3.675837474675139*^9, 
   3.675837477562161*^9}, 3.675837512475464*^9, {3.675837553234542*^9, 
   3.675837556234293*^9}, {3.6758532014315853`*^9, 3.6758532016941*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[16]:=",ExpressionUUID->"6183f809-4ba6-4931-a1a8-9a5fdfee4143"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SyncSpellings", "[", "input__List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"all", ",", "depthcheck", ",", "checked"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Checking", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"all", "=", 
      RowBox[{"{", "input", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"depthcheck", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"all", ",", 
        RowBox[{"\"\<Remove\>\"", "\[Rule]", "_List"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Depth", "[", "depthcheck", "]"}], "\[NotEqual]", "3"}], ",", 
       
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SyncSpellings", "::", "inv"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FileExistsQ", "[", "#", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"SyncSpellings", "::", "missing"}], ",", "#"}], "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", "depthcheck"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Processing", " ", "each", " ", "dictionary", " ", "batch"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Off", "[", 
      RowBox[{"SyncSpellings", "::", "done"}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"checked", "=", "True"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"SyncSpellings", "@@", 
        RowBox[{"all", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "all"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"On", "[", 
      RowBox[{"SyncSpellings", "::", "done"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"SyncSpellings", "::", "done"}], ",", "\"\<s\>\""}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.675771492506175*^9, 3.675771509778859*^9}, {3.675837474675139*^9, 
   3.675837477562161*^9}, {3.675837512475464*^9, 3.675837522187314*^9}, {
   3.675837558514146*^9, 3.675837567482314*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[17]:=",ExpressionUUID->"862bf631-f0d8-4afe-9f7c-06185f9d5c5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[18]:=",ExpressionUUID->"a8c5019a-041f-4ec4-a6ae-b7612dc9c4de"]
}, Closed]],

Cell[CellGroupData[{

Cell["SyncTexitEasy", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.67577147996329*^9, 
   3.675771483321144*^9}, {3.675837458971168*^9, 3.6758374611222277`*^9}, {
   3.727101956523003*^9, 
   3.7271019591996937`*^9}},ExpressionUUID->"1279a9a4-af7a-4f1f-af9b-\
188b4301c576"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[19]:=",ExpressionUUID->"f8b7589d-afc0-4747-a182-9965f74b1a25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SyncTexitEasy", "::", "done"}], "=", 
   "\"\<TexitEasy configuration files were copied successfully from `1` to \
`2`.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SyncTexitEasy", "::", "uptodate"}], "=", 
    "\"\<Nothing to update.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "SyncTexitEasy"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<LocalPaths\>\"", "\[Rule]", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<MacOSX\>\"", "\[Rule]", 
        "\"\</Users/Stian/Library/Mobile Documents/com~apple~CloudDocs/Stians \
iCloud\>\""}], "|>"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<ShowDialogue\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ForceCopyFrom\>\"", "\[Rule]", "False"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, {3.675837485059564*^9, 3.675837499995119*^9}, {
   3.7271077527455587`*^9, 3.727107766365996*^9}, {3.7271157058990726`*^9, 
   3.727115731568758*^9}, {3.727115832424203*^9, 3.7271158345742607`*^9}, {
   3.727116071233528*^9, 3.72711608580061*^9}, {3.727121403669508*^9, 
   3.727121435004125*^9}, {3.727121833443944*^9, 3.727121895116082*^9}, {
   3.7275014058716908`*^9, 3.7275014085344954`*^9}, 3.727539850856894*^9, {
   3.7275919127114983`*^9, 3.727591917734177*^9}, {3.7305701219773073`*^9, 
   3.730570134936302*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"0202cdc0-61f4-48b7-9504-79b68bdc7fb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[23]:=",ExpressionUUID->"4674835c-c177-4047-a1ed-8053c51062a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SyncTexitEasy", "[", 
   RowBox[{"OptionsPattern", "@", "SyncTexitEasy"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "cloudDir", ",", "dialogueQ", ",", "\[IndentingNewLine]", 
      "configDirSystem", ",", "libraryDirSystem", ",", "configDirCloud", ",", 
      "libraryDirCloud", ",", "\[IndentingNewLine]", "dirs", ",", "configDir",
       ",", "libraryDir", ",", "\[IndentingNewLine]", "forceOpt", ",", 
      "files", ",", "top", ",", "newest", ",", "newestSource", ",", 
      "copyFrom", ",", "\[IndentingNewLine]", "buttonRow", ",", 
      "\[IndentingNewLine]", "temp"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "local", " ", "paths"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cloudDir", "=", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<LocalPaths\>\"", "]"}], "[", 
       "$OperatingSystem", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dialogueQ", "=", 
      RowBox[{"OptionValue", "[", "\"\<ShowDialogue\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Directories", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "configDirSystem", "=", "\"\</Users/Stian/.config/texiteasy.com\>\""}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
     "libraryDirSystem", "=", 
      "\"\</Users/Stian/Library/Application \
Support/TexitEasy/TexitEasy\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"configDirCloud", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "cloudDir", ",", 
         "\"\<Prosjekter/Programoppsett/TexitEasy-oppsett\>\""}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"libraryDirCloud", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "cloudDir", ",", 
         "\"\<Prosjekter/Programoppsett/TexitEasy-oppsett/Bibliotek-mappe\>\"\
"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dirs", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "configDirSystem", ",", "libraryDirSystem", ",", "\[IndentingNewLine]",
         "configDirCloud", ",", "libraryDirCloud"}], "\[IndentingNewLine]", 
       "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"configDir", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"configDirCloud", ",", "\"\<Config-mappe\>\""}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"libraryDir", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"configDirCloud", ",", "\"\<Bibliotek-mappe\>\""}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", 
       RowBox[{"Force", " ", "copy"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"forceOpt", "=", 
      RowBox[{"OptionValue", "[", "\"\<ForceCopyFrom\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"forceOpt", "===", "\"\<System\>\""}], ",", 
       RowBox[{
        RowBox[{"copyFrom", "=", "\"\<System\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<Copy\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"forceOpt", "===", "\"\<Cloud\>\""}], ",", 
       RowBox[{
        RowBox[{"copyFrom", "=", "\"\<Cloud\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<Copy\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Any", " ", "directories", " ", 
       RowBox[{"missing", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{
          RowBox[{"dirs", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], ",", 
          "DirectoryQ"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"copyFrom", "=", "\"\<Cloud\>\""}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"dialogueQ", ",", 
          RowBox[{"Goto", "[", "\"\<Dialogue\>\"", "]"}], ",", 
          RowBox[{"Goto", "[", "\"\<Copy\>\"", "]"}]}], "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{
          RowBox[{"dirs", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"3", ",", "4"}], "}"}], "]"}], "]"}], ",", 
          "DirectoryQ"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"copyFrom", "=", "\"\<System\>\""}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"dialogueQ", ",", 
          RowBox[{"Goto", "[", "\"\<Dialogue\>\"", "]"}], ",", 
          RowBox[{"Goto", "[", "\"\<Copy\>\"", "]"}]}], "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Find", " ", "newest"}], ";"}], " ", "'"}], 
       RowBox[{"push", "'"}], " ", "to", " ", "cloud", " ", 
       RowBox[{"or", " ", "'"}], 
       RowBox[{"pull", "'"}], " ", "from", " ", "cloud"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"files", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<*\>\"", ",", 
          RowBox[{"{", "#", "}"}], ",", "Infinity"}], "]"}], "&"}], "/@", 
       "dirs"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"files", ",", 
          RowBox[{
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "===", "\"\<.\>\""}]}], "&"}], 
          ",", "Infinity"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"top", "=", 
      RowBox[{"Check", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TakeLargestBy", "[", 
            RowBox[{"#", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FileDate", "[", 
                RowBox[{"#", ",", "\"\<Modification\>\""}], "]"}], "&"}], 
              ")"}], ",", "1"}], "]"}], "&"}], "/@", "files"}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Nothing", " ", 
       RowBox[{"new", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", "dialogueQ"}], "&&", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Subtract", "@@", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"UnixTime", "@", 
               RowBox[{"FileDate", "[", 
                RowBox[{
                 RowBox[{"top", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", 
                 "\"\<Modification\>\""}], "]"}]}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{"2", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
            ")"}]}], "]"}], "<", "30"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SyncTexitEasy", "::", "uptodate"}], "]"}], ";", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newest", "=", 
      RowBox[{"First", "@", 
       RowBox[{"TakeLargestBy", "[", 
        RowBox[{"top", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"FileDate", "[", 
            RowBox[{"#", ",", "\"\<Modification\>\""}], "]"}], "&"}], ")"}], 
         ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newestSource", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"dirs", ",", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{
           RowBox[{"DirectoryName", "@", "newest"}], ",", "#"}], "]"}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"copyFrom", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SubsetQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"configDirSystem", ",", "libraryDirSystem"}], "}"}], ",", 
          "newestSource"}], "]"}], ",", "\"\<System\>\"", ",", 
        "\"\<Cloud\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Dialogue", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Dialogue\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"copyFrom", "===", "\"\<System\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<System\>\"", ",", "\"\<Cloud\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Cloud\>\"", ",", "\"\<System\>\""}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"buttonRow", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Spacer", "[", "200", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"DefaultButton", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"DialogReturn", "[", "#1", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{"#2", ",", 
            RowBox[{"DialogReturn", "[", "#2", "]"}]}], "]"}]}], "}"}], "&"}],
        "@@", "temp"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"copyFrom", "=", 
      RowBox[{"DialogInput", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "\"\<Choose where to copy from.\\nMost recently modified: \>\"", 
              "<>", "copyFrom"}], ",", "13"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", "buttonRow", "]"}]}], "\[IndentingNewLine]", 
          "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
        "WindowTitle", "\[Rule]", "\"\<Sync TexitEasy settings\>\""}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"copyFrom", "===", "$Failed"}], ",", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Delete", " ", "and", " ", "copy"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Copy\>\"", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"copyFrom", "===", "\"\<System\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"'", 
          RowBox[{
           RowBox[{"System", "'"}], " ", "--"}]}], ">", " ", 
         RowBox[{"'", 
          RowBox[{"Cloud", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DeleteDirectory", "[", 
         RowBox[{"configDirCloud", ",", 
          RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CreateDirectory", "[", "configDirCloud", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CopyDirectory", "[", 
         RowBox[{"configDirSystem", ",", "configDir"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CopyDirectory", "[", 
         RowBox[{"libraryDirSystem", ",", "libraryDir"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"'", 
          RowBox[{
           RowBox[{"Cloud", "'"}], " ", "--"}]}], ">", " ", 
         RowBox[{"'", 
          RowBox[{"System", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DeleteDirectory", "[", 
         RowBox[{"configDirSystem", ",", 
          RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CopyDirectory", "[", 
         RowBox[{"configDir", ",", "configDirSystem"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DeleteDirectory", "[", 
         RowBox[{"libraryDirSystem", ",", 
          RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CopyDirectory", "[", 
         RowBox[{"libraryDir", ",", "libraryDirSystem"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Report", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<system\>\"", ",", "\"\<cloud\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"copyFrom", "===", "\"\<Cloud\>\""}], ",", 
       RowBox[{"temp", "=", 
        RowBox[{"Reverse", "@", "temp"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"SyncTexitEasy", "::", "done"}], ",", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.675771492506175*^9, 3.675771509778859*^9}, {3.675837474675139*^9, 
   3.675837477562161*^9}, 3.675837512475464*^9, {3.675837553234542*^9, 
   3.675837556234293*^9}, {3.6758532014315853`*^9, 3.6758532016941*^9}, {
   3.727107759048675*^9, 3.727107760960678*^9}, {3.727107845871375*^9, 
   3.727107867900679*^9}, {3.72711246480984*^9, 3.727112498414424*^9}, {
   3.7271126811475697`*^9, 3.727112683819703*^9}, {3.7271128161670218`*^9, 
   3.727112981875598*^9}, {3.727113249384637*^9, 3.7271132529444513`*^9}, {
   3.7271141432623663`*^9, 3.7271141624460487`*^9}, {3.7271142029013042`*^9, 
   3.7271142779317408`*^9}, {3.7271143931537657`*^9, 
   3.7271143969358263`*^9}, {3.727114946659713*^9, 3.727114946891779*^9}, {
   3.727115597750779*^9, 3.727115699037228*^9}, {3.727115737131486*^9, 
   3.727115803048807*^9}, {3.727115873767785*^9, 3.7271158793352127`*^9}, {
   3.727116039805222*^9, 3.727116065843513*^9}, {3.7271161044597178`*^9, 
   3.727116126401785*^9}, {3.727116162026979*^9, 3.727116218663979*^9}, {
   3.72711628735983*^9, 3.727116293302105*^9}, {3.7271163288476267`*^9, 
   3.727116358662611*^9}, {3.727116456804234*^9, 3.7271164704503593`*^9}, {
   3.727116527850526*^9, 3.727116596671773*^9}, {3.727116638849395*^9, 
   3.727116654089348*^9}, {3.727117172333172*^9, 3.7271172417855387`*^9}, {
   3.7271175398532333`*^9, 3.727117574987732*^9}, {3.72711764588291*^9, 
   3.727117649001302*^9}, {3.727117815086574*^9, 3.727117826783545*^9}, {
   3.7271181482719584`*^9, 3.727118164982326*^9}, {3.727118206470195*^9, 
   3.7271182685793*^9}, {3.7271183166535463`*^9, 3.727118330019657*^9}, {
   3.727118696091257*^9, 3.727118760778523*^9}, {3.727120752920672*^9, 
   3.727120757254027*^9}, {3.727120893236004*^9, 3.727120896029066*^9}, {
   3.727121170885105*^9, 3.727121173148638*^9}, {3.7271212441574707`*^9, 
   3.72712129617749*^9}, {3.7271214550881767`*^9, 3.7271216050287743`*^9}, 
   3.727121651525131*^9, {3.727121698155922*^9, 3.727121698321638*^9}, {
   3.7271217503690977`*^9, 3.727121752336894*^9}, {3.7271219043593063`*^9, 
   3.727121937156733*^9}, {3.727122044515231*^9, 3.727122044762321*^9}, {
   3.7275918341753073`*^9, 3.727591844317669*^9}, 3.7275919032539167`*^9, {
   3.730570180458067*^9, 3.730570199057493*^9}, {3.730570253097476*^9, 
   3.730570253961833*^9}, {3.730570303362041*^9, 3.7305703191608353`*^9}, {
   3.73057214532681*^9, 3.73057220302287*^9}, {3.7305722929265823`*^9, 
   3.730572327643429*^9}, {3.730572378739666*^9, 3.730572384128351*^9}, {
   3.730572439338746*^9, 3.730572440368566*^9}, {3.7305727588510933`*^9, 
   3.730572830856339*^9}, {3.730572961014316*^9, 3.730573043115181*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[24]:=",ExpressionUUID->"070b3281-cdef-474f-b54b-4bd66db35919"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[25]:=",ExpressionUUID->"563b92c1-6269-46a9-9224-ebb6c7b8c7b1"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetWallpapers", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.67577147996329*^9, 
   3.675771483321144*^9}, {3.675837458971168*^9, 3.6758374611222277`*^9}, {
   3.6758596726941633`*^9, 3.6758596772139683`*^9}, {3.698820503840026*^9, 
   3.6988205038493347`*^9}, 3.740931159033534*^9, 
   3.740975346375945*^9},ExpressionUUID->"cfa6d2e7-36a8-42ff-82d8-\
e1062e24114a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[26]:=",ExpressionUUID->"6ca97392-41ae-4505-8b02-5e3f61a3e826"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetWallpapers", "::", "noNew"}], "=", 
   "\"\<No new images found.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetWallpapers", "::", "invURL"}], "=", "\"\<Invalid URL.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GetWallpapers"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<DownloadDirectory\>\"", "\[Rule]", 
      "\"\</Users/Stian/Pictures/InterfaceLIFT (2560x1440)\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Resolution\>\"", "\[Rule]", "\"\<2560x1440\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<PageIndex\>\"", "\[Rule]", "1"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, {3.675837485059564*^9, 3.675837499995119*^9}, 
   3.675859691967124*^9, {3.676025936519685*^9, 3.676025947286028*^9}, {
   3.676026365799076*^9, 3.676026369279723*^9}, {3.685807677095478*^9, 
   3.68580775349897*^9}, 3.687462883511978*^9, {3.704299342073306*^9, 
   3.704299349854834*^9}, {3.727958288575819*^9, 3.727958306259136*^9}, {
   3.740890533788611*^9, 3.7408905402057343`*^9}, {3.7408910063257217`*^9, 
   3.740891036314642*^9}, {3.7409041544198933`*^9, 3.740904178115506*^9}, {
   3.740904376572837*^9, 3.740904377849757*^9}, {3.7409044802950153`*^9, 
   3.7409044843509197`*^9}, {3.7409311508052673`*^9, 
   3.7409311508121643`*^9}, {3.740975339459882*^9, 3.740975339471464*^9}, {
   3.7409756423650618`*^9, 3.740975649219624*^9}, {3.741024058917465*^9, 
   3.741024092418037*^9}, {3.7410241725442944`*^9, 3.741024178767934*^9}, {
   3.7444589723103*^9, 3.7444589947486343`*^9}, 3.75594874272095*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"50a27b72-e3f2-4aa9-9d7d-e3011be4430d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[30]:=",ExpressionUUID->"135ab9ba-eb1e-4f1f-a583-c351f1ed8116"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetWallpapers", "[", 
   RowBox[{"OptionsPattern", "@", "GetWallpapers"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"url", ",", 
      RowBox[{"resolution", "=", 
       RowBox[{"OptionValue", "[", "\"\<Resolution\>\"", "]"}]}], ",", 
      "htmlData", ",", "itemData", ",", "\[IndentingNewLine]", 
      RowBox[{"downloadDir", "=", 
       RowBox[{"OptionValue", "[", "\"\<DownloadDirectory\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", "imageIDs", ",", "archivedIDs", ",", "newIDs", 
      ",", "\[IndentingNewLine]", "archived", ",", "newTitles", ",", 
      "\[IndentingNewLine]", "commentData", ",", "thumbnailData", ",", 
      "downloadURLdata", ",", "data", ",", "\[IndentingNewLine]", 
      "userSelected", ",", "\[IndentingNewLine]", "n", ",", "k", ",", 
      "\[IndentingNewLine]", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Organising"}], " ", "archived", " ", "images", 
      " ", "and", " ", "URL", " ", "data", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Fetching"}], " ", "latest", " ", "wallpapers", 
      " ", "from", " ", 
      RowBox[{"InterfaceLift", ".", "com"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"url", "=", 
      RowBox[{
      "\"\<https://interfacelift.com/wallpaper/downloads/date/wide_16:9/\>\"",
        "<>", "resolution", "<>", "\"\</index\>\"", "<>", 
       RowBox[{"ToString", "@", 
        RowBox[{"OptionValue", "[", "\"\<PageIndex\>\"", "]"}]}], "<>", 
       "\"\<.html\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"htmlData", "=", 
      RowBox[{"Check", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"URLRead", "[", 
         RowBox[{"url", ",", "\"\<Content\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "@", "url"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "@", "htmlData"}], "===", "Failure"}], ",", 
       RowBox[{"Return", "@", "htmlData"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"itemData", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"htmlData", ",", 
         RowBox[{
          RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
           RowBox[{"\"\<<div id=\\\"list_\>\"", "~~", 
            RowBox[{"Longest", "[", 
             RowBox[{"idNumber", ":", 
              RowBox[{"DigitCharacter", ".."}]}], "]"}], "~~", "__", "~~", 
            "\n", "\t\t", "\"\<High-resolution desktop wallpaper \>\"", "~~", 
            "\[IndentingNewLine]", "title__", "~~", "\"\< by\>\""}], 
           "\[IndentingNewLine]", "]"}], "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToExpression", "@", "idNumber"}], "\[Rule]", 
            RowBox[{"StringDelete", "[", 
             RowBox[{"title", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<!\>\"", ",", "\"\<...\>\""}], "}"}]}], "]"}]}], 
           "}"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"imageIDs", "=", 
      RowBox[{"Keys", "@", "itemData"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "with", " ", "storage", " ", 
       "directory", " ", "to", " ", "see", " ", "if", " ", "already", " ", 
       "downloaded"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"archived", "=", 
      RowBox[{"FileNames", "[", 
       RowBox[{
        RowBox[{"\"\<*.jpg\>\"", "~~", 
         RowBox[{"{", 
          RowBox[{"\"\<\>\"", ",", "\"\<.icloud\>\""}], "}"}]}], ",", 
        RowBox[{"{", "downloadDir", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"archived", "=", 
      RowBox[{"FileNameTake", "/@", "archived"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"archivedIDs", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"archived", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Shortest", "[", 
           RowBox[{"\"\<(\>\"", "~~", 
            RowBox[{"idNumber", ":", 
             RowBox[{"DigitCharacter", ".."}]}], "~~", "\"\<)\>\""}], 
           "\[IndentingNewLine]", "]"}], "\[RuleDelayed]", 
          RowBox[{"ToExpression", "@", "idNumber"}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newIDs", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"imageIDs", ",", "archivedIDs"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"End", " ", "if", " ", "no", " ", "new", " ", "images"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"newIDs", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetWallpapers", "::", "noNew"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"itemData", "=", 
      RowBox[{"KeySelect", "[", 
       RowBox[{"itemData", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"newIDs", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"itemData", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\</\>\"", ",", "\"\<\\\\\>\""}], "}"}], "\[Rule]", 
           "\"\<-\>\""}]}], "]"}], "&"}], "/@", "itemData"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newTitles", "=", 
      RowBox[{"Values", "@", "itemData"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".3", ".", " ", 
        RowBox[{"Photographers", "'"}]}], " ", "comments"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"commentData", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"StringCases", "[", "\[IndentingNewLine]", 
        RowBox[{"htmlData", ",", 
         RowBox[{
          RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<<div class=\\\"details\\\"\>\"", "~~", "__", "~~", 
            "\[IndentingNewLine]", "\"\</wallpaper/details/\>\"", "~~", 
            RowBox[{"idNumber", ":", 
             RowBox[{"(", 
              RowBox[{"ToString", "/@", "newIDs"}], ")"}]}], "~~", "__", "~~",
             "\[IndentingNewLine]", "\"\<<\>\"", "~~", "__", "~~", 
            "\"\<<p>\>\"", "~~", "comment___", "~~", "\"\<</p>\>\""}], "]"}], 
          "\[IndentingNewLine]", "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToExpression", "@", "idNumber"}], "\[Rule]", 
            RowBox[{"StringTrim", "@", "comment"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "A", ".4", " ", "Thumbnails", " ", "of", " ", "new", " ", "images"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"thumbnailData", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"htmlData", ",", 
         RowBox[{
          RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
           RowBox[{"\"\<<div id=\\\"list_\>\"", "~~", 
            RowBox[{"Longest", "[", 
             RowBox[{"idNumber", ":", 
              RowBox[{"DigitCharacter", ".."}]}], "]"}], "~~", "__", "~~", 
            "\n", "\t\t", 
            RowBox[{"url", ":", 
             RowBox[{"(", 
              RowBox[{
              "\"\<http://interfacelift.com/wallpaper/previews/\>\"", "~~", 
               "__", "~~", "\"\<672x420.jpg\>\""}], ")"}]}]}], "]"}], 
          "\[IndentingNewLine]", "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToExpression", "@", "idNumber"}], "\[Rule]", "url"}], 
           "}"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"thumbnailData", "=", 
      RowBox[{"KeySelect", "[", 
       RowBox[{"thumbnailData", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"newIDs", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"thumbnailData", "=", 
      RowBox[{"URLExecute", "/@", "thumbnailData"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", ".5", " ", "URL", " ", "preparations"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"downloadURLdata", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"htmlData", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
          RowBox[{"url", ":", 
           RowBox[{"(", 
            RowBox[{"\"\<href=\\\"/wallpaper/\>\"", "~~", 
             RowBox[{
              RowBox[{"Except", "[", "WhitespaceCharacter", "]"}], ".."}], "~~",
              "\[IndentingNewLine]", "\"\</\>\"", "~~", 
             RowBox[{"IntegerString", "[", 
              RowBox[{"newIDs", ",", "10", ",", "5"}], "]"}], "~~", "__", "~~", 
             RowBox[{"resolution", "<>", "\"\<.jpg\>\""}]}], ")"}]}], 
          "\[IndentingNewLine]", "]"}], "\[RuleDelayed]", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"url", ",", 
           RowBox[{
           "\"\<href=\\\"\>\"", "\[Rule]", 
            "\"\<https://interfacelift.com\>\""}]}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"downloadURLdata", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Shortest", "[", 
           RowBox[{"\"\</wallpaper/\>\"", "~~", "__", "~~", "\"\</0\>\"", "~~", 
            RowBox[{"id", ":", 
             RowBox[{"DigitCharacter", ".."}]}], "~~", "\"\<_\>\""}], "]"}], 
          "\[RuleDelayed]", "id"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"downloadURLdata", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Thread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ToExpression", "@", "temp"}], "\[Rule]", 
         "downloadURLdata"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".6", ".", " ", "Merging"}], " ", "data", " ", 
       "associations"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Merge", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "itemData", ",", "thumbnailData", ",", "commentData", ",", 
          "downloadURLdata"}], "}"}], ",", "Identity"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{"data", ",", 
        RowBox[{"#0", "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Selection"}], " ", "and", " ", "download", " ",
        "of", " ", "images", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Function"}], " ", "for", " ", "displaying", 
       " ", "thumbnails"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"userSelected", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", "i_", "]"}], ":=", 
      RowBox[{"ChoiceDialog", "[", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "24", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "750"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", "14", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
             RowBox[{"LineIndent", "\[Rule]", "0"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<Queue\>\"", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Skip\>\"", "\[Rule]", "False"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"WindowTitle", "\[Rule]", "\"\<Wallpaper selection\>\""}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"WindowSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"750", ",", "All"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Return\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"userSelected", ",", 
       RowBox[{"f", "[", "i", "]"}]}], "]"}], ";", 
     RowBox[{"i", "++"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "\[LessEqual]", "L"}], ",", 
       RowBox[{"Goto", "[", "\"\<Return\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"userSelected", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"data", ",", "userSelected", ",", "True"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"None", " ", 
       RowBox[{"selected", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"userSelected", "===", 
        RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetWallpapers", "::", "noNew"}], "]"}], ";", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"userSelected", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".2", " ", "Download"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dynamic", " ", "status"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"n", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"Length", "@", "temp"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", "\[IndentingNewLine]", 
      RowBox[{"Row", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Wallpaper download progress:\>\"", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
             "16"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "@", 
           RowBox[{"ProgressIndicator", "[", 
            RowBox[{"n", "/", "k"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "[", 
           RowBox[{"Text", "[", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"\"\<Downloaded: \>\"", "<>", 
               RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\< of \>\"", "<>", 
               RowBox[{"ToString", "[", "k", "]"}]}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
              "12"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Alignment", "\[Rule]", "Center"}]}], "\[IndentingNewLine]", 
       "]"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Actual", " ", "download"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"URLSave", "[", 
         RowBox[{
          RowBox[{"temp", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"downloadDir", ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<(\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Keys", "@", "temp"}], ")"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", "\"\<) \>\"", "<>",
               "\[IndentingNewLine]", 
              RowBox[{"temp", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "<>", 
              "\"\<.jpg\>\""}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", "++"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "temp"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Messages", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Text", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<All images already downloaded\>\"", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
           "16"}], "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Text", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Download completed\>\"", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
           "16"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760532517644*^9}, 
   3.6758597170894003`*^9, {3.676024965583131*^9, 3.676025469647758*^9}, {
   3.676025515745885*^9, 3.67602551884039*^9}, {3.6760255800964117`*^9, 
   3.676025582599947*^9}, {3.6760256476900063`*^9, 3.676025699959778*^9}, {
   3.676025865312593*^9, 3.67602604135182*^9}, {3.676026109873337*^9, 
   3.6760262817125607`*^9}, {3.676026325000695*^9, 3.6760263507216463`*^9}, {
   3.676026382289031*^9, 3.676026484521103*^9}, {3.676026542811741*^9, 
   3.67602656837764*^9}, {3.676026613642357*^9, 3.676026614274495*^9}, {
   3.6760266965625753`*^9, 3.676026735628437*^9}, {3.676026767748019*^9, 
   3.676026801762232*^9}, {3.67602687925953*^9, 3.6760268857551126`*^9}, {
   3.6760269248117867`*^9, 3.6760269360508623`*^9}, {3.676027933354642*^9, 
   3.676028105040491*^9}, {3.676028239929921*^9, 3.67602825800887*^9}, {
   3.676028319625607*^9, 3.676028334713768*^9}, {3.6760283651144943`*^9, 
   3.676028367209239*^9}, {3.676028489241769*^9, 3.676028496480888*^9}, {
   3.676028536074739*^9, 3.67602853712759*^9}, {3.676028567770694*^9, 
   3.676028568768545*^9}, {3.676028662106901*^9, 3.676028665809412*^9}, 
   3.6760287014495497`*^9, {3.676263344866416*^9, 3.676263350673572*^9}, {
   3.676266144286839*^9, 3.676266167951706*^9}, {3.676266236588616*^9, 
   3.676266263860808*^9}, {3.676266355801222*^9, 3.676266359064353*^9}, {
   3.676266400360446*^9, 3.676266402783497*^9}, {3.67983858550506*^9, 
   3.679838591487039*^9}, {3.679838771013543*^9, 3.6798387830851297`*^9}, {
   3.679838887546885*^9, 3.679838906496861*^9}, {3.679838957283988*^9, 
   3.679838972398939*^9}, {3.679839264353341*^9, 3.679839268472041*^9}, {
   3.679839312409122*^9, 3.679839319719692*^9}, {3.679839356913896*^9, 
   3.679839362183702*^9}, {3.6834573440096807`*^9, 3.6834573446504097`*^9}, {
   3.685807690241661*^9, 3.685807690464303*^9}, {3.685807720567437*^9, 
   3.6858077965971413`*^9}, {3.687434145031394*^9, 3.687434155035076*^9}, {
   3.68743445011117*^9, 3.687434468317842*^9}, {3.687434596249612*^9, 
   3.687434649873057*^9}, {3.687441446541209*^9, 3.687441558320661*^9}, {
   3.687441599544148*^9, 3.687441743434497*^9}, {3.687441775974131*^9, 
   3.6874417987475023`*^9}, {3.687441831829041*^9, 3.687441853123687*^9}, {
   3.687441906498824*^9, 3.687441963894146*^9}, {3.687442008377631*^9, 
   3.687442071193953*^9}, {3.687442109777306*^9, 3.687442115752943*^9}, {
   3.68744214892045*^9, 3.687442163838208*^9}, {3.687442620175901*^9, 
   3.687442620927599*^9}, {3.687442675149248*^9, 3.6874427491313343`*^9}, {
   3.6874427873153133`*^9, 3.687442788338522*^9}, {3.6874606944665537`*^9, 
   3.687460705313322*^9}, {3.687460929213545*^9, 3.687460937518474*^9}, 
   3.687461232795106*^9, {3.68746140792739*^9, 3.6874614906764803`*^9}, {
   3.687461538573071*^9, 3.687461544431966*^9}, 3.6874615774598923`*^9, {
   3.687461713066539*^9, 3.687461756410522*^9}, {3.68746178701858*^9, 
   3.68746181524817*^9}, {3.6874628512392893`*^9, 3.687462860574318*^9}, {
   3.687463660938143*^9, 3.687463661061008*^9}, {3.687463833490366*^9, 
   3.6874638343982077`*^9}, {3.687463986029216*^9, 3.687463986854792*^9}, {
   3.687464035291656*^9, 3.68746406526573*^9}, {3.687464305576037*^9, 
   3.687464306990657*^9}, {3.6875331433616667`*^9, 3.687533233312932*^9}, 
   3.68753334149444*^9, {3.687533381199279*^9, 3.687533402964898*^9}, {
   3.6875334503178587`*^9, 3.687533453044878*^9}, 3.6875335003006287`*^9, {
   3.687535117423121*^9, 3.687535196539281*^9}, {3.6875352320056763`*^9, 
   3.687535280282784*^9}, {3.6875353495463953`*^9, 3.6875353545446367`*^9}, {
   3.6875359088449593`*^9, 3.6875359351234007`*^9}, {3.687536030579694*^9, 
   3.687536061058978*^9}, {3.687536134864154*^9, 3.687536139294635*^9}, {
   3.687536173719574*^9, 3.687536174445909*^9}, {3.68753621368743*^9, 
   3.687536278179556*^9}, {3.6875363228232317`*^9, 3.687536344561455*^9}, {
   3.687536397036786*^9, 3.687536452495233*^9}, 3.687536496130087*^9, {
   3.687536618396985*^9, 3.687536684145252*^9}, {3.687536723440735*^9, 
   3.687536763134861*^9}, {3.687536809464254*^9, 3.68753685064507*^9}, {
   3.6875368887808523`*^9, 3.687536917417218*^9}, {3.689143720484993*^9, 
   3.689143759527773*^9}, {3.689161397438723*^9, 3.689161414236912*^9}, {
   3.689161472244587*^9, 3.689161487480955*^9}, 3.689161550672901*^9, {
   3.689162050228339*^9, 3.68916213216901*^9}, {3.689162178587137*^9, 
   3.6891621996544237`*^9}, {3.6891622597522078`*^9, 3.689162301103351*^9}, {
   3.689170763013435*^9, 3.689170800491914*^9}, {3.689227991672126*^9, 
   3.689227991742463*^9}, {3.68922888538087*^9, 3.689228936720771*^9}, {
   3.68922897196288*^9, 3.689228974777171*^9}, {3.689229080823193*^9, 
   3.689229089821207*^9}, {3.689229134789302*^9, 3.689229150532927*^9}, {
   3.6892292077328444`*^9, 3.689229256313159*^9}, {3.689229297715427*^9, 
   3.689229305488121*^9}, {3.689229355120236*^9, 3.6892293608790083`*^9}, {
   3.689229394110641*^9, 3.689229457420785*^9}, {3.689229528692524*^9, 
   3.689229551651548*^9}, {3.689229598156221*^9, 3.68922959853018*^9}, {
   3.6892304246810093`*^9, 3.68923042500597*^9}, 3.689230467687685*^9, {
   3.689230863837717*^9, 3.68923087208346*^9}, {3.689231071096784*^9, 
   3.6892310874377213`*^9}, {3.689231291746533*^9, 3.6892313226649427`*^9}, {
   3.689231542510008*^9, 3.68923168614135*^9}, {3.68923173073517*^9, 
   3.689231756944583*^9}, {3.689231787311429*^9, 3.689231790173608*^9}, {
   3.689231845278357*^9, 3.689231846733121*^9}, {3.6892318783807898`*^9, 
   3.689231880051916*^9}, {3.6892319251089287`*^9, 3.6892322492035646`*^9}, {
   3.6892323078578053`*^9, 3.689232366978663*^9}, {3.68923245004877*^9, 
   3.689232506360935*^9}, {3.689232612332309*^9, 3.689232675699667*^9}, {
   3.6892327062141848`*^9, 3.689232755338293*^9}, {3.6892328000555573`*^9, 
   3.689232825728194*^9}, {3.6892329389160337`*^9, 3.689232979738976*^9}, {
   3.689233581405051*^9, 3.689233610611374*^9}, {3.689233676779195*^9, 
   3.6892337094347057`*^9}, {3.689233745072814*^9, 3.689233790871626*^9}, {
   3.689233852752417*^9, 3.689233931446651*^9}, {3.689234420612647*^9, 
   3.689234430641255*^9}, {3.689234763611938*^9, 3.6892348047610283`*^9}, {
   3.689235013349279*^9, 3.689235071857584*^9}, {3.689235115739749*^9, 
   3.6892351165341873`*^9}, {3.689235261375656*^9, 3.6892352931821833`*^9}, {
   3.689235421036282*^9, 3.689235479816584*^9}, {3.6892355449401207`*^9, 
   3.689235554434264*^9}, {3.689235664314101*^9, 3.689235676157255*^9}, 
   3.689235776269311*^9, {3.689235875225749*^9, 3.689235924503316*^9}, {
   3.6892359742885923`*^9, 3.689236039285426*^9}, 3.692708053521682*^9, {
   3.6927080949822407`*^9, 3.69270815047003*^9}, {3.6927082111513643`*^9, 
   3.692708217538163*^9}, {3.698820543691766*^9, 3.698820610571306*^9}, {
   3.69882065510717*^9, 3.698820679233715*^9}, 3.698820740279583*^9, {
   3.698820923004937*^9, 3.6988209297139387`*^9}, {3.6988209622478027`*^9, 
   3.6988209628393517`*^9}, {3.698820998112653*^9, 3.698821033277979*^9}, {
   3.6988212916640863`*^9, 3.698821431594145*^9}, {3.6988214811397467`*^9, 
   3.698821489794044*^9}, {3.698821525745571*^9, 3.698821565504715*^9}, {
   3.698821734315688*^9, 3.698821771160987*^9}, {3.6988219095295677`*^9, 
   3.698821930726902*^9}, {3.698822044293515*^9, 3.6988221112648077`*^9}, 
   3.698822170466457*^9, 3.6988222300252457`*^9, 3.698822716929098*^9, {
   3.6988227660405293`*^9, 3.6988227873511953`*^9}, {3.698822827030431*^9, 
   3.6988228759641247`*^9}, {3.698822954297369*^9, 3.698822970953538*^9}, {
   3.698823401140126*^9, 3.698823422217499*^9}, {3.69882353503924*^9, 
   3.6988236733935966`*^9}, {3.6988237081684017`*^9, 
   3.6988237136712914`*^9}, {3.698823759025626*^9, 3.698823759735627*^9}, {
   3.6988238011416073`*^9, 3.698823831100375*^9}, {3.698824294998447*^9, 
   3.6988242993260593`*^9}, {3.698824532767014*^9, 3.698824573011606*^9}, {
   3.698824603565996*^9, 3.698824679547264*^9}, {3.6988248217272863`*^9, 
   3.69882484269591*^9}, {3.6988248742551193`*^9, 3.698824874733783*^9}, {
   3.714831540577577*^9, 3.714831558309544*^9}, {3.7408906894694433`*^9, 
   3.740890699584373*^9}, {3.740890768204583*^9, 3.74089081400345*^9}, {
   3.7408908503128853`*^9, 3.740890885436679*^9}, {3.740891773313387*^9, 
   3.740891802569051*^9}, {3.7408920497083*^9, 3.740892252980397*^9}, {
   3.740892506850162*^9, 3.740892635410843*^9}, {3.740892694146598*^9, 
   3.740892715742388*^9}, {3.740892755062392*^9, 3.740892757807778*^9}, {
   3.7408927962051277`*^9, 3.740892812643777*^9}, 3.7408928501560783`*^9, {
   3.740892902386469*^9, 3.7408929837083263`*^9}, {3.74089303237313*^9, 
   3.740893071532558*^9}, {3.740893178184226*^9, 3.740893215507592*^9}, {
   3.7408933304764977`*^9, 3.740893376580947*^9}, {3.740893522871208*^9, 
   3.740893597340444*^9}, {3.740893629237281*^9, 3.740893636561501*^9}, {
   3.740894231126853*^9, 3.7408942543870487`*^9}, {3.740894394783902*^9, 
   3.7408944126690273`*^9}, {3.740894760808733*^9, 3.740894769010334*^9}, {
   3.740895362703017*^9, 3.740895399203763*^9}, {3.7408960118820868`*^9, 
   3.7408960292131853`*^9}, {3.740896100298332*^9, 3.740896129715062*^9}, {
   3.7408961629723577`*^9, 3.740896253497458*^9}, {3.740896348531629*^9, 
   3.740896378412438*^9}, 3.7408964520986643`*^9, {3.740897017857913*^9, 
   3.740897116608354*^9}, {3.740897294925095*^9, 3.740897303965829*^9}, {
   3.7408977666746607`*^9, 3.7408977792536983`*^9}, {3.7408978113187523`*^9, 
   3.7408979040167103`*^9}, {3.740897935243805*^9, 3.740897935846511*^9}, {
   3.74089796893349*^9, 3.7408979693323298`*^9}, {3.740898030686364*^9, 
   3.740898052982459*^9}, {3.740898084070273*^9, 3.740898084357779*^9}, {
   3.740898133824205*^9, 3.7408981761831017`*^9}, 3.740898376777574*^9, {
   3.740898445071912*^9, 3.740898469512225*^9}, 3.7408985322899523`*^9, {
   3.740898643160071*^9, 3.740898785352674*^9}, {3.740898868207748*^9, 
   3.740898868330018*^9}, {3.740899057691608*^9, 3.740899118356969*^9}, 
   3.7408992194366293`*^9, {3.740899397630846*^9, 3.7408994030915127`*^9}, {
   3.740900458068342*^9, 3.740900464388323*^9}, {3.7409005153480377`*^9, 
   3.740900535775002*^9}, {3.7409007043452873`*^9, 3.740900729645743*^9}, {
   3.740900770404174*^9, 3.740900797381947*^9}, {3.7409008939261*^9, 
   3.740900923204875*^9}, {3.740901058899197*^9, 3.7409010960936327`*^9}, {
   3.740901137840193*^9, 3.7409011585546637`*^9}, 3.740901210032846*^9, {
   3.740901256414557*^9, 3.740901260871154*^9}, {3.7409013083116007`*^9, 
   3.74090130860926*^9}, {3.7409013394733753`*^9, 3.7409013464373627`*^9}, {
   3.740901485137375*^9, 3.740901487208301*^9}, {3.740901542653356*^9, 
   3.74090154304468*^9}, {3.7409016183713303`*^9, 3.740901705449177*^9}, {
   3.740901737013363*^9, 3.740901853656617*^9}, {3.740901983840465*^9, 
   3.740902217515576*^9}, {3.740902249965267*^9, 3.7409022768993807`*^9}, {
   3.740902318537183*^9, 3.740902365396896*^9}, {3.74090240353998*^9, 
   3.740902420893825*^9}, {3.7409024735376987`*^9, 3.740902474327689*^9}, {
   3.740902538280342*^9, 3.740902622208213*^9}, {3.740903896523925*^9, 
   3.740904037954124*^9}, {3.740904083942678*^9, 3.740904148395405*^9}, {
   3.740904393796962*^9, 3.740904396652628*^9}, {3.7409044314950533`*^9, 
   3.740904464846571*^9}, {3.740904535956167*^9, 3.740904607540613*^9}, {
   3.740904658514895*^9, 3.740904658833832*^9}, {3.740907605495767*^9, 
   3.74090760692924*^9}, {3.740907810717853*^9, 3.7409078786341333`*^9}, {
   3.7409079101964083`*^9, 3.740907916003162*^9}, {3.740907950005499*^9, 
   3.740907951227255*^9}, {3.74090841342029*^9, 3.740908415107514*^9}, {
   3.7409084984646187`*^9, 3.740908499461583*^9}, {3.740911490695024*^9, 
   3.7409115492595673`*^9}, {3.740911678593512*^9, 3.740911690864873*^9}, {
   3.740911754008708*^9, 3.740911844439476*^9}, {3.74091189154906*^9, 
   3.7409119234829283`*^9}, {3.740931150862105*^9, 3.740931150914604*^9}, {
   3.74097533952845*^9, 3.740975339591961*^9}, {3.7409756377644863`*^9, 
   3.740975654403399*^9}, {3.740975701912651*^9, 3.740975727527667*^9}, {
   3.740976137273267*^9, 3.7409761415581923`*^9}, {3.741024109087201*^9, 
   3.74102421870224*^9}, {3.741024255393237*^9, 3.741024339160699*^9}, {
   3.74102452594668*^9, 3.741024541785985*^9}, {3.741024696962208*^9, 
   3.74102482641168*^9}, {3.7410249509309072`*^9, 3.741025113532157*^9}, {
   3.741025242701519*^9, 3.741025256946368*^9}, {3.74102530422472*^9, 
   3.741025347574325*^9}, {3.74102538582486*^9, 3.7410253896459217`*^9}, {
   3.7410254329620256`*^9, 3.741025435517352*^9}, {3.7410272500820637`*^9, 
   3.7410272853410807`*^9}, {3.74102735165961*^9, 3.741027362849684*^9}, {
   3.7410273929683857`*^9, 3.7410273967050667`*^9}, {3.741027429138439*^9, 
   3.741027463760561*^9}, {3.741027502081562*^9, 3.741027569805504*^9}, {
   3.741027745865487*^9, 3.741027784246591*^9}, {3.7410278649136047`*^9, 
   3.741028112359179*^9}, {3.741028155361185*^9, 3.7410282022913733`*^9}, {
   3.741028233310907*^9, 3.7410282931040707`*^9}, {3.741028365651976*^9, 
   3.741028448791223*^9}, {3.741028525033021*^9, 3.7410285626847057`*^9}, {
   3.7410285995975113`*^9, 3.74102860231654*^9}, {3.741028721822791*^9, 
   3.741028861752837*^9}, {3.741361819099842*^9, 3.741361850652608*^9}, {
   3.741362008183255*^9, 3.741362016479569*^9}, {3.741362053177204*^9, 
   3.74136208452314*^9}, {3.7413621148155813`*^9, 3.7413621209222803`*^9}, 
   3.741362155981688*^9, 3.74141219795181*^9, {3.741412252544795*^9, 
   3.741412313058753*^9}, {3.741412412459033*^9, 3.741412428861911*^9}, {
   3.741412462495098*^9, 3.741412490250186*^9}, {3.741412542649473*^9, 
   3.741412560097638*^9}, {3.7414126571916943`*^9, 3.741412658597611*^9}, {
   3.7414127376845284`*^9, 3.741412797263571*^9}, {3.741412892175005*^9, 
   3.741412908281444*^9}, {3.741412949128401*^9, 3.741412949425137*^9}, {
   3.741413750241715*^9, 3.741413827090974*^9}, {3.741413875346999*^9, 
   3.741413930898109*^9}, {3.74142107386246*^9, 3.7414210761002398`*^9}, {
   3.741421111894011*^9, 3.741421129315464*^9}, {3.7414213120205793`*^9, 
   3.7414213150021963`*^9}, 3.741421400500951*^9, {3.7414214357488813`*^9, 
   3.7414214374753847`*^9}, {3.7414214688130913`*^9, 3.741421470407323*^9}, {
   3.741421652241467*^9, 3.741421662115738*^9}, {3.741421783367549*^9, 
   3.7414218762966127`*^9}, {3.7414221831243353`*^9, 
   3.7414221864406967`*^9}, {3.741422262325679*^9, 3.741422277018862*^9}, 
   3.741422375434602*^9, {3.741422540453453*^9, 3.741422563532693*^9}, {
   3.741423357893344*^9, 3.7414234199566917`*^9}, {3.7414235496476097`*^9, 
   3.741423552789349*^9}, {3.741423628503368*^9, 3.7414236571314373`*^9}, {
   3.741423698279365*^9, 3.7414237731620817`*^9}, 3.7414238072673883`*^9, 
   3.7414238765300007`*^9, {3.741424210802187*^9, 3.7414242611105003`*^9}, {
   3.741424499264925*^9, 3.741424499860511*^9}, {3.741424532611413*^9, 
   3.741424532792862*^9}, 3.741424592674333*^9, {3.7414246848208*^9, 
   3.7414246863240128`*^9}, {3.74142471678443*^9, 3.741424719262456*^9}, {
   3.741424756001369*^9, 3.741424819807068*^9}, {3.741424867456118*^9, 
   3.741424884968337*^9}, {3.74142501728307*^9, 3.741425122409691*^9}, 
   3.74142519060002*^9, {3.741425235752171*^9, 3.741425245388207*^9}, {
   3.741425373827579*^9, 3.741425374737027*^9}, {3.74142542969097*^9, 
   3.741425558469193*^9}, {3.741454681899626*^9, 3.7414546837293367`*^9}, {
   3.7414547431555243`*^9, 3.741454753023761*^9}, 3.7414547981455917`*^9, 
   3.741454966885707*^9, {3.74145504227487*^9, 3.741455057089151*^9}, {
   3.7414551616876793`*^9, 3.741455221807589*^9}, {3.7414555584165907`*^9, 
   3.741455559737339*^9}, {3.7415274651648693`*^9, 3.741527496338407*^9}, {
   3.742183333929596*^9, 3.742183335639221*^9}, {3.742183412297061*^9, 
   3.7421834698676863`*^9}, {3.742183534719486*^9, 3.742183560230012*^9}, {
   3.7421836152347593`*^9, 3.742183616631295*^9}, 3.742183667990527*^9, {
   3.744458914490642*^9, 3.7444589690060177`*^9}, {3.744459003998764*^9, 
   3.744459024997178*^9}, 3.744459080607469*^9, {3.744459275207852*^9, 
   3.744459390900449*^9}, {3.7469616971208763`*^9, 3.746961720173236*^9}, {
   3.746961923245006*^9, 3.746961960876544*^9}, {3.755948958999362*^9, 
   3.755948959243902*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[31]:=",ExpressionUUID->"25c668f6-23a5-478e-b009-e707374b07d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[32]:=",ExpressionUUID->"6c9d0217-78f7-4b48-a251-8f26cb6a0f7d"]
}, Closed]],

Cell[CellGroupData[{

Cell["GifGenerator", "Subchapter",
 CellChangeTimes->{{3.6589211819724207`*^9, 
  3.658921185149267*^9}},ExpressionUUID->"4b6fe57a-868d-479f-9b37-\
8245b81ab774"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[33]:=",ExpressionUUID->"d828999e-bda7-4154-b732-6aa849687fbc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GifGenerator", "::", "names"}], "=", 
   "\"\<Invalid dimensions of custom name list.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GifGenerator", "::", "namestring"}], "=", 
   "\"\<Some of the names are not strings.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GifGenerator", "::", "invalid"}], "=", 
   "\"\<Invalid \[LeftGuillemet]Names\[RightGuillemet] option.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GifGenerator", "::", "format"}], "=", 
    "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid output format.\>\
\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GifGenerator"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Time\>\"", "\[Rule]", "0.1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<GifName\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<OutputDirectory\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Format\>\"", "\[Rule]", "\"\<gif\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<BackwardsLoop\>\"", "\[Rule]", "False"}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678104346724377`*^9, {3.6678106741260653`*^9, 3.667810676122314*^9}, {
   3.6912156591212883`*^9, 3.691215706763674*^9}, {3.691216026574657*^9, 
   3.6912160345326557`*^9}, {3.6912167300240297`*^9, 3.69121673551864*^9}, 
   3.691221247334304*^9, {3.713511197716024*^9, 3.7135112024420033`*^9}, {
   3.761729935044736*^9, 3.761729935939042*^9}},
 Background->GrayLevel[0.85],
 CellLabel->"In[34]:=",ExpressionUUID->"02c55b43-9565-4a99-b029-5866e4fb8083"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[39]:=",ExpressionUUID->"fa91ebf0-85ca-4c3a-9ce4-8e1af93bfff0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GifGenerator", "[", 
   RowBox[{"input_List", ",", 
    RowBox[{"OptionsPattern", "@", "GifGenerator"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "L", ",", "autoimport", ",", "format", ",", "\[IndentingNewLine]", 
      "data", ",", "progress", ",", "image", ",", "\[IndentingNewLine]", 
      "data1", ",", "data2", ",", "\[IndentingNewLine]", "gifname", ",", 
      "dir", ",", "random", ",", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Checking", " ", "input", " ", "form"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "input"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     
     RowBox[{"Off", "[", 
      StyleBox[
       RowBox[{"FileExistsQ", "::", "fstr"}], "MessageName"], 
      StyleBox["]", "MessageName"]}], 
     StyleBox[";", "MessageName"], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Check", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"First", "@", "input"}]}], ",", 
         RowBox[{"Abort", "[", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"autoimport", "=", "True"}], ",", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"autoimport", "=", "False"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"autoimport", "=", "False"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"On", "[", 
      RowBox[{"FileExistsQ", "::", "fstr"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"format", "=", 
      RowBox[{"OptionValue", "[", "\"\<Format\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<gif\>\"", ",", "\"\<mp4\>\""}], "}"}], ",", 
          "format"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"GifGenerator", "::", "format"}], ",", "format"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Importing", " ", "data", " ", "if", " ", "necessary"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"autoimport", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Dynamic", " ", "status"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"progress", "=", "0"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"PrintTemporary", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{"Row", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Image import progress:\>\"", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",",
                 "16"}], "]"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"ProgressIndicator", "[", 
               RowBox[{"progress", "/", "L"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"Text", "[", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"\"\<Imported: \>\"", "<>", 
                  RowBox[{"ToString", "[", "progress", "]"}], "<>", 
                  "\"\< of \>\"", "<>", 
                  RowBox[{"ToString", "@", "L"}]}], ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], 
                 ",", "12"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
            "\t", "}"}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Alignment", "\[Rule]", "Center"}]}], 
          "\[IndentingNewLine]", "\t", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"image", "=", 
            RowBox[{"Import", "@", 
             RowBox[{"input", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"data", ",", "image"}], "]"}], ";", "\[IndentingNewLine]",
            "\t", 
           RowBox[{"progress", "++"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", "L"}], "}"}]}], "]"}]}], ",", "\t", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"No", " ", "import"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"data", "=", "input"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Backwards", " ", "loop"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<BackwardsLoop\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"data1", "=", "data"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"data2", "=", 
         RowBox[{"Rest", "@", 
          RowBox[{"Reverse", "@", "data"}]}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"data", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"data1", ",", "data2"}], "]"}]}]}]}], "\[IndentingNewLine]",
       "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Making", " ", "the", " ", "name", " ", "of", " ", "the", " ", "gif"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ImageQ", "[", 
        RowBox[{"First", "@", "input"}], "]"}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"gifname", "=", "\"\<output\>\""}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{
           RowBox[{"FileNameTake", "@", 
            RowBox[{"First", "@", "input"}]}], ",", "\"\<_\>\""}], "]"}], ",",
          "\[IndentingNewLine]", "\t", 
         RowBox[{"gifname", "=", 
          RowBox[{"StringDrop", "[", 
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"StringCases", "[", 
              RowBox[{
               RowBox[{"FileNameTake", "@", 
                RowBox[{"First", "@", "input"}]}], ",", 
               RowBox[{"__", "~~", "\"\<_\>\""}]}], "]"}]}], ",", 
            RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"gifname", "=", "\"\<output\>\""}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<GifName\>\"", "]"}]}], ",", 
       RowBox[{"gifname", "=", 
        RowBox[{"OptionValue", "[", "\"\<GifName\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Checking", " ", "output", " ", "directory"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"autoimport", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Use", " ", "source", " ", "directory"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"dir", "=", 
        RowBox[{"FileNameTake", "[", 
         RowBox[{
          RowBox[{"First", "@", "input"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Use", " ", "desktop"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"dir", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"$HomeDirectory", ",", "\"\<Desktop\>\""}], "}"}], 
         "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<OutputDirectory\>\"", "]"}], ",", 
       "Null", ",", "Null", ",", 
       RowBox[{"dir", "=", 
        RowBox[{"OptionValue", "[", "\"\<OutputDirectory\>\"", "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Exporting", " ", "to", " ", 
        RowBox[{"a", " ", ".", "mp4"}], " ", "video"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"format", "===", "\"\<mp4\>\""}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"random", "=", 
         RowBox[{"ToString", "@", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"10", "^", "10"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"dir", ",", 
            RowBox[{
            "\"\<tempname\>\"", "<>", "random", "<>", "\"\<.mov\>\""}]}], 
           "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Export", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
         "temp", ",", "\[IndentingNewLine]", "\t", "data", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
          "\"\<VideoEncoding\>\"", "\[Rule]", "\"\<MPEG-4 Video\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<FrameRate\>\"", "\[Rule]", 
           RowBox[{"1", "/", 
            RowBox[{"OptionValue", "[", "\"\<Time\>\"", "]"}]}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "@", 
         RowBox[{"RenameFile", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{"temp", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"dir", ",", 
              RowBox[{"gifname", "<>", "\"\<.mp4\>\""}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"OverwriteTarget", "\[Rule]", "True"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Exporting", " ", "gif"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"format", "===", "\"\<gif\>\""}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"Return", "@", 
        RowBox[{"Export", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"dir", ",", 
             RowBox[{"gifname", "<>", "\"\<.gif\>\""}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", "data", ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<Time\>\"", "]"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810666631538*^9, {3.669556436379407*^9, 3.669556443945465*^9}, {
   3.6912156836361237`*^9, 3.691215691704616*^9}, {3.69121596102699*^9, 
   3.691216023233466*^9}, {3.6912160979319572`*^9, 3.6912163992302313`*^9}, {
   3.691216511344393*^9, 3.691216511722507*^9}, {3.691216802362258*^9, 
   3.6912169039143972`*^9}, {3.691216946107288*^9, 3.691216948252275*^9}, 
   3.691216998432334*^9, {3.691217031882002*^9, 3.691217049269642*^9}, {
   3.691217109181466*^9, 3.691217164341524*^9}, {3.691217196325759*^9, 
   3.691217197652151*^9}, {3.6912174827952223`*^9, 3.6912174882906237`*^9}, {
   3.691217726509802*^9, 3.691217730152487*^9}, {3.691218143932776*^9, 
   3.6912181493599577`*^9}, {3.6912182361857443`*^9, 3.691218276722579*^9}, {
   3.691218499416984*^9, 3.6912184996811247`*^9}, {3.691219455092321*^9, 
   3.6912194552535553`*^9}, {3.7135112837866707`*^9, 3.713511285616396*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[40]:=",ExpressionUUID->"3cd49a64-af23-44a1-8ef2-81330882a3d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[41]:=",ExpressionUUID->"36de6a3e-2be7-45c7-aba4-31d218903854"]
}, Closed]],

Cell[CellGroupData[{

Cell["TagImages", "Subchapter",
 CellChangeTimes->{{3.665084487848164*^9, 3.665084489223646*^9}, {
  3.668162047446031*^9, 3.668162048572898*^9}, {3.714322616497538*^9, 
  3.714322616911911*^9}},ExpressionUUID->"a2a604c9-d4f7-4883-adb8-\
89d6af68a115"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[42]:=",ExpressionUUID->"2cccd52c-ba03-413e-97cd-a4ef60ebfbe1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TagImages", "::", "images"}], "=", 
   "\"\<Some of the images or file paths were invalid.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TagImages", "::", "tags"}], "=", 
   "\"\<Invalid dimensions of tag list.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TagImages", "::", "tagstrings"}], "=", 
   "\"\<Some of the tags are not strings.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TagImages", "::", "format"}], "=", 
    "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid output format.\>\
\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "TagImages"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<ExportTo\>\"", "\[Rule]", "\"\<InputDirectory\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Style\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"White", ",", "\"\<Inconsolata\>\"", ",", "54"}], "}"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"\"\<ImageFormat\>\"", "\[Rule]", "\"\<png\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<NewName\>\"", "\[Rule]", "False"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678104346724377`*^9, {3.667810796098818*^9, 3.667810798047408*^9}, {
   3.668152800687623*^9, 3.668152809739086*^9}, {3.6681530121130753`*^9, 
   3.6681530125505037`*^9}, {3.6681540409110413`*^9, 3.668154061237252*^9}, {
   3.6681552651940813`*^9, 3.66815526632075*^9}, {3.668156714128182*^9, 
   3.6681567243345957`*^9}, {3.668156786288147*^9, 3.668156789718041*^9}, {
   3.668157814277363*^9, 3.668157835317951*^9}, {3.690533451027625*^9, 
   3.690533464459483*^9}, {3.714322621882193*^9, 3.714322629520378*^9}, {
   3.714322720807767*^9, 3.714322721062339*^9}, {3.714734863117217*^9, 
   3.714734865432803*^9}, {3.714739556875498*^9, 3.714739564443028*^9}, {
   3.7147403943052263`*^9, 3.714740407678631*^9}, {3.714740755825068*^9, 
   3.7147407607673063`*^9}, 3.714797991839682*^9, {3.7148100720648003`*^9, 
   3.7148100966067543`*^9}, {3.71481110302629*^9, 3.7148111068725653`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"868683c8-5bc6-4c3f-b12e-94765e65c2bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[48]:=",ExpressionUUID->"721e678e-1b30-42d4-8e23-7ba425cd27c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TagImages", "[", 
   RowBox[{"input_", ",", "tags_List", ",", 
    RowBox[{"OptionsPattern", "@", "TagImages"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "images", ",", "type", ",", "L", ",", "\[IndentingNewLine]", "tagsLB", 
      ",", "tagsRB", ",", "progress", ",", "i", ",", "firstimage", ",", "dim",
       ",", "Lspace", ",", "Rspace", ",", "Bspace", ",", 
      "\[IndentingNewLine]", "oldbasename", ",", "newnamesf", ",", "newnames",
       ",", "nnOption", ",", "\[IndentingNewLine]", "inputdir", ",", 
      "outputdir", ",", "format", ",", "\[IndentingNewLine]", "s1", ",", "s2",
       ",", "s3", ",", "image", ",", "new1", ",", "new2"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Checking", " ", "input", " ", "form"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"images", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "input", "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"AllTrue", "[", 
        RowBox[{"images", ",", "ImageQ"}], "]"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"type", "=", "\"\<image\>\""}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"AllTrue", "[", 
        RowBox[{"images", ",", "FileExistsQ"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"type", "=", "\"\<string\>\""}], ",", "\t", 
       "\[IndentingNewLine]", "\t", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"TagImages", "::", "images"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "images"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "format", " ", "of", " ", "tags"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "tags", "]"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"L", ",", "2"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"TagImages", "::", "tags"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "tags"}], ",", "StringQ"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"TagImages", "::", "tagstrings"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "image", " ", "output", " ", "format"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"format", "=", 
      RowBox[{"ToLowerCase", "@", 
       RowBox[{"OptionValue", "[", "\"\<ImageFormat\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"format", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"format", ",", 
        RowBox[{"\"\<jpeg\>\"", "\[Rule]", "\"\<jpg\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<jpg\>\"", ",", "\"\<png\>\""}], "}"}], ",", 
          "format"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"TagImages", "::", "format"}], ",", "format"}], "]"}], ";", 
        
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Preparing", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"tagsLB", "=", 
      RowBox[{"tags", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"tagsRB", "=", 
      RowBox[{"tags", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"progress", "=", "0"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"firstimage", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"type", "\[Equal]", "\"\<string\>\""}], ",", 
        RowBox[{"Import", "@", 
         RowBox[{"First", "@", "images"}]}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"type", "\[Equal]", "\"\<image\>\""}], ",", 
        RowBox[{"First", "@", "images"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"dim", "=", 
      RowBox[{"ImageDimensions", "@", "firstimage"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Lspace", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"0.015", "*", 
        RowBox[{"First", "@", "dim"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Rspace", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"0.985", "*", 
        RowBox[{"First", "@", "dim"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Bspace", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"0.03", "*", 
        RowBox[{"Last", "@", "dim"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dynamic", " ", "status"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"PrintTemporary", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"Row", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Image conversion progress:\>\"", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
             "16"}], "]"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"Dynamic", "@", 
           RowBox[{"ProgressIndicator", "[", 
            RowBox[{"progress", "/", "L"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"Dynamic", "[", 
           RowBox[{"Text", "[", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"\"\<Converted: \>\"", "<>", 
               RowBox[{"ToString", "[", "progress", "]"}], "<>", 
               "\"\< of \>\"", "<>", 
               RowBox[{"ToString", "@", "L"}]}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
              "12"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", "\t", 
         "}"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"Alignment", "\[Rule]", "Center"}]}], "\[IndentingNewLine]", 
       "\t", "]"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{"New", " ", "names"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"newnamesf", "[", "old_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"old", "<>", "\"\<_\>\"", "<>", "\[IndentingNewLine]", "\t", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"#", ",", "10", ",", 
           RowBox[{"StringLength", "@", 
            RowBox[{"ToString", "@", "L"}]}]}], "]"}]}], "&"}], "/@", 
       RowBox[{"Range", "@", "L"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"nnOption", "=", 
      RowBox[{"OptionValue", "[", "\"\<NewName\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"type", "\[Equal]", "\"\<string\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"File", " ", "name", " ", "input"}], ",", " ", 
          RowBox[{"use", " ", "numeric", " ", "names"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"TrueQ", "@", "nnOption"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"oldbasename", "=", 
           RowBox[{"First", "@", 
            RowBox[{"StringCases", "[", 
             RowBox[{
              RowBox[{"StringTake", "\[IndentingNewLine]", "\t", "[", 
               RowBox[{
                RowBox[{"FileNameTake", "@", 
                 RowBox[{"First", "@", "images"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"__", "~~", "LetterCharacter"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"newnames", "=", 
           RowBox[{"newnamesf", "@", "oldbasename"}]}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
         RowBox[{"!", 
          RowBox[{"TrueQ", "@", "nnOption"}]}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"File", " ", "name", " ", "input"}], ",", " ", 
           RowBox[{"keep", " ", "old", " ", "names"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"newnames", "=", 
          RowBox[{"FileBaseName", "/@", 
           RowBox[{"FileNameTake", "/@", "images"}]}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
         RowBox[{"StringQ", "@", "nnOption"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"File", " ", "name", " ", "input"}], ",", " ", 
           RowBox[{"custom", " ", "base", " ", "name"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"newnames", "=", 
          RowBox[{"newnamesf", "@", "nnOption"}]}]}], "\[IndentingNewLine]", 
        "\t", "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"type", "\[Equal]", "\"\<image\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"StringQ", "@", "nnOption"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Image", " ", "intput"}], ",", " ", 
           RowBox[{"custom", " ", "base", " ", "name"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"newnames", "=", 
          RowBox[{"newnamesf", "@", "nnOption"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Image", " ", "input"}], ",", " ", 
           RowBox[{
            RowBox[{"defualt", " ", "'"}], 
            RowBox[{"Output", "'"}], " ", "name"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"newnames", "=", 
          RowBox[{"newnamesf", "[", "\"\<Output\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "\t", "]"}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Export", " ", "directory"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"DirectoryQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ExportTo\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Option", ":", " ", 
         RowBox[{"Custom", " ", "output", " ", "directory"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"outputdir", "=", 
        RowBox[{"OptionValue", "[", "\"\<ExportTo\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"type", "\[Equal]", "\"\<image\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "images"}], ",", " ", 
         RowBox[{"export", " ", "to", " ", "desktop"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"outputdir", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
          "$HomeDirectory", ",", "\"\<Desktop\>\"", ",", "\"\<Output\>\""}], 
          "}"}], "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"type", "\[Equal]", "\"\<string\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Use", " ", "input", " ", "directory"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"inputdir", "=", 
         RowBox[{"DirectoryName", "@", 
          RowBox[{"First", "@", "images"}]}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"outputdir", "=", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"inputdir", ",", "\"\<Output\>\""}], "}"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Quiet", "@", 
      RowBox[{"CreateDirectory", "@", "outputdir"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Procedure", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<StartProcedure\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Marking", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s1", ",", "s2", ",", "s3"}], "}"}], "=", 
      RowBox[{"OptionValue", "[", "\"\<Style\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"image", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"type", "\[Equal]", "\"\<string\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Import", "@", 
            RowBox[{"images", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"type", "\[Equal]", "\"\<image\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"images", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "\[IndentingNewLine]", "\t", 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"new1", "=", 
         RowBox[{"ImageCompose", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{"image", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"Text", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"tagsLB", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "s1", ",", 
                RowBox[{"FontFamily", "\[Rule]", "s2"}], ",", "s3"}], "]"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Left", ",", "Center"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Lspace", ",", "Bspace"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"new2", "=", 
         RowBox[{"ImageCompose", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{"new1", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"Text", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"tagsRB", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "s1", ",", 
                RowBox[{"FontFamily", "\[Rule]", "s2"}], ",", "s3"}], "]"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Right", ",", "Center"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Rspace", ",", "Bspace"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", "Export", " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"outputdir", ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"newnames", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<.\>\"", "<>", 
              "format"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
          "new2"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"progress", "++"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", "L"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "[", "progress", "]"}], "<>", "\"\< \>\"", "<>", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"L", "\[Equal]", "1"}], ",", "\"\<image\>\"", ",", 
         "\"\<images\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
       "\"\< were exported to \[LeftGuillemet]\>\"", "<>", 
       "\[IndentingNewLine]", 
       RowBox[{"ToString", "[", "outputdir", "]"}], "<>", 
       "\"\<\[RightGuillemet].\>\""}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.66781076989314*^9, {3.668152612339699*^9, 3.668152619386612*^9}, {
   3.6681538164462643`*^9, 3.668153841733284*^9}, {3.6681538917796783`*^9, 
   3.66815389460347*^9}, {3.6681539807864857`*^9, 3.6681539831535*^9}, {
   3.6681540741842012`*^9, 3.668154137661747*^9}, {3.668154171518057*^9, 
   3.668154186612385*^9}, 3.668154781378957*^9, {3.668154972203656*^9, 
   3.6681549835459843`*^9}, {3.6681550186978683`*^9, 3.668155029856184*^9}, {
   3.6681550621757803`*^9, 3.6681551334701157`*^9}, {3.668155207037395*^9, 
   3.668155224072003*^9}, {3.668155278012027*^9, 3.668155278882615*^9}, {
   3.6681554562322407`*^9, 3.668155612091757*^9}, {3.668155671378231*^9, 
   3.668155690904714*^9}, {3.668155954499608*^9, 3.6681560233848553`*^9}, {
   3.668156078231288*^9, 3.6681561857325706`*^9}, {3.668156248468493*^9, 
   3.668156326458626*^9}, {3.668156383073492*^9, 3.668156383728332*^9}, {
   3.668156502709445*^9, 3.668156537192501*^9}, {3.6681565717731647`*^9, 
   3.668156572139941*^9}, {3.6681566050270443`*^9, 3.668156692105473*^9}, {
   3.668156757464101*^9, 3.66815675799185*^9}, {3.668157640838399*^9, 
   3.668157643251562*^9}, {3.6681577429324703`*^9, 3.668157806280027*^9}, {
   3.668157851992715*^9, 3.668157863246393*^9}, {3.668161901796295*^9, 
   3.668161912586226*^9}, 3.668162009970155*^9, {3.690533473039648*^9, 
   3.6905335760640297`*^9}, {3.7143226325973186`*^9, 3.714322660900158*^9}, {
   3.7147348716986437`*^9, 3.714734874492527*^9}, 3.714734985805903*^9, {
   3.714735588747815*^9, 3.714735676632259*^9}, {3.714738685908175*^9, 
   3.714738720242131*^9}, {3.714739289293894*^9, 3.714739319035997*^9}, {
   3.714739465313553*^9, 3.7147395443264914`*^9}, {3.714739574758871*^9, 
   3.7147396012290173`*^9}, {3.7147396360448647`*^9, 3.714739701571308*^9}, 
   3.714739731602735*^9, {3.71473981459341*^9, 3.714739878183153*^9}, {
   3.7147401635518827`*^9, 3.714740196762953*^9}, {3.7147407325181303`*^9, 
   3.714740734035376*^9}, {3.714740765852787*^9, 3.714740766802635*^9}, {
   3.714740991430148*^9, 3.7147410047587643`*^9}, {3.7147964127200747`*^9, 
   3.7147964150947657`*^9}, {3.714796471353161*^9, 3.7147964738632383`*^9}, {
   3.714796535366661*^9, 3.714796542195622*^9}, {3.714796628179995*^9, 
   3.71479662885573*^9}, 3.714797260039068*^9, {3.714797401202031*^9, 
   3.714797404112928*^9}, {3.7147979730356293`*^9, 3.714798064072526*^9}, {
   3.7147999032226458`*^9, 3.714799952613496*^9}, {3.714800658737029*^9, 
   3.714800689242618*^9}, {3.714800815905838*^9, 3.7148008722408733`*^9}, {
   3.714800971981523*^9, 3.71480100729186*^9}, {3.714801766826825*^9, 
   3.714801786233788*^9}, {3.714801832585327*^9, 3.714801878799358*^9}, {
   3.7148024818517714`*^9, 3.7148025510073013`*^9}, {3.714802599761133*^9, 
   3.7148026250537643`*^9}, {3.7148030507251873`*^9, 3.714803097988085*^9}, {
   3.7148032493218813`*^9, 3.714803249895904*^9}, {3.714803334398253*^9, 
   3.714803340764709*^9}, 3.714803484443268*^9, {3.714803727462044*^9, 
   3.714803758324766*^9}, {3.714803888882957*^9, 3.7148040386289177`*^9}, {
   3.7148045388668823`*^9, 3.714804575273017*^9}, {3.71480466779195*^9, 
   3.7148047101894073`*^9}, {3.7148084949055157`*^9, 3.714808556910639*^9}, {
   3.714809233992529*^9, 3.714809277965659*^9}, {3.714809535440876*^9, 
   3.7148095367754707`*^9}, {3.7148098568588543`*^9, 3.714809857112962*^9}, 
   3.714809938479796*^9, {3.714810012863154*^9, 3.714810068291901*^9}, 
   3.714811044641264*^9, {3.714811111238121*^9, 3.714811168331624*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[49]:=",ExpressionUUID->"b5ce9337-e4ed-4b5d-9673-338bd1a6554b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[50]:=",ExpressionUUID->"e0577e5d-ded5-4286-aa05-c2701908bbff"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractUsage", "Subchapter",
 CellChangeTimes->{{3.667842371425439*^9, 
  3.6678423738006783`*^9}},ExpressionUUID->"08c528c4-043f-447d-95c2-\
c97a6803f147"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[319]:=",ExpressionUUID->"f4068f08-0f51-470c-b359-3d6b531da7c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtractUsage", "::", "mode"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a recognised mode.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExtractUsage", "::", "link"}], "=", 
    "\"\<The function name \[LeftGuillemet]`1`\[RightGuillemet] needs to be a \
hyperlink.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "ExtractUsage"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<Mode\>\"", "\[Rule]", "\"\<Normal\>\""}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"ExtractUsage", ",", "Listable"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678104346724377`*^9, {3.667810873424903*^9, 3.667810875341351*^9}, 
   3.6678423944253073`*^9, {3.667842718041253*^9, 3.6678427338174763`*^9}, {
   3.6678491781759367`*^9, 3.6678491793576193`*^9}, {3.667849354722323*^9, 
   3.6678493821211557`*^9}, {3.6678936780297937`*^9, 
   3.6678937026200953`*^9}, {3.667894859274582*^9, 3.667894862673396*^9}, {
   3.735277768925749*^9, 3.735277775291326*^9}, {3.76173001660185*^9, 
   3.7617300168409643`*^9}},
 CellLabel->
  "In[320]:=",ExpressionUUID->"92431e28-c7aa-48fa-a5d3-930454adc5fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667812446376968*^9, 3.66781245684652*^9}, {3.667812487271872*^9, 
   3.667812487581573*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[324]:=",ExpressionUUID->"e4196f15-913e-41d1-98df-53cfa57c58b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractUsage", "[", 
   RowBox[{"notebook_String", ",", 
    RowBox[{"OptionsPattern", "@", "ExtractUsage"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nb", ",", "packageName", ",", 
      RowBox[{"functionName", "=", 
       RowBox[{"FileBaseName", "@", "notebook"}]}], ",", "check", ",", "data",
       ",", "\[IndentingNewLine]", "L", ",", "starts", ",", "intervals", ",", 
      "usages", ",", "span", ",", "\[IndentingNewLine]", "specialStart", ",", 
      "specialEnd", ",", "wrap", ",", "messages", ",", "s", ",", "arg", ",", 
      "info", ",", "startSpace", ",", "line", ",", "\[IndentingNewLine]", 
      "temp"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Get", " ", "main", " ", "usage", " ", "cell", " ", "from", " ", 
      RowBox[{"(", "undeployed", ")"}], " ", "documentation", " ", 
      "notebook"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"NotebookOpen", "[", 
         RowBox[{"notebook", ",", 
          RowBox[{"Visible", "\[Rule]", "False"}]}], "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetSelectedNotebook", "@", "nb"}], ";", "\[IndentingNewLine]", 
     RowBox[{"check", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"check", "===", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SelectionMove", "[", 
         RowBox[{"nb", ",", "Next", ",", "Cell"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"NotebookRead", "[", "nb", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"check", "=", 
         RowBox[{"Quiet", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "===", "\"\<Usage\>\""}], ")"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookClose", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "intervals", " ", "with", " ", "usage", " ", 
       "information"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "temp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"starts", "=", 
      RowBox[{"starts", "=", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"temp", ",", "\"\<ModInfo\>\"", ",", "Infinity"}], "]"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"starts", ",", 
         RowBox[{"{", "_Integer", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"intervals", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"starts", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "L"}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"intervals", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"starts", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"starts", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "2"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"Length", "@", "starts"}], "-", "1"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"intervals", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"intervals", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"intervals", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "+", "2"}], 
              ",", "L"}], "}"}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"span", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Span", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
       "intervals"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"usages", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"temp", ",", "#"}], "]"}], "&"}], "/@", "span"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Extraction", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"specialStart", "=", "\"\<\\!\\(\\*\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"specialEnd", "=", "\"\<\\)\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wrap", "[", "input_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", "=", 
          RowBox[{"ToString", "@", "input"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"x", ",", "\"\<Box\>\""}], "]"}], ",", "x", ",", 
          RowBox[{"\"\<\\\"\>\"", "<>", "x", "<>", "\"\<\\\"\>\""}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"messages", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "=", 
         RowBox[{
          RowBox[{"usages", "[", 
           RowBox[{"[", "l", "]"}], "]"}], "/.", 
          RowBox[{"x_ButtonBox", "\[RuleDelayed]", 
           RowBox[{"First", "@", "x"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"s", "=", 
         RowBox[{"ToExpression", "@", 
          RowBox[{"StringDelete", "[", 
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{"FullForm", "@", "s"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\\\\[LineSeparator]\>\"", ",", "\"\<\\\\n\>\""}], 
             "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"s", ",", "\"\<[\>\"", ",", "Infinity"}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"Function", " ", "name", " ", "only"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"arg", "=", "functionName"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"functionName", ",", "\"\<[\>\"", ",", "\"\<]\>\""}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"Void", " ", "function"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"arg", "=", 
           RowBox[{"ToString", "@", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "\"\<\\\"\>\"", "<>", "functionName", "<>", "\"\<\\\"\>\""}], 
               ",", 
               RowBox[{
               "\"\<\\\"\>\"", "<>", "\"\<[]\>\"", "<>", "\"\<\\\"\>\""}]}], 
              "}"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"arg", "=", 
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", 
               RowBox[{"3", ";;", 
                RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Depth", "@", "arg"}], "<", "5"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"arg", "=", 
              RowBox[{"RowBox", "[", 
               RowBox[{"{", 
                RowBox[{"functionName", ",", "\"\<[\>\"", ",", 
                 RowBox[{"First", "@", "arg"}], ",", "\"\<]\>\""}], "}"}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"arg", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"arg", ",", 
                 RowBox[{"{", 
                  RowBox[{"functionName", ",", "\"\<[\>\""}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"arg", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"arg", ",", "\"\<]\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"arg", "=", 
               RowBox[{"FlattenAt", "[", 
                RowBox[{
                 RowBox[{"First", "@", "arg"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"arg", "=", 
            RowBox[{"wrap", "//@", "arg"}]}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"info", "=", 
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}], "/.", 
          RowBox[{"s_String", "\[RuleDelayed]", 
           RowBox[{"\"\<\\\"\>\"", "<>", "s", "<>", "\"\<\\\"\>\""}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"info", "=", 
         RowBox[{"info", "/.", 
          RowBox[{"s_String", "\[RuleDelayed]", 
           RowBox[{"StringDelete", "[", 
            RowBox[{"s", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\[LineSeparator]\>\"", ",", "\"\<\\n\>\""}], 
              "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"startSpace", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{"info", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], "===", "\"\< \>\""}], ",", 
           "\"\<\>\"", ",", "\"\< \>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"info", "=", 
         RowBox[{"ToString", "@", 
          RowBox[{"RowBox", "@", "info"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"line", "=", 
         RowBox[{
         "specialStart", "<>", "arg", "<>", "specialEnd", "<>", "startSpace", 
          "<>", "specialStart", "<>", "info", "<>", "specialEnd"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"messages", ",", "line"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"l", ",", 
         RowBox[{"Length", "@", "intervals"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
        RowBox[{"Include", " ", "package"}], "-", " ", 
        RowBox[{"and", " ", "function", " ", "name"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<Mode\>\"", "]"}], "===", 
        "\"\<Full\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"packageName", "=", 
         RowBox[{"First", "@", 
          RowBox[{"StringCases", "[", "\[IndentingNewLine]", 
           RowBox[{"notebook", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"name", ":", 
               RowBox[{
                RowBox[{"Except", "[", "\"\</\>\"", "]"}], ".."}]}], "~~", 
              "\"\</Documentation\>\""}], "\[RuleDelayed]", "name"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"messages", "=", 
         RowBox[{"{", 
          RowBox[{"packageName", ",", "functionName", ",", "messages"}], 
          "}"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Returning", " ", "information"}], " ", "*)"}], 
     "\[IndentingNewLine]", "messages"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810883538918*^9, {3.6678119799664907`*^9, 3.667812004062636*^9}, {
   3.667812039037266*^9, 3.667812072607596*^9}, 3.667812406683673*^9, {
   3.667813882624302*^9, 3.6678138933821697`*^9}, 3.667814924729149*^9, {
   3.66781496632804*^9, 3.6678149928687553`*^9}, {3.6678150319879923`*^9, 
   3.667815059729232*^9}, {3.6678370650379553`*^9, 3.667837080571652*^9}, {
   3.667837156210669*^9, 3.667837159120823*^9}, 3.6678423893311787`*^9, 
   3.6678424458027067`*^9, {3.667842486408422*^9, 3.6678424870521097`*^9}, {
   3.6678491837908373`*^9, 3.667849196316847*^9}, {3.6678492310627127`*^9, 
   3.667849347867344*^9}, {3.667849386562244*^9, 3.6678493956660547`*^9}, {
   3.6678502690321627`*^9, 3.667850270718402*^9}, {3.667885432315948*^9, 
   3.667885443584289*^9}, {3.6678886091768827`*^9, 3.667888618284264*^9}, {
   3.667888726013617*^9, 3.667888727965447*^9}, {3.667888851663785*^9, 
   3.667888852473021*^9}, {3.667889152447135*^9, 3.667889163822752*^9}, {
   3.667889360643476*^9, 3.667889390482397*^9}, {3.667889485585231*^9, 
   3.667889487263101*^9}, {3.667889595757792*^9, 3.667889620724247*^9}, {
   3.667890108962254*^9, 3.667890109608528*^9}, {3.667890744858707*^9, 
   3.667890745731081*^9}, {3.667890790906273*^9, 3.6678907919220057`*^9}, {
   3.667891889841053*^9, 3.667891891247429*^9}, {3.6678922519045677`*^9, 
   3.667892262455718*^9}, {3.667892311486883*^9, 3.667892316670149*^9}, {
   3.667892371374642*^9, 3.667892376260646*^9}, {3.6678924271076107`*^9, 
   3.667892427763419*^9}, {3.667892720984558*^9, 3.667892730684279*^9}, {
   3.66789278719515*^9, 3.6678928066426153`*^9}, {3.667893342922476*^9, 
   3.667893368893684*^9}, 3.667893456485235*^9, {3.6678935550008574`*^9, 
   3.6678935567286158`*^9}, {3.667893598705802*^9, 3.667893607287561*^9}, {
   3.667893653960865*^9, 3.667893674718265*^9}, 3.667893707506178*^9, {
   3.667894873347105*^9, 3.667894873506961*^9}, {3.667895011329136*^9, 
   3.667895024376791*^9}, {3.6678953032984324`*^9, 3.667895345849135*^9}, {
   3.667895452725642*^9, 3.667895462941853*^9}, {3.667895500317997*^9, 
   3.6678955012370453`*^9}, 3.6678956557417593`*^9, {3.667895779383746*^9, 
   3.6678958100700207`*^9}, {3.667895851933743*^9, 3.6678958935560913`*^9}, {
   3.667896171574704*^9, 3.667896263763373*^9}, {3.667896312122861*^9, 
   3.667896324754409*^9}, {3.6678963903543158`*^9, 3.6678964114961843`*^9}, {
   3.667896455809155*^9, 3.667896456675251*^9}, {3.667896493914776*^9, 
   3.667896525742229*^9}, {3.6678965891093082`*^9, 3.667896621691443*^9}, {
   3.667896713242935*^9, 3.667896755072253*^9}, {3.667896817256106*^9, 
   3.667896889397126*^9}, {3.6678969470525312`*^9, 3.667896962588962*^9}, {
   3.66789716539051*^9, 3.6678972171833*^9}, {3.6678972538709784`*^9, 
   3.667897288603929*^9}, {3.6678973528756742`*^9, 3.667897617020197*^9}, {
   3.66789770379532*^9, 3.6678977049618177`*^9}, {3.667897785432526*^9, 
   3.667897791191832*^9}, {3.66789796008405*^9, 3.667897963067811*^9}, {
   3.667898841113009*^9, 3.667898860551585*^9}, {3.6678989176231813`*^9, 
   3.6678990213639717`*^9}, {3.66789905851523*^9, 3.667899062507167*^9}, {
   3.667899103315624*^9, 3.6678991104182777`*^9}, 3.667899192265994*^9, {
   3.667911024706799*^9, 3.6679110624585648`*^9}, {3.668160963954216*^9, 
   3.6681609672208776`*^9}, {3.714831885412652*^9, 3.714831888130403*^9}, {
   3.7352279099898443`*^9, 3.7352279119894543`*^9}, {3.735227947335452*^9, 
   3.735227952021865*^9}, {3.735228057476899*^9, 3.735228177338558*^9}, {
   3.735277231320202*^9, 3.73527723635671*^9}, {3.7352773407782297`*^9, 
   3.735277407971662*^9}, {3.7352774541767883`*^9, 3.735277649510229*^9}, {
   3.735277703312562*^9, 3.7352777560457993`*^9}, {3.735278512054905*^9, 
   3.735278595820527*^9}, {3.735279507096591*^9, 3.7352795099284983`*^9}, {
   3.735279584492257*^9, 3.735279613390669*^9}, {3.735279688701007*^9, 
   3.7352797605695*^9}, {3.735279800130986*^9, 3.735279828575943*^9}, {
   3.7352799393046503`*^9, 3.735279979789836*^9}, {3.7352800171745853`*^9, 
   3.735280017644599*^9}, {3.735280116787613*^9, 3.735280121329863*^9}, 
   3.735280153874682*^9, {3.7352802988160686`*^9, 3.73528036627181*^9}, {
   3.735280397158695*^9, 3.735280436363415*^9}, {3.737970189743887*^9, 
   3.737970195967576*^9}, {3.737970242696484*^9, 3.737970254395742*^9}, {
   3.737970472386147*^9, 3.737970495127303*^9}, {3.7379708325373163`*^9, 
   3.7379708689034348`*^9}, {3.7379710554231977`*^9, 3.737971105241316*^9}, {
   3.7379711965691442`*^9, 3.737971224089724*^9}, {3.737971277422216*^9, 
   3.737971278806017*^9}, {3.73797147720399*^9, 3.7379714890194197`*^9}, {
   3.737971556370063*^9, 3.7379716421431427`*^9}, {3.761467840081215*^9, 
   3.761467847166497*^9}, {3.761467950307549*^9, 3.761467997069125*^9}, {
   3.761468089061266*^9, 3.761468093066968*^9}, {3.7614685229233932`*^9, 
   3.761468692021304*^9}, {3.761468880276452*^9, 3.7614688814416723`*^9}, {
   3.761468924436459*^9, 3.761468927217424*^9}, {3.7614690782651863`*^9, 
   3.761469083567354*^9}, {3.761469125038463*^9, 3.7614691297696247`*^9}, {
   3.761469184509779*^9, 3.7614691937943583`*^9}, {3.7614692263864927`*^9, 
   3.761469287265432*^9}, {3.761469317898486*^9, 3.761469379609047*^9}, {
   3.761469440352092*^9, 3.761469566788692*^9}, {3.761469615179755*^9, 
   3.761469824616735*^9}, {3.761469875905054*^9, 3.7614698793580627`*^9}, {
   3.761469926606781*^9, 3.761470134386421*^9}, 3.761470168834037*^9, {
   3.761470307454604*^9, 3.761470341387541*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[325]:=",ExpressionUUID->"20b1a9aa-e7c9-461b-95e8-f9df2d66982a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[326]:=",ExpressionUUID->"1e0cc859-eda6-496b-99e5-bc8d64d89e4d"]
}, Closed]],

Cell[CellGroupData[{

Cell["NeatUsage", "Subchapter",
 CellChangeTimes->{{3.667722667271051*^9, 3.667722668806367*^9}, 
   3.667850300505624*^9},ExpressionUUID->"5194c2cd-c03e-4de2-af38-\
a14277dd947f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[351]:=",ExpressionUUID->"5d68380c-9c65-480a-af94-52c5ed212fd6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NeatUsage", "::", "error"}], "=", 
   "\"\<The usage is neither a string nor a list of strings.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NeatUsage", "::", "dir"}], "=", 
    "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid \
directory.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "NeatUsage"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<DocumentationHyperlink\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Mode\>\"", "\[Rule]", "\"\<Normal\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<OverwriteAutomatically\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<WriteTo\>\"", "\[Rule]", "False"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678104346724377`*^9, {3.667810873424903*^9, 3.667810875341351*^9}, {
   3.667908690584041*^9, 3.6679087037986794`*^9}, {3.66816649847222*^9, 
   3.668166502894822*^9}, {3.668168391112651*^9, 3.668168392544508*^9}, {
   3.6681686970571632`*^9, 3.668168720912581*^9}, {3.668171328149095*^9, 
   3.668171328331027*^9}, {3.668174651092638*^9, 3.668174651628518*^9}, {
   3.6681747682269382`*^9, 3.668174770113784*^9}, {3.761653378966709*^9, 
   3.761653395256031*^9}, {3.7617301843750668`*^9, 3.761730184949564*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"e8797855-14f2-4d36-9640-8d463ab36a97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667812446376968*^9, 3.66781245684652*^9}, {3.667812487271872*^9, 
   3.667812487581573*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[355]:=",ExpressionUUID->"56c35efc-7952-4d59-9f09-0137a7a34dbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NeatUsage", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"application_String", ",", "symbol_Symbol"}], "}"}], ",", 
    "usage_", ",", 
    RowBox[{"OptionsPattern", "@", "NeatUsage"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mode", ",", "L", ",", "usagelist", ",", "messagelist", ",", 
      "\[IndentingNewLine]", "cleared1", ",", "cleared2", ",", "cleared3", 
      ",", "cleared4", ",", "\[IndentingNewLine]", "arguments", ",", "rules", 
      ",", "message", ",", "nogap", ",", "complete", ",", "f", ",", 
      "\[IndentingNewLine]", "outputfile", ",", "old", ",", "windowtext", ",",
       "decision", ",", "case"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "Analysing", " ", "input"}], " ", "**)"}], 
    "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Message", " ", "may", " ", "already", " ", "be", " ", "formatted"}], 
     " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
    RowBox[{
     RowBox[{"mode", "=", 
      RowBox[{"OptionValue", "[", "\"\<Mode\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"usage", ",", "StandardForm"}], "]"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<StyleBox\>\"", "|", "\"\<SubscriptBox\>\""}]}], "]"}], 
       ",", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"mode", "=", "\"\<Formatted\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mode", "\[Equal]", "\"\<Formatted\>\""}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ListQ", "@", "usage"}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"messagelist", "=", "usage"}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"messagelist", "=", 
           RowBox[{"{", "usage", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"Goto", "[", "\"\<FormattingDone\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Input", " ", "form"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"Head", "@", "usage"}], "]"}], "\[Equal]", 
        "\"\<String\>\""}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"L", "=", "1"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"usagelist", "=", 
         RowBox[{"{", "usage", "}"}]}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"Head", "@", "usage"}], "]"}], "\[Equal]", "\"\<List\>\""}], 
       ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AllTrue", "[", 
            RowBox[{"usage", ",", "StringQ"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"NeatUsage", "::", "error"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"L", "=", 
         RowBox[{"Length", "@", "usage"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"usagelist", "=", "usage"}]}], ",", "\[IndentingNewLine]", 
       "\t", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"NeatUsage", "::", "error"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "Formatting", " ", "one", " ", "or", " ", "several", " ", 
       "messages"}], " ", "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"messagelist", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Formatting", " ", "usage", " ", "message"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"In", " ", "case", " ", "function", " ", "name", " ", 
        RowBox[{"contains", " ", "'"}], 
        RowBox[{"$", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"cleared1", "=", 
         RowBox[{"StringCases", "[", 
          RowBox[{
           RowBox[{"usagelist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"\"\<$\>\"", "~~", 
            RowBox[{"LetterCharacter", ".."}], "~~", "_"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"cleared2", "=", 
         RowBox[{"StringTrim", "@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"cleared1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"x", ",", 
                RowBox[{"-", "1"}]}], "]"}], "\[Equal]", "\"\<$\>\""}]}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"cleared3", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"cleared2", ",", 
           RowBox[{"\"\<$\>\"", "\[Rule]", "\"\<\[Section]\>\""}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"cleared4", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"usagelist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{"cleared2", "\[Rule]", "cleared3"}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
        RowBox[{"arguments", "=", 
         RowBox[{"StringCases", "[", 
          RowBox[{"cleared4", ",", 
           RowBox[{"Shortest", "[", 
            RowBox[{"\"\<$\>\"", "~~", "__", "~~", "\"\<$\>\""}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"rules", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"arguments", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
            RowBox[{"\"\<\\!\\(\\*\\nStyleBox[\\\"\>\"", "<>", 
             RowBox[{"arguments", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "<>", 
             "\"\<\\\", \\\"TI\\\"]\\)\>\""}]}], ",", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "arguments"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"message", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"cleared4", ",", "rules"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"message", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"message", ",", "\"\<$\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"message", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"message", ",", 
           RowBox[{"\"\<\[Section]\>\"", "\[Rule]", "\"\<$\>\""}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Processing", " ", "subscripts"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"nogap", "=", 
         RowBox[{
          RowBox[{"WordCharacter", ".."}], "|", 
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"\"\< \>\"", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Except", "[", "\"\< \>\"", "]"}], ".."}], "~~", 
              "\"\<, \>\"", "~~", 
              RowBox[{
               RowBox[{"Except", "[", "\"\< \>\"", "]"}], ".."}]}]}], "]"}], 
           ".."}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"message", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"message", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"pre", ":", "nogap"}], "~~", "\"\<_\>\"", "~~", 
             RowBox[{"sub", ":", "nogap"}]}], "\[RuleDelayed]", 
            RowBox[{
            "\"\<\\!\\(\\*SubscriptBox[\\(\>\"", "<>", "pre", "<>", 
             "\"\<\\), \\(\>\"", "<>", "sub", "<>", "\"\<\\)]\\)\>\""}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Correcting", " ", "ellipses"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"message", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"message", ",", 
           RowBox[{"\"\<...\>\"", "\[Rule]", "\"\<\[Ellipsis]\>\""}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Correcting", " ", "spaces", " ", "between", " ", "arguments"}], " ",
          "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"message", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"message", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "\"\<\\\"TI\\\"]\\),\\!\\(\\*\\nStyleBox[\>\"", "\[Rule]", 
              "\"\<\\\"TI\\\"], \\*\\nStyleBox[\>\""}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<\\\"TI\\\"]\\),{\\!\\(\\*\\nStyleBox[\>\"", "\[Rule]", 
              "\"\<\\\"TI\\\"]\\), {\\!\\(\\*\\nStyleBox[\>\""}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<\\\"TI\\\"]\\)},\\!\\(\\*\\nStyleBox[\>\"", "\[Rule]", 
              "\"\<\\\"TI\\\"]\\)}, \\!\\(\\*\\nStyleBox[\>\""}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"messagelist", ",", "message"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", "L"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "Preparing", " ", "the", " ", "usage", " ", "layout"}], " ", 
      "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<FormattingDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"complete", "=", 
      RowBox[{"Riffle", "[", 
       RowBox[{"messagelist", ",", "\"\<\\n\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Appending", " ", "hyperlink", " ", "to", " ", "the", " ", 
       "documentation"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"ToString", "@", "symbol"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<DocumentationHyperlink\>\"", "]"}]}],
        ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"complete", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "=", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"Row", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"complete", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
             "\t", "\"\<   \>\"", ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"Hyperlink", "[", 
              RowBox[{"\"\<\[RightSkeleton]\>\"", ",", 
               RowBox[{
               "\"\<paclet:\>\"", "<>", "application", "<>", "\"\</ref/\>\"", 
                "<>", "f"}], ",", "\[IndentingNewLine]", "\t", 
               RowBox[{"ActiveStyle", "\[Rule]", "None"}]}], "]"}]}], 
            "\[IndentingNewLine]", "\t", "}"}], "\[IndentingNewLine]", "\t", 
           "]"}], ",", "StandardForm"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Setting", " ", "the", " ", "usage"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"outputfile", "=", 
      RowBox[{"ToString", "@", 
       RowBox[{"OptionValue", "[", "\"\<WriteTo\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"message", "=", 
      RowBox[{"StringJoin", "@", "complete"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DirectoryName", "[", "outputfile", "]"}], "\[Equal]", 
         "\"\<\>\""}], "||", 
        RowBox[{"!", 
         RowBox[{"DirectoryQ", "@", 
          RowBox[{"DirectoryName", "@", "outputfile"}]}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"symbol", "::", "usage"}], "=", "message"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "@", 
         RowBox[{"Information", "[", 
          RowBox[{"symbol", ",", 
           RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", 
       RowBox[{"Option", ":", " ", 
        RowBox[{"Store", " ", "usage", " ", "messages"}]}]}], " ", "**)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "output", " ", "file", " ", "already", " ", 
       "exists"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "outputfile"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{"outputfile", ",", "\"\<\>\""}], "]"}], ",", 
          RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"old", "=", "\"\<\>\""}]}], ",", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"old", "=", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"ReadString", "@", "outputfile"}], ",", 
          RowBox[{"Abort", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "file", " ", "already", " ", "contains", " ", 
       "the", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"old", ",", 
         RowBox[{"StartOfLine", "~~", 
          RowBox[{"f", "<>", "\"\<::usage=\>\""}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{
           "OptionValue", "[", "\"\<OverwriteAutomatically\>\"", "]"}]}], ",",
           "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"windowtext", "=", 
            RowBox[{"StringJoin", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{
              "\"\<A usage message for \[LeftGuillemet]\>\"", ",", 
               "\[IndentingNewLine]", "\t", "f", ",", "\[IndentingNewLine]", 
               "\t", "\"\<\[RightGuillemet] already exists in \
\[LeftGuillemet]\>\"", ",", "\[IndentingNewLine]", "\t", 
               RowBox[{"FileNameTake", "@", "outputfile"}], ",", 
               "\[IndentingNewLine]", "\t", 
               "\"\<\[RightGuillemet].\\nWould you like to overwrite the old \
message?\>\""}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"decision", "=", 
            RowBox[{"ChoiceDialog", "[", 
             RowBox[{"windowtext", ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<No\>\"", "\[Rule]", "False"}], ",", 
                RowBox[{"\"\<Yes\>\"", "\[Rule]", "True"}]}], "}"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "WindowTitle", "\[Rule]", "\"\<Overwrite usage message\>\""}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"WindowFloating", "\[Rule]", "True"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", "decision"}], ",", 
             RowBox[{"Abort", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
         "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Replacing", " ", "old", " ", "message"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"case", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"old", ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"Shortest", "[", 
             RowBox[{
              RowBox[{"f", "<>", "\"\<::usage=\>\""}], "~~", "__", "~~", 
              "\"\<;\>\""}], "]"}], "\[Rule]", "\[IndentingNewLine]", "\t\t", 
            
            RowBox[{"f", "<>", "\"\<::usage=\>\"", "<>", 
             RowBox[{"ToString", "@", 
              RowBox[{"FullForm", "@", 
               RowBox[{"StringJoin", "@", "message"}]}]}], "<>", 
             "\"\<;\>\""}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Return", "@", 
         RowBox[{"Export", "[", 
          RowBox[{"outputfile", ",", "case"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Append", " ", "new", " ", "usage"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"WriteString", "[", 
      RowBox[{
      "outputfile", ",", "\[IndentingNewLine]", "\t", "old", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"f", "<>", "\"\<::usage=\>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"FullForm", "@", 
          RowBox[{"StringJoin", "@", "message"}]}]}]}], ",", 
       "\[IndentingNewLine]", "\t", "\"\<;\\n\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Close", "@", "outputfile"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810883538918*^9, {3.6678119799664907`*^9, 3.667812004062636*^9}, {
   3.667812039037266*^9, 3.667812072607596*^9}, 3.667812406683673*^9, {
   3.667813882624302*^9, 3.6678138933821697`*^9}, 3.667814924729149*^9, {
   3.66781496632804*^9, 3.6678149928687553`*^9}, {3.6678150319879923`*^9, 
   3.667815059729232*^9}, {3.6678370650379553`*^9, 3.667837080571652*^9}, {
   3.667837156210669*^9, 3.667837159120823*^9}, {3.667908932612733*^9, 
   3.667909140003276*^9}, {3.6679092891288967`*^9, 3.6679093072406178`*^9}, {
   3.667909378728078*^9, 3.667909385806776*^9}, 3.6679094645439787`*^9, {
   3.667909551805661*^9, 3.6679095772688637`*^9}, {3.667909873528627*^9, 
   3.667909885693358*^9}, {3.667909967926968*^9, 3.667910004853548*^9}, {
   3.667910046133897*^9, 3.667910050012671*^9}, {3.6679100833093767`*^9, 
   3.667910107176985*^9}, {3.667910226610819*^9, 3.667910251483017*^9}, {
   3.6679102972356453`*^9, 3.667910313883361*^9}, {3.667910354015862*^9, 
   3.667910355430586*^9}, {3.667910405695218*^9, 3.6679104080780973`*^9}, {
   3.667910449599267*^9, 3.667910452645286*^9}, {3.667910592254632*^9, 
   3.667910624761389*^9}, 3.667910683810557*^9, {3.667910720618655*^9, 
   3.6679108007765837`*^9}, {3.66816631739188*^9, 3.668166320959875*^9}, {
   3.6681663636956263`*^9, 3.668166444524235*^9}, 3.668167020727107*^9, {
   3.6681674635000753`*^9, 3.668167474657826*^9}, {3.668167560922271*^9, 
   3.668167602135705*^9}, {3.6681676393577623`*^9, 3.668167689140959*^9}, {
   3.668168102730618*^9, 3.668168128330806*^9}, {3.668168193267274*^9, 
   3.66816821744075*^9}, {3.668168266503697*^9, 3.66816831469429*^9}, {
   3.668168531225005*^9, 3.6681685421679087`*^9}, {3.6681689599427433`*^9, 
   3.6681689683253508`*^9}, {3.668169016156123*^9, 3.668169046211808*^9}, {
   3.668170043519361*^9, 3.668170047053616*^9}, {3.668170412696371*^9, 
   3.668170419100215*^9}, {3.668170560185047*^9, 3.668170641158381*^9}, {
   3.668171026147955*^9, 3.668171028550968*^9}, {3.668171330935315*^9, 
   3.668171415835734*^9}, {3.66817200462433*^9, 3.6681720337178497`*^9}, {
   3.668172471948838*^9, 3.668172621079666*^9}, {3.668172750597891*^9, 
   3.6681727815562363`*^9}, {3.668174823556732*^9, 3.6681748569470263`*^9}, {
   3.6695562733937073`*^9, 3.669556273567175*^9}, {3.730115678852222*^9, 
   3.730115699585402*^9}, {3.7301157323482027`*^9, 3.7301157333531857`*^9}, {
   3.730115767075754*^9, 3.7301157710654697`*^9}, {3.737970116749701*^9, 
   3.737970163733947*^9}, {3.76165340561904*^9, 3.761653416000424*^9}, {
   3.761653929290098*^9, 3.761653931545969*^9}, {3.761654237245414*^9, 
   3.761654239906726*^9}, {3.761654329517303*^9, 3.761654329694879*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[356]:=",ExpressionUUID->"a22a9888-e852-4af6-bcc1-87d51dd82f81"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NeatUsage", "[", 
   RowBox[{"notebook_String", ",", "output_String", ",", 
    RowBox[{"OptionsPattern", "@", "NeatUsage"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "info", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Extract", " ", "information", " ", "from", " ", "notebook"}], 
     " ", "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"info", "=", 
      RowBox[{"ExtractUsage", "[", 
       RowBox[{"notebook", ",", 
        RowBox[{"\"\<Mode\>\"", "\[Rule]", "\"\<Full\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "output", " ", "directory"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DirectoryName", "[", "output", "]"}], "\[Equal]", 
         "\"\<\>\""}], "||", 
        RowBox[{"!", 
         RowBox[{"DirectoryQ", "@", 
          RowBox[{"DirectoryName", "@", "output"}]}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"NeatUsage", "::", "dir"}], ",", 
          RowBox[{"DirectoryName", "@", "output"}]}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Write", " ", "information", " ", "to", " ", "output", " ", "file"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"NeatUsage", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"info", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"ToExpression", "@", 
          RowBox[{"info", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"info", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"\"\<Mode\>\"", "\[Rule]", "\"\<Formatted\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"\"\<WriteTo\>\"", "\[Rule]", "output"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810883538918*^9, {3.6678119799664907`*^9, 3.667812004062636*^9}, {
   3.667812039037266*^9, 3.667812072607596*^9}, 3.667812406683673*^9, {
   3.667813882624302*^9, 3.6678138933821697`*^9}, 3.667814924729149*^9, {
   3.66781496632804*^9, 3.6678149928687553`*^9}, {3.6678150319879923`*^9, 
   3.667815059729232*^9}, {3.6678370650379553`*^9, 3.667837080571652*^9}, {
   3.667837156210669*^9, 3.667837159120823*^9}, {3.667842515304603*^9, 
   3.667842605059421*^9}, 3.667842680393711*^9, {3.667849539917348*^9, 
   3.6678495955963087`*^9}, {3.667849646172352*^9, 3.667849650506996*^9}, {
   3.667908750478983*^9, 3.667908761965444*^9}, {3.667909195231482*^9, 
   3.667909200047358*^9}, {3.667909526571316*^9, 3.6679095448082523`*^9}, {
   3.6679095850253973`*^9, 3.667909585291171*^9}, {3.667910126892024*^9, 
   3.667910130144701*^9}, {3.6679108263500137`*^9, 3.667910857082486*^9}, {
   3.6681674036811123`*^9, 3.668167410993102*^9}, {3.66816868688957*^9, 
   3.66816868696166*^9}, {3.6681687372109137`*^9, 3.6681687928153563`*^9}, {
   3.668168837414296*^9, 3.668168837998024*^9}, {3.6681721484090967`*^9, 
   3.66817214937738*^9}, {3.735277912490841*^9, 3.735277919304461*^9}, {
   3.735278654025343*^9, 3.73527865417015*^9}, {3.735278686393462*^9, 
   3.735278692223948*^9}, {3.737970173317581*^9, 3.7379701798620996`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[357]:=",ExpressionUUID->"7afd61f7-3012-4bee-b413-42f75032eaf4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[358]:=",ExpressionUUID->"e335e315-9998-4c1a-a5e7-d87940945360"]
}, Closed]],

Cell[CellGroupData[{

Cell["CopyDefinitionCodeToDocumentation", "Subchapter",
 CellChangeTimes->{{3.667722667271051*^9, 3.667722668806367*^9}, 
   3.667850300505624*^9, {3.735289606222719*^9, 
   3.735289627652623*^9}},ExpressionUUID->"d448e25a-a41d-4a8f-ba86-\
076f5b6a4763"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[67]:=",ExpressionUUID->"c1822f2a-dfc6-4aa4-83e4-292ef3d8e361"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CopyDefinitionCodeToDocumentation", "::", "missingFile"}], "=", 
   "\"\<Cannot find the file for \[LeftGuillemet]`1`\[RightGuillemet].\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CopyDefinitionCodeToDocumentation", "::", "nbEditor"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] does not appear to be open. \
Recall that this function has to be run in the 'Notebook Editor' front end.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CopyDefinitionCodeToDocumentation", "::", "missingDocTools"}], 
    "=", "\"\<Missing \[LeftGuillemet]DocumentationTools\[RightGuillemet] \
from Applications.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "CopyDefinitionCodeToDocumentation"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<DocumentationSymbolsDir\>\"", "\[Rule]", 
      "\"\</Users/Stian/Jottacloud/UiS/Mathematica \
project/GitHub/MaXrd/Documentation/English/ReferencePages/Symbols\>\""}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
     "\"\<DefinitionFile\>\"", "\[Rule]", 
      "\"\</Users/Stian/Jottacloud/UiS/Mathematica \
project/GitHub/MaXrd/Core/Definitions.nb\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<ShowNotebooks\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<TestRun\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<OpenedWindowsMode\>\"", "\[Rule]", "False"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678104346724377`*^9, {3.667810873424903*^9, 3.667810875341351*^9}, {
   3.667908690584041*^9, 3.6679087037986794`*^9}, {3.66816649847222*^9, 
   3.668166502894822*^9}, {3.668168391112651*^9, 3.668168392544508*^9}, {
   3.6681686970571632`*^9, 3.668168720912581*^9}, {3.668171328149095*^9, 
   3.668171328331027*^9}, {3.668174651092638*^9, 3.668174651628518*^9}, {
   3.6681747682269382`*^9, 3.668174770113784*^9}, 3.735289646941869*^9, {
   3.735289690900867*^9, 3.7352897542826157`*^9}, {3.735290086771192*^9, 
   3.7352900871389008`*^9}, {3.735290149524373*^9, 3.7352901571321*^9}, {
   3.7352903374722023`*^9, 3.735290438771717*^9}, {3.737358472750031*^9, 
   3.737358486325653*^9}, {3.737359635345592*^9, 3.737359687269163*^9}, {
   3.7373641625923243`*^9, 3.737364171907065*^9}, {3.737365179893634*^9, 
   3.737365183486251*^9}, {3.737867367180114*^9, 3.737867386371318*^9}, {
   3.737867933883534*^9, 3.737867967960684*^9}, {3.7438681116223307`*^9, 
   3.7438681239425497`*^9}, {3.7592245668195553`*^9, 
   3.7592245887631607`*^9}, {3.761415406283896*^9, 3.761415429814992*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"00112fbd-3dbe-43fe-a0fc-70153541fff7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667812446376968*^9, 3.66781245684652*^9}, {3.667812487271872*^9, 
   3.667812487581573*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[72]:=",ExpressionUUID->"6e57b0d0-75f5-4afc-bed4-fe5f78163d2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CopyDefinitionCodeToDocumentation", "[", 
   RowBox[{"symbol_String", ",", 
    RowBox[{"OptionsPattern", "@", "CopyDefinitionCodeToDocumentation"}]}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "symbolsDocDir", ",", "definitionsFile", ",", "targetFile", ",", 
      "\[IndentingNewLine]", "showQ", ",", "testRunQ", ",", "windowModeQ", 
      ",", "\[IndentingNewLine]", "nb", ",", "check", ",", "data", ",", 
      "cells", ",", "\[IndentingNewLine]", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "File", " ", "and", " ", "directory", 
      " ", "setup", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"symbolsDocDir", "=", 
      RowBox[{"OptionValue", "[", "\"\<DocumentationSymbolsDir\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"definitionsFile", "=", 
      RowBox[{"OptionValue", "[", "\"\<DefinitionFile\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Check", "[", 
      RowBox[{
       RowBox[{"targetFile", "=", 
        RowBox[{"First", "@", 
         RowBox[{"FileNames", "[", 
          RowBox[{
           RowBox[{"symbol", "<>", "\"\<.nb\>\""}], ",", "symbolsDocDir"}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CopyDefinitionCodeToDocumentation", "::", "missingFile"}], 
          ",", "symbol"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"showQ", "=", 
      RowBox[{"OptionValue", "[", "\"\<ShowNotebooks\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"testRunQ", "=", 
      RowBox[{"OptionValue", "[", "\"\<TestRun\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"windowModeQ", "=", 
      RowBox[{"OptionValue", "[", "\"\<OpenedWindowsMode\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Copy", " ", "cell", 
       RowBox[{"(", "s", ")"}], " ", "from", " ", "source", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nb", "=", 
      RowBox[{"NotebookOpen", "[", 
       RowBox[{"definitionsFile", ",", 
        RowBox[{"Visible", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetSelectedNotebook", "@", "nb"}], ";", "\[IndentingNewLine]", 
     RowBox[{"check", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"check", "===", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NotebookFind", "[", 
         RowBox[{"definitionsFile", ",", "symbol"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SelectionMove", "[", 
         RowBox[{"nb", ",", "Next", ",", "Cell"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"NotebookRead", "[", "nb", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"check", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "===", "symbol"}], "&&", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "===", "\"\<Subchapter\>\""}]}], 
          ")"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{"nb", ",", "Next", ",", "CellGroup"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cells", "=", 
      RowBox[{"NotebookRead", "[", "nb", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"NotebookClose", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"cells", ",", 
            RowBox[{"Background", "\[Rule]", "#"}], ",", "Infinity"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
           InterpretationBox[
            ButtonBox[
             TooltipBox[
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[0.87, 0.94, 1], RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               
               FrameStyle->RGBColor[
                0.5800000000000001, 0.6266666666666667, 0.6666666666666666],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None],
              "RGBColor[0.87, 0.94, 1]"],
             Appearance->None,
             BaseStyle->{},
             BaselinePosition->Baseline,
             ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
               If[
                Not[
                 AbsoluteCurrentValue["Deployed"]], 
                SelectionMove[Typeset`box$, All, Expression]; 
                FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                FrontEnd`Private`$ColorSelectorInitialColor = 
                 RGBColor[0.87, 0.94, 1]; 
                FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                MathLink`CallFrontEnd[
                  FrontEnd`AttachCell[Typeset`box$, 
                   FrontEndResource["RGBColorValueSelector"], {
                   0, {Left, Bottom}}, {Left, Top}, 
                   "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
             DefaultBaseStyle->{},
             Evaluator->Automatic,
             Method->"Preemptive"],
            RGBColor[0.87, 0.94, 1],
            Editable->False,
            Selectable->False], ",", 
           InterpretationBox[
            ButtonBox[
             TooltipBox[
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[1, 0.9, 0.8], RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               Frame->True,
               
               FrameStyle->RGBColor[
                0.6666666666666666, 0.6000000000000001, 0.5333333333333334],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None],
              "RGBColor[1, 0.9, 0.8]"],
             Appearance->None,
             BaseStyle->{},
             BaselinePosition->Baseline,
             ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
               If[
                Not[
                 AbsoluteCurrentValue["Deployed"]], 
                SelectionMove[Typeset`box$, All, Expression]; 
                FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                FrontEnd`Private`$ColorSelectorInitialColor = 
                 RGBColor[1, 0.9, 0.8]; 
                FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                MathLink`CallFrontEnd[
                  FrontEnd`AttachCell[Typeset`box$, 
                   FrontEndResource["RGBColorValueSelector"], {
                   0, {Left, Bottom}}, {Left, Top}, 
                   "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
             DefaultBaseStyle->{},
             Evaluator->Automatic,
             Method->"Preemptive"],
            RGBColor[1, 0.9, 0.8],
            Editable->False,
            Selectable->False]}], "}"}]}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}], ",", 
        RowBox[{"temp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{";;", "3"}]}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cells", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"cells", ",", 
        RowBox[{"temp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{";;", "3"}]}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cells", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"cells", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"InitializationCell", "\[Rule]", "True"}], ")"}], "\[Rule]", 
         RowBox[{"InitializationCell", " ", "\[Rule]", " ", "False"}]}], ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Copy", " ", "to", " ", "target", " ", 
       RowBox[{"(", 
        RowBox[{"documentation", " ", "notebook"}], ")"}], " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"windowModeQ", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "'"}], 
         RowBox[{"OpenedWindows", "'"}], " ", 
         RowBox[{"mode", ":", " ", 
          RowBox[{
          "execute", " ", "copying", " ", "on", " ", "window", " ", "opened", 
           " ", "in", " ", "notebook", " ", "editior"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"nb", "=", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"SetSelectedNotebook", "@@", 
           RowBox[{"Notebooks", "@", "symbol"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"CopyDefinitionCodeToDocumentation", "::", "nbEditor"}], 
             ",", "symbol"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"b", ".", " ", "Assume"}], " ", "notebook", " ", "editor", 
          " ", "front"}], "-", 
         RowBox[{
         "end", " ", "is", " ", "running", " ", "and", " ", "open", " ", 
          "notebook"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", 
         RowBox[{"if", " ", "'"}], 
         RowBox[{"DocumentationTools", "'"}], " ", "are", " ", "present"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
              "$UserBaseDirectory", ",", "\"\<Applications\>\"", ",", 
               "\"\<DocumentationTools\>\"", ",", "\[IndentingNewLine]", 
               "\"\<Kernel\>\"", ",", "\"\<init.m\>\""}], "}"}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
            "CopyDefinitionCodeToDocumentation", "::", "missingDocTools"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"nb", "=", 
         RowBox[{"NotebookOpen", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"symbolsDocDir", ",", 
              RowBox[{"symbol", "<>", "\"\<.nb\>\""}]}], "}"}], "]"}], ",", 
           RowBox[{"Visible", "\[Rule]", "showQ"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Common", " ", "copying", " ", "procedure"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{"nb", ",", "After", ",", "Notebook"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookFind", 
      StyleBox["[", "Code"], 
      StyleBox[
       RowBox[{"nb", ",", "\"\<Mathematica code\>\"", ",", "Previous"}], 
       "Code"], 
      StyleBox["]", "Input"]}], 
     StyleBox[";", "Input"], "\[IndentingNewLine]", 
     RowBox[{"While", "[", "\[IndentingNewLine]", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SelectionMove", "[", 
         RowBox[{"nb", ",", "Next", ",", "Cell"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"check", "=", 
         RowBox[{"NotebookRead", "[", "nb", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"check", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"NotebookDelete", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookFind", 
      StyleBox["[", "Code"], 
      StyleBox[
       RowBox[{"nb", ",", "\"\<Mathematica code\>\"", ",", "Previous"}], 
       "Code"], 
      StyleBox["]", "Input"]}], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     RowBox[{"SelectionMove", "[", 
      RowBox[{"nb", ",", "Next", ",", "Cell"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{"nb", ",", "cells"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "testRunQ"}], ",", 
       RowBox[{"NotebookSave", "@", "nb"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "testRunQ"}], ",", 
       RowBox[{"NotebookClose", "@", "nb"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810883538918*^9, {3.6678119799664907`*^9, 3.667812004062636*^9}, {
   3.667812039037266*^9, 3.667812072607596*^9}, 3.667812406683673*^9, {
   3.667813882624302*^9, 3.6678138933821697`*^9}, 3.667814924729149*^9, {
   3.66781496632804*^9, 3.6678149928687553`*^9}, {3.6678150319879923`*^9, 
   3.667815059729232*^9}, {3.6678370650379553`*^9, 3.667837080571652*^9}, {
   3.667837156210669*^9, 3.667837159120823*^9}, {3.667908932612733*^9, 
   3.667909140003276*^9}, {3.6679092891288967`*^9, 3.6679093072406178`*^9}, {
   3.667909378728078*^9, 3.667909385806776*^9}, 3.6679094645439787`*^9, {
   3.667909551805661*^9, 3.6679095772688637`*^9}, {3.667909873528627*^9, 
   3.667909885693358*^9}, {3.667909967926968*^9, 3.667910004853548*^9}, {
   3.667910046133897*^9, 3.667910050012671*^9}, {3.6679100833093767`*^9, 
   3.667910107176985*^9}, {3.667910226610819*^9, 3.667910251483017*^9}, {
   3.6679102972356453`*^9, 3.667910313883361*^9}, {3.667910354015862*^9, 
   3.667910355430586*^9}, {3.667910405695218*^9, 3.6679104080780973`*^9}, {
   3.667910449599267*^9, 3.667910452645286*^9}, {3.667910592254632*^9, 
   3.667910624761389*^9}, 3.667910683810557*^9, {3.667910720618655*^9, 
   3.6679108007765837`*^9}, {3.66816631739188*^9, 3.668166320959875*^9}, {
   3.6681663636956263`*^9, 3.668166444524235*^9}, 3.668167020727107*^9, {
   3.6681674635000753`*^9, 3.668167474657826*^9}, {3.668167560922271*^9, 
   3.668167602135705*^9}, {3.6681676393577623`*^9, 3.668167689140959*^9}, {
   3.668168102730618*^9, 3.668168128330806*^9}, {3.668168193267274*^9, 
   3.66816821744075*^9}, {3.668168266503697*^9, 3.66816831469429*^9}, {
   3.668168531225005*^9, 3.6681685421679087`*^9}, {3.6681689599427433`*^9, 
   3.6681689683253508`*^9}, {3.668169016156123*^9, 3.668169046211808*^9}, {
   3.668170043519361*^9, 3.668170047053616*^9}, {3.668170412696371*^9, 
   3.668170419100215*^9}, {3.668170560185047*^9, 3.668170641158381*^9}, {
   3.668171026147955*^9, 3.668171028550968*^9}, {3.668171330935315*^9, 
   3.668171415835734*^9}, {3.66817200462433*^9, 3.6681720337178497`*^9}, {
   3.668172471948838*^9, 3.668172621079666*^9}, {3.668172750597891*^9, 
   3.6681727815562363`*^9}, {3.668174823556732*^9, 3.6681748569470263`*^9}, {
   3.6695562733937073`*^9, 3.669556273567175*^9}, {3.730115678852222*^9, 
   3.730115699585402*^9}, {3.7301157323482027`*^9, 3.7301157333531857`*^9}, {
   3.730115767075754*^9, 3.7301157710654697`*^9}, {3.735289657936088*^9, 
   3.735289674327729*^9}, {3.735289784154421*^9, 3.735289787481594*^9}, {
   3.7352898272167797`*^9, 3.735290002582595*^9}, {3.735290095329773*^9, 
   3.735290162868586*^9}, {3.735290245484164*^9, 3.735290301746228*^9}, {
   3.735290448176181*^9, 3.73529045094989*^9}, {3.7354745660653477`*^9, 
   3.735474569373767*^9}, {3.737358460985723*^9, 3.737358505918415*^9}, {
   3.737358888159601*^9, 3.737358910887532*^9}, {3.73735969451973*^9, 
   3.73735974463031*^9}, {3.737364187287591*^9, 3.737364204110086*^9}, {
   3.7373642618136168`*^9, 3.737364351729041*^9}, 3.737365162722157*^9, {
   3.73736519549762*^9, 3.737365213573543*^9}, 3.737365597400303*^9, {
   3.737365631774474*^9, 3.7373656706830273`*^9}, {3.73736581405068*^9, 
   3.7373658162654867`*^9}, {3.7373659517285748`*^9, 
   3.7373659851577177`*^9}, {3.737866258464151*^9, 3.7378662600263777`*^9}, {
   3.737867352161652*^9, 3.737867361750782*^9}, {3.7378673944242973`*^9, 
   3.737867402901949*^9}, {3.737867480140284*^9, 3.737867548524981*^9}, 
   3.737867818445236*^9, {3.737867870425857*^9, 3.737867882575543*^9}, {
   3.7378679823649683`*^9, 3.7378679831431847`*^9}, {3.738342716835187*^9, 
   3.738342718468779*^9}, {3.738344008687887*^9, 3.738344027222809*^9}, {
   3.738344077365644*^9, 3.7383440801646442`*^9}, {3.738344278665743*^9, 
   3.738344283370802*^9}, {3.7383448070520287`*^9, 3.73834483129782*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[73]:=",ExpressionUUID->"6d916927-dcba-409b-ab03-6d75cf829143"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CopyDefinitionCodeToDocumentation", "[", 
   RowBox[{"OptionsPattern", "@", "CopyDefinitionCodeToDocumentation"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "symbolsDocDir", ",", "definitionsFile", ",", "functionNames", ",", 
      "options"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Find", " ", "all", " ", "symbols", " ", 
      "automatically", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"symbolsDocDir", "=", 
      RowBox[{"OptionValue", "[", "\"\<DocumentationSymbolsDir\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"definitionsFile", "=", 
      RowBox[{"OptionValue", "[", "\"\<DefinitionFile\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"functionNames", "=", 
      RowBox[{"NotebookImport", "[", 
       RowBox[{"definitionsFile", ",", "\"\<Subchapter\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Options", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"options", "=", 
      RowBox[{"Keys", "@", 
       RowBox[{"Options", "@", "CopyDefinitionCodeToDocumentation"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"options", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", 
         RowBox[{"OptionValue", "[", "#", "]"}]}], "&"}], "/@", "options"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "CopyDefinitionCodeToDocumentation", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"functionNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"options", "/.", 
          RowBox[{"List", "\[Rule]", "Sequence"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "functionNames"}]}], "}"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810883538918*^9, {3.6678119799664907`*^9, 3.667812004062636*^9}, {
   3.667812039037266*^9, 3.667812072607596*^9}, 3.667812406683673*^9, {
   3.667813882624302*^9, 3.6678138933821697`*^9}, 3.667814924729149*^9, {
   3.66781496632804*^9, 3.6678149928687553`*^9}, {3.6678150319879923`*^9, 
   3.667815059729232*^9}, {3.6678370650379553`*^9, 3.667837080571652*^9}, {
   3.667837156210669*^9, 3.667837159120823*^9}, {3.667908932612733*^9, 
   3.667909140003276*^9}, {3.6679092891288967`*^9, 3.6679093072406178`*^9}, {
   3.667909378728078*^9, 3.667909385806776*^9}, 3.6679094645439787`*^9, {
   3.667909551805661*^9, 3.6679095772688637`*^9}, {3.667909873528627*^9, 
   3.667909885693358*^9}, {3.667909967926968*^9, 3.667910004853548*^9}, {
   3.667910046133897*^9, 3.667910050012671*^9}, {3.6679100833093767`*^9, 
   3.667910107176985*^9}, {3.667910226610819*^9, 3.667910251483017*^9}, {
   3.6679102972356453`*^9, 3.667910313883361*^9}, {3.667910354015862*^9, 
   3.667910355430586*^9}, {3.667910405695218*^9, 3.6679104080780973`*^9}, {
   3.667910449599267*^9, 3.667910452645286*^9}, {3.667910592254632*^9, 
   3.667910624761389*^9}, 3.667910683810557*^9, {3.667910720618655*^9, 
   3.6679108007765837`*^9}, {3.66816631739188*^9, 3.668166320959875*^9}, {
   3.6681663636956263`*^9, 3.668166444524235*^9}, 3.668167020727107*^9, {
   3.6681674635000753`*^9, 3.668167474657826*^9}, {3.668167560922271*^9, 
   3.668167602135705*^9}, {3.6681676393577623`*^9, 3.668167689140959*^9}, {
   3.668168102730618*^9, 3.668168128330806*^9}, {3.668168193267274*^9, 
   3.66816821744075*^9}, {3.668168266503697*^9, 3.66816831469429*^9}, {
   3.668168531225005*^9, 3.6681685421679087`*^9}, {3.6681689599427433`*^9, 
   3.6681689683253508`*^9}, {3.668169016156123*^9, 3.668169046211808*^9}, {
   3.668170043519361*^9, 3.668170047053616*^9}, {3.668170412696371*^9, 
   3.668170419100215*^9}, {3.668170560185047*^9, 3.668170641158381*^9}, {
   3.668171026147955*^9, 3.668171028550968*^9}, {3.668171330935315*^9, 
   3.668171415835734*^9}, {3.66817200462433*^9, 3.6681720337178497`*^9}, {
   3.668172471948838*^9, 3.668172621079666*^9}, {3.668172750597891*^9, 
   3.6681727815562363`*^9}, {3.668174823556732*^9, 3.6681748569470263`*^9}, {
   3.6695562733937073`*^9, 3.669556273567175*^9}, {3.730115678852222*^9, 
   3.730115699585402*^9}, {3.7301157323482027`*^9, 3.7301157333531857`*^9}, {
   3.730115767075754*^9, 3.7301157710654697`*^9}, {3.735289657936088*^9, 
   3.735289674327729*^9}, {3.735289784154421*^9, 3.735289787481594*^9}, {
   3.7352898272167797`*^9, 3.735290002582595*^9}, {3.735290095329773*^9, 
   3.735290162868586*^9}, {3.735290245484164*^9, 3.735290301746228*^9}, {
   3.735290448176181*^9, 3.73529045094989*^9}, {3.735290525116585*^9, 
   3.7352905413939257`*^9}, {3.735290584122366*^9, 3.7352906465511703`*^9}, {
   3.737358939619228*^9, 3.737359018409576*^9}, {3.7373593602857637`*^9, 
   3.737359377872649*^9}, {3.7373595559838123`*^9, 3.7373595796313553`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[74]:=",ExpressionUUID->"b3021758-00a9-4a62-b432-303279433fac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[75]:=",ExpressionUUID->"045335f9-6570-44cb-8bb9-a2302903b6f5"]
}, Closed]],

Cell[CellGroupData[{

Cell["RenamePackageFunction", "Subchapter",
 CellChangeTimes->{{3.667722667271051*^9, 3.667722668806367*^9}, 
   3.667850300505624*^9, {3.735289606222719*^9, 3.735289627652623*^9}, {
   3.735322302924317*^9, 3.7353223166581173`*^9}, {3.735474220716318*^9, 
   3.735474221818568*^9}},ExpressionUUID->"aad9bf96-19cc-47ef-81b7-\
25edf00b2164"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[76]:=",ExpressionUUID->"b87485ae-5487-4bc5-8055-c0e7c35d265c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RenamePackageFunction", "::", "notfound"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] was not found in the definitions \
file.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RenamePackageFunction", "::", "nbNotFound"}], "=", 
   "\"\<No notebook \[LeftGuillemet]`1`.nb\[RightGuillemet] was found in \
\[LeftGuillemet]`2`\[RightGuillemet].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RenamePackageFunction", "::", "missingDocTools"}], "=", 
    "\"\<Missing \[LeftGuillemet]DocumentationTools\[RightGuillemet] from \
Applications.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "RenamePackageFunction"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<DocumentationDir\>\"", "\[Rule]", 
      "\"\</Users/Stian/Library/Mobile Documents/com~apple~CloudDocs/Stians \
iCloud/Utdanning/(2016-2020) Universitetet i Stavanger (PhD)/Mathematica \
project/GitHub/MaXrd/Documentation\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<DefinitionFile\>\"", "\[Rule]", 
      "\"\</Users/Stian/Library/Mobile Documents/com~apple~CloudDocs/Stians \
iCloud/Utdanning/(2016-2020) Universitetet i Stavanger (PhD)/Mathematica \
project/GitHub/MaXrd/Core/Definitions.nb\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<ShowNotebooks\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<TestRun\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ReturnContainedOnly\>\"", "\[Rule]", "False"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678104346724377`*^9, {3.667810873424903*^9, 3.667810875341351*^9}, {
   3.667908690584041*^9, 3.6679087037986794`*^9}, {3.66816649847222*^9, 
   3.668166502894822*^9}, {3.668168391112651*^9, 3.668168392544508*^9}, {
   3.6681686970571632`*^9, 3.668168720912581*^9}, {3.668171328149095*^9, 
   3.668171328331027*^9}, {3.668174651092638*^9, 3.668174651628518*^9}, {
   3.6681747682269382`*^9, 3.668174770113784*^9}, 3.735289646941869*^9, {
   3.735289690900867*^9, 3.7352897542826157`*^9}, {3.735290086771192*^9, 
   3.7352900871389008`*^9}, {3.735290149524373*^9, 3.7352901571321*^9}, {
   3.7352903374722023`*^9, 3.735290438771717*^9}, {3.73532233027634*^9, 
   3.735322336653865*^9}, {3.735390407875737*^9, 3.7353904123012857`*^9}, {
   3.7353910850442038`*^9, 3.735391118051364*^9}, {3.7353912149870987`*^9, 
   3.735391222478245*^9}, {3.735391565009264*^9, 3.735391565577145*^9}, {
   3.735391802501281*^9, 3.735391804201668*^9}, {3.7353966884764223`*^9, 
   3.735396710369771*^9}, {3.735400500969212*^9, 3.7354005278134937`*^9}, {
   3.735404190742627*^9, 3.73540419081968*^9}, {3.735474245331739*^9, 
   3.735474245346443*^9}, {3.737873045599255*^9, 3.737873049429261*^9}, {
   3.737949802792818*^9, 3.7379498106962357`*^9}, {3.737957291952108*^9, 
   3.737957292223482*^9}, {3.737957840484242*^9, 3.7379578658995113`*^9}, {
   3.737957936360182*^9, 3.7379579675979977`*^9}, 3.7379765929162483`*^9, 
   3.7379767648318043`*^9, {3.743865135381383*^9, 3.7438651413027782`*^9}, {
   3.743865232961587*^9, 3.743865247883717*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"13d88144-50a3-4f62-a5bd-3ac43f40a60f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667812446376968*^9, 3.66781245684652*^9}, {3.667812487271872*^9, 
   3.667812487581573*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[81]:=",ExpressionUUID->"c89539d3-3f27-4893-aef4-d2b39ee5c0d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenamePackageFunction", "[", 
   RowBox[{"oldName_String", ",", "newName_String", ",", 
    RowBox[{"OptionsPattern", "@", "RenamePackageFunction"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "docDir", ",", "symbolsDocDir", ",", "definitionsFile", ",", "showQ", 
      ",", "testRunQ", ",", "\[IndentingNewLine]", "import", ",", "L", ",", 
      "nb", ",", "\[IndentingNewLine]", "allDocPages", ",", 
      RowBox[{"contained", "=", 
       RowBox[{"{", "}"}]}], ",", "exc", ",", "oldNamePattern", ",", 
      "\[IndentingNewLine]", "checkAndReplace", ",", "searchAndReplace", ",", 
      "saveProcedure", ",", "\[IndentingNewLine]", "read", ",", "write", ",", 
      "oldFile", ",", "newFile"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "File", " ", "and", " ", "directory", 
      " ", "setup", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"docDir", "=", 
      RowBox[{"OptionValue", "[", "\"\<DocumentationDir\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"symbolsDocDir", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "docDir", ",", "\"\<English\>\"", ",", "\"\<ReferencePages\>\"", ",", 
         "\"\<Symbols\>\""}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"definitionsFile", "=", 
      RowBox[{"OptionValue", "[", "\"\<DefinitionFile\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"showQ", "=", 
      RowBox[{"OptionValue", "[", "\"\<ShowNotebooks\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"testRunQ", "=", 
      RowBox[{"OptionValue", "[", "\"\<TestRun\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Pattern", " ", "recognition"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"exc", "=", 
      RowBox[{"Except", "[", 
       RowBox[{"{", 
        RowBox[{"LetterCharacter", "|", "\"\<\\\"\>\""}], "}"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"oldNamePattern", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"StartOfString", ",", "exc"}], "}"}], "~~", "oldName", "~~", 
       RowBox[{"{", 
        RowBox[{"exc", ",", "EndOfString"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Symbol", " ", "notebooks"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"allDocPages", "=", 
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*.nb\>\"", ",", "symbolsDocDir"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"oldFile", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"allDocPages", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{
           "$PathnameSeparator", "~~", "oldName", "~~", "\"\<.nb\>\"", "~~", 
            "EndOfString"}]}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", ":", " ", 
       RowBox[{
        RowBox[{"Does", " ", "'"}], "<", "oldName", ">", 
        RowBox[{
         RowBox[{".", 
          RowBox[{"nb", "'"}]}], " ", 
         RowBox[{"exist", "?"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"oldFile", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"RenamePackageFunction", "::", "nbNotFound"}], ",", 
          "\[IndentingNewLine]", "\t", "oldName", ",", "symbolsDocDir"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"oldFile", "=", 
        RowBox[{"First", "@", "oldFile"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"contained", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"allDocPages", ",", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"#", ",", "\"\<Text\>\""}], "]"}], ",", "oldName"}], 
          "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<ReturnContainedOnly\>\"", "]"}], ",", 
       
       RowBox[{"Return", "[", 
        RowBox[{"FileBaseName", "/@", "contained"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", "-"}], "*", " ", "check"}], "-", "and", "-", 
       RowBox[{"replace", " ", "procedures", " ", "*", 
        RowBox[{"--", "-"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", "-", "and", "-", "replace"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"checkAndReplace", "[", "nb_NotebookObject", "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SelectionMove", "[", 
         RowBox[{"nb", ",", "All", ",", "Expression"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"read", "=", 
         RowBox[{"NotebookRead", "[", "nb", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "@", "read"}], "\[Equal]", "TemplateBox"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"SelectionMove", "[", 
            RowBox[{"nb", ",", "Next", ",", "Cell"}], "]"}], ";", 
           RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"ToString", "@", "read"}], ",", "oldNamePattern"}], "]"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"write", "=", 
            RowBox[{"read", "/.", 
             RowBox[{"s_String", "\[RuleDelayed]", 
              RowBox[{"StringReplace", "[", 
               RowBox[{"s", ",", 
                RowBox[{"oldName", "\[Rule]", "newName"}]}], "]"}]}]}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"NotebookWrite", "[", 
            RowBox[{"nb", ",", "write"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SelectionMove", "[", 
         RowBox[{"nb", ",", "Next", ",", "Word"}], "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Search", "-", "and", "-", "replace"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"searchAndReplace", "[", "nb_NotebookObject", "]"}], ":=", 
      RowBox[{"While", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NotebookFind", "[", 
          RowBox[{"nb", ",", "oldName", ",", 
           RowBox[{"WordSearch", "\[Rule]", "True"}]}], "]"}], "=!=", 
         "$Failed"}], ",", "\[IndentingNewLine]", 
        RowBox[{"checkAndReplace", "[", "nb", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Saving", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"saveProcedure", "[", "nb_NotebookObject", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{"testRunQ", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"showQ", ",", 
          RowBox[{"DialogInput", "[", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Click OK to close this (unsaved) and continue.\>\"", ",", 
              RowBox[{"DefaultButton", "[", 
               RowBox[{"\"\<OK\>\"", ",", 
                RowBox[{"DialogReturn", "[", "]"}]}], "]"}]}], "}"}], "]"}], 
           "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"NotebookSave", "[", "nb", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Replacements", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "1.", " ", "Scan", " ", "through", " ", "definitions", " ", 
       "notebook"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"import", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"definitionsFile", ",", "\"\<Text\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "old", " ", "function", " ", "exists"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"import", ",", "oldName"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"RenamePackageFunction", "::", "notfound"}], ",", 
          "oldName"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Total", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"List", "@", 
         RowBox[{"StringCount", "[", 
          RowBox[{"import", ",", "oldName"}], "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nb", "=", 
      RowBox[{"NotebookOpen", "[", 
       RowBox[{"definitionsFile", ",", 
        RowBox[{"Visible", "\[Rule]", "showQ"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"searchAndReplace", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"saveProcedure", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookClose", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "2.", " ", "Scan", " ", "through", " ", "documentation", " ", "pages"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", 
       RowBox[{"if", " ", "'"}], 
       RowBox[{"DocumentationTools", "'"}], " ", "are", " ", "present"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "$UserBaseDirectory", ",", "\"\<Applications\>\"", ",", 
            "\"\<DocumentationTools\>\"", ",", "\[IndentingNewLine]", 
            "\"\<Kernel\>\"", ",", "\"\<init.m\>\""}], "}"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"RenamePackageFunction", "::", "missingDocTools"}], "]"}], 
        ";", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{"(*", " ", "Execution", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nb", "=", 
         RowBox[{"NotebookOpen", "[", 
          RowBox[{
           RowBox[{"contained", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"Visible", "\[Rule]", "showQ"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"searchAndReplace", "[", "nb", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"saveProcedure", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"NotebookClose", "@", "nb"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "contained"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Rename", " ", "corresponding", " ", "documentation", " ", "page"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "testRunQ"}], ",", 
       RowBox[{
        RowBox[{"newFile", "=", 
         RowBox[{"FileNameJoin", "@", 
          RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FileNameSplit", "@", "oldFile"}], ",", 
            RowBox[{"newName", "<>", "\"\<.nb\>\""}], ",", 
            RowBox[{"-", "1"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RenameFile", "[", 
         RowBox[{"oldFile", ",", "newFile"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Print", " ", "information", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<Changed: \>\"", "<>", "oldName", "<>", 
       "\"\< \[LongRightArrow] \>\"", "<>", "newName", "<>", "\"\<\\n\>\"", "<>",
        "\[IndentingNewLine]", "\"\<Replacements in definitions file: \>\"", "<>", 
       RowBox[{"ToString", "@", "L"}], "<>", "\"\<\\n\>\"", 
       "\[IndentingNewLine]", "<>", 
       "\"\<Documentation pages considered:\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"FileBaseName", "/@", "contained"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810883538918*^9, {3.6678119799664907`*^9, 3.667812004062636*^9}, {
   3.667812039037266*^9, 3.667812072607596*^9}, 3.667812406683673*^9, {
   3.667813882624302*^9, 3.6678138933821697`*^9}, 3.667814924729149*^9, {
   3.66781496632804*^9, 3.6678149928687553`*^9}, {3.6678150319879923`*^9, 
   3.667815059729232*^9}, {3.6678370650379553`*^9, 3.667837080571652*^9}, {
   3.667837156210669*^9, 3.667837159120823*^9}, {3.667908932612733*^9, 
   3.667909140003276*^9}, {3.6679092891288967`*^9, 3.6679093072406178`*^9}, {
   3.667909378728078*^9, 3.667909385806776*^9}, 3.6679094645439787`*^9, {
   3.667909551805661*^9, 3.6679095772688637`*^9}, {3.667909873528627*^9, 
   3.667909885693358*^9}, {3.667909967926968*^9, 3.667910004853548*^9}, {
   3.667910046133897*^9, 3.667910050012671*^9}, {3.6679100833093767`*^9, 
   3.667910107176985*^9}, {3.667910226610819*^9, 3.667910251483017*^9}, {
   3.6679102972356453`*^9, 3.667910313883361*^9}, {3.667910354015862*^9, 
   3.667910355430586*^9}, {3.667910405695218*^9, 3.6679104080780973`*^9}, {
   3.667910449599267*^9, 3.667910452645286*^9}, {3.667910592254632*^9, 
   3.667910624761389*^9}, 3.667910683810557*^9, {3.667910720618655*^9, 
   3.6679108007765837`*^9}, {3.66816631739188*^9, 3.668166320959875*^9}, {
   3.6681663636956263`*^9, 3.668166444524235*^9}, 3.668167020727107*^9, {
   3.6681674635000753`*^9, 3.668167474657826*^9}, {3.668167560922271*^9, 
   3.668167602135705*^9}, {3.6681676393577623`*^9, 3.668167689140959*^9}, {
   3.668168102730618*^9, 3.668168128330806*^9}, {3.668168193267274*^9, 
   3.66816821744075*^9}, {3.668168266503697*^9, 3.66816831469429*^9}, {
   3.668168531225005*^9, 3.6681685421679087`*^9}, {3.6681689599427433`*^9, 
   3.6681689683253508`*^9}, {3.668169016156123*^9, 3.668169046211808*^9}, {
   3.668170043519361*^9, 3.668170047053616*^9}, {3.668170412696371*^9, 
   3.668170419100215*^9}, {3.668170560185047*^9, 3.668170641158381*^9}, {
   3.668171026147955*^9, 3.668171028550968*^9}, {3.668171330935315*^9, 
   3.668171415835734*^9}, {3.66817200462433*^9, 3.6681720337178497`*^9}, {
   3.668172471948838*^9, 3.668172621079666*^9}, {3.668172750597891*^9, 
   3.6681727815562363`*^9}, {3.668174823556732*^9, 3.6681748569470263`*^9}, {
   3.6695562733937073`*^9, 3.669556273567175*^9}, {3.730115678852222*^9, 
   3.730115699585402*^9}, {3.7301157323482027`*^9, 3.7301157333531857`*^9}, {
   3.730115767075754*^9, 3.7301157710654697`*^9}, {3.735289657936088*^9, 
   3.735289674327729*^9}, {3.735289784154421*^9, 3.735289787481594*^9}, {
   3.7352898272167797`*^9, 3.735290002582595*^9}, {3.735290095329773*^9, 
   3.735290162868586*^9}, {3.735290245484164*^9, 3.735290301746228*^9}, {
   3.735290448176181*^9, 3.73529045094989*^9}, {3.73532233840807*^9, 
   3.7353223478530397`*^9}, {3.735390249209564*^9, 3.735390370445681*^9}, {
   3.7353907664617367`*^9, 3.7353907675883503`*^9}, {3.735390799525942*^9, 
   3.7353908342927427`*^9}, {3.735390867196972*^9, 3.735390892393715*^9}, {
   3.735390979544832*^9, 3.735390987557987*^9}, {3.735391044456431*^9, 
   3.735391081381122*^9}, {3.7353911230622473`*^9, 3.7353911483319063`*^9}, {
   3.735391227291803*^9, 3.735391245555953*^9}, {3.735391348808051*^9, 
   3.735391349103528*^9}, {3.735391458253347*^9, 3.735391562242652*^9}, {
   3.735393235636435*^9, 3.735393241128446*^9}, {3.735396641734086*^9, 
   3.7353966734442453`*^9}, {3.735396761996003*^9, 3.735396792306005*^9}, {
   3.735396940288539*^9, 3.735396941223641*^9}, {3.735397045445467*^9, 
   3.7353970567173157`*^9}, {3.735397099476255*^9, 3.7353971011226873`*^9}, 
   3.735397153556191*^9, {3.73539718999494*^9, 3.735397190890129*^9}, {
   3.735397706696685*^9, 3.735397711909418*^9}, {3.73539844258248*^9, 
   3.735398448167486*^9}, {3.735398720801361*^9, 3.735398724574945*^9}, {
   3.735398791034539*^9, 3.7353988488246193`*^9}, {3.735398881518497*^9, 
   3.735398897933325*^9}, {3.735399039715726*^9, 3.735399040784863*^9}, {
   3.735399424424613*^9, 3.735399428438336*^9}, {3.735399481655443*^9, 
   3.735399488102029*^9}, {3.73539959174009*^9, 3.735399643609173*^9}, {
   3.7354005416563387`*^9, 3.7354005875979347`*^9}, {3.735401519049059*^9, 
   3.735401519206965*^9}, {3.735401822353863*^9, 3.7354018416979628`*^9}, {
   3.735401965855734*^9, 3.735401986205192*^9}, {3.735403634434763*^9, 
   3.735403638539209*^9}, {3.735404185272098*^9, 3.735404185360835*^9}, {
   3.735404958519732*^9, 3.73540498040436*^9}, {3.735474245355218*^9, 
   3.735474245379064*^9}, {3.735474427818927*^9, 3.735474446503525*^9}, {
   3.737873071344336*^9, 3.7378731218691883`*^9}, {3.737873243077183*^9, 
   3.737873243210782*^9}, {3.737873880718032*^9, 3.737873885565482*^9}, {
   3.737874117233116*^9, 3.7378741199272127`*^9}, {3.737874156206501*^9, 
   3.737874219678466*^9}, {3.737874333740016*^9, 3.7378744760866547`*^9}, {
   3.737874511125544*^9, 3.737874511437448*^9}, {3.7378768375551243`*^9, 
   3.737876932727627*^9}, {3.737877196716042*^9, 3.737877206600863*^9}, {
   3.737879382699382*^9, 3.737879386641904*^9}, {3.737901600358079*^9, 
   3.7379016678846273`*^9}, {3.7379023528785763`*^9, 3.737902359980657*^9}, {
   3.737903642458033*^9, 3.7379036466259823`*^9}, {3.737904211565021*^9, 
   3.737904237946347*^9}, 3.737904350609631*^9, {3.737904398003624*^9, 
   3.737904430370249*^9}, {3.73790453872197*^9, 3.737904555356708*^9}, 
   3.737905084214141*^9, {3.73790522158604*^9, 3.737905252055702*^9}, {
   3.737905363974929*^9, 3.737905435029807*^9}, 3.7379491609538717`*^9, {
   3.73794924101828*^9, 3.7379492431872168`*^9}, {3.737949814515917*^9, 
   3.737949832568791*^9}, {3.7379557048338547`*^9, 3.737955723916409*^9}, {
   3.737956421508773*^9, 3.737956437795971*^9}, {3.7379565903870087`*^9, 
   3.737956594680777*^9}, 3.737956637119808*^9, {3.737956941922901*^9, 
   3.737956963178364*^9}, {3.737957087967761*^9, 3.737957117976007*^9}, {
   3.737957217517269*^9, 3.737957288762561*^9}, {3.737957554710309*^9, 
   3.73795757365272*^9}, {3.7379579750407877`*^9, 3.737958029088035*^9}, {
   3.737958324011935*^9, 3.7379583933934402`*^9}, {3.73795894462119*^9, 
   3.737958959036398*^9}, {3.737959006802411*^9, 3.737959015417671*^9}, {
   3.737959211551921*^9, 3.737959218391046*^9}, {3.737959465442397*^9, 
   3.73795946782446*^9}, 3.737960107413025*^9, {3.737960286333557*^9, 
   3.73796028646518*^9}, {3.737960350732463*^9, 3.737960364702005*^9}, {
   3.737960546047044*^9, 3.737960667874773*^9}, {3.737961536936509*^9, 
   3.737961539807261*^9}, 3.737961601464066*^9, {3.737961703390848*^9, 
   3.7379617046368513`*^9}, {3.7379619916796*^9, 3.737962012981533*^9}, {
   3.737962117514866*^9, 3.737962118399678*^9}, {3.737962149284223*^9, 
   3.737962149450584*^9}, {3.737962444060905*^9, 3.737962516916318*^9}, {
   3.7379627476623583`*^9, 3.737962760917955*^9}, {3.737962813405002*^9, 
   3.737962815024207*^9}, {3.737962876980073*^9, 3.7379628804662037`*^9}, {
   3.737963247674111*^9, 3.737963287624411*^9}, {3.737963387983808*^9, 
   3.73796341254184*^9}, {3.737967470010887*^9, 3.7379676498367453`*^9}, {
   3.7379677207450447`*^9, 3.737967737435257*^9}, {3.737967776651698*^9, 
   3.737967778499423*^9}, {3.737967970240466*^9, 3.737968053437356*^9}, 
   3.73796810431654*^9, {3.737976572929469*^9, 3.737976619949153*^9}, {
   3.737976720484857*^9, 3.737976727105138*^9}, {3.737976759946334*^9, 
   3.7379767772495413`*^9}, {3.737976816712895*^9, 3.7379768534229603`*^9}, {
   3.7379794363731203`*^9, 3.737979631046418*^9}, {3.7379798474651213`*^9, 
   3.737979858902966*^9}, {3.737980142307378*^9, 3.737980160211328*^9}, {
   3.737980268592187*^9, 3.737980312781247*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[82]:=",ExpressionUUID->"6a14548c-43ee-406c-bd45-2d8dc776d7c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[83]:=",ExpressionUUID->"0c298ca8-308a-4c7e-9d86-dbb808b7210b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Definitions \[Dash] ",
  FontWeight->"Regular"],
 StyleBox["GroupTheory",
  FontWeight->"Regular",
  FontSlant->"Italic"]
}], "Chapter",
 CellChangeTimes->{{3.657263896281269*^9, 3.6572639010563383`*^9}, {
  3.667809853233161*^9, 3.667809863671739*^9}, {3.761728827595784*^9, 
  3.761728834114563*^9}, {3.761730342275674*^9, 
  3.761730344881713*^9}},ExpressionUUID->"031cd189-ad07-4a58-8b26-\
2a34f526d55c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "End", " ", "previous", " ", "subcontext", " ", "and", " ", "start", " ", 
    "a", " ", "new", " ", "one"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Begin", "[", "\"\<`GroupTheory`\>\"", "]"}], ";"}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}, 3.761730412539352*^9, {3.761730453202365*^9, 
   3.761730460119701*^9}, {3.761731637767768*^9, 3.761731639166442*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[84]:=",ExpressionUUID->"9a75a61b-e27a-4248-82e1-0522b17f5532"],

Cell[CellGroupData[{

Cell["GroupTable", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.675838502676457*^9, 
   3.6758385042838907`*^9}},ExpressionUUID->"35ec5c91-b82a-4fb9-b01f-\
5baa07ade9da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[86]:=",ExpressionUUID->"a29b1c0b-a226-46a3-9c93-45ccea49f7dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GroupTable", "[", "m_Integer", "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "table", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"i", "*", "j"}], ",", "m"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"m", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", 
          RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TableForm", "[", 
      RowBox[{"table", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"TableHeadings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"#", ",", "#"}], "}"}]}], "&"}], "@", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", "m"}], "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.675838907518242*^9, 3.675838910885036*^9}, {3.6758531613902197`*^9, 
   3.675853170792153*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[87]:=",ExpressionUUID->"a6c653eb-9598-4f07-a1fc-cbdef5c0332b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GroupTable", "[", 
   RowBox[{"set_List", ",", "m_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"antall", ",", "table"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"antall", "=", 
      RowBox[{"Length", "@", "set"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"table", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"set", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"set", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", "m"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "antall"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "antall"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TableForm", "[", 
      RowBox[{"table", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"TableHeadings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"#", ",", "#"}], "}"}]}], "&"}], "@", "set"}]}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.675838907518242*^9, 3.675838910885036*^9}, {3.675839018077092*^9, 
   3.6758390291602507`*^9}, {3.6758408699907007`*^9, 3.675840872918118*^9}, {
   3.675853156831971*^9, 3.675853173864142*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[88]:=",ExpressionUUID->"22f61b9d-d884-43e5-b7a1-5d0df75b5e67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[89]:=",ExpressionUUID->"0f1001a0-93b6-4c58-b52c-795087d5f7b8"]
}, Closed]],

Cell[CellGroupData[{

Cell["GroupInverse", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.675760528981639*^9, 
   3.675760529044574*^9}, {3.6758385716555862`*^9, 3.675838573207355*^9}, {
   3.675840899327005*^9, 
   3.6758408999813538`*^9}},ExpressionUUID->"92300b9d-429c-4a0f-be1c-\
1de4ae1e3834"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[90]:=",ExpressionUUID->"007cffbb-a74d-4a7b-b11f-7390234018e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GroupInverse", "[", 
   RowBox[{"t_Integer", ",", "m_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "k", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"k", "*", "t"}], ",", "m"}], "]"}], "\[NotEqual]", "1"}], 
       ",", 
       RowBox[{"k", "++"}]}], "]"}], ";", "\[IndentingNewLine]", "k"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760532517644*^9}, {
   3.675840912763227*^9, 3.675840916362125*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[91]:=",ExpressionUUID->"907b56a1-2874-4615-924f-e655be2bb1ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[92]:=",ExpressionUUID->"450fe546-f7ae-4701-b7ba-97e38254a885"]
}, Closed]],

Cell[CellGroupData[{

Cell["RelativelyPrimeList", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.675760528981639*^9, 
   3.675760529044574*^9}, {3.6758385716555862`*^9, 3.675838573207355*^9}, {
   3.675838678173476*^9, 3.675838681813233*^9}, {3.6758387178241043`*^9, 
   3.675838718215083*^9}},ExpressionUUID->"97e46d1e-3de0-40ca-a585-\
4fe99af8cb0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[93]:=",ExpressionUUID->"ee344522-37c4-48c8-a3b3-429e4185d7ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RelativelyPrimeList", "[", "t_Integer", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"liste", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"liste", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"t", "-", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GCD", "[", 
           RowBox[{"i", ",", "t"}], "]"}], "\[Equal]", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"liste", ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(", "Null", ")"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "liste"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760532517644*^9}, {
   3.675840962073091*^9, 3.675840967464484*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[94]:=",ExpressionUUID->"582e8cec-88e5-427a-87db-0b826ec90d62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[95]:=",ExpressionUUID->"3c92d277-437f-4dae-9d71-13ecad4931cd"]
}, Closed]],

Cell[CellGroupData[{

Cell["CommonPrimes", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.675760528981639*^9, 
   3.675760529044574*^9}, {3.6758385716555862`*^9, 3.675838573207355*^9}, {
   3.675838678173476*^9, 3.675838681813233*^9}, {3.6758387178241043`*^9, 
   3.675838718215083*^9}, {3.675838777128817*^9, 
   3.675838779744413*^9}},ExpressionUUID->"bfb7c721-7022-4fe5-a664-\
ab2bdbdce857"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[96]:=",ExpressionUUID->"99c0aae9-1463-48d4-9d97-14a149f6e309"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CommonPrimes", "[", "i__Integer", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"antall", ",", "temp1", ",", "temp2", ",", "felles", ",", "j"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"antall", "=", 
      RowBox[{"Length", "@", 
       RowBox[{"{", "i", "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"FactorInteger", "[", "#", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
       RowBox[{"{", "i", "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp2", "=", 
      RowBox[{"Tally", "@", 
       RowBox[{"Flatten", "@", "temp1"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"felles", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"Length", "@", "temp2"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"temp2", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "2"}], "]"}], "]"}], "\[Equal]", "antall"}], 
         ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"felles", ",", 
           RowBox[{"temp2", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], ",", "Null"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "felles"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760532517644*^9}, {
   3.675841002084045*^9, 3.67584100482679*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[97]:=",ExpressionUUID->"8addee6f-01b5-48f8-982c-a2ca3233ef46"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[98]:=",ExpressionUUID->"eb925385-b4b5-443d-b38e-deb0dccaad9e"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindGenerators", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.675760528981639*^9, 
   3.675760529044574*^9}, {3.6758385716555862`*^9, 3.675838573207355*^9}, {
   3.675838678173476*^9, 3.675838681813233*^9}, {3.6758387178241043`*^9, 
   3.675838718215083*^9}, {3.675838777128817*^9, 
   3.6758387897793417`*^9}},ExpressionUUID->"32fa0a7d-f1e7-491c-825d-\
c70e7a703d2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[99]:=",ExpressionUUID->"66585b36-d120-4b18-b9de-8a3e4648de05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindGenerators", "[", "m_Integer", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"generatorer", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"generatorer", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "2"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"i", "<", "m"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "@", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"i", "^", 
              RowBox[{"Range", "@", 
               RowBox[{"(", 
                RowBox[{"m", "-", "1"}], ")"}]}]}], ",", "m"}], "]"}]}], "===", 
          RowBox[{"Range", "@", 
           RowBox[{"(", 
            RowBox[{"m", "-", "1"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"generatorer", ",", "i"}], "]"}], ",", 
         "\[IndentingNewLine]", "\t", "Null"}], "]"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "generatorer"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760532517644*^9}, {
   3.675841039942245*^9, 3.675841043414275*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[100]:=",ExpressionUUID->"39a94591-3a13-4a9f-9ea9-1e6d15255765"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[101]:=",ExpressionUUID->"249ed044-0854-4210-9f05-f54f98a2e813"]
}, Closed]],

Cell[CellGroupData[{

Cell["LinearCongruenceSolve", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.675760528981639*^9, 
   3.675760529044574*^9}, {3.6758385716555862`*^9, 3.675838573207355*^9}, {
   3.675838678173476*^9, 3.675838681813233*^9}, {3.6758387178241043`*^9, 
   3.675838718215083*^9}, {3.675838777128817*^9, 
   3.6758388318900967`*^9}},ExpressionUUID->"64f5e7f7-e605-4089-881a-\
ced52a6b4c20"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[102]:=",ExpressionUUID->"fa6a26df-c1df-4782-9dc8-ec6c0891bf49"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LinearCongruenceSolve", "::", "nosolution"}], "=", 
   "\"\<No solutions.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, {3.6758411384127073`*^9, 3.675841162650053*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"29cd17f2-b490-4ffd-bba1-e0fe5daf1499"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[104]:=",ExpressionUUID->"ce3d4d77-5135-4b7c-8329-401959344dbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinearCongruenceSolve", "[", 
   RowBox[{
   "\[Alpha]_Integer", ",", "\[Beta]_Integer", ",", "\[Gamma]_Integer"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "solutions", ",", "a", ",", "b", ",", "c", ",", "k", ",", "x", ",", "X", 
      ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Checking", " ", "the", " ", "number", " ", "of", " ", "solutions", " ", 
      
      RowBox[{"(", 
       RowBox[{"if", " ", "any"}], ")"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"solutions", "=", 
      RowBox[{"GCD", "[", 
       RowBox[{"\[Alpha]", ",", "\[Gamma]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Divisible", "[", 
        RowBox[{"\[Beta]", ",", "solutions"}], "]"}], ",", "Null", ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"LinearCongruenceSolve", "::", "nosolution"}], "]"}], ";", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Reducing", " ", "the", " ", "congruence"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], "/", 
       RowBox[{"GCD", "[", 
        RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "]"}]}]}], ";",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"a", ">", "c"}], ",", 
       RowBox[{"a", "=", 
        RowBox[{"a", "-", 
         RowBox[{
          RowBox[{"Quotient", "[", 
           RowBox[{"a", ",", "c"}], "]"}], "*", "c"}]}]}], ",", "Null"}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Finding", " ", "the", " ", "inverse", " ", "in", " ", "the", " ", 
       "corresponding", " ", "cyclic", " ", "group"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"k", "=", "2"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"k", "*", "a"}], ",", "c"}], "]"}], "\[NotEqual]", "1"}], 
       ",", 
       RowBox[{"k", "++"}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"The", " ", "inverse", " ", "will", " ", 
       RowBox[{"be", " ", "'"}], 
       RowBox[{"k", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Finding", " ", "the", " ", "solutions"}], " ", "*)"}], " ", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"x", " ", "=", " ", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"k", "*", "b"}], ",", "c"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"X", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"n", "=", "0"}], ",", 
       RowBox[{
        RowBox[{"x", "+", "n"}], "<", "\[Gamma]"}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"n", "+", "c"}]}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"X", ",", 
         RowBox[{"x", "+", "n"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"ToString", "@", "X"}], "<>", "\"\< + \>\"", "<>", 
       RowBox[{"ToString", "@", "\[Gamma]"}], "<>", 
       "\"\<\[DoubleStruckCapitalZ]\>\""}], "]"}], ";", "\[IndentingNewLine]",
      "\t\t", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760532517644*^9}, {
   3.675841068734824*^9, 3.6758411302812347`*^9}, {3.67584116796537*^9, 
   3.675841242865676*^9}, {3.6758529575253553`*^9, 3.6758530049059677`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[105]:=",ExpressionUUID->"c83cd064-7e35-40e3-8d7e-5af5944296d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[106]:=",ExpressionUUID->"3e49c63f-7c65-44c5-9a12-d4368f8efb0f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Definitions \[Dash] ",
  FontWeight->"Regular"],
 StyleBox["Miscellaneous",
  FontWeight->"Regular",
  FontSlant->"Italic"]
}], "Chapter",
 CellChangeTimes->{{3.657263896281269*^9, 3.6572639010563383`*^9}, {
  3.667809853233161*^9, 3.667809863671739*^9}, {3.761728827595784*^9, 
  3.761728834114563*^9}, {3.761730342275674*^9, 3.761730344881713*^9}, {
  3.761730682204132*^9, 
  3.761730685242449*^9}},ExpressionUUID->"65cdd307-ec21-4d74-bf3e-\
e40115c97ccd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "End", " ", "previous", " ", "subcontext", " ", "and", " ", "start", " ", 
    "a", " ", "new", " ", "one"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Begin", "[", "\"\<`Miscellaneous`\>\"", "]"}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}, 3.761730412539352*^9, {3.761730453202365*^9, 
   3.761730460119701*^9}, {3.761730690450734*^9, 3.761730693730373*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[107]:=",ExpressionUUID->"ecc4b8aa-3769-4ff8-8330-be30c1367903"],

Cell[CellGroupData[{

Cell["PolygonArea", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.675760284251472*^9, 
   3.675760286690322*^9}},ExpressionUUID->"ccd94346-d1f4-4ca0-9412-\
d512a67c61de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[109]:=",ExpressionUUID->"e22e6b24-7055-461c-acaa-7da47cf3a532"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolygonArea", "[", "input_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "i", ",", "s", ",", "dets"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "input", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "=", "1"}], ";", 
        RowBox[{"s", "=", "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"i", "<", 
        RowBox[{"Length", "[", "input", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"s", "+", 
         RowBox[{"Det", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"input", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"input", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dets", "=", 
      RowBox[{"s", "+", 
       RowBox[{"Det", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"input", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"input", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Abs", "[", 
      RowBox[{"dets", "/", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760360410982*^9, 3.675760367160817*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[110]:=",ExpressionUUID->"20b296de-f438-4325-ac49-9bf60af692a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[111]:=",ExpressionUUID->"19a75f88-c7ab-4e30-8190-f7bc74b76d11"]
}, Closed]],

Cell[CellGroupData[{

Cell["ColourConversion", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.67577147996329*^9, 
   3.675771483321144*^9}, {3.6757716308069983`*^9, 
   3.6757716757644*^9}},ExpressionUUID->"fc3c2336-ca65-4feb-a834-\
547ead5af758"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[112]:=",ExpressionUUID->"8772d8a1-3eec-4848-8da5-7bc3a2902fb0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ColourConversion", "::", "invRGB"}], "=", 
   "\"\<RGB colours should be a list of three integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColourConversion", "::", "invHTMLlength"}], "=", 
   "\"\<HTML colours should be six characters long.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColourConversion", "::", "invHTML"}], "=", 
   "\"\<HTML colours should only contain digits or letters a\[Dash]e.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColourConversion", "::", "inv"}], "=", "\"\<Invalid input.\>\""}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.675776440833538*^9, {3.7617307676668997`*^9, 
   3.761730769234971*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"7ba9edb2-c7e5-415f-acd0-cb991d5c6369"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[117]:=",ExpressionUUID->"ef984816-196d-4b7c-89c0-439229f5a7f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ColourConversion", "[", 
   RowBox[{"{", 
    RowBox[{"R_Integer", ",", "G_Integer", ",", "B_Integer"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "r", ",", "g", ",", "b", ",", "temp1", ",", "temp2", ",", "temp3", ",", 
      "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r", "=", 
      RowBox[{"IntegerString", "[", 
       RowBox[{"R", ",", "16"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"IntegerString", "[", 
       RowBox[{"G", ",", "16"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"IntegerString", "[", 
       RowBox[{"B", ",", "16"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp1", "=", 
      RowBox[{"{", 
       RowBox[{"r", ",", "g", ",", "b"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp2", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<", "4"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringLength", "[", 
           RowBox[{"Part", "[", 
            RowBox[{"temp1", ",", "i"}], "]"}], "]"}], "\[Equal]", "1"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"temp2", ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<0\>\"", ",", 
             RowBox[{"Part", "[", 
              RowBox[{"temp1", ",", "i"}], "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"temp2", ",", 
           RowBox[{"Part", "[", 
            RowBox[{"temp1", ",", "i"}], "]"}]}], "]"}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"temp3", "=", 
      RowBox[{"StringJoin", "@", "temp2"}]}], ";", "\[IndentingNewLine]", 
     "temp3"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.675771492506175*^9, 3.675771509778859*^9}, {3.675771691502741*^9, 
   3.6757716957245693`*^9}, {3.6758347563276873`*^9, 3.6758347565170107`*^9}, 
   3.67583504843884*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[118]:=",ExpressionUUID->"ecbd883e-75b6-45f4-9e95-168130d6e30b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ColourConversion", "[", "HTML_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "html", ",", "r", ",", "g", ",", "b", ",", "R", ",", "G", ",", "B"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"html", "=", 
      RowBox[{"ToString", "[", "HTML", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"html", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"html", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"html", ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{"r", ",", "16"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"G", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{"g", ",", "16"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"B", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{"b", ",", "16"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"R", ",", "G", ",", "B"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.675771492506175*^9, 3.675771509778859*^9}, {3.675771691502741*^9, 
   3.6757717076304417`*^9}, 3.675835061311369*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[119]:=",ExpressionUUID->"a2771877-9a3b-46a5-ac0d-6fa15e51f878"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[120]:=",ExpressionUUID->"594756e5-fb88-4ace-a9df-5f9c6980b473"]
}, Closed]],

Cell[CellGroupData[{

Cell["ComplementaryColour", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.67577147996329*^9, 
   3.675771483321144*^9}, {3.6757716308069983`*^9, 3.6757716757644*^9}, {
   3.675776406608594*^9, 
   3.675776410544284*^9}},ExpressionUUID->"ebb4e8b0-5423-4f87-964d-\
7a5715a28446"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[121]:=",ExpressionUUID->"67355dc3-d60e-440e-b415-f9628f95a406"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComplementaryColour", "[", "input_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "c", ",", "c1", ",", "c2", ",", "m1", ",", "m2", ",", "m3", 
      ",", "colour"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Interpreting", " ", "and", " ", "testing", " ", "input", " ", 
      "format"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AnyTrue", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "input", "]"}], "===", "#"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"String", ",", "List"}], "}"}]}], ",", "TrueQ"}], "]"}]}],
        ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"Colour", "::", "inv"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"RGB", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "input", "]"}], "\[Equal]", "List"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{
            RowBox[{"Length", "@", 
             RowBox[{"Flatten", "[", "input", "]"}]}], "\[Equal]", "3"}]}], 
          ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"Colour", "::", "invRGB"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"c", "=", "input"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"type", "=", "\"\<RGB\>\""}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"HTML", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "input", "]"}], "\[Equal]", "String"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{
            RowBox[{"StringLength", "[", "input", "]"}], "\[Equal]", "6"}]}], 
          ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"Colour", "::", "invHTMLlength"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{
            RowBox[{"StringLength", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{"input", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "DigitCharacter", ",", "\"\<a\>\"", ",", "\"\<b\>\"", ",", 
                  "\"\<c\>\"", ",", "\"\<d\>\"", ",", "\"\<e\>\"", ",", 
                  "\"\<f\>\""}], "}"}], "\[Rule]", "\"\<\>\""}]}], "]"}], 
             "]"}], "\[Equal]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"Colour", "::", "invHTML"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"c", "=", 
         RowBox[{"ColourConversion", "[", "input", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"type", "=", "\"\<HTML\>\""}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", 
        RowBox[{"A", ":", " ", 
         RowBox[{
         "If", " ", "at", " ", "least", " ", "two", " ", "values", " ", "are",
           " ", "identical"}]}]}], ",", " ", 
       RowBox[{"swap", " ", "them"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DuplicateFreeQ", "[", "c", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c1", ",", "c2"}], "}"}], "=", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", "c", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"colour", "=", 
         RowBox[{"c", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"c1", "\[Rule]", "c2"}], ",", 
            RowBox[{"c2", "\[Rule]", "c1"}]}], "}"}]}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", 
        RowBox[{"B", ":", " ", 
         RowBox[{
         "If", " ", "all", " ", "values", " ", "are", " ", "distinct"}]}]}], 
       ",", " ", 
       RowBox[{
       "first", " ", "swap", " ", "position", " ", "of", " ", "the", " ", 
        "minimum", " ", "and", " ", "maximum", " ", "values"}]}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "The", " ", "remaining", " ", "middle", " ", "position", " ", "will", 
        " ", "be", " ", "filled", " ", 
        RowBox[{"by", " ", "'"}], "max"}], " ", "-", " ", "middle", " ", "+", 
       " ", 
       RowBox[{"min", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DuplicateFreeQ", "[", "c", "]"}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m1", ",", "m2", ",", "m3"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Min", "[", "c", "]"}], ",", 
           RowBox[{"Max", "[", "c", "]"}], ",", 
           RowBox[{
            RowBox[{"Sort", "[", "c", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"colour", "=", 
         RowBox[{"c", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m1", "\[Rule]", "m2"}], ",", 
            RowBox[{"m2", "\[Rule]", "m1"}], ",", 
            RowBox[{"m3", "\[Rule]", 
             RowBox[{"m2", "-", "m3", "+", "m1"}]}]}], "}"}]}]}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"type", "\[Equal]", "\"\<RGB\>\""}], ",", "colour", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"type", "\[Equal]", "\"\<HTML\>\""}], ",", 
       RowBox[{"ColourConversion", "[", "colour", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.675771492506175*^9, 3.675771509778859*^9}, {3.675771691502741*^9, 
   3.6757716957245693`*^9}, 3.675776463826363*^9, {3.675776523552889*^9, 
   3.6757765254969397`*^9}, {3.675835069032036*^9, 3.675835080784296*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[122]:=",ExpressionUUID->"1e2ae640-8717-4bfb-9a1f-9e11f3e27eee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[123]:=",ExpressionUUID->"abd293fc-619a-4a2b-ad23-559e0befedf6"]
}, Closed]],

Cell[CellGroupData[{

Cell["ColourTriad", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.67577147996329*^9, 
   3.675771483321144*^9}, {3.6757716308069983`*^9, 3.6757716757644*^9}, {
   3.675776406608594*^9, 3.675776410544284*^9}, {3.675776573581718*^9, 
   3.675776575724516*^9}},ExpressionUUID->"3d6e5ad1-6873-49ab-bd1f-\
025e8d82f4d8"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[124]:=",ExpressionUUID->"a0bd8bde-6054-47b2-aa19-d4d1ca7eb6b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ColourTriad"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Display\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Format\>\"", "\[Rule]", "Null"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, {3.675776418586307*^9, 3.675776437905808*^9}, 
   3.675776584757881*^9, {3.761730814785493*^9, 3.761730820961344*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"d7e85eec-611a-4ec3-b3b4-1ee29cf54391"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[126]:=",ExpressionUUID->"7354585a-c5f7-4ac9-9663-e4ab30468349"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ColourTriad", "[", 
   RowBox[{"input_", ",", 
    RowBox[{"OptionsPattern", "@", "ColourTriad"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "c", ",", "p", ",", "colour", ",", "format", ",", "output", 
      ",", "rgb"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Interpreting", " ", "and", " ", "testing", " ", "input", " ", 
      "format"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AnyTrue", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "input", "]"}], "===", "#"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"String", ",", "List"}], "}"}]}], ",", "TrueQ"}], "]"}]}],
        ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"Colour", "::", "inv"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"RGB", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "input", "]"}], "\[Equal]", "List"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{
            RowBox[{"Length", "@", 
             RowBox[{"Flatten", "[", "input", "]"}]}], "\[Equal]", "3"}]}], 
          ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"Colour", "::", "invRGB"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"c", "=", "input"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"type", "=", "\"\<RGB\>\""}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"HTML", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "input", "]"}], "\[Equal]", "String"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{
            RowBox[{"StringLength", "[", "input", "]"}], "\[Equal]", "6"}]}], 
          ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"Colour", "::", "invHTMLlength"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{
            RowBox[{"StringLength", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{"input", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "DigitCharacter", ",", "\"\<a\>\"", ",", "\"\<b\>\"", ",", 
                  "\"\<c\>\"", ",", "\"\<d\>\"", ",", "\"\<e\>\"", ",", 
                  "\"\<f\>\""}], "}"}], "\[Rule]", "\"\<\>\""}]}], "]"}], 
             "]"}], "\[Equal]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"Colour", "::", "invHTML"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"c", "=", 
         RowBox[{"ColourConversion", "[", "input", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"type", "=", "\"\<HTML\>\""}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Cycle", " ", "the", " ", "values"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"p", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Permutations", "[", 
         RowBox[{"Range", "@", "3"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Signature", "[", "#", "]"}], "\[Equal]", "1"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"colour", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"[", "#1", "]"}], "]"}], ",", 
          RowBox[{"c", "[", 
           RowBox[{"[", "#2", "]"}], "]"}], ",", 
          RowBox[{"c", "[", 
           RowBox[{"[", "#3", "]"}], "]"}]}], "}"}], "&"}], "@@", "p"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", 
       RowBox[{"Output", " ", "format"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"format", "=", 
      RowBox[{"OptionValue", "[", "\"\<Format\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"format", "\[Equal]", "\"\<RGB\>\""}], "||", 
        RowBox[{"format", "\[Equal]", "\"\<rgb\>\""}]}], ",", 
       RowBox[{"type", "=", "\"\<RGB\>\""}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"format", "\[Equal]", "\"\<HTML\>\""}], "||", 
        RowBox[{"format", "\[Equal]", "\"\<html\>\""}]}], ",", 
       RowBox[{"type", "=", "\"\<HTML\>\""}], ",", "\[IndentingNewLine]", 
       "\t", "True", ",", "Null"}], "]"}], ";", "\t", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"type", "\[Equal]", "\"\<RGB\>\""}], ",", 
       RowBox[{"output", "=", "colour"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"type", "\[Equal]", "\"\<HTML\>\""}], ",", 
       RowBox[{"output", "=", 
        RowBox[{"ColourConversion", "/@", "colour"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", 
       RowBox[{"Display", " ", "colours"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Display\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"rgb", "=", 
         RowBox[{"RGBColor", "@@@", 
          RowBox[{"(", 
           RowBox[{"colour", "/", "255"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rgb", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Rectangle", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rgb", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"Rectangle", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"rgb", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"Rectangle", "[", 
              RowBox[{"{", 
               RowBox[{"2", ",", "0"}], "}"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "\t", "}"}], "\[IndentingNewLine]", "\t", 
         "]"}]}], ",", "\[IndentingNewLine]", "\t", "output"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.675771492506175*^9, 3.675771509778859*^9}, {3.675771691502741*^9, 
   3.6757716957245693`*^9}, 3.675776463826363*^9, {3.675776523552889*^9, 
   3.6757765254969397`*^9}, {3.675776594431937*^9, 3.675776603654928*^9}, {
   3.6758350375608387`*^9, 3.675835040272936*^9}, {3.675835087063622*^9, 
   3.675835089727955*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[127]:=",ExpressionUUID->"04ebf026-3db2-4ca4-9f83-57b380f9fb6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[128]:=",ExpressionUUID->"f0a42344-dee2-4535-ac39-77f15d37379a"]
}, Closed]],

Cell[CellGroupData[{

Cell["LaTeXReminderCheck", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.675760284251472*^9, 
   3.675760286690322*^9}, {3.675838016203916*^9, 
   3.675838021340363*^9}},ExpressionUUID->"f3d28b0a-561c-49f8-b704-\
da4ded58928a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[129]:=",ExpressionUUID->"9630139d-5025-4bfc-85d6-bb7b5b001c82"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LaTeXReminderCheck", "::", "ok"}], "=", 
   "\"\<No duplicates found.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LaTeXReminderCheck", "::", "dup"}], "=", 
   "\"\<`1` duplicates were found.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.667811591227736*^9, 3.675838029313024*^9},
 CellLabel->
  "In[130]:=",ExpressionUUID->"a59de8d9-7fca-4868-ae60-bea45fcb722c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[132]:=",ExpressionUUID->"b18402e0-02ff-48f7-890c-e9ce6313c9c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LaTeXReminderCheck", "[", 
   RowBox[{
   "file_String:", "\[IndentingNewLine]", 
    "\"\</Users/Stian/Dropbox/Prosjekter/LaTeX/Guider og hjelp/LaTeX \
reminders.txt\>\""}], "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "temp1", ",", "a", ",", "b", ",", "temp2", ",", "temp3", ",", "temp4", 
      ",", "temp5"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp1", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "\"\<Data\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"temp1", ",", "#"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Custom shortcuts in TexitEasy:\>\"", ",", 
         "\"\<Custom shortcuts in Texmaker:\>\""}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"temp2", "=", 
      RowBox[{
       RowBox[{"StringCases", "[", 
        RowBox[{
         RowBox[{"ToString", "/@", 
          RowBox[{"temp1", "[", 
           RowBox[{"[", 
            RowBox[{"a", ";;", "b"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"WordCharacter", ",", "\"\<[\>\"", ",", "\"\<]\>\""}], 
            "}"}], ".."}], "~~", 
          RowBox[{"Repeated", "[", 
           RowBox[{"\"\< + \>\"", "~~", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"WordCharacter", ".."}], ",", "_"}], "}"}]}], "]"}]}]}],
         "]"}], "/.", 
       RowBox[{
        RowBox[{"{", "}"}], "\[Rule]", "Nothing"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"temp3", "=", 
      RowBox[{"Gather", "[", 
       RowBox[{"ToString", "/@", "temp2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Length", "/@", "temp3"}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{"1", "\[Rule]", "Nothing"}], "}"}]}], "]"}], "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"LaTeXReminderCheck", "::", "ok"}], "]"}], ";", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"temp4", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Select", "[", 
         RowBox[{"temp3", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], "&"}]}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"temp5", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"temp4", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<{\>\"", ",", "\"\<}\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"LaTeXReminderCheck", "::", "dup"}], ",", 
       RowBox[{"Length", "@", "temp5"}]}], "]"}], ";", 
     RowBox[{"Print", "@", 
      RowBox[{"TableForm", "@", "temp5"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760360410982*^9, 3.675760367160817*^9}, {
   3.675838035515229*^9, 3.675838056262883*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[133]:=",ExpressionUUID->"00600fac-e3f2-42c7-a975-65c71166ba84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[134]:=",ExpressionUUID->"05bffa84-cb80-4cf0-bc64-9833132bc9f0"]
}, Closed]],

Cell[CellGroupData[{

Cell["PlagiarismCheck", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.675760284251472*^9, 
   3.675760286690322*^9}, {3.675838016203916*^9, 3.675838021340363*^9}, {
   3.675838106157346*^9, 
   3.675838111469845*^9}},ExpressionUUID->"f98a45b7-4927-4fc4-bf56-\
d9944cc9fe43"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[135]:=",ExpressionUUID->"8099dc39-3b0a-4f9e-9077-deef8e106d99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlagiarismCheck", "[", "input_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"temp", ",", "temp2", ",", "temp3", ",", "temp4"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "=", 
      RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"$TemporaryDirectory", ",", 
         RowBox[{
          RowBox[{"ToString", "@", 
           RowBox[{"Unique", "[", "\"\<temp\>\"", "]"}]}], "<>", 
          "\"\<.pdf\>\""}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CopyFile", "[", 
      RowBox[{"input", ",", "temp"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"temp2", "=", 
      RowBox[{"ChangeExtension", "[", 
       RowBox[{"temp", ",", "\"\<txt\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp3", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"temp2", ",", "\"\<String\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp4", "=", 
      RowBox[{"Hash", "[", 
       RowBox[{"temp3", ",", "\"\<MD5\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"temp4", ",", "16"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760360410982*^9, 3.675760367160817*^9}, {
   3.675838035515229*^9, 3.675838056262883*^9}, 3.675838305543357*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[136]:=",ExpressionUUID->"15a7d11f-eb94-4de1-b10f-f58ead36be9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlagiarismCheck", "[", "input_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"list", ",", "found", ",", "n", ",", "h", ",", "i"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"found", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"input", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"h", "=", 
         RowBox[{"PlagiarismCheck", "@", 
          RowBox[{"input", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"list", ",", "h"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"found", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"list", "[", "h", "]"}], ",", "n"}], "}"}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"list", ",", 
          RowBox[{"h", "\[Rule]", "n"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "input"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "found"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760360410982*^9, 3.675760367160817*^9}, {
   3.675838035515229*^9, 3.675838056262883*^9}, {3.675838305543357*^9, 
   3.6758383178905582`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[137]:=",ExpressionUUID->"1ab72223-7cd8-443a-9f6a-49659eee15ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[138]:=",ExpressionUUID->"516f7241-69d4-43c3-b81b-3c65f465b202"]
}, Closed]],

Cell[CellGroupData[{

Cell["Pok\[EAcute]monTeamTest", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.675760284251472*^9, 
   3.675760286690322*^9}, {3.675838016203916*^9, 3.675838021340363*^9}, {
   3.675838106157346*^9, 3.675838111469845*^9}, {3.675841266768855*^9, 
   3.6758412682165337`*^9}, {3.6758413293148613`*^9, 3.675841333442782*^9}, 
   3.679634247579987*^9},ExpressionUUID->"4f294354-0368-4de4-893f-\
7981240fcbea"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[139]:=",ExpressionUUID->"f5cb846b-bd99-4722-8613-0f98c6d36bed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Default", "[", 
     RowBox[{"PokemonTeamTest", ",", "2"}], "]"}], "=", 
    RowBox[{"(", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Null", ",", "\"\<normal\>\"", ",", "\"\<fight\>\"", ",", 
         "\"\<flying\>\"", ",", "\"\<poison\>\"", ",", "\"\<ground\>\"", ",", 
         "\"\<rock\>\"", ",", "\"\<bug\>\"", ",", "\"\<ghost\>\"", ",", 
         "\"\<steel\>\"", ",", "\"\<fire\>\"", ",", "\"\<water\>\"", ",", 
         "\"\<grass\>\"", ",", "\"\<electric\>\"", ",", "\"\<psychic\>\"", 
         ",", "\"\<ice\>\"", ",", "\"\<dragon\>\"", ",", "\"\<dark\>\"", ",", 
         "\"\<fairy\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<normal\>\"", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
         ",", ".5", ",", "1", ",", "0", ",", ".5", ",", "1", ",", "1", ",", 
         "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<fight\>\"", ",", "2", ",", "1", ",", ".5", ",", ".5", ",", "1", 
         ",", "2", ",", ".5", ",", "0", ",", "2", ",", "1", ",", "1", ",", 
         "1", ",", "1", ",", ".5", ",", "2", ",", "1", ",", "2", ",", ".5"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<flying\>\"", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", 
         ",", ".5", ",", "2", ",", "1", ",", ".5", ",", "1", ",", "1", ",", 
         "2", ",", ".5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<poison\>\"", ",", "1", ",", "1", ",", "1", ",", ".5", ",", ".5", 
         ",", ".5", ",", "1", ",", ".5", ",", "0", ",", "1", ",", "1", ",", 
         "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ground\>\"", ",", "1", ",", "1", ",", "0", ",", "2", ",", "1", 
         ",", "2", ",", ".5", ",", "1", ",", "2", ",", "2", ",", "1", ",", 
         ".5", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<rock\>\"", ",", "1", ",", ".5", ",", "2", ",", "1", ",", ".5", 
         ",", "1", ",", "2", ",", "1", ",", ".5", ",", "2", ",", "1", ",", 
         "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<bug\>\"", ",", "1", ",", ".5", ",", ".5", ",", ".5", ",", "1", 
         ",", "1", ",", "1", ",", ".5", ",", ".5", ",", ".5", ",", "1", ",", 
         "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2", ",", ".5"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ghost\>\"", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", 
         ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1",
          ",", "1", ",", "2", ",", "1", ",", "1", ",", ".5", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<steel\>\"", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
         ",", "2", ",", "1", ",", "1", ",", ".5", ",", ".5", ",", ".5", ",", 
         "1", ",", ".5", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<fire\>\"", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",",
          ".5", ",", "2", ",", "1", ",", "2", ",", ".5", ",", ".5", ",", "2", 
         ",", "1", ",", "1", ",", "2", ",", ".5", ",", "1", ",", "1"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<water\>\"", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", 
         ",", "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", ".5", ",", 
         ".5", ",", "1", ",", "1", ",", "1", ",", ".5", ",", "1", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<grass\>\"", ",", "1", ",", "1", ",", ".5", ",", ".5", ",", "2", 
         ",", "2", ",", ".5", ",", "1", ",", ".5", ",", ".5", ",", "2", ",", 
         ".5", ",", "1", ",", "1", ",", "1", ",", ".5", ",", "1", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<electric\>\"", ",", "1", ",", "1", ",", "2", ",", "1", ",", "0", 
         ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", 
         ".5", ",", ".5", ",", "1", ",", "1", ",", ".5", ",", "1", ",", "1"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<psychic\>\"", ",", "1", ",", "2", ",", "1", ",", "2", ",", "1", 
         ",", "1", ",", "1", ",", "1", ",", ".5", ",", "1", ",", "1", ",", 
         "1", ",", "1", ",", ".5", ",", "1", ",", "1", ",", "0", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ice\>\"", ",", "1", ",", "1", ",", "2", ",", "1", ",", "2", ",", 
         "1", ",", "1", ",", "1", ",", ".5", ",", ".5", ",", ".5", ",", "2", 
         ",", "1", ",", "1", ",", ".5", ",", "2", ",", "1", ",", "1"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<dragon\>\"", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
         ",", "1", ",", "1", ",", "1", ",", ".5", ",", "1", ",", "1", ",", 
         "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<dark\>\"", ",", "1", ",", ".5", ",", "1", ",", "1", ",", "1", 
         ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1",
          ",", "1", ",", "2", ",", "1", ",", "1", ",", ".5", ",", ".5"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<fairy\>\"", ",", "1", ",", "2", ",", "1", ",", ".5", ",", "1", 
         ",", "1", ",", "1", ",", "1", ",", ".5", ",", ".5", ",", "1", ",", 
         "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", "1"}], 
        "}"}]}], "}"}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PokemonTeamTest", "::", "InvType"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid Pok\[EAcute]mon \
type.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PokemonTeamTest", "::", "InvTypes"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] are not a valid Pok\[EAcute]mon \
types.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PokemonTeamTest", "::", "NotString"}], "=", 
   "\"\<Pok\[EAcute]mon types must be strings.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PokemonTeamTest", "::", "OK"}], "=", 
   "\"\<Pok\[EAcute]mon team OK.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.675838029313024*^9, {3.67583830728659*^9, 
   3.675838311870343*^9}, {3.675841388549286*^9, 3.675841414668627*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"68003f11-1ef2-49bb-86e1-47105996184f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[145]:=",ExpressionUUID->"f97c46fd-a6ad-4fa6-9625-f7bbd8418a11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PokemonTeamTest", "[", 
   RowBox[{"pokemon_", ",", "typetable_."}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "alltypes", ",", "notpokemon", ",", "ttable", ",", "pkmn", ",", "str", 
      ",", "goodagainst", ",", "good", ",", "missing"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Basic", " ", "information"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"alltypes", "=", 
      RowBox[{"typetable", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", 
         RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"notpokemon", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"pokemon", ",", "alltypes"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"notpokemon", "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "notpokemon", "]"}], "\[Equal]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"PokemonTeamTest", "::", "InvType"}], ",", 
            RowBox[{"First", "@", "notpokemon"}]}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"PokemonTeamTest", "::", "InvTypes"}], ",", "notpokemon"}],
           "]"}]}], "\[IndentingNewLine]", "\t", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"pokemon", ",", "StringQ"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"PokemonTeamTest", "::", "NotString"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Keeping", " ", "rows", " ", "with", " ", "given", " ", "types"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"ttable", "=", 
      RowBox[{"typetable", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"pkmn", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"ttable", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"pokemon", ",", 
           RowBox[{"First", "[", "#", "]"}]}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Finding", " ", "which", " ", "types", " ", "the", " ", "team", " ", 
       "is", " ", "effective", " ", "against"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"str", "=", 
      RowBox[{"Last", "/@", 
       RowBox[{"Position", "[", 
        RowBox[{"pkmn", ",", "2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"goodagainst", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"typetable", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "#"}], "]"}], "]"}], "&"}], "/@", "str"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"good", "=", 
      RowBox[{"DeleteDuplicates", "@", "goodagainst"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Missing", " ", "types", " ", "effective", " ", "against"}], 
       "..."}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"missing", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"alltypes", ",", "good"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Returning", " ", "result"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"missing", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Message", "[", 
        RowBox[{"PokemonTeamTest", "::", "OK"}], "]"}], ",", 
       RowBox[{"Return", "@", "missing"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760360410982*^9, 3.675760367160817*^9}, {
   3.675838035515229*^9, 3.675838056262883*^9}, 3.675838305543357*^9, {
   3.675841392309507*^9, 3.67584142626477*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[146]:=",ExpressionUUID->"75102219-1cfc-4b58-b675-0ade0f36216a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[147]:=",ExpressionUUID->"78fb45d7-79ab-4bed-9248-0460d7c7c8c1"]
}, Closed]],

Cell[CellGroupData[{

Cell["GradeCalculation", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.675841534198148*^9, 
   3.675841538501794*^9}},ExpressionUUID->"d8d3ac30-f2f1-4d60-94c6-\
ad406da96082"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[148]:=",ExpressionUUID->"8111ab22-da75-4353-adc5-6269177643fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GradeCalculation", "::", "invalid"}], "=", 
   "\"\<Invalid input.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, {3.675842792564227*^9, 3.675842807867942*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"6190833c-d470-4d17-b948-9f6105dc5920"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[150]:=",ExpressionUUID->"9d8e615d-e2ad-431b-821a-5a0984329df4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GradeCalculation", "[", "input__", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Gather", " ", "numbers", " ", "in", " ", "a", " ", "list"}], " ",
     "*)"}], "\[IndentingNewLine]", "\t", 
   RowBox[{"GradeCalculation", "[", 
    RowBox[{"{", "input", "}"}], "]"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.6758415517950277`*^9, 3.6758415567955217`*^9}, {3.675841621448022*^9, 
   3.675841802986803*^9}, {3.675841838022696*^9, 3.6758418409354773`*^9}, {
   3.675841916804886*^9, 3.6758419197242517`*^9}, {3.6758419788381567`*^9, 
   3.675841997106422*^9}, {3.6758420345088987`*^9, 3.675842248426758*^9}, {
   3.675842364612609*^9, 3.675842516911927*^9}, {3.675842595334993*^9, 
   3.675842650590219*^9}, {3.675842747747283*^9, 3.675842816988883*^9}, {
   3.6758432343308277`*^9, 3.6758432608500643`*^9}, {3.67584329326573*^9, 
   3.6758433076330013`*^9}, {3.675844324008954*^9, 3.675844387999127*^9}, {
   3.675844438101932*^9, 3.675844480364152*^9}, {3.675844557498332*^9, 
   3.675844608538219*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[151]:=",ExpressionUUID->"06cc15eb-b4a3-4177-9c19-4292f3041c73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GradeCalculation", "[", "input_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "L", ",", "Letter", ",", "Number", ",", "sum", ",", "averagegrade"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"L", "=", 
      RowBox[{"Length", "[", "input", "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "6"}], "}"}], ",", "L"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GradeCalculation", "::", "invalid"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Conversion", " ", "functions"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"Letter", "[", "number_", "]"}], ":=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"number", "<", "0.5"}], ",", "           ", "\"\<F\>\"", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"0.5", "\[LessEqual]", "number", "<", "1.5"}], ",", 
        "\"\<E\>\"", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"1.5", "\[LessEqual]", "number", "<", "2.5"}], ",", 
        "\"\<D\>\"", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"2.5", "\[LessEqual]", "number", "<", "3.5"}], ",", 
        "\"\<C\>\"", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"3.5", "\[LessEqual]", "number", "<", "4.5"}], ",", 
        "\"\<B\>\"", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"number", "\[GreaterEqual]", "4.5"}], ",", "           ", 
        "\"\<A\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"Number", "[", "letter_", "]"}], ":=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"letter", "\[Equal]", "\"\<F\>\""}], ",", "0", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"letter", "\[Equal]", "\"\<E\>\""}], ",", "1", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"letter", "\[Equal]", "\"\<D\>\""}], ",", "2", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"letter", "\[Equal]", "\"\<C\>\""}], ",", "3", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"letter", "\[Equal]", "\"\<B\>\""}], ",", "4", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"letter", "\[Equal]", "\"\<A\>\""}], ",", "5", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"NumericQ", "[", "letter", "]"}], ",", "letter"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Average", " ", "grade", " ", "of", " ", "an", " ", "exam"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"L", "\[Equal]", "5"}], ",", 
       RowBox[{"sum", "=", 
        RowBox[{"input", ".", 
         RowBox[{"(", 
          RowBox[{"Number", "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\"", ",", "\"\<D\>\"",
              ",", "\"\<E\>\""}], "}"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"L", "\[Equal]", "6"}], ",", 
       RowBox[{"sum", "=", 
        RowBox[{"input", ".", 
         RowBox[{"(", 
          RowBox[{"Number", "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\"", ",", "\"\<D\>\"",
              ",", "\"\<E\>\"", ",", "\"\<F\>\""}], "}"}]}], ")"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     RowBox[{"averagegrade", "=", 
      RowBox[{"Letter", "[", 
       RowBox[{"sum", "/", 
        RowBox[{"Total", "@", "input"}]}], "]"}]}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.6758415517950277`*^9, 3.6758415567955217`*^9}, {3.675841621448022*^9, 
   3.675841802986803*^9}, {3.675841838022696*^9, 3.6758418409354773`*^9}, {
   3.675841916804886*^9, 3.6758419197242517`*^9}, {3.6758419788381567`*^9, 
   3.675841997106422*^9}, {3.6758420345088987`*^9, 3.675842248426758*^9}, {
   3.675842364612609*^9, 3.675842516911927*^9}, {3.675842595334993*^9, 
   3.675842650590219*^9}, {3.675842747747283*^9, 3.675842816988883*^9}, {
   3.6758432343308277`*^9, 3.6758432608500643`*^9}, {3.67584329326573*^9, 
   3.6758433076330013`*^9}, {3.675844324008954*^9, 3.675844387999127*^9}, {
   3.675844438101932*^9, 3.675844458229601*^9}, 3.675844679200184*^9, 
   3.675844857614297*^9, {3.675853070858673*^9, 3.675853088776436*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[152]:=",ExpressionUUID->"0398eebc-aba4-4c6e-9bdf-20b8f9b3960e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GradeCalculation", "[", 
   RowBox[{"input_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Letter", ",", "Number", ",", "grades", ",", "weights", ",", "gpa"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Conversion", " ", "functions"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Letter", "[", "number_", "]"}], ":=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"number", "<", "0.5"}], ",", "           ", "\"\<F\>\"", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"0.5", "\[LessEqual]", "number", "<", "1.5"}], ",", 
        "\"\<E\>\"", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"1.5", "\[LessEqual]", "number", "<", "2.5"}], ",", 
        "\"\<D\>\"", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"2.5", "\[LessEqual]", "number", "<", "3.5"}], ",", 
        "\"\<C\>\"", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"3.5", "\[LessEqual]", "number", "<", "4.5"}], ",", 
        "\"\<B\>\"", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"number", "\[GreaterEqual]", "4.5"}], ",", "           ", 
        "\"\<A\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"Number", "[", "letter_", "]"}], ":=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"letter", "\[Equal]", "\"\<F\>\""}], ",", "0", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"letter", "\[Equal]", "\"\<E\>\""}], ",", "1", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"letter", "\[Equal]", "\"\<D\>\""}], ",", "2", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"letter", "\[Equal]", "\"\<C\>\""}], ",", "3", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"letter", "\[Equal]", "\"\<B\>\""}], ",", "4", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"letter", "\[Equal]", "\"\<A\>\""}], ",", "5", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"NumericQ", "[", "letter", "]"}], ",", "letter"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Grade", " ", "point", " ", "average"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"grades", "=", 
      RowBox[{"Number", "/@", 
       RowBox[{"input", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"weights", "=", 
      RowBox[{"input", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"gpa", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"grades", ".", "weights"}], ")"}], "/", 
       RowBox[{"Total", "[", "weights", "]"}]}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"N", "[", "gpa", "]"}], ",", "3"}], "]"}], ",", 
       RowBox[{"Letter", "@", "gpa"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.675760500525331*^9, 3.675760518660946*^9}, {
   3.6758415517950277`*^9, 3.6758415567955217`*^9}, {3.675841621448022*^9, 
   3.675841802986803*^9}, {3.675841838022696*^9, 3.6758418409354773`*^9}, {
   3.675841916804886*^9, 3.6758419197242517`*^9}, {3.6758419788381567`*^9, 
   3.675841997106422*^9}, {3.6758420345088987`*^9, 3.675842248426758*^9}, {
   3.675842364612609*^9, 3.675842516911927*^9}, {3.675842595334993*^9, 
   3.675842650590219*^9}, {3.675842747747283*^9, 3.675842816988883*^9}, {
   3.6758432343308277`*^9, 3.6758432608500643`*^9}, {3.67584329326573*^9, 
   3.675843368390951*^9}, {3.675843658752578*^9, 3.675843658896246*^9}, {
   3.6758437568229523`*^9, 3.675843884258683*^9}, {3.675843919121866*^9, 
   3.6758441234695587`*^9}, {3.6758447831752863`*^9, 3.675844838668064*^9}, {
   3.6758530757682533`*^9, 3.6758530944963293`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[153]:=",ExpressionUUID->"282ab0ec-84db-46df-8cab-80030fb56b43"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[154]:=",ExpressionUUID->"1dfc7237-8460-4e8b-ab6e-9150673cb96f"]
}, Closed]],

Cell[CellGroupData[{

Cell["GridToLaTeX", "Subchapter",
 CellChangeTimes->{{3.668442020342494*^9, 3.668442072108212*^9}, 
   3.714315126646989*^9, 
   3.714830261886001*^9},ExpressionUUID->"87680306-f2fe-4ef2-b043-\
927f71b4ff73"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[155]:=",ExpressionUUID->"1ef94e97-295e-4171-b3d4-729b5cab0c10"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GridToLaTeX"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<WrapNumbers\>\"", "\[Rule]", "False"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678104346724377`*^9, {3.667810873424903*^9, 3.667810875341351*^9}, {
   3.667908690584041*^9, 3.6679087037986794`*^9}, {3.66816649847222*^9, 
   3.668166502894822*^9}, {3.668168391112651*^9, 3.668168392544508*^9}, {
   3.6681686970571632`*^9, 3.668168720912581*^9}, {3.668171328149095*^9, 
   3.668171328331027*^9}, {3.668174651092638*^9, 3.668174651628518*^9}, {
   3.6681747682269382`*^9, 3.668174770113784*^9}, {3.668442126364066*^9, 
   3.66844212744283*^9}, {3.668665117695271*^9, 3.66866513603782*^9}, {
   3.7617309999494753`*^9, 3.761731003139814*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"8ad550a8-a9b7-4496-adde-be934771e0d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667812446376968*^9, 3.66781245684652*^9}, {3.667812487271872*^9, 
   3.667812487581573*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[157]:=",ExpressionUUID->"a76e4c86-c999-4c5a-bcce-b119c2ef84fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GridToLaTeX", "[", 
   RowBox[{"grid_Grid", ",", 
    RowBox[{"OptionsPattern", "@", "GridToLaTeX"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "dim", ",", "content", ",", "\[IndentingNewLine]", "greek", ",", "rule1",
       ",", "rule2", ",", "extrarules", ",", "rules", ",", "extranonmath", 
      ",", "\[IndentingNewLine]", "temp"}], "\[IndentingNewLine]", "}"}], ",",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Table", " ", "dimensions", " ", "and", " ", "content"}], " ", 
     "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "grid"}], ">", "1"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"dim", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "@", 
             RowBox[{"First", "[", "#", "]"}]}], ",", 
            RowBox[{"Length", "@", 
             RowBox[{"First", "@", 
              RowBox[{"First", "[", "#", "]"}]}]}]}], "}"}], "&"}], "[", 
         "grid", "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"dim", "=", 
        RowBox[{"Dimensions", "@", 
         RowBox[{"First", "@", "grid"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"content", "=", 
      RowBox[{"ToString", "/@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"First", "@", "grid"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Convert", " ", "to", " ", "string", " ", "and", " ", "correct", " ", 
       "empty", " ", "cells"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ToString", "/@", "content"}], ")"}], "/.", 
       RowBox[{"\"\<Null\>\"", "\[Rule]", "\"\<\>\""}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Correct", " ", "subscripts"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pre", ":", 
             RowBox[{
              RowBox[{"Except", "[", "\"\< \>\"", "]"}], ".."}]}], "~~", 
            "\"\<\\n\>\"", "~~", "sub__"}], "\[RuleDelayed]", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
           "\"\<{\>\"", "<>", "pre", "<>", "\"\<}\>\"", "<>", "\"\<_{\>\"", "<>", 
            RowBox[{"StringTrim", "@", "sub"}], "<>", "\"\<}\>\""}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"pre1", ":", 
             RowBox[{
              RowBox[{"Except", "[", "\"\< \>\"", "]"}], ".."}]}], "~~", 
            RowBox[{
             RowBox[{"\"\< \>\"", ".."}], "|", "\"\<\\\\n\>\""}], "~~", 
            "pre2___", "~~", "\"\<\\n\>\"", "~~", "sub__"}], "\[RuleDelayed]",
            "\[IndentingNewLine]", "\t", 
           RowBox[{
           "\"\<{\>\"", "<>", "pre1", "<>", "\"\<}\>\"", "<>", "\"\<_{\>\"", "<>", 
            RowBox[{"StringTrim", "@", "sub"}], "<>", "\"\<} \>\"", "<>", 
            "pre2"}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Correct", " ", "greek"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"greek", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<alpha\>\"", ",", "\"\<beta\>\"", ",", "\"\<gamma\>\"", ",", 
          "\"\<delta\>\"", ",", "\"\<epsilon\>\"", ",", "\"\<zeta\>\"", ",", 
          "\"\<eta\>\"", ",", "\"\<theta\>\"", ",", "\"\<iota\>\"", ",", 
          "\"\<kappa\>\"", ",", "\"\<lambda\>\"", ",", "\"\<mu\>\"", ",", 
          "\"\<nu\>\"", ",", "\"\<xi\>\"", ",", "\"\<omicron\>\"", ",", 
          "\"\<pi\>\"", ",", "\"\<rho\>\"", ",", "\"\<sigma\>\"", ",", 
          "\"\<tau\>\"", ",", "\"\<upsilon\>\"", ",", "\"\<phi\>\"", ",", 
          "\"\<chi\>\"", ",", "\"\<psi\>\"", ",", "\"\<omega\>\""}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Alpha\>\"", ",", "\"\<Beta\>\"", ",", "\"\<Gamma\>\"", ",", 
          "\"\<Delta\>\"", ",", "\"\<Epsilon\>\"", ",", "\"\<Zeta\>\"", ",", 
          "\"\<Eta\>\"", ",", "\"\<Theta\>\"", ",", "\"\<Iota\>\"", ",", 
          "\"\<Kappa\>\"", ",", "\"\<Lambda\>\"", ",", "\"\<Mu\>\"", ",", 
          "\"\<Nu\>\"", ",", "\"\<Xi\>\"", ",", "\"\<Omicron\>\"", ",", 
          "\"\<Pi\>\"", ",", "\"\<Rho\>\"", ",", "\"\<Sigma\>\"", ",", 
          "\"\<Tau\>\"", ",", "\"\<Upsilon\>\"", ",", "\"\<Phi\>\"", ",", 
          "\"\<Chi\>\"", ",", "\"\<Psi\>\"", ",", "\"\<Omega\>\""}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<CapitalAlpha\>\"", ",", "\"\<CapitalBeta\>\"", ",", 
          "\"\<CapitalGamma\>\"", ",", "\"\<CapitalDelta\>\"", ",", 
          "\"\<CapitalEpsilon\>\"", ",", "\"\<CapitalZeta\>\"", ",", 
          "\"\<CapitalEta\>\"", ",", "\"\<CapitalTheta\>\"", ",", 
          "\"\<CapitalIota\>\"", ",", "\"\<CapitalKappa\>\"", ",", 
          "\"\<CapitalLambda\>\"", ",", "\"\<CapitalMu\>\"", ",", 
          "\"\<CapitalNu\>\"", ",", "\"\<CapitalXi\>\"", ",", 
          "\"\<CapitalOmicron\>\"", ",", "\"\<CapitalPi\>\"", ",", 
          "\"\<CapitalRho\>\"", ",", "\"\<CapitalSigma\>\"", ",", 
          "\"\<CapitalTau\>\"", ",", "\"\<CapitalUpsilon\>\"", ",", 
          "\"\<CapitalPhi\>\"", ",", "\"\<CapitalChi\>\"", ",", 
          "\"\<CapitalPsi\>\"", ",", "\"\<CapitalOmega\>\""}], "}"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"rule1", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"greek", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
        RowBox[{"greek", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"rule1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<\\\\[\>\"", "<>", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<]\>\""}], "\[Rule]", 
         RowBox[{"\"\<\\\\\>\"", "<>", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}], "/@", "rule1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"rule2", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"greek", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
        RowBox[{"greek", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"rule2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\"\<\\\\[\>\"", "<>", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<]\>\""}], "\[Rule]", 
         RowBox[{"\"\<\\\\\>\"", "<>", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}], "/@", "rule2"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"extrarules", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"\"\<\\\\[Micro]\>\"", "\[Rule]", "\"\<\\\\mu\>\""}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
        "\"\<\\\\[Degree]\>\"", "\[Rule]", "\"\<\\\\si{\\\\degree}\>\""}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"rules", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"{", 
        RowBox[{"rule1", ",", "rule2", ",", "extrarules"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"ToString", "/@", 
       RowBox[{"FullForm", "/@", "temp"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Clearing", " ", "extra", " ", "quatiation", " ", "marks"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"{", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{
           "\"\<\\\"\\\\\\\"\>\"", "~~", "c__", "~~", 
            "\"\<\\\\\\\"\\\"\>\""}], "\[RuleDelayed]", "\[IndentingNewLine]",
            "\t", 
           RowBox[{"\"\<\\\"\>\"", "<>", "c", "<>", "\"\<\\\"\>\""}]}], ",", 
          RowBox[{"\"\<\\\"\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp", ",", "rules"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"x", ":", "greek"}], "~~", 
          RowBox[{"y", ":", 
           RowBox[{"LetterCharacter", ".."}]}]}], "\[RuleDelayed]", 
         RowBox[{"x", "<>", "\"\< \>\"", "<>", "y"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Wrapping", " ", "subscript", " ", "expressions", " ", "on", " ", 
         "the", " ", "form", " ", 
         RowBox[{"{", "...", "}"}], "_", 
         RowBox[{"{", "...", "}"}], " ", "with", " ", "$"}], "..."}], "$"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp", ",", 
        RowBox[{
         RowBox[{"G", ":", "\[IndentingNewLine]", "\t", 
          RowBox[{"Shortest", "[", 
           RowBox[{
           "\"\<{\>\"", "~~", "__", "~~", "\"\<}_{\>\"", "~~", "__", "~~", 
            "\"\<}\>\""}], "]"}]}], "\[RuleDelayed]", 
         RowBox[{"\"\<$\>\"", "<>", "G", "<>", "\"\<$\>\""}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Finding", " ", "unwrapped", " ", "greek", " ", "math"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", ":", 
            RowBox[{"(", "\[IndentingNewLine]", "\t", 
             RowBox[{"p__", "/;", 
              RowBox[{"(", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{"StringMatchQ", "[", 
                 RowBox[{"p", ",", 
                  RowBox[{
                  "\"\<$\>\"", "~~", "___", "~~", "\"\<\\\\\>\"", "~~", 
                   "greek", "~~", "___", "~~", "\"\<$\>\""}]}], "]"}], "||", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"StringMatchQ", "[", 
                 RowBox[{"p", ",", 
                  RowBox[{"\"\<\\\\\>\"", "~~", "greek"}]}], "]"}]}], ")"}]}],
              "\[IndentingNewLine]", "\t", ")"}]}], "\[RuleDelayed]", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"q", ",", 
             RowBox[{"{", "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{
                RowBox[{"Shortest", "[", 
                 RowBox[{"\"\<$\>\"", "~~", "k__", "~~", "\"\<$\>\""}], "]"}],
                 "\[RuleDelayed]", 
                RowBox[{
                "\"\<\[Section]\>\"", "~~", "k", "~~", 
                 "\"\<\[Section]\>\""}]}], ",", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{"g", ":", 
                 RowBox[{"(", 
                  RowBox[{"\"\<\\\\\>\"", "~~", "greek"}], ")"}]}], 
                "\[RuleDelayed]", 
                RowBox[{"\"\<$\>\"", "<>", "g", "<>", "\"\<$\>\""}]}]}], 
              "}"}]}], "]"}]}], ")"}], "/.", 
         RowBox[{"\"\<\[Section]\>\"", "\[Rule]", "\"\<$\>\""}]}]}], 
       "\[IndentingNewLine]", "\t", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Other", " ", "corrections"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"extranonmath", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
        "\"\<\\\\[ODoubleDot]\>\"", "\[Rule]", "\"\<\[ODoubleDot]\>\""}], ",",
         "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\\\\textunderscore \>\""}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp", ",", "extranonmath"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", 
       RowBox[{"Wrap", " ", "numbers"}]}], " ", "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<WrapNumbers\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"temp", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"temp", ",", 
          RowBox[{
           RowBox[{"t", ":", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"DigitCharacter", ",", "\"\<.\>\"", ",", "\"\<-\>\""}], 
              "}"}], ".."}]}], "\[RuleDelayed]", "\[IndentingNewLine]", "\t", 
           
           RowBox[{"\"\<\\\\\>\"", "<>", 
            RowBox[{"OptionValue", "[", "\"\<WrapNumbers\>\"", "]"}], "<>", 
            "\"\<{\>\"", "<>", "t", "<>", "\"\<}\>\""}]}]}], "]"}]}]}], "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Writing", " ", "out", " ", "lines"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"Last", "@", "dim"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Riffle", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "\"\<&\>\"", "}"}]}], "]"}], "&"}], "/@", "temp"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringJoin", "@", 
         RowBox[{"Riffle", "[", 
          RowBox[{"#", ",", "\"\< \>\""}], "]"}]}], "&"}], "/@", "temp"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "<>", "\"\< \\\\\\\\\\n\>\""}], "&"}], "/@", "temp"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Print", "@@", 
      RowBox[{"Join", "@@", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<\\\\begin{tabular}{\>\"", "<>", 
           RowBox[{"StringJoin", "@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"\"\<c\>\"", ",", 
              RowBox[{"Last", "@", "dim"}]}], "]"}]}], "<>", "\"\<}\\n\>\""}],
           "}"}], ",", "\[IndentingNewLine]", "temp", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "\"\<\\\\end{tabular}\>\"", "}"}]}], "}"}]}]}], ";"}]}],
    "\t", "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810883538918*^9, {3.6678119799664907`*^9, 3.667812004062636*^9}, {
   3.667812039037266*^9, 3.667812072607596*^9}, 3.667812406683673*^9, {
   3.667813882624302*^9, 3.6678138933821697`*^9}, 3.667814924729149*^9, {
   3.66781496632804*^9, 3.6678149928687553`*^9}, {3.6678150319879923`*^9, 
   3.667815059729232*^9}, {3.6678370650379553`*^9, 3.667837080571652*^9}, {
   3.667837156210669*^9, 3.667837159120823*^9}, {3.667842515304603*^9, 
   3.667842605059421*^9}, 3.667842680393711*^9, {3.667849539917348*^9, 
   3.6678495955963087`*^9}, {3.667849646172352*^9, 3.667849650506996*^9}, {
   3.667908750478983*^9, 3.667908761965444*^9}, {3.667909195231482*^9, 
   3.667909200047358*^9}, {3.667909526571316*^9, 3.6679095448082523`*^9}, {
   3.6679095850253973`*^9, 3.667909585291171*^9}, {3.667910126892024*^9, 
   3.667910130144701*^9}, {3.6679108263500137`*^9, 3.667910857082486*^9}, {
   3.6681674036811123`*^9, 3.668167410993102*^9}, {3.66816868688957*^9, 
   3.66816868696166*^9}, {3.6681687372109137`*^9, 3.6681687928153563`*^9}, {
   3.668168837414296*^9, 3.668168837998024*^9}, {3.6681721484090967`*^9, 
   3.66817214937738*^9}, {3.668442109996791*^9, 3.6684421233549232`*^9}, {
   3.6684562646118803`*^9, 3.668456746072813*^9}, {3.668456832072101*^9, 
   3.668456845105104*^9}, 3.66852537521148*^9, {3.6685316403322287`*^9, 
   3.668531664171526*^9}, {3.6685880099761*^9, 3.6685880925250397`*^9}, {
   3.6685887486247177`*^9, 3.668588757087628*^9}, {3.668665154400448*^9, 
   3.66866523524555*^9}, {3.668665292149033*^9, 3.6686652986921167`*^9}, {
   3.668665334908391*^9, 3.668665350187031*^9}, {3.6686653855476723`*^9, 
   3.6686653882913218`*^9}, {3.668665462321898*^9, 3.6686654742007637`*^9}, {
   3.668665508049378*^9, 3.668665509007465*^9}, {3.6686655573196783`*^9, 
   3.6686655976398077`*^9}, {3.6686656589326763`*^9, 3.668665661947451*^9}, {
   3.668665802362358*^9, 3.668665822608124*^9}, {3.6686658631612463`*^9, 
   3.668665904238866*^9}, {3.669285826411764*^9, 3.66928583885032*^9}, {
   3.669294202041409*^9, 3.669294232067951*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[158]:=",ExpressionUUID->"c0a92156-a084-4c4c-93e1-99f660bdc78b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[159]:=",ExpressionUUID->"f5b2a10b-5fa6-4cd0-ac63-d19dc8055bc3"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Definitions \[Dash] ",
  FontWeight->"Regular"],
 StyleBox["PhD",
  FontWeight->"Regular",
  FontSlant->"Italic"]
}], "Chapter",
 CellChangeTimes->{{3.657263896281269*^9, 3.6572639010563383`*^9}, {
  3.667809853233161*^9, 3.667809863671739*^9}, {3.761728827595784*^9, 
  3.761728834114563*^9}, {3.761730342275674*^9, 3.761730344881713*^9}, {
  3.761730682204132*^9, 3.761730685242449*^9}, {3.761731031724598*^9, 
  3.761731032035096*^9}},ExpressionUUID->"3cfff641-c4ae-4011-a0ce-\
78efa62c8fa0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "End", " ", "previous", " ", "subcontext", " ", "and", " ", "start", " ", 
    "a", " ", "new", " ", "one"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Begin", "[", "\"\<`PhD`\>\"", "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}, 3.761730412539352*^9, {3.761730453202365*^9, 
   3.761730460119701*^9}, {3.761730690450734*^9, 3.761730693730373*^9}, {
   3.761731035763451*^9, 3.761731036107098*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[160]:=",ExpressionUUID->"ae97b002-5f40-4f0b-88ba-4b154393b33e"],

Cell[CellGroupData[{

Cell["AlignUB", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667818523109948*^9, {3.7137889504855537`*^9, 
   3.7137889515556917`*^9}},ExpressionUUID->"a1caeef5-9fed-42bd-93a0-\
e0ab75b98add"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[162]:=",ExpressionUUID->"1a7889c3-ed64-4f01-b35d-8a1ef55205f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AlignUB", "::", "ambiguous"}], "=", 
   "\"\<`1` possible matrices found. Use a smaller tolerance.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AlignUB", "::", "none"}], "=", "\"\<No matrices found.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AlignUB", "::", "notfound"}], "=", 
   "\"\<The `1` data file was not found.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AlignUB", "::", "invalid"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid input.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AlignUB", "::", "delta"}], "=", 
    "\"\<Invalid setting for \[Delta].\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "AlignUB"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Delta\>\"", "\[Rule]", "\"\<Auto\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ReturnDelta\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ReturnMatrices\>\"", "\[Rule]", "False"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.667818529468916*^9, {3.69053608199729*^9, 
   3.6905360823248963`*^9}, {3.712561785146146*^9, 3.7125617925355453`*^9}, {
   3.7125659740199213`*^9, 3.712566032391958*^9}, {3.713787723313532*^9, 
   3.713787731591707*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"5d16eb0a-beea-45f5-918b-5b26ca6bf27d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[169]:=",ExpressionUUID->"273b815f-12b0-4039-8924-f7ae26ff86c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlignUB", "[", "input_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "input2", ",", "temp1", ",", "temp2", ",", "temp3", ",", "temp4", ",", 
      "temp5"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Import", " ", "if", " ", "input", " ", "is", " ", "a", " ", "file"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "@", "input"}], ",", "\[IndentingNewLine]", 
       RowBox[{"input2", "=", 
        RowBox[{"StringJoin", "@", 
         RowBox[{"Riffle", "[", 
          RowBox[{
           RowBox[{"ToString", "/@", 
            RowBox[{
             RowBox[{"Import", "[", "input", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\"\< \>\""}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"input2", "=", "input"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"temp1", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"input2", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<-\>\"", ",", "DigitCharacter"}], "}"}], "~~", "__"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp2", "=", 
      RowBox[{"First", "@", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"temp1", ",", "\"\< \>\""}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp3", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp2", ",", 
        RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp4", "=", 
      RowBox[{"ToExpression", "/@", "temp3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp5", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"temp4", ",", "3"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.6678115931321983`*^9, 3.667818496199253*^9, 
  3.713786049229826*^9, 3.71378646588659*^9, 3.713787733697793*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[170]:=",ExpressionUUID->"14d0f2a8-58eb-416c-85a4-49b2ed886f44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlignUB", "[", 
   RowBox[{"class_String", ",", "ref_", ",", "input_", ",", 
    RowBox[{"OptionsPattern", "@", "AlignUB"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "M", ",", "m", ",", "ubref", ",", "ubinput", ",", "delta", ",", 
      "\[IndentingNewLine]", "temp", ",", "temp1", ",", "temp2", ",", "temp3",
       ",", "temp4", ",", "temp5", ",", "temp6", ",", "temp7", ",", 
      "\[IndentingNewLine]", "tempA", ",", "tempB", ",", "tempC", ",", 
      "tempD", ",", "tempE", ",", "tempF", ",", "tempG"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"--", 
        RowBox[{"-", " ", "Preparing"}]}], " ", 
       RowBox[{"input", " ", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Reference", " ", "and", " ", "input", " ", "matrices"}], " ", 
     "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"M", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Import", " ", ".", "dat"}], " ", "file"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"TrueQ", "[", 
           RowBox[{
            RowBox[{"FileFormat", "[", "M", "]"}], "\[Equal]", 
            "\"\<Table\>\""}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"temp", "=", 
            RowBox[{"Check", "[", 
             RowBox[{
              RowBox[{"Import", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{
               RowBox[{"Message", "[", 
                RowBox[{
                 RowBox[{"AlignUB", "::", "notfound"}], ",", 
                 "\"\<reference\>\""}], "]"}], ";", "\[IndentingNewLine]", 
               "\t\t", 
               RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"m", "=", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", 
                 RowBox[{"3", ";;", "11"}]}], "]"}], "]"}], ",", "3"}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Matrix", " ", "given", " ", "as", " ", "string"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"StringQ", "@", "m"}], ",", 
          RowBox[{"m", "=", 
           RowBox[{"AlignUB", "@", "m"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Matrix", " ", "given", " ", "directly"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"MatrixQ", "@", "m"}], ",", "Null", ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"None", " ", "of", " ", "the", " ", "above"}], " ", "*)"}],
           "\[IndentingNewLine]", "\t", "True", ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"AlignUB", "::", "invalid"}], ",", "m"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"M", ",", "m"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"m", ",", 
         RowBox[{"{", 
          RowBox[{"ref", ",", "input"}], "}"}]}], "}"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ubref", ",", "ubinput"}], "}"}], "=", "M"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Finding"}]}], " ", "correct", " ", 
        RowBox[{"matrix", " ", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Multiplying", " ", "input", " ", "matrix", " ", "by", " ", "all", " ", 
       "symmetry", " ", "operations"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"temp1", "=", 
      RowBox[{"Check", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"SymmetryOperations", "[", "class", "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp2", "=", 
      RowBox[{"Transpose", "/@", "temp1"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"temp3", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{"ubinput", ",", "#"}], "]"}], "&"}], "/@", "temp2"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "Determining"}], " ", "the", " ", "value", " ", 
       RowBox[{"of", " ", "'"}], 
       RowBox[{
        RowBox[{"delta", "'"}], " ", "--"}]}], "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"delta", "=", 
      RowBox[{"OptionValue", "[", "\"\<Delta\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Automatic", " ", "method"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"delta", "===", "\"\<Auto\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Subtracting", " ", "reference", " ", "matrix", " ", "with", 
         "\[IndentingNewLine]", "\t\t", "every", " ", "Laue", " ", 
         "equivalent"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{
        RowBox[{"tempA", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Subtract", "[", 
            RowBox[{"ubref", ",", "#"}], "]"}], "&"}], "/@", "temp3"}]}], ";",
         "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Find", " ", "the", " ", "matrix", " ", "with", " ", "the", " ", 
          "smallest", "\[IndentingNewLine]", "\t\t", "total", " ", "squared", 
          " ", "deviation"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"tempB", "=", 
         RowBox[{"Total", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Flatten", "/@", "tempA"}], "^", "2"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Find", " ", "the", " ", "largest", " ", "element", " ", "of", " ", 
          "that", " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t\t", 
        RowBox[{"tempC", "=", 
         RowBox[{"First", "@", 
          RowBox[{"TakeSmallest", "[", 
           RowBox[{"tempB", ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]",
         "\t\t\t", 
        RowBox[{"tempD", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"tempB", ",", "tempC"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"tempE", "=", 
         RowBox[{"First", "@", 
          RowBox[{"TakeLargestBy", "[", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"tempA", "[", 
              RowBox[{"[", "tempD", "]"}], "]"}]}], ",", "Abs", ",", "1"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"tempF", "=", 
         RowBox[{"RealDigits", "@", "tempE"}]}], ";", "\[IndentingNewLine]", 
        "\t\t\t", 
        RowBox[{"tempG", "=", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"First", "@", "tempF"}], ",", 
             RowBox[{
              RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}], "-", 
          RowBox[{"Last", "@", "tempF"}]}]}], ";", "\[IndentingNewLine]", 
        "\t\t\t", 
        RowBox[{"delta", "=", 
         RowBox[{
          RowBox[{"Abs", "[", "tempE", "]"}], "+", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "tempG"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
        "\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Optional", ":", " ", 
          RowBox[{"Return", " ", "the", " ", "found", " ", "value"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<ReturnDelta\>\"", "]"}], ",", 
          RowBox[{"Return", "@", "delta"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Use", " ", "value", " ", "set", " ", "by", " ", 
         RowBox[{"user", " ", "--"}], " ", "check", " ", "if", " ", 
         "numeric"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"NumericQ", "@", "delta"}], ",", "Null", ",", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"None", " ", "of", " ", "the", " ", "above"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"AlignUB", "::", "delta"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Finding", " ", "matrices", " ", "within", " ", "threshold"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp4", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"temp3", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{"#", "-", "ubref"}], ",", "delta"}], "]"}], "\[Equal]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], "&"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"temp5", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"temp3", ",", "#"}], "]"}], "&"}], "/@", "temp4"}], "]"}]}],
      ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Abort", " ", "if", " ", "there", " ", "are", " ", "more", " ", "than", 
       " ", "one", " ", "possibility"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "temp5"}], ">", "1"}], ",", 
       "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"(*", " ", "Option", " ", "*)"}], "\[IndentingNewLine]", 
       "\t\t\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<ReturnMatrices\>\"", "]"}], ",", 
          RowBox[{"Return", "@", "temp4"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"AlignUB", "::", "ambiguous"}], ",", 
          RowBox[{"Length", "@", "temp5"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Warning", " ", "if", " ", "no", " ", "matrices", " ", "were", " ", 
       "found"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp5", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"AlignUB", "::", "none"}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Formatting"}]}], " ", 
        RowBox[{"output", " ", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"temp6", "=", 
      RowBox[{"temp1", "[", 
       RowBox[{"[", 
        RowBox[{"First", "@", "temp5"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp7", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{
        RowBox[{"ToString", "@", "temp6"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<{\>\"", ",", "\"\<}\>\"", ",", "\"\<,\>\""}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "[", 
      RowBox[{"\"\<um crec \>\"", "<>", "temp7"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667818543440028*^9, 3.681669132470278*^9, {
   3.690535325954748*^9, 3.690535359276989*^9}, {3.6905355534591265`*^9, 
   3.6905355583576202`*^9}, {3.6905358551377277`*^9, 
   3.6905358771809516`*^9}, {3.6905360779880133`*^9, 
   3.6905360951639433`*^9}, {3.7125631148433237`*^9, 3.712563117665346*^9}, {
   3.712563169431756*^9, 3.712563169579771*^9}, {3.712563894334762*^9, 
   3.712563913869672*^9}, {3.712564211792872*^9, 3.712564245748274*^9}, {
   3.71256430505355*^9, 3.7125643374304113`*^9}, {3.71256438526989*^9, 
   3.712564394767991*^9}, {3.7125645483791523`*^9, 3.7125646307850933`*^9}, {
   3.712564696952684*^9, 3.7125647015962667`*^9}, {3.7125647665501337`*^9, 
   3.712564871739029*^9}, {3.712564905543867*^9, 3.71256505404323*^9}, {
   3.71256509777337*^9, 3.71256513138198*^9}, {3.7125652935855207`*^9, 
   3.7125656812419863`*^9}, {3.71256572207304*^9, 3.712565738769511*^9}, {
   3.712565862476458*^9, 3.712565895287305*^9}, {3.7125660445699263`*^9, 
   3.7125660486977386`*^9}, {3.712566135141488*^9, 3.712566209768283*^9}, {
   3.712566268371656*^9, 3.7125662860687523`*^9}, {3.712566318481862*^9, 
   3.712566449414094*^9}, {3.71256649017102*^9, 3.7125667100633907`*^9}, {
   3.712566748454239*^9, 3.712566749919161*^9}, {3.71256680770293*^9, 
   3.712566845015143*^9}, {3.7137877378848667`*^9, 3.713787762916152*^9}, {
   3.713787795987237*^9, 3.713787804579011*^9}, {3.7137879256968937`*^9, 
   3.713787926223703*^9}, {3.7137883230311117`*^9, 3.713788326405159*^9}, 
   3.717740897017721*^9, {3.72750489344874*^9, 3.727504893714706*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[171]:=",ExpressionUUID->"2f80f240-73b1-4762-bcee-5b8b2499c18b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[172]:=",ExpressionUUID->"0a2d65ae-5fb3-4bd8-9ebd-c8ff4c69704c"]
}, Closed]],

Cell[CellGroupData[{

Cell["ErrorPropagation", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.684646660758275*^9, 
   3.684646660811885*^9}, {3.684679409191053*^9, 3.684679411222722*^9}, {
   3.6846811176191063`*^9, 3.684681119497213*^9}, {3.6846813101581917`*^9, 
   3.6846813119644547`*^9}, {3.684735312111738*^9, 
   3.684735315961302*^9}},ExpressionUUID->"b2f7cc32-c8e4-4b2d-8cde-\
ebd8dcac7cd5"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[173]:=",ExpressionUUID->"48696907-3b24-47a0-903f-d94b7751a6be"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ErrorPropagation"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<RoundSignificantFigures\>\"", "\[Rule]", "True"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7616532044789143`*^9, {3.761731182184*^9, 3.761731183231921*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"9460cd00-5df4-48f0-bc51-73c46ee35dc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[175]:=",ExpressionUUID->"ce813654-42aa-415f-a40d-51ffea14f503"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ErrorPropagation", "[", 
   RowBox[{"function_", ",", "values__List", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "ErrorPropagation"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "X", ",", "\[Delta]X", ",", "f", ",", "\[Delta]f", ",", "u", 
      ",", "x", ",", "pd", ",", "calc"}], "}"}], ",", " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Preparations", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "@", 
       RowBox[{"{", "values", "}"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", "\[Delta]X"}], "}"}], "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", "values", "}"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"f", "=", 
      RowBox[{"function", "@@", "X"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Partial", " ", "derivatives", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Dummy", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"u", "=", 
      RowBox[{"IntegerString", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "n"}], "]"}], ",", "10", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"x", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<x\>\"", ",", "#"}], "]"}], "&"}], ",", "u"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Partial", " ", "derivatives", " ", "for", " ", "each", " ", 
       "variable"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"pd", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"pd", ",", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"function", "@@", "x"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "*", 
          RowBox[{"\[Delta]X", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Inserting", " ", "values", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"calc", "=", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"pd", ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"x", "\[Rule]", "X"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]f", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Total", "[", 
        RowBox[{"calc", "^", "2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"'", 
        RowBox[{"RoundSignificantFigures", "'"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<RoundSignificantFigures\>\"", "]"}], 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"RoundSignificantFigures", "[", 
        RowBox[{"{", 
         RowBox[{"f", ",", "\[Delta]f"}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"f", ",", "\[Delta]f"}], "}"}]}], "\[IndentingNewLine]", "\t",
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713096547089555*^9, 3.713096849976799*^9}, {
   3.71309688502486*^9, 3.71309689343155*^9}, 3.713096988838799*^9, {
   3.713097031765951*^9, 3.7130971367709627`*^9}, {3.713097193383993*^9, 
   3.7130972607906857`*^9}, {3.7130973179989653`*^9, 3.713097564214031*^9}, {
   3.713097641589403*^9, 3.713097649827558*^9}, {3.761653204484763*^9, 
   3.7616532044961777`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[176]:=",ExpressionUUID->"a7b25da5-07b4-4378-bf30-7a8f3929fbda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[177]:=",ExpressionUUID->"6c497642-3a44-41ca-8cc5-1c63241fccc2"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExportCrystalData", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, {
   3.682134073518475*^9, 3.682134077310957*^9}, {3.6821351637913322`*^9, 
   3.682135164412662*^9}, {3.682138013029172*^9, 3.682138014016361*^9}, {
   3.717851081489071*^9, 3.7178510849035378`*^9}, {3.717851178791065*^9, 
   3.7178511845893507`*^9}},ExpressionUUID->"f17bd351-2c38-4cb7-b6a8-\
689f9b80aec2"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[178]:=",ExpressionUUID->"fcfa87a2-f589-419b-a19c-9a9b5bf918ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ExportCrystalData"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<IncludeSymmetryOperations\>\"", "\[Rule]", "True"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.66810571214802*^9, {3.6681867516522207`*^9, 
   3.668186778354513*^9}, {3.6681868394172163`*^9, 3.6681868614325943`*^9}, {
   3.668187374101748*^9, 3.6681874104278383`*^9}, {3.668187695125526*^9, 
   3.668187730468417*^9}, {3.668188056044814*^9, 3.668188056876872*^9}, {
   3.6681926250344687`*^9, 3.668192625250432*^9}, 3.68166923708845*^9, {
   3.6817064191712627`*^9, 3.68170642414537*^9}, {3.6817239114596*^9, 
   3.681723955601696*^9}, {3.681724223652172*^9, 3.681724224172266*^9}, {
   3.6818128705108147`*^9, 3.681812886108671*^9}, {3.681819874858591*^9, 
   3.681819895264824*^9}, {3.681835709479094*^9, 3.681835743293057*^9}, {
   3.682100938006762*^9, 3.682100938717538*^9}, 3.682134103684627*^9, {
   3.682142891293942*^9, 3.6821428951259127`*^9}, {3.682144298513987*^9, 
   3.682144308993547*^9}, {3.682144403478119*^9, 3.682144406579885*^9}, {
   3.682144581637662*^9, 3.6821446292028418`*^9}, {3.6821529895283422`*^9, 
   3.68215300977632*^9}, 3.717851096640901*^9, {3.71791774343513*^9, 
   3.717917764277873*^9}, {3.717929010200309*^9, 3.71792902616625*^9}, 
   3.717929121448449*^9, {3.726834592349515*^9, 3.7268345928495283`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"6868daab-8d21-4341-ad52-b145fc9fc377"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[180]:=",ExpressionUUID->"91248770-8752-41e1-89c7-44308304482b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExportCrystalData", "[", 
   RowBox[{"crystal_String", ",", "output_String", ",", 
    RowBox[{"OptionsPattern", "@", "ExportCrystalData"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "data", ",", "compound", ",", "c", ",", "ltc", ",", "sg", ",", 
      "csmatrix", ",", "\[IndentingNewLine]", "cell", ",", "atoms", ",", 
      "siteM", ",", "type", ",", "flag", ",", "X", ",", "\[IndentingNewLine]",
       "$f0", ",", "sccoeff", ",", "asf", ",", "fp", ",", "fpp", ",", "write",
       ",", "end", ",", "endTab", ",", "\[IndentingNewLine]", "temp"}], "}"}],
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"crystal", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Preparing", " ", "data", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Input", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"data", "=", 
      RowBox[{"$CrystalData", "[", "crystal", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Compounds", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"compound", "=", "crystal"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Centring", " ", "vectors"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"c", "=", 
      RowBox[{"SymmetryData", "[", 
       RowBox[{"crystal", ",", "\"\<Centring\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"ltc", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"c", "\[Equal]", "\"\<P\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"c", "\[Equal]", "\"\<A\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"c", "\[Equal]", "\"\<B\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", "0", ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"c", "\[Equal]", "\"\<C\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "0"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"c", "\[Equal]", "\"\<I\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"c", "\[Equal]", "\"\<F\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", "0", ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"c", "\[Equal]", "\"\<R\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}]}], "}"}]}], "}"}]}], 
       "\[IndentingNewLine]", "\t", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Space", " ", "group"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"sg", "=", 
      RowBox[{"SymmetryData", "[", 
       RowBox[{"crystal", ",", "\"\<HermannMauguinShort\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Symmetry", " ", "operations"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<IncludeSymmetryOperations\>\"", "]"}],
        ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"csmatrix", "=", 
         RowBox[{"SymmetryOperations", "[", "crystal", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"csmatrix", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"#", ",", "InputForm"}], "]"}], "&"}], "/@", 
          "csmatrix"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]",
        "\t", 
       RowBox[{"csmatrix", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], "}"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Lattice", " ", "parameters"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"cell", "=", 
      RowBox[{"N", "@", 
       RowBox[{"LatticeParameters", "[", 
        RowBox[{"crystal", ",", 
         RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Atom", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"atoms", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"data", "[", "\"\<AtomData\>\"", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Element\>\"", ",", "\"\<OccupationFactor\>\"", ",", 
           "\"\<FractionalCoordinates\>\"", ",", "\[IndentingNewLine]", "\t", 
           "\"\<DisplacementParameters\>\""}], "}"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"$CrystalData", "[", 
            RowBox[{"crystal", ",", "\"\<AtomData\>\""}], "]"}]}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"atoms", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"atoms", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], "}"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "atoms"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"atoms", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"StringDelete", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"atoms", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
         "}"}]}], "]"}]}], ";", "\t", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Multiplicity", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"r", "=", 
      RowBox[{"atoms", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"siteM", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"Length", "@", "\[IndentingNewLine]", "\t", 
           RowBox[{
           "SymmetryEquivalentPositions", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"crystal", ",", 
             RowBox[{"r", "[", 
              RowBox[{"[", "a", "]"}], "]"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"Length", "@", "r"}]}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", "\t", "/", 
       RowBox[{"Length", "@", 
        RowBox[{"SymmetryOperations", "@", "crystal"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"atoms", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"atoms", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", "siteM"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "ToString", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     
     RowBox[{"atoms", "=", 
      RowBox[{"atoms", "/.", 
       RowBox[{"x_String", "\[RuleDelayed]", 
        RowBox[{"\"\<\\\"\>\"", "<>", "x", "<>", "\"\<\\\"\>\""}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"atoms", "=", 
      RowBox[{"atoms", "/.", 
       RowBox[{
        RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
        RowBox[{"ToString", "[", 
         RowBox[{"x", ",", "InputForm"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Flag", " ", 
       RowBox[{"(", 
        RowBox[{"ADP", " ", "type"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"type", "=", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"\"\<AtomData\>\"", ",", "1", ",", "\"\<Type\>\""}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"flag", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"type", "\[Equal]", "\"\<Biso\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<B\>\"", ",", "\"\<B\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<U\>\"", ",", "\"\<U\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Scattering", " ", "coefficients"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"X", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"\"\<AtomData\>\"", ",", "All", ",", "\"\<Element\>\""}], 
         "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"X", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"X", ",", 
        RowBox[{"{", 
         RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"$f0", "=", 
      RowBox[{"Import", "@", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", "\[IndentingNewLine]", "\t", 
         RowBox[{
         "$XrayPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
          "\[IndentingNewLine]", "\t", "\"\<AtomicScatteringFactor\>\"", ",", 
          "\"\<WaasmaierKirfel.m\>\""}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"$f0", "/@", "X"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Values", "@", 
       RowBox[{"temp", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<a1\>\"", ",", "\"\<a2\>\"", ",", "\"\<a3\>\"", ",", 
            "\"\<a4\>\"", ",", "\"\<a5\>\"", ",", "\[IndentingNewLine]", 
            "\"\<b1\>\"", ",", "\"\<b2\>\"", ",", "\"\<b3\>\"", ",", 
            "\"\<b4\>\"", ",", "\"\<b5\>\"", ",", "\[IndentingNewLine]", 
            "\"\<c\>\""}], "}"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sccoeff", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", "5"}], "]"}], ",", 
          RowBox[{"Last", "@", "#"}]}], "]"}], "&"}], "/@", "temp"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"PrependTo", "[", 
        RowBox[{
         RowBox[{"sccoeff", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"X", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "X"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"sccoeff", "=", 
      RowBox[{"sccoeff", "/.", 
       RowBox[{"x_String", "\[RuleDelayed]", 
        RowBox[{"\"\<\\\"\>\"", "<>", "x", "<>", "\"\<\\\"\>\""}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Anomalous", " ", "corrections"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"asf", "=", "\[IndentingNewLine]", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<H\>\"", "\[Rule]", "\"\<{0.,0.}\>\""}], ",", 
        RowBox[{"\"\<He\>\"", "\[Rule]", "\"\<{0.,0.}\>\""}], ",", 
        RowBox[{"\"\<Li\>\"", "\[Rule]", "\"\<{0.,0.}\>\""}], ",", 
        RowBox[{
        "\"\<Be\>\"", "\[Rule]", 
         "\"\<{fpBe[Global`lambda],fppBe[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<B\>\"", "\[Rule]", 
         "\"\<{fpB[Global`lambda],fppB[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<C\>\"", "\[Rule]", 
         "\"\<{fpC[Global`lambda],fppC[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<N\>\"", "\[Rule]", 
         "\"\<{fpN[Global`lambda],fppN[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<O\>\"", "\[Rule]", 
         "\"\<{fpO[Global`lambda],fppO[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<F\>\"", "\[Rule]", 
         "\"\<{fpF[Global`lambda],fppF[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<Ne\>\"", "\[Rule]", 
         "\"\<{fpNe[Global`lambda],fppNe[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<Na\>\"", "\[Rule]", 
         "\"\<{fpNa[Global`lambda],fppNa[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<Mg\>\"", "\[Rule]", 
         "\"\<{fpMg[Global`lambda],fppMg[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<Al\>\"", "\[Rule]", 
         "\"\<{fpAl[Global`lambda],fppAl[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<Si\>\"", "\[Rule]", 
         "\"\<{fpSi[Global`lambda],fppSi[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<P\>\"", "\[Rule]", 
         "\"\<{fpP[Global`lambda],fppP[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<S\>\"", "\[Rule]", 
         "\"\<{fpS[Global`lambda],fppS[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<Cl\>\"", "\[Rule]", 
         "\"\<{fpCl[Global`lambda],fppCl[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<Ar\>\"", "\[Rule]", 
         "\"\<{fpAr[Global`lambda],fppAr[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<K\>\"", "\[Rule]", 
         "\"\<{fpK[Global`lambda],fppK[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<Ca\>\"", "\[Rule]", 
         "\"\<{fpCa[Global`lambda],fppCa[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<Sc\>\"", "\[Rule]", 
         "\"\<{fpSc[Global`lambda],fppSc[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<Ti\>\"", "\[Rule]", 
         "\"\<{fpTi[Global`lambda],fppTi[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<V\>\"", "\[Rule]", 
         "\"\<{fpV[Global`lambda],fppV[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<Cr\>\"", "\[Rule]", 
         "\"\<{fpCr[Global`lambda],fppCr[Global`lambda]}\>\""}], ",", 
        RowBox[{
        "\"\<Mn\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=1.895,{fpMn1[Global`lambda],fppMn1[Global`\
lambda]},\\n                   \
{fpMn2[Global`lambda],fppMn2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Fe\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=1.743,{fpFe1[Global`lambda],fppFe1[Global`\
lambda]},\\n                   \
{fpFe2[Global`lambda],fppFe2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Co\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=1.608,{fpCo1[Global`lambda],fppCo1[Global`\
lambda]},\\n                   \
{fpCo2[Global`lambda],fppCo2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Ni\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=1.487,{fpNi1[Global`lambda],fppNi1[Global`\
lambda]},\\n                   \
{fpNi2[Global`lambda],fppNi2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Cu\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=1.380,{fpCu1[Global`lambda],fppCu1[Global`\
lambda]},\\n                   \
{fpCu2[Global`lambda],fppCu2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Zn\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=1.283,{fpZn1[Global`lambda],fppZn1[Global`\
lambda]},\\n                   \
{fpZn2[Global`lambda],fppZn2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Ga\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=1.195,{fpGa1[Global`lambda],fppGa1[Global`\
lambda]},\\n                   \
{fpGa2[Global`lambda],fppGa2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Ge\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=1.11659,{fpGe1[Global`lambda],fppGe1[\
Global`lambda]},\\n                          \
{fpGe2[Global`lambda],fppGe2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<As\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=1.044,{fpAs1[Global`lambda],fppAs1[Global`\
lambda]},\\n                   \
{fpAs2[Global`lambda],fppAs2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Se\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.979,{fpSe1[Global`lambda],fppSe1[Global`\
lambda]},\\n                   \
{fpSe2[Global`lambda],fppSe2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Br\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.920,{fpBr1[Global`lambda],fppBr1[Global`\
lambda]},\\n                   \
{fpBr2[Global`lambda],fppBr2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Kr\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.865,{fpKr1[Global`lambda],fppKr1[Global`\
lambda]},\\n                   \
{fpKr2[Global`lambda],fppKr2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Rb\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.815,{fpRb1[Global`lambda],fppRb1[Global`\
lambda]},\\n                   \
{fpRb2[Global`lambda],fppRb2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Sr\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.769,{fpSr1[Global`lambda],fppSr1[Global`\
lambda]},\\n                   \
{fpSr2[Global`lambda],fppSr2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Y\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.727,{fpY1[Global`lambda],fppY1[Global`\
lambda]},\\n                   \
{fpY2[Global`lambda],fppY2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Zr\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.688,{fpZr1[Global`lambda],fppZr1[Global`\
lambda]},\\n                   \
{fpZr2[Global`lambda],fppZr2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Nb\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.653,{fpNb1[Global`lambda],fppNb1[Global`\
lambda]},\\n                   \
{fpNb2[Global`lambda],fppNb2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Mo\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.619,{fpMo1[Global`lambda],fppMo1[Global`\
lambda]},\\n                   \
{fpMo2[Global`lambda],fppMo2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Tc\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.589,{fpTc1[Global`lambda],fppTc1[Global`\
lambda]},\\n                   \
{fpTc2[Global`lambda],fppTc2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Ru\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.560,{fpRu1[Global`lambda],fppRu1[Global`\
lambda]},\\n                   \
{fpRu2[Global`lambda],fppRu2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Rh\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.533,{fpRh1[Global`lambda],fppRh1[Global`\
lambda]},\\n                   \
{fpRh2[Global`lambda],fppRh2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Pd\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.509,{fpPd1[Global`lambda],fppPd1[Global`\
lambda]},\\n                   \
{fpPd2[Global`lambda],fppPd2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Ag\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.485,{fpAg1[Global`lambda],fppAg1[Global`\
lambda]},\\n                   \
{fpAg2[Global`lambda],fppAg2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Cd\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.464,{fpCd1[Global`lambda],fppCd1[Global`\
lambda]},\\n                   \
{fpCd2[Global`lambda],fppCd2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<In\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.443,{fpIn1[Global`lambda],fppIn1[Global`\
lambda]},\\n                   \
{fpIn2[Global`lambda],fppIn2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Sn\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.424,{fpSn1[Global`lambda],fppSn1[Global`\
lambda]},\\n                   \
{fpSn2[Global`lambda],fppSn2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Sb\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.406,{fpSb1[Global`lambda],fppSb1[Global`\
lambda]},\\n                   \
{fpSb2[Global`lambda],fppSb2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Te\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.389,{fpTe1[Global`lambda],fppTe1[Global`\
lambda]},\\n                   \
{fpTe2[Global`lambda],fppTe2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<I\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.373,{fpI1[Global`lambda],fppI1[Global`\
lambda]},\\n                   \
{fpI2[Global`lambda],fppI2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Xe\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.358,{fpXe1[Global`lambda],fppXe1[Global`\
lambda]},\\n                   \
{fpXe2[Global`lambda],fppXe2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Cs\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.344,{fpCs1[Global`lambda],fppCs1[Global`\
lambda]},\\n                   \
{fpCs2[Global`lambda],fppCs2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<Ba\>\"", "\[Rule]", 
         "\"\<\\nIf[Global`lambda<=0.331,{fpBa1[Global`lambda],fppBa1[Global`\
lambda]},\\n                   \
{fpBa2[Global`lambda],fppBa2[Global`lambda]}]\>\""}], ",", 
        RowBox[{
        "\"\<La\>\"", "\[Rule]", 
         "\"\<\\nLahich[Global`lambda<=0.318,{fpLa1[Global`lambda],fppLa1[\
Global`lambda]},\\n      \
0.319<=Global`lambda<=1.978,{fpLa2[Global`lambda],fppLa2[Global`lambda]},\\n  \
    Global`lambda>=1.979,{fpLa3[Global`lambda],fppLa3[Global`lambda]}]\>\""}],
         ",", 
        RowBox[{
        "\"\<Ce\>\"", "\[Rule]", 
         "\"\<\\nCehich[Global`lambda<=0.306,{fpCe1[Global`lambda],fppCe1[\
Global`lambda]},\\n      \
0.307<=Global`lambda<=1.893,{fpCe2[Global`lambda],fppCe2[Global`lambda]},\\n  \
    Global`lambda>=1.894,{fpCe3[Global`lambda],fppCe3[Global`lambda]}]\>\""}],
         ",", 
        RowBox[{
        "\"\<Pr\>\"", "\[Rule]", 
         "\"\<\\nPrhich[Global`lambda<=0.295,{fpPr1[Global`lambda],fppPr1[\
Global`lambda]},\\n      \
0.296<=Global`lambda<=1.813,{fpPr2[Global`lambda],fppPr2[Global`lambda]},\\n  \
    1.814<=Global`lambda<=1.924,{fpPr3[Global`lambda],fppPr3[Global`lambda]},\
\\n      Global`lambda>=1.925,{fpPr4[Global`lambda],fppPr4[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Nd\>\"", "\[Rule]", 
         "\"\<\\nNdhich[Global`lambda<=0.284,{fpNd1[Global`lambda],fppNd1[\
Global`lambda]},\\n      \
0.285<=Global`lambda<=1.739,{fpNd2[Global`lambda],fppNd2[Global`lambda]},\\n  \
    1.740<=Global`lambda<=1.844,{fpNd3[Global`lambda],fppNd3[Global`lambda]},\
\\n      1.845<=Global`lambda<=1.997,{fpNd4[Global`lambda],fppNd4[Global`\
lambda]},\\n      \
Global`lambda>=1.998,{fpNd5[Global`lambda],fppNd5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Sm\>\"", "\[Rule]", 
         "\"\<\\nSmhich[Global`lambda<=0.264,{fpSm1[Global`lambda],fppSm1[\
Global`lambda]},\\n      \
0.265<=Global`lambda<=1.602,{fpSm2[Global`lambda],fppSm2[Global`lambda]},\\n  \
    1.603<=Global`lambda<=1.695,{fpSm3[Global`lambda],fppSm3[Global`lambda]},\
\\n      1.696<=Global`lambda<=1.845,{fpSm4[Global`lambda],fppSm4[Global`\
lambda]},\\n      \
Global`lambda>=1.846,{fpSm5[Global`lambda],fppSm5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Eu\>\"", "\[Rule]", 
         "\"\<\\nEuhich[Global`lambda<=0.255,{fpEu1[Global`lambda],fppEu1[\
Global`lambda]},\\n      \
0.256<=Global`lambda<=1.539,{fpEu2[Global`lambda],fppEu2[Global`lambda]},\\n  \
    1.540<=Global`lambda<=1.627,{fpEu3[Global`lambda],fppEu3[Global`lambda]},\
\\n      1.628<=Global`lambda<=1.776,{fpEu4[Global`lambda],fppEu4[Global`\
lambda]},\\n      \
Global`lambda>=1.777,{fpEu5[Global`lambda],fppEu5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Gd\>\"", "\[Rule]", 
         "\"\<\\nGdhich[Global`lambda<=0.246,{fpGd1[Global`lambda],fppGd1[\
Global`lambda]},\\n      \
0.247<=Global`lambda<=1.480,{fpGd2[Global`lambda],fppGd2[Global`lambda]},\\n  \
    1.481<=Global`lambda<=1.563,{fpGd3[Global`lambda],fppGd3[Global`lambda]},\
\\n      1.564<=Global`lambda<=1.711,{fpGd4[Global`lambda],fppGd4[Global`\
lambda]},\\n      \
Global`lambda>=1.712,{fpGd5[Global`lambda],fppGd5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Tb\>\"", "\[Rule]", 
         "\"\<\\nTbhich[Global`lambda<=0.238,{fpTb1[Global`lambda],fppTb1[\
Global`lambda]},\\n      \
0.239<=Global`lambda<=1.423,{fpTb2[Global`lambda],fppTb2[Global`lambda]},\\n  \
    1.424<=Global`lambda<=1.502,{fpTb3[Global`lambda],fppTb3[Global`lambda]},\
\\n      1.503<=Global`lambda<=1.649,{fpTb4[Global`lambda],fppTb4[Global`\
lambda]},\\n      \
Global`lambda>=1.650,{fpTb5[Global`lambda],fppTb5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Yb\>\"", "\[Rule]", 
         "\"\<\\nYbhich[Global`lambda<=0.202,{fpYb1[Global`lambda],fppYb1[\
Global`lambda]},\\n      \
0.203<=Global`lambda<=1.182,{fpYb2[Global`lambda],fppYb2[Global`lambda]},\\n  \
    1.183<=Global`lambda<=1.242,{fpYb3[Global`lambda],fppYb3[Global`lambda]},\
\\n      1.243<=Global`lambda<=1.386,{fpYb4[Global`lambda],fppYb4[Global`\
lambda]},\\n      \
Global`lambda>=1.387,{fpYb5[Global`lambda],fppYb5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Lu\>\"", "\[Rule]", 
         "\"\<\\nLuhich[Global`lambda<=0.195,{fpLu1[Global`lambda],fppLu1[\
Global`lambda]},\\n      \
0.196<=Global`lambda<=1.140,{fpLu2[Global`lambda],fppLu2[Global`lambda]},\\n  \
    1.141<=Global`lambda<=1.198,{fpLu3[Global`lambda],fppLu3[Global`lambda]},\
\\n      1.199<=Global`lambda<=1.341,{fpLu4[Global`lambda],fppLu4[Global`\
lambda]},\\n      \
Global`lambda>=1.342,{fpLu5[Global`lambda],fppLu5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Hf\>\"", "\[Rule]", 
         "\"\<\\nHfhich[Global`lambda<=0.189,{fpHf1[Global`lambda],fppHf1[\
Global`lambda]},\\n      \
0.190<=Global`lambda<=1.099,{fpHf2[Global`lambda],fppHf2[Global`lambda]},\\n  \
    1.100<=Global`lambda<=1.154,{fpHf3[Global`lambda],fppHf3[Global`lambda]},\
\\n      1.155<=Global`lambda<=1.296,{fpHf4[Global`lambda],fppHf4[Global`\
lambda]},\\n      \
Global`lambda>=1.297,{fpHf5[Global`lambda],fppHf5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Ta\>\"", "\[Rule]", 
         "\"\<\\nTahich[Global`lambda<=0.183,{fpTa1[Global`lambda],fppTa1[\
Global`lambda]},\\n      \
0.184<=Global`lambda<=1.061,{fpTa2[Global`lambda],fppTa2[Global`lambda]},\\n  \
    1.062<=Global`lambda<=1.113,{fpTa3[Global`lambda],fppTa3[Global`lambda]},\
\\n      1.114<=Global`lambda<=1.254,{fpTa4[Global`lambda],fppTa4[Global`\
lambda]},\\n      \
Global`lambda>=1.255,{fpTa5[Global`lambda],fppTa5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<W\>\"", "\[Rule]", 
         "\"\<\\nWhich[Global`lambda<=0.178,{fpW1[Global`lambda],fppW1[Global`\
lambda]},\\n      \
0.179<=Global`lambda<=1.024,{fpW2[Global`lambda],fppW2[Global`lambda]},\\n    \
  1.025<=Global`lambda<=1.073,{fpW3[Global`lambda],fppW3[Global`lambda]},\\n  \
    1.074<=Global`lambda<=1.214,{fpW4[Global`lambda],fppW4[Global`lambda]},\\\
n      Global`lambda>=1.215,{fpW5[Global`lambda],fppW5[Global`lambda]}]\>\""}]\
, ",", 
        RowBox[{
        "\"\<Re\>\"", "\[Rule]", 
         "\"\<\\nRehich[Global`lambda<=0.172,{fpRe1[Global`lambda],fppRe1[\
Global`lambda]},\\n      \
0.173<=Global`lambda<=0.989,{fpRe2[Global`lambda],fppRe2[Global`lambda]},\\n  \
    0.990<=Global`lambda<=1.036,{fpRe3[Global`lambda],fppRe3[Global`lambda]},\
\\n      1.037<=Global`lambda<=1.176,{fpRe4[Global`lambda],fppRe4[Global`\
lambda]},\\n      \
Global`lambda>=1.177,{fpRe5[Global`lambda],fppRe5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Os\>\"", "\[Rule]", 
         "\"\<\\nOshich[Global`lambda<=0.167,{fpOs1[Global`lambda],fppOs1[\
Global`lambda]},\\n      \
0.168<=Global`lambda<=0.956,{fpOs2[Global`lambda],fppOs2[Global`lambda]},\\n  \
    0.957<=Global`lambda<=1.001,{fpOs3[Global`lambda],fppOs3[Global`lambda]},\
\\n      1.002<=Global`lambda<=1.140,{fpOs4[Global`lambda],fppOs4[Global`\
lambda]},\\n      \
Global`lambda>=1.141,{fpOs5[Global`lambda],fppOs5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Ir\>\"", "\[Rule]", 
         "\"\<\\nIrhich[Global`lambda<=0.162,{fpIr1[Global`lambda],fppIr1[\
Global`lambda]},\\n      \
0.163<=Global`lambda<=0.923,{fpIr2[Global`lambda],fppIr2[Global`lambda]},\\n  \
    0.924<=Global`lambda<=0.966,{fpIr3[Global`lambda],fppIr3[Global`lambda]},\
\\n      0.967<=Global`lambda<=1.105,{fpIr4[Global`lambda],fppIr4[Global`\
lambda]},\\n      \
Global`lambda>=1.106,{fpIr5[Global`lambda],fppIr5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Pt\>\"", "\[Rule]", 
         "\"\<\\nPthich[Global`lambda<=0.158,{fpPt1[Global`lambda],fppPt1[\
Global`lambda]},\\n      \
0.159<=Global`lambda<=0.893,{fpPt2[Global`lambda],fppPt2[Global`lambda]},\\n  \
    0.894<=Global`lambda<=0.934,{fpPt3[Global`lambda],fppPt3[Global`lambda]},\
\\n      0.935<=Global`lambda<=1.072,{fpPt4[Global`lambda],fppPt4[Global`\
lambda]},\\n      \
Global`lambda>=1.073,{fpPt5[Global`lambda],fppPt5[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Au\>\"", "\[Rule]", 
         "\"\<\\nAuhich[Global`lambda<=0.153,{-0.9007,fppAu1[Global`lambda]},\
\\n      0.154<=Global`lambda<=0.863,{fpAu2[Global`lambda],fppAu2[Global`\
lambda]},\\n      \
0.864<=Global`lambda<=0.902,{fpAu3[Global`lambda],fppAu3[Global`lambda]},\\n  \
    0.903<=Global`lambda<=1.040,{fpAu4[Global`lambda],fppAu4[Global`lambda]},\
\\n      Global`lambda>=1.041,{fpAu5[Global`lambda],fppAu5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Hg\>\"", "\[Rule]", 
         "\"\<\\nHghich[Global`lambda<=0.149,{-0.9287,fppHg1[Global`lambda]},\
\\n      0.150<=Global`lambda<=0.835,{fpHg2[Global`lambda],fppHg2[Global`\
lambda]},\\n      \
0.836<=Global`lambda<=0.872,{fpHg3[Global`lambda],fppHg3[Global`lambda]},\\n  \
    0.873<=Global`lambda<=1.009,{fpHg4[Global`lambda],fppHg4[Global`lambda]},\
\\n      Global`lambda>=1.010,{fpHg5[Global`lambda],fppHg5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Tl\>\"", "\[Rule]", 
         "\"\<\\nTlhich[Global`lambda<=0.144,{-0.9566,fppTl1[Global`lambda]},\
\\n      0.145<=Global`lambda<=0.807,{fpTl2[Global`lambda],fppTl2[Global`\
lambda]},\\n      \
0.808<=Global`lambda<=0.843,{fpTl3[Global`lambda],fppTl3[Global`lambda]},\\n  \
    0.844<=Global`lambda<=0.979,{fpTl4[Global`lambda],fppTl4[Global`lambda]},\
\\n      Global`lambda>=0.980,{fpTl5[Global`lambda],fppTl5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Pb\>\"", "\[Rule]", 
         "\"\<\\nPbhich[Global`lambda<=0.140,{-0.9856,fppPb1[Global`lambda]},\
\\n      0.141<=Global`lambda<=0.781,{fpPb2[Global`lambda],fppPb2[Global`\
lambda]},\\n      \
0.782<=Global`lambda<=0.815,{fpPb3[Global`lambda],fppPb3[Global`lambda]},\\n  \
    0.816<=Global`lambda<=0.951,{fpPb4[Global`lambda],fppPb4[Global`lambda]},\
\\n      Global`lambda>=0.952,{fpPb5[Global`lambda],fppPb5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Bi\>\"", "\[Rule]", 
         "\"\<\\nBihich[Global`lambda<=0.136,{-1.015,fppBi1[Global`lambda]},\\\
n      0.137<=Global`lambda<=0.756,{fpBi2[Global`lambda],fppBi2[Global`lambda]\
},\\n      \
0.757<=Global`lambda<=0.789,{fpBi3[Global`lambda],fppBi3[Global`lambda]},\\n  \
    0.790<=Global`lambda<=0.923,{fpBi4[Global`lambda],fppBi4[Global`lambda]},\
\\n      Global`lambda>=0.924,{fpBi5[Global`lambda],fppBi5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Po\>\"", "\[Rule]", 
         "\"\<\\nPohich[Global`lambda<=0.133,{-1.045,fppPo1[Global`lambda]},\\\
n      0.134<=Global`lambda<=0.731,{fpPo2[Global`lambda],fppPo2[Global`lambda]\
},\\n      \
0.732<=Global`lambda<=0.763,{fpPo3[Global`lambda],fppPo3[Global`lambda]},\\n  \
    0.764<=Global`lambda<=0.897,{fpPo4[Global`lambda],fppPo4[Global`lambda]},\
\\n      Global`lambda>=0.898,{fpPo5[Global`lambda],fppPo5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<At\>\"", "\[Rule]", 
         "\"\<\\nAthich[Global`lambda<=0.129,{-1.076,fppAt1[Global`lambda]},\\\
n      0.130<=Global`lambda<=0.708,{fpAt2[Global`lambda],fppAt2[Global`lambda]\
},\\n      \
0.709<=Global`lambda<=0.738,{fpAt3[Global`lambda],fppAt3[Global`lambda]},\\n  \
    0.739<=Global`lambda<=0.872,{fpAt4[Global`lambda],fppAt4[Global`lambda]},\
\\n      Global`lambda>=0.873,{fpAt5[Global`lambda],fppAt5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Rn\>\"", "\[Rule]", 
         "\"\<\\nRnhich[Global`lambda<=0.125,{-1.107,fppRn1[Global`lambda]},\\\
n      0.126<=Global`lambda<=0.686,{fpRn2[Global`lambda],fppRn2[Global`lambda]\
},\\n      \
0.687<=Global`lambda<=0.715,{fpRn3[Global`lambda],fppRn3[Global`lambda]},\\n  \
    0.716<=Global`lambda<=0.848,{fpRn4[Global`lambda],fppRn4[Global`lambda]},\
\\n      Global`lambda>=0.849,{fpRn5[Global`lambda],fppRn5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Fr\>\"", "\[Rule]", 
         "\"\<\\nFrhich[Global`lambda<=0.122,{-1.138,fppFr1[Global`lambda]},\\\
n      0.123<=Global`lambda<=0.665,{fpFr2[Global`lambda],fppFr2[Global`lambda]\
},\\n      \
0.666<=Global`lambda<=0.692,{fpFr3[Global`lambda],fppFr3[Global`lambda]},\\n  \
    0.693<=Global`lambda<=0.824,{fpFr4[Global`lambda],fppFr4[Global`lambda]},\
\\n      Global`lambda>=0.825,{fpFr5[Global`lambda],fppFr5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Ra\>\"", "\[Rule]", 
         "\"\<\\nRahich[Global`lambda<=0.119,{-1.170,fppRa1[Global`lambda]},\\\
n      0.120<=Global`lambda<=0.644,{fpRa2[Global`lambda],fppRa2[Global`lambda]\
},\\n      \
0.645<=Global`lambda<=0.670,{fpRa3[Global`lambda],fppRa3[Global`lambda]},\\n  \
    0.671<=Global`lambda<=0.802,{fpRa4[Global`lambda],fppRa4[Global`lambda]},\
\\n      Global`lambda>=0.803,{fpRa5[Global`lambda],fppRa5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Ac\>\"", "\[Rule]", 
         "\"\<\\nAchich[Global`lambda<=0.116,{-1.203,fppAc1[Global`lambda]},\\\
n      0.117<=Global`lambda<=0.624,{fpAc2[Global`lambda],fppAc2[Global`lambda]\
},\\n      \
0.625<=Global`lambda<=0.649,{fpAc3[Global`lambda],fppAc3[Global`lambda]},\\n  \
    0.650<=Global`lambda<=0.781,{fpAc4[Global`lambda],fppAc4[Global`lambda]},\
\\n      Global`lambda>=0.782,{fpAc5[Global`lambda],fppAc5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Th\>\"", "\[Rule]", 
         "\"\<\\nThhich[Global`lambda<=0.113,{-1.237,fppTh1[Global`lambda]},\\\
n      0.114<=Global`lambda<=0.605,{fpTh2[Global`lambda],fppTh2[Global`lambda]\
},\\n      \
0.606<=Global`lambda<=0.629,{fpTh3[Global`lambda],fppTh3[Global`lambda]},\\n  \
    0.630<=Global`lambda<=0.760,{fpTh4[Global`lambda],fppTh4[Global`lambda]},\
\\n      Global`lambda>=0.761,{fpTh5[Global`lambda],fppTh5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Pa\>\"", "\[Rule]", 
         "\"\<\\nPahich[Global`lambda<=0.110,{-1.271,fppPa1[Global`lambda]},\\\
n      0.111<=Global`lambda<=0.587,{fpPa2[Global`lambda],fppPa2[Global`lambda]\
},\\n      \
0.588<=Global`lambda<=0.610,{fpPa3[Global`lambda],fppPa3[Global`lambda]},\\n  \
    0.611<=Global`lambda<=0.740,{fpPa4[Global`lambda],fppPa4[Global`lambda]},\
\\n      Global`lambda>=0.741,{fpPa5[Global`lambda],fppPa5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<U\>\"", "\[Rule]", 
         "\"\<\\nUhich[Global`lambda<=0.107,{-1.305,fppU1[Global`lambda]},\\n \
     0.108<=Global`lambda<=0.569,{fpU2[Global`lambda],fppU2[Global`lambda]},\\\
n      0.570<=Global`lambda<=0.591,{fpU3[Global`lambda],fppU3[Global`lambda]},\
\\n      0.592<=Global`lambda<=0.722,{fpU4[Global`lambda],fppU4[Global`lambda]\
},\\n      Global`lambda>=0.723,{fpU5[Global`lambda],fppU5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Np\>\"", "\[Rule]", 
         "\"\<\\nNphich[Global`lambda<=0.104,{-1.341,fppNp1[Global`lambda]},\\\
n      0.105<=Global`lambda<=0.552,{fpNp2[Global`lambda],fppNp2[Global`lambda]\
},\\n      \
0.553<=Global`lambda<=0.573,{fpNp3[Global`lambda],fppNp3[Global`lambda]},\\n  \
    0.574<=Global`lambda<=0.704,{fpNp4[Global`lambda],fppNp4[Global`lambda]},\
\\n      Global`lambda>=0.705,{fpNp5[Global`lambda],fppNp5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Pu\>\"", "\[Rule]", 
         "\"\<\\nPuhich[Global`lambda<=0.101,{-1.377,fppPu1[Global`lambda]},\\\
n      0.102<=Global`lambda<=0.539,{fpPu2[Global`lambda],fppPu2[Global`lambda]\
},\\n      \
0.540<=Global`lambda<=0.559,{fpPu3[Global`lambda],fppPu3[Global`lambda]},\\n  \
    0.560<=Global`lambda<=0.692,{fpPu4[Global`lambda],fppPu4[Global`lambda]},\
\\n      Global`lambda>=0.693,{fpPu5[Global`lambda],fppPu5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Am\>\"", "\[Rule]", 
         "\"\<\\nAmhich[Global`lambda<=0.099,{-1.414,fppAm1[Global`lambda]},\\\
n      0.100<=Global`lambda<=0.521,{fpAm2[Global`lambda],fppAm2[Global`lambda]\
},\\n      \
0.522<=Global`lambda<=0.540,{fpAm3[Global`lambda],fppAm3[Global`lambda]},\\n  \
    0.541<=Global`lambda<=0.669,{fpAm4[Global`lambda],fppAm4[Global`lambda]},\
\\n      Global`lambda>=0.670,{fpAm5[Global`lambda],fppAm5[Global`lambda]}]\>\
\""}], ",", 
        RowBox[{
        "\"\<Cm\>\"", "\[Rule]", 
         "\"\<\\nCmhich[Global`lambda<=0.096,{-1.451,fppCm1[Global`lambda]},\\\
n      0.097<=Global`lambda<=0.506,{fpCm2[Global`lambda],fppCm2[Global`lambda]\
},\\n      \
0.507<=Global`lambda<=0.521,{fpCm3[Global`lambda],fppCm3[Global`lambda]},\\n  \
    0.522<=Global`lambda<=0.654,{fpCm4[Global`lambda],fppCm4[Global`lambda]},\
\\n      0.655<=Global`lambda<=1.971,{fpCm5[Global`lambda],fppCm5[Global`\
lambda]},      \\n      \
Global`lambda>=1.972,{fpCm6[Global`lambda],fppCm6[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Bk\>\"", "\[Rule]", 
         "\"\<\\nBkhich[Global`lambda<=0.094,{-1.489,fppBk1[Global`lambda]},\\\
n      0.095<=Global`lambda<=0.490,{fpBk2[Global`lambda],fppBk2[Global`lambda]\
},\\n      \
0.491<=Global`lambda<=0.508,{fpBk3[Global`lambda],fppBk3[Global`lambda]},\\n  \
    0.509<=Global`lambda<=0.637,{fpBk4[Global`lambda],fppBk4[Global`lambda]},\
\\n      0.638<=Global`lambda<=1.891,{fpBk5[Global`lambda],fppBk5[Global`\
lambda]}      \\n      \
Global`lambda>=1.892,{fpBk6[Global`lambda],fppBk6[Global`lambda]}]\>\""}], 
        ",", 
        RowBox[{
        "\"\<Cf\>\"", "\[Rule]", 
         "\"\<\\nCfhich[Global`lambda<=0.091,{-1.528,fppCf1[Global`lambda]},\\\
n      0.092<=Global`lambda<=0.478,{fpCf2[Global`lambda],fppCf2[Global`lambda]\
},\\n      \
0.479<=Global`lambda<=0.495,{fpCf3[Global`lambda],fppCf3[Global`lambda]},\\n  \
    0.496<=Global`lambda<=0.627,{fpCf4[Global`lambda],fppCf4[Global`lambda]},\
\\n      0.628<=Global`lambda<=1.859,{fpCf5[Global`lambda],fppCf5[Global`\
lambda]},\\n      \
1.860<=Global`lambda<=1.978,{fpCf6[Global`lambda],fppCf6[Global`lambda]},     \
 \\n      \
Global`lambda>=1.979,{fpCf7[Global`lambda],fppCf7[Global`lambda]}]\>\""}]}], 
       "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"fp", "=", 
      RowBox[{"StringTrim", "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\"\<\\\"\>\"", "<>", "#", "<>", "\"\<\\\"\>\""}], "&"}], 
           "/@", "X"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"asf", "[", "#", "]"}], "&"}], "/@", "X"}]}], "}"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"fp", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"fp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "\[IndentingNewLine]",
         "\t", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{
           RowBox[{"f", ":", 
            RowBox[{"(", 
             RowBox[{"\"\<f\>\"", "~~", "__"}], ")"}]}], "~~", "c_", "~~", 
           "\"\<[\>\""}], "]"}], "\[RuleDelayed]", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"f", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"NumericQ", "@", 
              RowBox[{"ToExpression", "@", "c"}]}]}], ",", 
            RowBox[{"c", "<>", "\"\<1\>\""}], ",", "c"}], "]"}], "<>", 
          "\"\<[\>\""}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"fp", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{
        RowBox[{"fp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "\"\<\\n\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"fpp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
        "\"\<Get[\\\"inpol-\>\"", "<>", "#", "<>", "\[IndentingNewLine]", 
         "\"\<.dat\\\",Path->\\\"D:\\\\\\\\X-Ray-Diffraction\\\\\\\\Anomal\\\\\
\\\\Data\\\"];\>\""}], "&"}], "/@", "X"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Prepare", " ", "file"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"end", "[", "x_", "]"}], ":=", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"x", ",", "InputForm"}], "]"}], "<>", "\"\<;\\n\>\""}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"endTab", "[", "x_", "]"}], ":=", 
      RowBox[{"\"\<{\>\"", "<>", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ToString", "/@", 
           RowBox[{"Riffle", "[", 
            RowBox[{"x", ",", "\"\<\\n\\t\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\"\<,\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ")"}], "<>", "\"\<};\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"write", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "\"\<compound = \\\"\>\"", "<>", "crystal", "<>", 
          "\"\<\\\";\\n\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "\"\<spacegroup = \\\"\>\"", "<>", "sg", "<>", "\"\<\\\";\\n\>\""}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<ltc=\>\"", "<>", 
          RowBox[{"end", "@", "ltc"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<csmatrix=\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "csmatrix"}], "===", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"end", "@", "csmatrix"}], ",", 
            RowBox[{"endTab", "@", "csmatrix"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<cell=\>\"", "<>", 
          RowBox[{"end", "@", "cell"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<atoms=\>\"", "<>", 
          RowBox[{"endTab", "@", "atoms"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<flag=\>\"", "<>", 
          RowBox[{"end", "@", "flag"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<sccoeff=\>\"", "<>", 
          RowBox[{"endTab", "@", "sccoeff"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<fp=\>\"", "<>", 
          RowBox[{"endTab", "[", 
           RowBox[{"DeleteDuplicates", "@", "fp"}], "]"}], "<>", 
          "\"\<\\n\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{"DeleteDuplicates", "@", "fpp"}]}], "\[IndentingNewLine]", 
        "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Write", " ", "file"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"output", ",", "write", ",", "\"\<Text\>\""}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682134119475279*^9, 
   3.68213414049387*^9}, {3.682134230034416*^9, 3.682134358353902*^9}, {
   3.682134389202623*^9, 3.682134415753475*^9}, {3.68213471223449*^9, 
   3.682134738680016*^9}, {3.682135167917287*^9, 3.6821351692739058`*^9}, {
   3.682138062911598*^9, 3.682138063720244*^9}, {3.6821381082904797`*^9, 
   3.682138208115355*^9}, {3.682138260558123*^9, 3.682138470630207*^9}, {
   3.682142430328573*^9, 3.682142561470036*^9}, {3.6821426027834806`*^9, 
   3.682142633588481*^9}, {3.682142673674217*^9, 3.682142683054764*^9}, {
   3.682142831982066*^9, 3.6821428879204903`*^9}, {3.6821443136719933`*^9, 
   3.682144398215694*^9}, {3.682144667707994*^9, 3.682144722485908*^9}, {
   3.682146073210956*^9, 3.68214608362833*^9}, {3.6821461172637672`*^9, 
   3.6821461630666447`*^9}, {3.6821463016789713`*^9, 3.682146327282445*^9}, {
   3.682151620835616*^9, 3.682151624741599*^9}, {3.682151684939176*^9, 
   3.6821516924478617`*^9}, {3.6821521411767*^9, 3.682152149634416*^9}, {
   3.682152264995434*^9, 3.682152328608294*^9}, {3.682152441457012*^9, 
   3.68215245878516*^9}, {3.682152762344564*^9, 3.682152791810916*^9}, {
   3.6821528601618853`*^9, 3.682152860391903*^9}, {3.6821529539507027`*^9, 
   3.682152984540741*^9}, {3.68215302321913*^9, 3.682153129482265*^9}, {
   3.682153280259882*^9, 3.682153321673149*^9}, {3.7178511036483183`*^9, 
   3.717851122327134*^9}, {3.717851189821681*^9, 3.717851193253324*^9}, {
   3.717916603383876*^9, 3.717916615900518*^9}, {3.71791678533737*^9, 
   3.717916822693717*^9}, {3.717916865814321*^9, 3.717916885343642*^9}, {
   3.717916986983926*^9, 3.7179169979292173`*^9}, {3.717917037830962*^9, 
   3.717917045659477*^9}, {3.7179170793062963`*^9, 3.717917109267124*^9}, {
   3.717917204811631*^9, 3.717917207139429*^9}, {3.717917254969499*^9, 
   3.7179173374214897`*^9}, {3.7179175864193707`*^9, 3.717917659226503*^9}, {
   3.717917850307029*^9, 3.717917873292598*^9}, {3.7179179215268784`*^9, 
   3.7179179586127367`*^9}, {3.717917989152759*^9, 3.717918193378786*^9}, {
   3.717918252260969*^9, 3.7179182894439898`*^9}, {3.7179183263544292`*^9, 
   3.717918373884111*^9}, {3.7179184443231*^9, 3.71791859116503*^9}, {
   3.71791863140095*^9, 3.717918661157935*^9}, {3.717918691759494*^9, 
   3.717918904234448*^9}, {3.71791893752807*^9, 3.717918958132572*^9}, {
   3.717919047866308*^9, 3.7179190794148827`*^9}, {3.717919125850175*^9, 
   3.717919126585883*^9}, {3.71791915693224*^9, 3.717919157047124*^9}, {
   3.717919315192214*^9, 3.7179194745363817`*^9}, {3.717919527579845*^9, 
   3.7179195993661537`*^9}, {3.717919702041493*^9, 3.7179198892134333`*^9}, {
   3.717919925010474*^9, 3.717919942575781*^9}, {3.7179208770459547`*^9, 
   3.717920877264462*^9}, {3.717920975077087*^9, 3.717921089727352*^9}, {
   3.717921281105476*^9, 3.717921283024523*^9}, {3.7179213442689238`*^9, 
   3.717921352072809*^9}, {3.717921402759777*^9, 3.7179214269416113`*^9}, 
   3.7179290589818077`*^9, 3.7179291196754827`*^9, {3.717932870553046*^9, 
   3.717932908637034*^9}, {3.717933068586175*^9, 3.717933074090494*^9}, {
   3.717934434205607*^9, 3.7179344354333572`*^9}, {3.7179346495613947`*^9, 
   3.717934741706024*^9}, {3.7179347968659983`*^9, 3.7179349004449472`*^9}, {
   3.717937216065546*^9, 3.717937235401092*^9}, {3.717937326455368*^9, 
   3.717937334638166*^9}, 3.7179373723916473`*^9, {3.71793747073635*^9, 
   3.7179374716832323`*^9}, 3.719062284377136*^9, {3.7192054216113234`*^9, 
   3.7192054240424347`*^9}, {3.719205581771082*^9, 3.719205619497569*^9}, {
   3.719205652787191*^9, 3.719205669461669*^9}, {3.71920595658852*^9, 
   3.719206051455226*^9}, {3.7192061068391457`*^9, 3.719206108509877*^9}, {
   3.719206507760811*^9, 3.719206511952664*^9}, {3.7192066150919456`*^9, 
   3.719206624644392*^9}, {3.719206654760507*^9, 3.71920665515414*^9}, {
   3.719206737370376*^9, 3.719206742894656*^9}, {3.719206818338148*^9, 
   3.7192068751165533`*^9}, {3.719206919296289*^9, 3.7192069197159157`*^9}, {
   3.719206969300866*^9, 3.7192069773219337`*^9}, {3.71920703171224*^9, 
   3.719207044057707*^9}, {3.7192071164759483`*^9, 3.7192071256838293`*^9}, {
   3.7192071653824263`*^9, 3.7192071968875*^9}, {3.719207269656448*^9, 
   3.719207282268661*^9}, {3.719207312610282*^9, 3.719207459803895*^9}, {
   3.719207523660273*^9, 3.719207655407179*^9}, {3.719207687340831*^9, 
   3.719207929747686*^9}, {3.719207976375491*^9, 3.719207980620072*^9}, {
   3.71920802928226*^9, 3.719208062291397*^9}, {3.719208703456603*^9, 
   3.719208707744376*^9}, {3.719208809157524*^9, 3.7192088395220337`*^9}, {
   3.719208903683654*^9, 3.719208907235894*^9}, {3.7192091032061567`*^9, 
   3.719209148266526*^9}, {3.719209266954831*^9, 3.719209269814912*^9}, {
   3.7192093001737547`*^9, 3.719209348673376*^9}, {3.719209382179757*^9, 
   3.719209402604899*^9}, {3.7192094632378483`*^9, 3.719209547642548*^9}, {
   3.71920958107302*^9, 3.719209596166226*^9}, {3.719209663481758*^9, 
   3.719209696225484*^9}, {3.719209728301947*^9, 3.719209744245853*^9}, {
   3.719209786896216*^9, 3.719209898539953*^9}, {3.7192099448038588`*^9, 
   3.7192099474504337`*^9}, {3.719210028290267*^9, 3.719210054427005*^9}, {
   3.719210085840733*^9, 3.71921008729804*^9}, {3.719210145915444*^9, 
   3.719210196276587*^9}, {3.7192103986362257`*^9, 3.71921041896262*^9}, 
   3.719210925778717*^9, {3.719211586851451*^9, 3.719211590668058*^9}, 
   3.71921168111728*^9, {3.7192117624557543`*^9, 3.719211772466675*^9}, {
   3.719211952313706*^9, 3.719211979406364*^9}, {3.719212017030777*^9, 
   3.7192120794281263`*^9}, {3.719212127835136*^9, 3.719212179558937*^9}, {
   3.719212256971817*^9, 3.719212262909226*^9}, {3.7196860964591827`*^9, 
   3.7196860973077917`*^9}, {3.7196861829094067`*^9, 
   3.7196862166208687`*^9}, {3.719686333122931*^9, 3.7196863438428373`*^9}, {
   3.719686549364262*^9, 3.71968656060751*^9}, {3.719686702771332*^9, 
   3.719686744724094*^9}, {3.719812480214345*^9, 3.719812487210722*^9}, {
   3.7220630514752903`*^9, 3.722063051548852*^9}, {3.7268346752955427`*^9, 
   3.726834778252481*^9}, {3.726834822906386*^9, 3.726834842427602*^9}, {
   3.726834981665464*^9, 3.726834989809967*^9}, {3.7268355943625307`*^9, 
   3.726835625193077*^9}, 3.726835691512577*^9, {3.726835913472745*^9, 
   3.726835925871607*^9}, {3.726836338134117*^9, 3.726836402572958*^9}, {
   3.7268365508242826`*^9, 3.726836705125986*^9}, {3.726836790194151*^9, 
   3.726836844419907*^9}, {3.7268369029042187`*^9, 3.7268369417014627`*^9}, {
   3.726841173881588*^9, 3.726841182893406*^9}, {3.72684142097085*^9, 
   3.72684142129825*^9}, {3.726843653636404*^9, 3.7268436552265673`*^9}, {
   3.726843771872473*^9, 3.726843774760372*^9}, 3.7276767840329514`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[181]:=",ExpressionUUID->"a2845ce7-71e0-4d6a-a6dc-87d3577e009d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[182]:=",ExpressionUUID->"8c5c0c83-bc7b-4dfc-ab79-86a1bcf78685"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExportReflectionFile", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, {
   3.682134073518475*^9, 3.682134077310957*^9}, {3.6821351637913322`*^9, 
   3.682135164412662*^9}, {3.682138013029172*^9, 
   3.682138014016361*^9}},ExpressionUUID->"0c51ab41-fc34-4902-a0de-\
0408fceda32b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[183]:=",ExpressionUUID->"d8dc135c-e07e-4d83-8c2a-70ce4f08c8c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExportReflectionFile", "::", "dir"}], "=", 
   "\"\<Invalid directory.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportReflectionFile", "::", "format"}], "=", 
   "\"\<Invalid format of the reflection data.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportReflectionFile", "::", "hkl"}], "=", 
   "\"\<Output must end with \!\(\*StyleBox[\".\", \
\"Program\"]\)\!\(\*StyleBox[\"hkl\", \"Program\"]\).\>\""}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.66810571214802*^9, {3.6681867516522207`*^9, 
   3.668186778354513*^9}, {3.6681868394172163`*^9, 3.6681868614325943`*^9}, {
   3.668187374101748*^9, 3.6681874104278383`*^9}, {3.668187695125526*^9, 
   3.668187730468417*^9}, {3.668188056044814*^9, 3.668188056876872*^9}, {
   3.6681926250344687`*^9, 3.668192625250432*^9}, 3.68166923708845*^9, {
   3.6817064191712627`*^9, 3.68170642414537*^9}, {3.6817239114596*^9, 
   3.681723955601696*^9}, {3.681724223652172*^9, 3.681724224172266*^9}, {
   3.6818128705108147`*^9, 3.681812886108671*^9}, {3.681819874858591*^9, 
   3.681819895264824*^9}, {3.681835709479094*^9, 3.681835743293057*^9}, {
   3.682100938006762*^9, 3.682100938717538*^9}, 3.682134103684627*^9, {
   3.682142891293942*^9, 3.6821428951259127`*^9}, {3.682144298513987*^9, 
   3.682144308993547*^9}, {3.682144403478119*^9, 3.682144406579885*^9}, {
   3.682144581637662*^9, 3.6821446292028418`*^9}, {3.6821529895283422`*^9, 
   3.68215300977632*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"1bc27315-87d8-4633-a3b6-3c18a1916dce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[187]:=",ExpressionUUID->"312c650b-6095-4009-969c-f4a73e2c6005"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExportReflectionFile", "[", 
   RowBox[{"output_String", ",", "hkl_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dir", ",", "list", ",", "spacing", ",", "input", ",", "temp1", ",", 
      "temp2", ",", "temp3", ",", "temp4"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Checking", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"dir", "=", 
      RowBox[{"DirectoryName", "@", "output"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dir", "\[Equal]", "\"\<\>\""}], "||", 
        RowBox[{"dir", "\[Equal]", "\"\</\>\""}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ExportReflectionFile", "::", "dir"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DirectoryQ", "@", "dir"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ExportReflectionFile", "::", "dir"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"output", ",", 
           RowBox[{"-", "3"}]}], "]"}], "\[Equal]", "\"\<hkl\>\""}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ExportReflectionFile", "::", "hkl"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{
          RowBox[{"Depth", "@", "hkl"}], "\[Equal]", "3"}]}], 
        "\[IndentingNewLine]", "\t", "&&", 
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}], ",", 
           RowBox[{"Length", "@", 
            RowBox[{"RandomChoice", "@", "hkl"}]}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ExportReflectionFile", "::", "format"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Handling", " ", "the", " ", "format", " ", "of", " ", "each", " ", 
       "reflection"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"list", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"spacing", "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4", ",", "4", ",", "8", ",", "8", ",", "4"}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"First", "@", "hkl"}]}], "\[Equal]", "5"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"spacing", "=", 
        RowBox[{"spacing", "[", 
         RowBox[{"[", 
          RowBox[{";;", "5"}], "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Adjusting", " ", "spacing", " ", "for", " ", "each", " ", "line"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"input", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"ToString", ",", "hkl", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"temp1", "=", 
         RowBox[{"input", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"temp2", "=", 
         RowBox[{"spacing", "-", 
          RowBox[{"StringLength", "/@", "temp1"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"temp3", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"StringJoin", "@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"\"\< \>\"", ",", "#"}], "]"}]}], "&"}], "/@", 
          "temp2"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"temp4", "=", 
         RowBox[{"StringJoin", "@", 
          RowBox[{"Riffle", "[", 
           RowBox[{"temp3", ",", "temp1"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"list", ",", "temp4"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "input"}]}], "}"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Export", "[", 
      RowBox[{"output", ",", "list", ",", "\"\<Table\>\""}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682134119475279*^9, 
   3.68213414049387*^9}, {3.682134230034416*^9, 3.682134358353902*^9}, {
   3.682134389202623*^9, 3.682134415753475*^9}, {3.68213471223449*^9, 
   3.682134738680016*^9}, {3.682135167917287*^9, 3.6821351692739058`*^9}, {
   3.682138062911598*^9, 3.682138063720244*^9}, {3.6821381082904797`*^9, 
   3.682138208115355*^9}, {3.682138260558123*^9, 3.682138470630207*^9}, {
   3.682142430328573*^9, 3.682142561470036*^9}, {3.6821426027834806`*^9, 
   3.682142633588481*^9}, {3.682142673674217*^9, 3.682142683054764*^9}, {
   3.682142831982066*^9, 3.6821428879204903`*^9}, {3.6821443136719933`*^9, 
   3.682144398215694*^9}, {3.682144667707994*^9, 3.682144722485908*^9}, {
   3.682146073210956*^9, 3.68214608362833*^9}, {3.6821461172637672`*^9, 
   3.6821461630666447`*^9}, {3.6821463016789713`*^9, 3.682146327282445*^9}, {
   3.682151620835616*^9, 3.682151624741599*^9}, {3.682151684939176*^9, 
   3.6821516924478617`*^9}, {3.6821521411767*^9, 3.682152149634416*^9}, {
   3.682152264995434*^9, 3.682152328608294*^9}, {3.682152441457012*^9, 
   3.68215245878516*^9}, {3.682152762344564*^9, 3.682152791810916*^9}, {
   3.6821528601618853`*^9, 3.682152860391903*^9}, {3.6821529539507027`*^9, 
   3.682152984540741*^9}, {3.68215302321913*^9, 3.682153129482265*^9}, {
   3.682153280259882*^9, 3.682153321673149*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[188]:=",ExpressionUUID->"48fe546b-6ac5-45ff-8ad0-dac7d2155695"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[189]:=",ExpressionUUID->"34740895-68e3-4d82-b51a-f67934b58b39"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindPixelClusters", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.6678188399987793`*^9, 3.667818878319042*^9}, 
   3.667973368548716*^9},ExpressionUUID->"14bf3578-8d9c-4cb7-b4c3-\
cebe0abb7317"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[190]:=",ExpressionUUID->"23a68ca8-04b2-40e9-b5ba-26f20c00863a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FindPixelClusters", "::", "method"}], "=", 
   "\"\<The method \[LeftGuillemet]`1`\[RightGuillemet] was not recognised.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindPixelClusters", "::", "pixels"}], "=", 
   "\"\<Pixels in the binarised image: `1`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindPixelClusters", "::", "files"}], "=", 
   "\"\<All images must be file paths.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindPixelClusters", "::", "dir"}], "=", 
    "\"\<Invalid directory.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "FindPixelClusters"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Method", "\[Rule]", "\"\<Auto\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ReturnBinaryImage\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ClusterRange\>\"", "\[Rule]", "3"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ClearStatus\>\"", "\[Rule]", "False"}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, {3.667926883433126*^9, 3.667926892913142*^9}, {
   3.6679303915678787`*^9, 3.667930397064508*^9}, {3.667930504515873*^9, 
   3.6679305119877663`*^9}, {3.667930552979792*^9, 3.6679305587145452`*^9}, {
   3.6679305964269743`*^9, 3.667930598585484*^9}, {3.66793271531362*^9, 
   3.667932721040504*^9}, {3.667972261358046*^9, 3.6679722648457327`*^9}, {
   3.6679723098927813`*^9, 3.667972310700526*^9}, {3.667973385739415*^9, 
   3.667973388827128*^9}, {3.667977543043991*^9, 3.667977558082513*^9}, {
   3.667995016616452*^9, 3.667995022446369*^9}, {3.6679950722772903`*^9, 
   3.6679950740452623`*^9}, {3.6679957762713337`*^9, 3.667995776453274*^9}, {
   3.667996475790578*^9, 3.6679964973333187`*^9}, {3.668230520096628*^9, 
   3.668230520296247*^9}, {3.668231248823513*^9, 3.668231266470131*^9}, {
   3.668231934350088*^9, 3.6682319425497923`*^9}, {3.6682320393165903`*^9, 
   3.668232046291453*^9}, {3.668232248143578*^9, 3.668232275009239*^9}, {
   3.6682338783511744`*^9, 3.668233902814499*^9}, {3.6682341617838697`*^9, 
   3.66823416263997*^9}, 3.668234334356662*^9, {3.668234369772044*^9, 
   3.6682343712508717`*^9}, {3.668234441121419*^9, 3.668234442249284*^9}, {
   3.668234474145546*^9, 3.668234476228924*^9}, {3.668234888878497*^9, 
   3.668234889678135*^9}, {3.668234943421139*^9, 3.6682349550848227`*^9}, {
   3.6682352736460247`*^9, 3.66823528523668*^9}, {3.668235379331465*^9, 
   3.668235382934746*^9}, {3.6682354313782387`*^9, 3.6682354331850758`*^9}, {
   3.68751217918044*^9, 3.687512181304822*^9}, 3.7138583598504868`*^9, {
   3.714207623856532*^9, 3.7142076294786367`*^9}, {3.7142085710706787`*^9, 
   3.7142085726870623`*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"ca60526b-6186-4e3c-aeb5-3bdef76773b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[196]:=",ExpressionUUID->"0b6ccb59-b1ec-4444-96c8-1b1f9ddff73c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindPixelClusters", "[", 
   RowBox[{"image_Image", ",", 
    RowBox[{"OptionsPattern", "@", "FindPixelClusters"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "bin", ",", "data", ",", "L", ",", "method", ",", "fraction", ",", 
      "check", ",", "\[IndentingNewLine]", "P", ",", "update", ",", "start", 
      ",", "near", ",", "r", ",", "progress", ",", "status", ",", "total", 
      ",", "p", ",", "i", ",", "j", ",", "neighbours", ",", "new", ",", "n", 
      ",", "new2", ",", "\[IndentingNewLine]", "clusters", ",", "k"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Preparing", " ", "image", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Otsu", "'"}], "s", " ", "cluster", " ", "variance", " ", 
      "maximization", " ", "method"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"bin", "=", 
      RowBox[{"Binarize", "@", "image"}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"data", "=", 
      RowBox[{"PixelValuePositions", "[", 
       RowBox[{"bin", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", 
       RowBox[{"Choose", " ", "method"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"method", "=", 
      RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"method", "\[Equal]", "\"\<Auto\>\""}], ",", 
       RowBox[{"method", "=", "\"\<Median\>\""}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"method", "\[Equal]", "\"\<Median\>\""}], ",", 
       RowBox[{"L", "=", "50000"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"method", "\[Equal]", "\"\<Mean\>\""}], ",", 
       RowBox[{"L", "=", "50000"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"method", "\[Equal]", "\"\<Cluster\>\""}], ",", 
       RowBox[{"L", "=", "50000"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"method", "\[Equal]", "\"\<HighestFraction\>\""}], ",", 
       RowBox[{"L", "=", "50001"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"method", "\[Equal]", "\"\<BinariseOnly\>\""}], ",", 
       RowBox[{"Goto", "[", "\"\<BinarisationDone\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"FindPixelClusters", "::", "method"}], ",", "method"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "further", " ", "refinement", " ", "is", " ", 
       "necessary"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"L", "\[LessEqual]", "20000"}], ",", "Null", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"L", "\[LessEqual]", "50000"}], ",", 
       RowBox[{"bin", "=", 
        RowBox[{"DeleteSmallComponents", "[", 
         RowBox[{"bin", ",", 
          RowBox[{"Method", "\[Rule]", "method"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"(*", " ", 
        RowBox[{
        "Special", " ", "procedure", " ", "for", " ", "very", " ", "noisy", 
         " ", "images"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"fraction", "=", "1.00"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"check", "=", "True"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"While", "[", 
         RowBox[{"check", ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"fraction", "=", 
            RowBox[{"fraction", "-", "0.005"}]}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"bin", "=", 
            RowBox[{"Binarize", "[", 
             RowBox[{"image", ",", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<BlackFraction\>\"", ",", " ", "fraction"}], 
                "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"check", "=", 
            RowBox[{
             RowBox[{"PixelValuePositions", "[", 
              RowBox[{"bin", ",", "1"}], "]"}], "\[Equal]", 
             RowBox[{"{", "}"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"bin", "=", 
         RowBox[{"DeleteSmallComponents", "[", 
          RowBox[{"bin", ",", 
           RowBox[{"Method", "\[Rule]", "\"\<Mean\>\""}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"data", "=", 
      RowBox[{"PixelValuePositions", "[", 
       RowBox[{"bin", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", 
       RowBox[{
       "Return", " ", "binary", " ", "image", " ", "and", " ", "data", " ", 
        "length", " ", "for", " ", "inspection"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"Label", "[", "\"\<BinarisationDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<ReturnBinaryImage\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"FindPixelClusters", "::", "pixels"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"ToString", "@", 
           RowBox[{"NumberForm", "[", 
            RowBox[{
             RowBox[{"Length", "@", "data"}], ",", 
             RowBox[{"DigitBlock", "\[Rule]", "3"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Return", "@", "bin"}]}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Cluster", " ", "determination", " ", 
       "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"List", " ", "of", " ", "all", " ", "pixels"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"P", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"update", "=", 
      RowBox[{"N", "@", "data"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"start", "=", 
      RowBox[{"First", "@", "update"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"r", "=", 
      RowBox[{"N", "@", 
       RowBox[{"OptionValue", "[", "\"\<ClusterRange\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"near", "=", 
      RowBox[{"N", "@", 
       RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"-", "r"}], ",", "r"}], "}"}]}], "]"}], ",", "1"}], 
          "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"total", "=", 
      RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", "total"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Dynamic", " ", "status"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"status", "=", 
      RowBox[{"PrintTemporary", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"Row", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Determining pixel clusters:\>\"", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
              "14"}], "]"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"ProgressIndicator", "[", 
             RowBox[{"1", "-", 
              RowBox[{"progress", "/", "total"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "\t", "}"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"Alignment", "\[Rule]", "Center"}]}], "\[IndentingNewLine]", 
        "\t", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Single", " ", "pixel"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{"Reap", "@", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"update", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"First", " ", "iteration"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"neighbours", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"start", "+", "#"}], "&"}], "/@", "near"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"new", "=", 
           RowBox[{"Intersection", "[", 
            RowBox[{"update", ",", "neighbours"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Avoid", " ", "looping", " ", "over", " ", "the", " ", "same", " ",
             "single", " ", "pixel"}], " ", "*)"}], "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"new", "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"update", "=", 
             RowBox[{"Rest", "@", "update"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"p", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"p", ",", "new"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"update", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{"update", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]",
           "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"The", " ", "next", " ", "iterations"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"new", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{"Current", " ", "and", " ", "rest"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"n", "=", 
              RowBox[{"First", "@", "new"}]}], ";", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"new", "=", 
              RowBox[{"Rest", "@", "new"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"neighbours", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"n", "+", "#"}], "&"}], "/@", "near"}]}], ";", 
             "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
             RowBox[{"(*", " ", 
              RowBox[{"Actual", " ", "new", " ", "elements"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"new2", "=", 
              RowBox[{"Intersection", "[", 
               RowBox[{"update", ",", "neighbours"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"p", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"p", ",", "new2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
             RowBox[{"update", "=", 
              RowBox[{"Complement", "[", 
               RowBox[{"update", ",", "p"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"new", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"new", ",", "new2"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"One", " ", "pixel", " ", "done"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Sow", "[", "p", "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"progress", "=", 
           RowBox[{"Length", "@", "update"}]}], ";", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"update", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"start", "=", 
             RowBox[{"First", "@", "update"}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<ClearStatus\>\"", "]"}], ",", 
       RowBox[{"NotebookDelete", "@", "status"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"P", "=", 
      RowBox[{"P", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"clusters", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"P", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Merge", " ", "pixel", " ", "clusters", 
       " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"P", "=", 
      RowBox[{"Reap", "@", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"k", "=", 
           RowBox[{"Round", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"Total", "@", 
                RowBox[{"clusters", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "All", ",", "1"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"Total", "@", 
                RowBox[{"clusters", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "All", ",", "2"}], "]"}], "]"}]}]}], 
              "\[IndentingNewLine]", "\t", "}"}], "\[IndentingNewLine]", "\t",
              "/", 
             RowBox[{"Length", "@", 
              RowBox[{"clusters", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
            "\t", "]"}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Sow", "[", "k", "]"}]}], ",", "\[IndentingNewLine]", "\t", 
         
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "clusters"}]}], "}"}]}], 
        "\[IndentingNewLine]", "\t", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"P", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667819015852723*^9, {3.667926743191167*^9, 
   3.667926756485921*^9}, {3.6679268065659847`*^9, 3.6679268096604767`*^9}, {
   3.667926962553701*^9, 3.6679269943921003`*^9}, 3.6679277909347057`*^9, {
   3.6679278215421352`*^9, 3.6679278447888317`*^9}, {3.667927921354144*^9, 
   3.66792792396218*^9}, {3.667927998418087*^9, 3.667927998617405*^9}, {
   3.6679280547365437`*^9, 3.667928057183651*^9}, {3.667928585451659*^9, 
   3.667928696849235*^9}, {3.667930404905075*^9, 3.6679304216077147`*^9}, {
   3.6679304533630323`*^9, 3.667930454063971*^9}, {3.6679310019224863`*^9, 
   3.667931184397665*^9}, {3.667931227245723*^9, 3.667931371281341*^9}, {
   3.667931420882256*^9, 3.667931517142481*^9}, 3.667931552079372*^9, {
   3.667931592230816*^9, 3.6679315953351383`*^9}, {3.66793164158883*^9, 
   3.667931735041656*^9}, {3.667931797945294*^9, 3.667931835823868*^9}, {
   3.667931870240131*^9, 3.667931910901052*^9}, {3.6679320411065617`*^9, 
   3.667932042282494*^9}, {3.6679321631039057`*^9, 3.667932185255023*^9}, {
   3.6679322367038527`*^9, 3.6679322536777477`*^9}, 3.667939889308084*^9, {
   3.667969769378148*^9, 3.667969771378113*^9}, 3.667970090993989*^9, {
   3.667973390326392*^9, 3.6679733948223467`*^9}, {3.667976913750659*^9, 
   3.667976916404254*^9}, {3.6679769619491863`*^9, 3.667976962373781*^9}, 
   3.66797708246696*^9, 3.667977633341072*^9, {3.667977678626876*^9, 
   3.667977952564095*^9}, {3.667982385812993*^9, 3.6679823891230717`*^9}, {
   3.667982552768587*^9, 3.6679825768232183`*^9}, {3.667982617631548*^9, 
   3.667982618230095*^9}, 3.667982783740485*^9, 3.667982978648044*^9, {
   3.667987233443955*^9, 3.6679872350670633`*^9}, 3.667987319881976*^9, {
   3.667995025393314*^9, 3.667995077673361*^9}, {3.667995795417122*^9, 
   3.6679958330065393`*^9}, 3.66799604865274*^9, {3.667996211983923*^9, 
   3.667996238685172*^9}, {3.667996325731824*^9, 3.6679963500750713`*^9}, 
   3.6679964246118183`*^9, {3.6679964925539827`*^9, 3.6679965140880003`*^9}, {
   3.6679966308453293`*^9, 3.667996631124778*^9}, {3.667996667541781*^9, 
   3.667996679667149*^9}, {3.6682298967733393`*^9, 3.668230154667777*^9}, {
   3.6682302282495613`*^9, 3.668230337862431*^9}, {3.66823037439754*^9, 
   3.6682304210040913`*^9}, {3.668230470966654*^9, 3.668230509026909*^9}, {
   3.6682305945216846`*^9, 3.668230608294874*^9}, {3.668230649418269*^9, 
   3.6682306552087507`*^9}, {3.668230777855473*^9, 3.668230779342372*^9}, {
   3.668230827027471*^9, 3.668230869589425*^9}, {3.6682309020436172`*^9, 
   3.6682309032099752`*^9}, {3.668230964088015*^9, 3.6682309837305403`*^9}, {
   3.668231043206236*^9, 3.668231198625996*^9}, {3.6682312793778677`*^9, 
   3.668231309239684*^9}, {3.668231360770649*^9, 3.668231478579686*^9}, {
   3.6682315182903957`*^9, 3.6682316606075783`*^9}, {3.668231853738429*^9, 
   3.6682319097544107`*^9}, 3.6682320481299458`*^9, {3.66823231198499*^9, 
   3.668232340966546*^9}, {3.668232413221817*^9, 3.6682324555084667`*^9}, {
   3.668232593908114*^9, 3.6682326569589863`*^9}, {3.668232694967547*^9, 
   3.6682327934677343`*^9}, {3.668233168339756*^9, 3.668233211018368*^9}, {
   3.668233911929123*^9, 3.668233912673284*^9}, {3.668234165475075*^9, 
   3.668234166434887*^9}, 3.668234335726321*^9, {3.668234375925832*^9, 
   3.668234383685205*^9}, {3.6682344192284307`*^9, 3.668234420445109*^9}, {
   3.6682344814285107`*^9, 3.668234482946336*^9}, {3.668234565665369*^9, 
   3.6682345756405*^9}, {3.668234658311418*^9, 3.668234660936935*^9}, {
   3.668234729151449*^9, 3.668234734437337*^9}, {3.668234775292177*^9, 
   3.668234776492208*^9}, {3.6682348149806547`*^9, 3.6682348872015553`*^9}, {
   3.668234957471792*^9, 3.668234962599025*^9}, {3.66823500756784*^9, 
   3.668235010638788*^9}, {3.668235386702396*^9, 3.6682353879562407`*^9}, {
   3.668235436429007*^9, 3.668235463195363*^9}, {3.668235513409904*^9, 
   3.668235551480637*^9}, 3.668235614055798*^9, {3.668235690567173*^9, 
   3.668235719044767*^9}, {3.6695562972398148`*^9, 3.669556297373962*^9}, {
   3.687512196806978*^9, 3.6875121973395967`*^9}, {3.713802902597312*^9, 
   3.713802915932815*^9}, {3.713803320942219*^9, 3.713803345450964*^9}, {
   3.7138034257374067`*^9, 3.713803460759953*^9}, 3.713803519649189*^9, {
   3.713803604382509*^9, 3.713803680578794*^9}, {3.7138037681305428`*^9, 
   3.713803775505362*^9}, {3.713803860977088*^9, 3.713803917581181*^9}, {
   3.713803974310575*^9, 3.713803976182168*^9}, 3.7138040436679573`*^9, {
   3.7138063486627274`*^9, 3.713806350942552*^9}, {3.713807462694106*^9, 
   3.713807489203656*^9}, {3.7138075517857037`*^9, 3.713807559617502*^9}, {
   3.713807618953618*^9, 3.713807903852294*^9}, {3.713808001585246*^9, 
   3.7138080016781054`*^9}, 3.71380855458074*^9, {3.71380863487689*^9, 
   3.7138087192939777`*^9}, {3.713808846860177*^9, 3.713808857421461*^9}, {
   3.713808897778977*^9, 3.713808912465152*^9}, {3.713808955217936*^9, 
   3.7138089628015137`*^9}, {3.713808995906348*^9, 3.713809022295484*^9}, {
   3.713809073335235*^9, 3.713809100565136*^9}, {3.713809177854271*^9, 
   3.7138093132746353`*^9}, {3.7138093441213913`*^9, 
   3.7138093456793613`*^9}, {3.713809453317717*^9, 3.713809513685094*^9}, {
   3.7138095931785507`*^9, 3.713809626242549*^9}, {3.713809658033081*^9, 
   3.713809664135953*^9}, 3.713809740064288*^9, {3.713809808472837*^9, 
   3.7138099121534863`*^9}, {3.713844685073086*^9, 3.7138446872542553`*^9}, {
   3.71384588184228*^9, 3.7138458833230133`*^9}, {3.713846292992717*^9, 
   3.713846349611416*^9}, 3.713846695574162*^9, {3.7138467278378*^9, 
   3.713846731171411*^9}, {3.713846806808646*^9, 3.713846913776025*^9}, {
   3.7138469529141293`*^9, 3.713846953470827*^9}, {3.713847032551959*^9, 
   3.7138470334900837`*^9}, {3.713847168612919*^9, 3.713847198830091*^9}, {
   3.713847280190546*^9, 3.713847327524582*^9}, {3.713847407284361*^9, 
   3.713847407599958*^9}, {3.7138474475624743`*^9, 3.713847471334959*^9}, {
   3.713847502755796*^9, 3.713847510323131*^9}, {3.7138476002010098`*^9, 
   3.713847681785532*^9}, {3.7138477189303513`*^9, 3.713847720783132*^9}, {
   3.713848047572956*^9, 3.713848050312454*^9}, {3.713848196591464*^9, 
   3.713848212251227*^9}, {3.713848276669099*^9, 3.713848283663631*^9}, {
   3.713855305653678*^9, 3.713855338332179*^9}, {3.713855626443754*^9, 
   3.713855628890686*^9}, 3.713855941830909*^9, {3.713856433219384*^9, 
   3.713856437634218*^9}, {3.713862011147923*^9, 3.713862014225955*^9}, {
   3.713865700953743*^9, 3.7138657011938753`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[197]:=",ExpressionUUID->"881eb084-ebad-421e-8706-db485fe279f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindPixelClusters", "[", 
   RowBox[{"images_List", ",", "output_String", ",", 
    RowBox[{"OptionsPattern", "@", "FindPixelClusters"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "progress", ",", "L", ",", "outputfile", ",", "step1", ",", "step2"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "and", " ", "prepare", " ", "input"}], " ", "*)"}],
     "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AnyTrue", "[", 
        RowBox[{"images", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FileExistsQ", "[", "#", "]"}]}], "&"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FindPixelClusters", "::", "files"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DirectoryQ", "@", 
         RowBox[{"DirectoryName", "@", "output"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"FindPixelClusters", "::", "dir"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", "0"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "images"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Clear", " ", "current", " ", "$PixelData"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"$PixelData", "=", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dynamic", " ", "status"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"PrintTemporary", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"Row", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Progress:\>\"", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
             "16"}], "]"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"Dynamic", "@", 
           RowBox[{"ProgressIndicator", "[", 
            RowBox[{"progress", "/", "L"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"Dynamic", "[", 
           RowBox[{"Text", "[", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"\"\<Images done: \>\"", "<>", 
               RowBox[{"ToString", "[", "progress", "]"}], "<>", 
               "\"\< of \>\"", "<>", 
               RowBox[{"ToString", "@", "L"}]}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
              "12"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", "\t", 
         "}"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"Alignment", "\[Rule]", "Center"}]}], "\[IndentingNewLine]", 
       "\t", "]"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{"Preparing", " ", "output", " ", "file"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"outputfile", "=", "output"}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"Quiet", "@", 
      RowBox[{"Close", "@", "outputfile"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"WriteString", "[", 
      RowBox[{"outputfile", ",", "\"\<<|\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Loop", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"step1", "=", 
         RowBox[{"IntegerString", "[", 
          RowBox[{
           RowBox[{"FileHash", "[", 
            RowBox[{
             RowBox[{"images", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<MD5\>\""}], "]"}], 
           ",", "16", ",", "32"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"step2", "=", 
         RowBox[{"FindPixelClusters", "[", 
          RowBox[{
           RowBox[{"Import", "@", 
            RowBox[{"images", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"OptionValue", "[", "Method", "]"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"\"\<ClearStatus\>\"", "\[Rule]", "True"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", "\t", 
        RowBox[{"WriteString", "[", 
         RowBox[{"outputfile", ",", 
          RowBox[{
           RowBox[{"\"\<\\\"\>\"", "<>", "step1", "<>", "\"\<\\\"\>\""}], 
           "\[Rule]", "step2"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[NotEqual]", 
           RowBox[{"Length", "@", "images"}]}], ",", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outputfile", ",", "\"\<,\>\""}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"progress", "++"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "images"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "End", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"WriteString", "[", 
      RowBox[{"outputfile", ",", "\"\<|>\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Close", "@", "outputfile"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"AbsoluteFileName", "@", "outputfile"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667819176600494*^9, {3.667971802914857*^9, 
   3.667971859080471*^9}, {3.667971920120824*^9, 3.667971948479953*^9}, {
   3.667972005909231*^9, 3.667972006581135*^9}, 3.667990375472611*^9, {
   3.668102913573119*^9, 3.668102916285203*^9}, {3.668103301333783*^9, 
   3.6681033022141*^9}, {3.668104231931918*^9, 3.6681042368437233`*^9}, {
   3.66810427800709*^9, 3.668104281171877*^9}, {3.6681432560752687`*^9, 
   3.668143261920676*^9}, 3.668143368784114*^9, 3.668143565638023*^9, {
   3.668143603138604*^9, 3.6681436262097673`*^9}, {3.6682424356421633`*^9, 
   3.668242445129506*^9}, {3.7142085599143867`*^9, 3.7142085890345488`*^9}, 
   3.7142087250019093`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[198]:=",ExpressionUUID->"6d5a08ba-f159-42c7-8316-e106aa2f1781"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[199]:=",ExpressionUUID->"41e844d4-8203-469f-a72c-bf026506bbdb"]
}, Closed]],

Cell[CellGroupData[{

Cell["ImgScript", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.6678187105381413`*^9, {3.668848030801978*^9, 
   3.668848031166407*^9}},ExpressionUUID->"2acb6343-d992-441d-871b-\
f419ef3f6357"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[200]:=",ExpressionUUID->"e72b781e-f33c-4f80-9775-6360fa993f33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ImgScript", "::", "None"}], "=", 
   "\"\<No \!\(\*StyleBox[\".\", \"Program\"]\)\!\(\*StyleBox[\"img\", \
\"Program\"]\) files were found.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImgScript", "::", "InvalidFormat"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid output \
format.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImgScript", "::", "String"}], "=", 
   "\"\<\!\(\*StyleBox[\".\", \"Program\"]\)\!\(\*StyleBox[\"img\", \"Program\
\"]\) file paths must be strings.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImgScript", "::", "span"}], "=", 
   "\"\<The setting of \\\"SelectAdjust\\\" must be a Span.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImgScript", "::", "integers"}], "=", 
   "\"\<The span in \\\"SelectAdjust\\\" must be comprised of \
integers.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImgScript", "::", "InvalidRange"}], "=", 
   "\"\<Range for \\\"SelectAdjust\\\" is not compatible with the number of \
\!\(\*StyleBox[\".\", \"Program\"]\)\!\(\*StyleBox[\"img\", \"Program\"]\) \
files.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImgScript", "::", "na"}], "=", 
    "\"\<\\\"SelectAdjust\\\" cannot be used without a brightness \
factor.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ImgScript", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<WriteDirectory\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<OutputFormat\>\"", "\[Rule]", "\"\<bmp\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SelectAdjust\>\"", "\[Rule]", "All"}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.6678187237378197`*^9, {3.668848288618224*^9, 
   3.668848322223003*^9}, {3.668848530395031*^9, 3.668848533381481*^9}, {
   3.6688497155811567`*^9, 3.6688497270532312`*^9}, {3.668849885708955*^9, 
   3.668849886505486*^9}, {3.6688503391546297`*^9, 3.6688503570195227`*^9}, 
   3.674074162948956*^9, {3.712570751498494*^9, 3.712570784698996*^9}, {
   3.712571222891932*^9, 3.712571251218502*^9}, {3.712571379979851*^9, 
   3.712571405771557*^9}, {3.712571561879644*^9, 3.7125716370634108`*^9}, {
   3.712571916757163*^9, 3.712571977918076*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"7aea4502-3660-4d26-9d7c-94fcde59e7d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[209]:=",ExpressionUUID->"414a1848-111c-4586-accb-b5005825f0aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImgScript", "[", 
   RowBox[{"input_", ",", 
    RowBox[{"Optional", "[", 
     RowBox[{
      RowBox[{"m_", "?", "NumericQ"}], ",", "1"}], "]"}], ",", 
    RowBox[{"OptionsPattern", "@", "ImgScript"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "type", ",", "outdir", ",", "\[IndentingNewLine]", "imgfiles", ",", 
      "name", ",", "ext", ",", "end", ",", "i", ",", "writedir", ",", 
      "adjust", ",", "\[IndentingNewLine]", "fcode", ",", "entry"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Analysing", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"type", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"Head", "@", "input"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"type", "\[Equal]", "\"\<String\>\""}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Finding", " ", ".", "img"}], " ", "files", " ", "in", " ", 
         "the", " ", "given", " ", "directory"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"imgfiles", "=", 
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<*.img\>\"", ",", "input"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"outdir", "=", "input"}], ";", "\[IndentingNewLine]", "\t\t", 
        
        RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"imgfiles", "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"ImgScript", "::", "None"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"type", "\[Equal]", "\"\<List\>\""}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"imgfiles", "=", "input"}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"outdir", "=", 
         RowBox[{"DirectoryName", "@", 
          RowBox[{"First", "@", "input"}]}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "if", " ", "empty"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"imgfiles", "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"ImgScript", "::", "None"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Check", " ", "if", " ", "list", " ", "contains", " ", "strings", 
          " ", "only"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AllTrue", "[", 
            RowBox[{"imgfiles", ",", "StringQ"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"ImgScript", "::", "String"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Determining", " ", ".", "mac"}], " ", "file", " ", "name"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{
         RowBox[{"FileNameTake", "@", 
          RowBox[{"First", "@", "imgfiles"}]}], ",", "\"\<_\>\""}], "]"}], 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Truncated", " ", "name"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"name", "=", 
        RowBox[{"StringDrop", "[", 
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"StringCases", "[", 
            RowBox[{
             RowBox[{"FileNameTake", "@", 
              RowBox[{"First", "@", "imgfiles"}]}], ",", 
             RowBox[{"__", "~~", "\"\<_\>\""}]}], "]"}]}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Base", " ", "name"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"name", "=", 
        RowBox[{"StringDrop", "[", 
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"StringCases", "[", 
            RowBox[{
             RowBox[{"FileNameTake", "@", "\[IndentingNewLine]", 
              RowBox[{"First", "@", "imgfiles"}]}], ",", 
             RowBox[{"Shortest", "[", 
              RowBox[{"__", "~~", "DigitCharacter"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Function", " ", "that", " ", "sets", " ", "new", " ", "extension"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"ext", "=", 
      RowBox[{"OptionValue", "[", "\"\<OutputFormat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"end", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"StringDrop", "[", 
        RowBox[{
         RowBox[{"imgfiles", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"-", "3"}]}], "]"}], "<>", "ext"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Write", " ", "a", " ", "different", " ", "directory"}]}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"writedir", "=", 
      RowBox[{"OptionValue", "[", "\"\<WriteDirectory\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "writedir"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"imgfiles", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"writedir", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"FileNameTake", "/@", "imgfiles"}], ")"}]}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Output", " ", "format"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"ext", "\[Equal]", "\"\<bmp\>\""}], ",", 
       RowBox[{"fcode", "=", "\"\<bitmap \>\""}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"ext", "\[Equal]", "\"\<jpg\>\""}], ",", 
       RowBox[{"fcode", "=", "\"\<jpgbmp \>\""}], ",", "\[IndentingNewLine]", 
       "\t", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ImgScript", "::", "InvalidFormat"}], ",", "ext"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Adjust", " ", "brightness"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"adjust", "=", 
      RowBox[{"OptionValue", "[", "\"\<SelectAdjust\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", "Checks", " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"adjust", "===", "All"}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "@", 
            RowBox[{"Head", "@", "adjust"}]}], "\[NotEqual]", 
           "\"\<Span\>\""}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"ImgScript", "::", "span"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AllTrue", "[", 
            RowBox[{"adjust", ",", "IntegerQ"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"ImgScript", "::", "integers"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"!", 
            RowBox[{
             RowBox[{"adjust", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[GreaterEqual]", "1"}]}], "||", 
           RowBox[{
            RowBox[{"adjust", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ">", 
            RowBox[{"Length", "@", "imgfiles"}]}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"ImgScript", "::", "InvalidRange"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"m", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t\t", 
          
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"ImgScript", "::", "na"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "\t\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m", "\[NotEqual]", "1"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"adjust", "\[Equal]", "All"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"adjust", "=", 
          RowBox[{"Range", "@", 
           RowBox[{"Length", "@", "imgfiles"}]}]}], ",", "Null", ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"adjust", "=", 
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Range", "@", 
             RowBox[{"Length", "@", "imgfiles"}]}], ",", "adjust"}], 
           "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Function", " ", "that", " ", "writes", " ", "code", " ", "for", " ", 
       "each", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"entry", "[", "i_", "]"}], ":=", "\[IndentingNewLine]", "\t", 
      RowBox[{"\"\<rd i \\\"\>\"", "<>", 
       RowBox[{"imgfiles", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<\\\"\\n\>\"", "<>", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"adjust", ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"\"\<ip multiplydouble i1 i1 \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "<>", "\"\<\\n\>\""}], ",", 
         "\[IndentingNewLine]", "\t", "\"\<\>\""}], "]"}], "<>", 
       "\[IndentingNewLine]", "\t", "\"\<wd \>\"", "<>", "fcode", "<>", 
       "\"\<\\\"\>\"", "<>", 
       RowBox[{"end", "[", "i", "]"}], "<>", "\"\<\\\"\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Generating", " ", "and", " ", "exporting", " ", "table"}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"outdir", ",", 
          RowBox[{"name", "<>", "\"\<.mac\>\""}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"entry", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "imgfiles"}]}], "}"}]}], "]"}], ",", 
       "\"\<Table\>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667818718091518*^9, {3.668843227216737*^9, 
   3.668843260623933*^9}, {3.668843800356245*^9, 3.668843859685425*^9}, {
   3.6688485350589647`*^9, 3.668848542811091*^9}, 3.668848640505588*^9, {
   3.6688487133639917`*^9, 3.668848741790744*^9}, {3.668848785584115*^9, 
   3.66884878833679*^9}, {3.6688490369025507`*^9, 3.6688490408015003`*^9}, {
   3.6688494283086033`*^9, 3.668849443936469*^9}, {3.668849502587039*^9, 
   3.668849505233816*^9}, {3.668849602307579*^9, 3.6688496096107407`*^9}, {
   3.6688496553249607`*^9, 3.668849684559898*^9}, {3.6688498057208433`*^9, 
   3.668849816647071*^9}, {3.668849854052587*^9, 3.66884990391476*^9}, {
   3.668849949676675*^9, 3.668849958799165*^9}, {3.6688499909252577`*^9, 
   3.668850017824744*^9}, {3.668850064073255*^9, 3.668850194002316*^9}, {
   3.668850226589102*^9, 3.668850322211541*^9}, 3.668850363896997*^9, {
   3.6688504485662117`*^9, 3.668850480990592*^9}, {3.6688505147957897`*^9, 
   3.668850553881968*^9}, {3.668850586916111*^9, 3.668850590223164*^9}, {
   3.668850648044367*^9, 3.668850649675537*^9}, {3.668850705498735*^9, 
   3.6688507289847927`*^9}, {3.668850766122506*^9, 3.668850840956725*^9}, {
   3.668851068760067*^9, 3.6688510957854223`*^9}, 3.6740740543208313`*^9, {
   3.674074168023467*^9, 3.674074175975074*^9}, {3.712570554671812*^9, 
   3.7125705604817667`*^9}, {3.7125706716467*^9, 3.7125707289881287`*^9}, {
   3.712570792351226*^9, 3.712570812097787*^9}, {3.7125708766421413`*^9, 
   3.712570881238154*^9}, {3.712571203693883*^9, 3.71257121373002*^9}, {
   3.712571259807963*^9, 3.712571368115559*^9}, 3.7125714133318653`*^9, {
   3.712571674956291*^9, 3.712571675228469*^9}, {3.712571740063588*^9, 
   3.71257177061097*^9}, {3.7125718800827417`*^9, 3.712571911708654*^9}, {
   3.712571982422608*^9, 3.712572021855831*^9}, {3.7125720580663567`*^9, 
   3.712572093677559*^9}, {3.712572148360096*^9, 3.712572151574245*^9}, {
   3.712572204885757*^9, 3.712572329555284*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[210]:=",ExpressionUUID->"7cae0bb2-b056-4d96-8f9b-c61777a95838"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[211]:=",ExpressionUUID->"d69a9006-8db9-468b-be40-d6c7883c9970"]
}, Closed]],

Cell[CellGroupData[{

Cell["ImportReflectionFile", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, {
   3.682134073518475*^9, 3.682134077310957*^9}, {3.6821351637913322`*^9, 
   3.682135164412662*^9}},ExpressionUUID->"e964329e-9607-409f-b03e-\
c8db084f23da"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[212]:=",ExpressionUUID->"12abebc3-3aa6-43db-8152-7448c37e04db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[213]:=",ExpressionUUID->"7bbfa8ea-ec5e-4b48-b633-9a42cce8327e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImportReflectionFile", "[", 
   RowBox[{"file_", "?", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"#", ",", 
         RowBox[{"-", "3"}]}], "]"}], "\[Equal]", "\"\<hkl\>\""}], "&"}], 
     ")"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "import", ",", "end", ",", "temp", ",", "need0", ",", "l", ",", "zero"}],
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Importing", " ", "and", " ", 
      RowBox[{"trimming", " ", ".", "hkl"}], " ", "file"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"import", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"file", ",", "\"\<Table\>\""}], "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"import", "=", 
      RowBox[{"ToString", "/@", "import"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"end", "=", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"StringCases", "[", 
         RowBox[{"import", ",", "\"\<0, 0, 0\>\""}], "]"}], ",", 
        RowBox[{"{", "\"\<0, 0, 0\>\"", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Not", " ", "ending", " ", "with", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"end", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"end", "=", 
         RowBox[{"Length", "@", "import"}]}], ";", 
        RowBox[{"need0", "=", "True"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       
       RowBox[{
        RowBox[{"end", "=", 
         RowBox[{"First", "@", 
          RowBox[{"Flatten", "@", "end"}]}]}], ";", 
        RowBox[{"need0", "=", "False"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"import", "[", 
       RowBox[{"[", 
        RowBox[{";;", "end"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Fixing", " ", "clustered", " ", "entries"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"a", ":", "DigitCharacter"}], "~~", "\"\<-\>\"", "~~", 
          RowBox[{"b", ":", "DigitCharacter"}]}], "\[RuleDelayed]", 
         RowBox[{"a", "<>", "\"\< , \>\"", "<>", "b"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"ToExpression", "/@", 
       RowBox[{"StringTrim", "/@", "temp"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Appending", " ", "zero", " ", "element", " ", "if", " ", "needed"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"l", "=", 
      RowBox[{"Length", "@", 
       RowBox[{"RandomChoice", "@", "temp"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"zero", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0.00", ",", "0.00", ",", "0"}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"zero", "=", 
      RowBox[{"zero", "[", 
       RowBox[{"[", 
        RowBox[{";;", "l"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"need0", ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"temp", ",", "zero"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", "temp"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682134119475279*^9, 
   3.68213414049387*^9}, {3.682134230034416*^9, 3.682134358353902*^9}, {
   3.682134389202623*^9, 3.682134415753475*^9}, {3.68213471223449*^9, 
   3.682134738680016*^9}, {3.682135167917287*^9, 3.6821351692739058`*^9}, {
   3.6821406292666683`*^9, 3.682140654094082*^9}, {3.6821406991343613`*^9, 
   3.6821407036714487`*^9}, {3.6821407535813293`*^9, 3.682140776232851*^9}, {
   3.682141280640764*^9, 3.6821413140749407`*^9}, {3.682215668637539*^9, 
   3.6822158020038137`*^9}, {3.682215858234087*^9, 3.682216069916401*^9}, {
   3.682216114700245*^9, 3.682216117967658*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[214]:=",ExpressionUUID->"9f0223cb-811d-407b-b958-395d3f8efdee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[215]:=",ExpressionUUID->"2a0bcbec-4d89-416a-99af-ae0164582584"]
}, Closed]],

Cell[CellGroupData[{

Cell["IntensityTable", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 
   3.667817961099627*^9},ExpressionUUID->"3b753f0e-2dc0-498e-9a94-\
d94051e92fc9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[216]:=",ExpressionUUID->"fa2bab8d-5625-4750-9c41-09c459feb749"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "IntensityTable"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<Sort\>\"", "\[Rule]", 
     RowBox[{"-", "2"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713621199125605*^9, 3.7136212458990927`*^9}, {
  3.7136216692573566`*^9, 3.713621683264825*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"5e4d63a7-a7ab-4687-890b-9360d007f30a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[218]:=",ExpressionUUID->"b8ed105a-8270-42d1-bea6-f17597842c9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntensityTable", "[", 
   RowBox[{"group_String", ",", 
    RowBox[{"file_", "?", "FileExistsQ"}], ",", 
    RowBox[{"OptionsPattern", "@", "IntensityTable"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "import", ",", "sgHM", ",", "hkl", ",", "data", ",", 
      "\[IndentingNewLine]", "gathered", ",", "wmean", ",", 
      "\[IndentingNewLine]", "tally", ",", "minmax", ",", "min", ",", "max", 
      ",", "range", ",", "span", ",", "\[IndentingNewLine]", "values", ",", 
      "sort", ",", "table", ",", "\[IndentingNewLine]", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Importing", " ", "data", " ", "and", 
      " ", "reorganising", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"import", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Check", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"file", ",", "\"\<CSV\>\""}], "]"}], ",", 
         RowBox[{"Abort", "[", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"sgHM", "=", 
      RowBox[{"SymmetryData", "[", 
       RowBox[{"group", ",", "\"\<HermannMauguinFull\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Removing", " ", "the", " ", "metadata", " ", "appended", " ", "in", 
       " ", "newer", " ", "versions"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"import", ",", "\"\<   0   0   0    0.00    0.00   0\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"import", "=", 
        RowBox[{"import", "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{
            RowBox[{"temp", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "]"}], 
         "]"}]}]}], "]"}], ";", "\t\t", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Fixing", " ", "squeezed", " ", "entries"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"import", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"import", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"\"\<  \>\"", "~~", 
          RowBox[{"p", ":", 
           RowBox[{"{", 
            RowBox[{"\"\<-\>\"", ",", "\"\<\>\""}], "}"}]}], "~~", 
          RowBox[{"a", ":", 
           RowBox[{"DigitCharacter", ".."}]}], "~~", "\"\<-\>\"", "~~", 
          RowBox[{"b", ":", "DigitCharacter"}]}], "\[RuleDelayed]", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
         "\"\<  \>\"", "~~", "p", "~~", "a", "~~", "\"\< -\>\"", "~~", 
          "b"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"import", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"import", ",", "Whitespace"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Reorganising", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"data", "=", 
      RowBox[{"import", "/.", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "h_", ",", "k_", ",", "l_", ",", "F2_", ",", "\[Sigma]2_", ",", 
          "batch_"}], "}"}], "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"h", ",", "k", ",", "l"}], "}"}], ",", "F2", ",", 
          "\[Sigma]2"}], "}"}]}]}]}], ";", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Deleting", " ", "extinct", " ", "reflections"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"hkl", "=", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"SystematicAbsentQ", "[", 
       RowBox[{"sgHM", ",", "hkl"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"data", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"data", ",", "temp", ",", "False"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Gathering", " ", "data", " ", "by", 
       " ", "Laue", " ", "class", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Gather", " ", "by", " ", "symmetry", " ", "equivalence"}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"gathered", "=", 
      RowBox[{"GatherBy", "[", 
       RowBox[{"data", ",", 
        RowBox[{
         RowBox[{"Sort", "@", 
          RowBox[{"SymmetryEquivalentReflections", "[", "\[IndentingNewLine]", 
           RowBox[{"sgHM", ",", 
            RowBox[{"First", "@", "#"}]}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Calculating", " ", "a", " ", "weighted", " ", "mean", " ", "for", " ", 
       "each", " ", "type"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"gathered", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "All", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"wmean", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"WeightedMean", "@", "#"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], "]"}], "]"}], "&"}], "/@", 
       "temp"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Extracting", " ", "useful", " ", 
       "information", " ", "for", " ", "each", " ", "group", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"tally", "=", 
      RowBox[{"Length", "/@", "gathered"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"minmax", "=", 
      RowBox[{"Reap", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Sow", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"temp", "=", 
            RowBox[{"f", "/@", 
             RowBox[{"gathered", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"NumberForm", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
               "\t", 
               RowBox[{"DigitBlock", "\[Rule]", "3"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"NumberSeparator", "\[Rule]", "\"\<,\>\""}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"NumberPoint", "\[Rule]", "\"\<\>\""}]}], "]"}], "&"}],
             "/@", "temp"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"f", ",", 
           RowBox[{"{", 
            RowBox[{"Min", ",", "Max"}], "}"}]}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", "\t", "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"min", ",", "max"}], "}"}], "=", 
      RowBox[{"minmax", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"range", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<(\>\"", "<>", 
          RowBox[{"ToString", "[", "#1", "]"}], "<>", "\"\<; \>\"", "<>", 
          RowBox[{"ToString", "[", "#2", "]"}], "<>", "\"\<)\>\""}], "&"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"min", ",", "max"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"span", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#1", "-", "#2"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "#3"}], ")"}]}], "*", "100.0"}], "&"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{"First", ",", 
          RowBox[{"{", 
           RowBox[{"max", ",", "min", ",", "wmean"}], "}"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assigning", " ", "a", " ", "representative", " ", "for", " ", "each", 
       " ", "type", " ", "of", " ", "equivalent", " ", "reflections"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToStandardSetting", "[", 
         RowBox[{"sgHM", ",", "#"}], "]"}], "&"}], "/@", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(", 
        RowBox[{"First", "/@", 
         RowBox[{"First", "/@", "gathered"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"hkl", "=", 
      RowBox[{"ToMiller", "/@", "temp"}]}], ";", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Merging", " ", "the", " ", "representatives", " ", "with", " ", "the", 
       " ", "corresponding", " ", "values"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"values", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "\[IndentingNewLine]", "\t", 
        RowBox[{"hkl", ",", 
         RowBox[{"wmean", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"wmean", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Length", "/@", "gathered"}], ",", "range", ",", "span"}], 
        "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Sorting", " ", "option"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"sort", "=", 
      RowBox[{"OptionValue", "[", "\"\<Sort\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"No", " ", "preferance"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"Range", "@", 
           RowBox[{"Last", "@", 
            RowBox[{"Dimensions", "@", "values"}]}]}], ",", 
          RowBox[{"Abs", "@", "sort"}]}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<SortingDone\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Sorting", " ", "by", " ", "a", " ", "specific", " ", "column"}], " ", 
      "*)"}], "\t\t\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"values", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"values", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", 
            RowBox[{"Abs", "@", "sort"}], "]"}], "]"}], "<", 
          RowBox[{"#2", "[", 
           RowBox[{"[", 
            RowBox[{"Abs", "@", "sort"}], "]"}], "]"}]}], "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Reversing", " ", "if", " ", "negative"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sort", "<", "0"}], ",", 
       RowBox[{"values", "=", 
        RowBox[{"Reverse", "@", "values"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Rounding", " ", "off", " ", "numbers", 
       " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<SortingDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"NumberForm", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"DigitBlock", "\[Rule]", "3"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"NumberSeparator", "\[Rule]", "\"\<,\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"NumberPoint", "\[Rule]", "\"\<\>\""}]}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"Flatten", "@", "values"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"values", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"Last", "@", 
         RowBox[{"Dimensions", "@", "values"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Inserting", " ", "percentage", " ", "signs", " ", "to", " ", 
       RowBox[{"the", " ", "'"}], "relative", " ", 
       RowBox[{"span", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"values", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "6"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<%\>\""}], "&"}], "/@", 
       RowBox[{"values", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "6"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Table", " ", "construction", " ", "*", 
       
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"table", "=", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"values", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
         "\"\<(hkl)\>\"", ",", "\"\<[counts]\>\"", ",", "\"\<[counts]\>\"", 
          ",", "Null", ",", "\"\<(min; max)\>\"", ",", 
          "\"\<from middle\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"table", "=", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"table", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
         "Null", ",", "\"\<Intensity\>\"", ",", "\"\<Uncertainty\>\"", ",", 
          "\"\<Tally\>\"", ",", "\"\<Range\>\"", ",", 
          "\"\<Relative span\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Grid", "[", 
      RowBox[{"table", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Dividers", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"{", "True", "}"}], ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"None", ",", "None", ",", "True"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Background", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "None", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"GrayLevel", "[", "0.90", "]"}]}], "}"}]}], "}"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Alignment", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1.5", ",", 
          RowBox[{"2", "\[Rule]", "0.25"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"ItemStyle", "\[Rule]", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
         "Automatic", ",", "\[IndentingNewLine]", "\t", "Automatic", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"Last", "@", 
                  RowBox[{"Dimensions", "@", "values"}]}]}], "}"}]}], "}"}], 
             "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}], 
               ",", 
               RowBox[{"FontSize", "\[Rule]", "15"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"Last", "@", 
                  RowBox[{"Dimensions", "@", "values"}]}]}], "}"}]}], "}"}], 
             "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}], 
               ",", 
               RowBox[{"FontSize", "\[Rule]", "13"}], ",", "Gray"}], "}"}]}], 
            ",", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"3", ",", 
                 RowBox[{"Length", "@", "table"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "6"}], "}"}]}], "}"}], "\[Rule]", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Courier\>\""}]}]}], 
           "\[IndentingNewLine]", "\t", "}"}]}], "\[IndentingNewLine]", "\t", 
         "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.6678179776799517`*^9, {3.668180041909956*^9, 
   3.66818006829044*^9}, 3.668244081243107*^9, {3.6747521337060423`*^9, 
   3.6747521381469088`*^9}, 3.6747544474543667`*^9, {3.6747547341025133`*^9, 
   3.674754736781383*^9}, {3.6747547840013933`*^9, 3.674754796748868*^9}, {
   3.6747548706832523`*^9, 3.6747549227776203`*^9}, {3.674755158711894*^9, 
   3.67475518337843*^9}, 3.67475523506689*^9, {3.6747625583682632`*^9, 
   3.674762560438879*^9}, {3.674762668534231*^9, 3.674762724258876*^9}, {
   3.674762776690702*^9, 3.6747627893869343`*^9}, {3.67476289932897*^9, 
   3.674762916711329*^9}, {3.674762976838047*^9, 3.674762978933086*^9}, {
   3.681669128273329*^9, 3.6816691313995447`*^9}, {3.713515882282662*^9, 
   3.713515903417301*^9}, {3.7135159519153023`*^9, 3.713515955161378*^9}, {
   3.713516709287328*^9, 3.71351673845008*^9}, {3.713516933028019*^9, 
   3.7135169660016108`*^9}, {3.713517017669434*^9, 3.713517018982033*^9}, {
   3.713517263386682*^9, 3.71351726667832*^9}, {3.7135173002826567`*^9, 
   3.71351738309219*^9}, {3.713517437385408*^9, 3.713517448431707*^9}, 
   3.71351751120065*^9, {3.713519165139821*^9, 3.71351916784344*^9}, {
   3.713586548928996*^9, 3.7135866361444187`*^9}, 3.713586704798615*^9, {
   3.713586788881996*^9, 3.713586820426944*^9}, {3.713587867817526*^9, 
   3.713587888031878*^9}, 3.7135879275442047`*^9, {3.71358837140742*^9, 
   3.713588406943164*^9}, {3.71358911226116*^9, 3.713589138698991*^9}, {
   3.7135892493929453`*^9, 3.713589255479849*^9}, {3.713589419908753*^9, 
   3.7135894361407757`*^9}, {3.713591206266412*^9, 3.713591262265044*^9}, {
   3.713591311703704*^9, 3.713591312355399*^9}, {3.713613028472899*^9, 
   3.713613169102304*^9}, {3.713613243701432*^9, 3.713613259482008*^9}, {
   3.7136134658455133`*^9, 3.71361347101232*^9}, {3.713613506269532*^9, 
   3.7136135334279203`*^9}, {3.713613827277714*^9, 3.713613866139351*^9}, {
   3.713614136073141*^9, 3.713614177159155*^9}, {3.713614258661078*^9, 
   3.713614274994151*^9}, {3.713614316339431*^9, 3.713614326119635*^9}, {
   3.71361439324091*^9, 3.7136144643350143`*^9}, {3.7136145003750763`*^9, 
   3.713614503798221*^9}, {3.7136147414828243`*^9, 3.713614745759801*^9}, {
   3.713614995996611*^9, 3.713615019234371*^9}, {3.713615083913261*^9, 
   3.7136151064954023`*^9}, {3.7136153341477337`*^9, 
   3.7136153765300913`*^9}, {3.713615519671282*^9, 3.713615523343231*^9}, {
   3.7136155809755487`*^9, 3.713615584269882*^9}, {3.713615772226592*^9, 
   3.713615842588029*^9}, {3.7136158828091288`*^9, 3.7136159083334837`*^9}, {
   3.713615957094849*^9, 3.7136161148888617`*^9}, {3.713616180915184*^9, 
   3.71361619492793*^9}, {3.713616680016246*^9, 3.713616685772635*^9}, {
   3.713617209482376*^9, 3.7136172119303007`*^9}, {3.71361728481925*^9, 
   3.713617298053862*^9}, {3.7136178702702703`*^9, 3.7136180045372763`*^9}, {
   3.713618113832099*^9, 3.7136181174282923`*^9}, {3.713618212238364*^9, 
   3.713618213691772*^9}, {3.71361828705192*^9, 3.71361829257969*^9}, {
   3.7136201073484993`*^9, 3.7136203811004467`*^9}, {3.713620413388191*^9, 
   3.7136204702096043`*^9}, {3.71362050162772*^9, 3.713620526449724*^9}, {
   3.7136205606735992`*^9, 3.713620607502698*^9}, {3.7136206499531107`*^9, 
   3.7136206591678457`*^9}, {3.7136207070545177`*^9, 3.713620723219816*^9}, {
   3.7136207891556263`*^9, 3.713620813532362*^9}, {3.7136208515620737`*^9, 
   3.713620855544623*^9}, {3.713620902347073*^9, 3.713620974977251*^9}, {
   3.7136211597710648`*^9, 3.713621161459248*^9}, 3.713621207851184*^9, {
   3.713621339095902*^9, 3.713621372532834*^9}, {3.713621417981744*^9, 
   3.7136216461331244`*^9}, {3.713621695791157*^9, 3.713621709511959*^9}, {
   3.713621812094284*^9, 3.713621920223949*^9}, {3.713621957249928*^9, 
   3.713621961446721*^9}, {3.713622007048894*^9, 3.713622011159752*^9}, {
   3.713757819753793*^9, 3.7137578215678596`*^9}, {3.7137578864948807`*^9, 
   3.7137579084856043`*^9}, {3.7177408971545553`*^9, 3.717740915557084*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[219]:=",ExpressionUUID->"638d2a72-b58f-4a7d-9b57-119c87ec7011"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[220]:=",ExpressionUUID->"075394b5-4d49-4717-b6fd-d16f1b704e2c"]
}, Closed]],

Cell[CellGroupData[{

Cell["MergeLogs", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667818770448368*^9, {3.685944630313244*^9, 
   3.6859446311620817`*^9}},ExpressionUUID->"9d33350d-47b1-461d-8fba-\
ccef7867b6be"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[221]:=",ExpressionUUID->"14e7319b-b2fd-4d3a-bbb3-f468c006f4c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MergeLogs", "::", "failed"}], "=", 
   "\"\<Failed to interpret input. No log files with the prefix \
\[LeftGuillemet]crysalispro_red\[RightGuillemet] were found in \
\[LeftGuillemet]`1`\[RightGuillemet].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MergeLogs", "::", "files"}], "=", 
   "\"\<One or more log files were missing.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.667818785593197*^9, 3.66792282527605*^9, {
   3.685944764419455*^9, 3.685944765279242*^9}, {3.712639959020924*^9, 
   3.712639959289299*^9}, {3.71264125203446*^9, 3.712641257472536*^9}, {
   3.7126413551997232`*^9, 3.7126413952217503`*^9}, {3.7126426295378447`*^9, 
   3.7126426428572206`*^9}, {3.7126461213488073`*^9, 3.712646124859322*^9}, {
   3.71264627163409*^9, 3.712646273688037*^9}, {3.71264732284953*^9, 
   3.712647338615885*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"927be788-9173-4973-8d48-731dcb8fee5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[224]:=",ExpressionUUID->"0ea00e5f-03c5-41c4-b110-bc29f235d719"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MergeLogs", "[", 
   RowBox[{
    RowBox[{"input_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"StringQ", "[", "#", "]"}], "||", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"#", ",", "StringQ"}], "]"}]}], "&"}], ")"}]}], ",", 
    RowBox[{"out_:", "\"\< \>\""}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "logs", ",", "sorted", ",", "imported", ",", "joined", ",", "output", 
      ",", "name", ",", "file"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Processing", " ", "input", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"A", ".", " ", "Already"}], " ", "merged", " ", "log", " ", 
      "given"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Quiet", "@", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"input", ",", "27"}], "]"}], "\[Equal]", 
         "\"\<Your current setup file is:\>\""}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"Return", "@", "input"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"B", ".", " ", "Project"}], " ", "or", " ", "log", " ", 
       "directory", " ", "given"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Quiet", "@", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DirectoryQ", "@", "input"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"logs", "=", 
          RowBox[{"FileNames", "[", 
           RowBox[{"\"\<crysalispro_red*\>\"", ",", "input", ",", "3"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Goto", "[", "\"\<InputCheck\>\"", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"C", ".", " ", "Single"}], " ", "log", " ", "file", " ", 
       "given"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{
         RowBox[{"FileFormat", "[", "input", "]"}], "\[Equal]", 
         "\"\<Text\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", 
        RowBox[{"Import", "[", 
         RowBox[{"input", ",", "\"\<String\>\""}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"D", ".", " ", "Log"}], " ", "files", " ", "given", " ", "as", 
       " ", "a", " ", "list", " ", "of", " ", "paths"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "@", "input"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", "file", " ", "existence"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AllTrue", "[", 
            RowBox[{"input", ",", "FileExistsQ"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"MergeLogs", "::", "files"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"logs", "=", "input"}]}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Label", "[", "\"\<InputCheck\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"logs", "\[Equal]", 
         RowBox[{"{", "}"}]}], "||", 
        RowBox[{"!", 
         RowBox[{"ValueQ", "@", "logs"}]}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"MergeLogs", "::", "failed"}], ",", "input"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", 
        RowBox[{
        "Only", " ", "one", " ", "matching", " ", "log", " ", "file"}]}]}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "logs", "]"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"joined", "=", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"First", "@", "logs"}], ",", "\"\<Data\>\""}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "joined", "]"}], ">", "2"}], ",", 
          RowBox[{"joined", "=", 
           RowBox[{"Flatten", "@", "joined"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Goto", "[", "\"\<MergingDone\>\"", "]"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Sorting", " ", "chronologically", " ", 
       "and", " ", "merging", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"sorted", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{"logs", ",", 
        RowBox[{
         RowBox[{"UnixTime", "@", 
          RowBox[{"FileDate", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"imported", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Flatten", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"#", ",", "\"\<Data\>\""}], "]"}], "&"}], "/@", 
         "sorted"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"joined", "=", 
      RowBox[{"imported", "/.", 
       RowBox[{
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"Depth", "[", "x", "]"}], ">", "2"}]}], "\[RuleDelayed]", 
        RowBox[{"Flatten", "[", "x", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Returning", " ", "merged", " ", "log", 
       " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<MergingDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"A", ".", " ", "Exporting"}], " ", "to", " ", "output", " ", 
        "directory"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"Quiet", "@", 
        RowBox[{"AllTrue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"input", ",", 
            RowBox[{"ToString", "@", "out"}]}], "}"}], ",", "DirectoryQ"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"name", "=", 
         RowBox[{
          RowBox[{"FileNameTake", "[", 
           RowBox[{"input", ",", 
            RowBox[{"{", 
             RowBox[{"-", "2"}], "}"}]}], "]"}], "<>", "\"\<_log.txt\>\""}]}],
         ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"out", ",", "name"}], "}"}], "]"}], ",", "joined"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"B", ".", " ", "Returning"}], " ", "merged", " ", "log"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", "True", ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"output", "=", 
         RowBox[{"ToString", "/@", "joined"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Export", " ", "and", " ", "import", " ", "for", " ", "correct", " ",
           "formatting"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"file", "=", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"$TemporaryDirectory", ",", "\"\<temp.txt\>\""}], "}"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Export", "[", 
         RowBox[{"file", ",", "output"}], "]"}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"Import", "[", 
         RowBox[{"file", ",", "\"\<String\>\""}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.6678187804252996`*^9, {3.667914236945704*^9, 
   3.6679143285922613`*^9}, {3.6679225871709967`*^9, 3.667922617944098*^9}, {
   3.667922762030367*^9, 3.667922832155384*^9}, {3.667924619580389*^9, 
   3.667924621540043*^9}, {3.669556409378379*^9, 3.669556409721177*^9}, {
   3.674595330792635*^9, 3.674595335064242*^9}, {3.674596922722081*^9, 
   3.6745969236420517`*^9}, 3.674597782774687*^9, 3.674597913131309*^9, {
   3.674597951393291*^9, 3.674597980002778*^9}, {3.674598016648612*^9, 
   3.6745980930859833`*^9}, 3.67459817130089*^9, {3.6745982016044073`*^9, 
   3.674598228594613*^9}, {3.685876198759145*^9, 3.6858761989090347`*^9}, {
   3.6859447352677507`*^9, 3.685944738860939*^9}, {3.685945047525332*^9, 
   3.6859450602222958`*^9}, {3.685945151707117*^9, 3.685945239776497*^9}, {
   3.685945309792897*^9, 3.685945314249278*^9}, {3.6859453950851307`*^9, 
   3.685945409800962*^9}, {3.685945459892754*^9, 3.685945526695649*^9}, {
   3.6859455887011213`*^9, 3.6859455888440037`*^9}, {3.685945620191126*^9, 
   3.685945639869965*^9}, {3.6859457670160522`*^9, 3.68594581333556*^9}, {
   3.685945844409431*^9, 3.685945848541841*^9}, {3.7126397763097067`*^9, 
   3.712639798874113*^9}, {3.712639923831069*^9, 3.7126399271352243`*^9}, {
   3.712639995517703*^9, 3.712639995741643*^9}, {3.712640079300881*^9, 
   3.7126400795076113`*^9}, {3.7126407836697598`*^9, 3.712640798220117*^9}, {
   3.71264083565385*^9, 3.712640850213189*^9}, {3.712641040712243*^9, 
   3.71264104467061*^9}, {3.712641085983047*^9, 3.712641163652363*^9}, {
   3.712641213220591*^9, 3.712641233715104*^9}, {3.712641399480689*^9, 
   3.71264141728011*^9}, {3.712641588724821*^9, 3.712641700761346*^9}, {
   3.712642620557871*^9, 3.712642653003079*^9}, {3.712642872407312*^9, 
   3.7126428912536917`*^9}, {3.712643935918606*^9, 3.712643950237338*^9}, {
   3.712644043213313*^9, 3.7126440438155622`*^9}, {3.712644078219646*^9, 
   3.712644086363275*^9}, {3.712644373477325*^9, 3.712644418956834*^9}, {
   3.712644471538918*^9, 3.712644681597015*^9}, {3.712645316568478*^9, 
   3.712645318670971*^9}, {3.712646033976853*^9, 3.712646038015174*^9}, {
   3.7126461326298037`*^9, 3.712646133996862*^9}, {3.712646292059218*^9, 
   3.712646304737474*^9}, {3.712646348811199*^9, 3.712646352225185*^9}, {
   3.7126467051384773`*^9, 3.712646706815776*^9}, {3.712646753016305*^9, 
   3.712646755061678*^9}, {3.712646791368539*^9, 3.712646799877905*^9}, 
   3.712646864350336*^9, {3.712646937692761*^9, 3.712647128616267*^9}, {
   3.712647176223422*^9, 3.712647179981093*^9}, {3.7126472179747667`*^9, 
   3.7126473172420263`*^9}, {3.712647357370229*^9, 3.712647387144503*^9}, {
   3.712647494095216*^9, 3.712647494245845*^9}, {3.712647537247559*^9, 
   3.7126475430373697`*^9}, {3.712647574029471*^9, 3.712647613755066*^9}, {
   3.712647649868638*^9, 3.71264767056256*^9}, 3.71264793780542*^9, {
   3.7126480083793507`*^9, 3.712648009835347*^9}, {3.712648797563335*^9, 
   3.712648814184557*^9}, {3.712648854880533*^9, 3.7126488595191097`*^9}, {
   3.712649076532634*^9, 3.712649076731003*^9}, {3.713687341011962*^9, 
   3.713687391108676*^9}, {3.7136874988963633`*^9, 3.713687675011414*^9}, {
   3.713687802017467*^9, 3.7136878467191687`*^9}, {3.7136879550375357`*^9, 
   3.7136880624685*^9}, {3.71368812284603*^9, 3.713688132840229*^9}, 
   3.713688185793482*^9, {3.713688281799802*^9, 3.713688308786852*^9}, {
   3.713688600664522*^9, 3.713688821361224*^9}, {3.713688854281848*^9, 
   3.713688892111027*^9}, {3.713688933910858*^9, 3.7136890250904827`*^9}, {
   3.718432663381671*^9, 3.718432665671525*^9}, {3.7184327201814632`*^9, 
   3.71843274251434*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[225]:=",ExpressionUUID->"cc51c18b-a55f-4500-ad28-b5397e609971"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[226]:=",ExpressionUUID->"753b6640-683f-4d8b-b37e-29314f731568"]
}, Closed]],

Cell[CellGroupData[{

Cell["MonitorIni", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 
   3.6678184015847597`*^9},ExpressionUUID->"b94621d0-6abe-4017-88a4-\
e922b74f41c2"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[227]:=",ExpressionUUID->"a5eaf5c2-36e4-41cd-8c8c-5a90463d6966"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MonitorIni", "::", "InvInput"}], "=", 
   "\"\<The length og the custom input does not match that of the \
\!\(\*StyleBox[\".\", \"Program\"]\)\!\(\*StyleBox[\"ini\", \"Program\"]\) \
file (or invalid range).\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MonitorIni", "::", "InvFlux"}], "=", 
   "\"\<The flux file does not match the (length) of data.\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.667811591227736*^9, 3.667818408776988*^9},
 CellLabel->
  "In[228]:=",ExpressionUUID->"23863b24-6390-47ab-8f7a-d06e0ff5d71e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[230]:=",ExpressionUUID->"efc7281b-ee92-4798-9e85-ece211e89c35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MonitorIni", "[", 
   RowBox[{
    RowBox[{"file_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"FileExtension", "[", "#", "]"}], "\[Equal]", "\"\<ini\>\""}],
        "&"}], ")"}]}], ",", "input_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "flux", ",", "Flux", ",", "linFrom", ",", "linTo", ",", "method", ",", 
      "import", ",", "end", ",", "prefix", ",", "L", ",", "seq", ",", 
      "newvalues", ",", "i", ",", "newdata", ",", "filename"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Basic", " ", "operations"}], " ", "*)"}], "\[IndentingNewLine]",
     "\t", 
    RowBox[{
     RowBox[{"import", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"Import", "@", "file"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"end", "=", 
      RowBox[{"StringExtract", "[", 
       RowBox[{
        RowBox[{"import", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"\"\<_\>\"", "\[Rule]", 
         RowBox[{"-", "1"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"prefix", "=", 
      RowBox[{"StringTrim", "[", 
       RowBox[{
        RowBox[{"import", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "end"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"L", "=", 
      RowBox[{
       RowBox[{"Length", "@", "import"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"seq", "=", 
      RowBox[{"ToString", "/@", 
       RowBox[{"Range", "@", "L"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Checking", " ", "if", " ", "input", " ", "is", " ", "a", " ", "flux", 
       " ", "file"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "@", 
         RowBox[{"Head", "[", "input", "]"}]}], "\[Equal]", 
        "\"\<String\>\""}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"flux", "=", 
         RowBox[{"Check", "[", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"input", ",", "\"\<Data\>\""}], "]"}], ",", 
           RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"Flux", "=", 
         RowBox[{"Rest", "@", "flux"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "flux", "]"}], "\[Equal]", 
           RowBox[{"{", "\"\<Flux\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{
           RowBox[{"newvalues", "=", 
            RowBox[{"ToString", "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Flatten", "[", "Flux", "]"}], "/", 
               RowBox[{"N", "[", 
                RowBox[{"Max", "[", "Flux", "]"}], "]"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Checking", " ", "if", " ", "the", " ", "flux", " ", "file", " ", 
             "is", " ", "correct"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "newvalues"}], "\[NotEqual]", "L"}], ",", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{"MonitorIni", "::", "InvFlux"}], "]"}], ";", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Goto", "[", "\"\<ToNewData\>\"", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Checking", " ", "input", " ", "for", " ", "method"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"method", "=", "\"\<LinearDecay\>\""}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Flatten", "@", "input"}]}], "\[Equal]", "2"}], ",", 
       RowBox[{
        RowBox[{"linFrom", "=", 
         RowBox[{"input", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"linTo", "=", 
         RowBox[{"input", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"method", "=", "\"\<CustomInput\>\""}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Writing", " ", "new", " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"method", "\[Equal]", "\"\<CustomInput\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"newvalues", "=", 
         RowBox[{"ToString", "/@", "input"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Checking", " ", "the", " ", "custom", " ", "input"}], " ", 
         "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "newvalues"}], "\[NotEqual]", "L"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"MonitorIni", "::", "InvInput"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"newvalues", "=", 
        RowBox[{"ToString", "/@", 
         RowBox[{"Reverse", "@", 
          RowBox[{"Check", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "linTo", ",", "linFrom", ",", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"linFrom", "-", "linTo"}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"L", "-", "1"}], ")"}]}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Abort", "[", "]"}]}], "]"}]}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<ToNewData\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"newdata", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"prefix", "<>", "#1", "<>", "\"\<.img=\>\"", "<>", "#2"}], 
         "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"seq", ",", "newvalues"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"newdata", ",", "\"\<[Monitor]\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Writing", " ", "new", " ", "file"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"filename", "=", 
      RowBox[{"StringDrop", "[", 
       RowBox[{"file", ",", 
        RowBox[{"-", "4"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"filename", "<>", "\"\<_new\>\"", "<>", "\"\<.ini\>\""}], ",", 
       "newdata", ",", "\"\<Table\>\""}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667818417586022*^9, {3.713776593189336*^9, 
   3.71377659553338*^9}, {3.713776860849901*^9, 3.7137768669605627`*^9}, {
   3.713776904401009*^9, 3.713776914127028*^9}, {3.7137769733727493`*^9, 
   3.713776996197693*^9}, {3.713777056188547*^9, 3.713777085817994*^9}, {
   3.713777148209811*^9, 3.713777150296506*^9}, {3.7137786545976257`*^9, 
   3.713778662947815*^9}, {3.713779115098048*^9, 3.71377914280836*^9}, {
   3.713779308534072*^9, 3.713779311801156*^9}, {3.713779374108143*^9, 
   3.713779381044965*^9}, {3.7137806625823307`*^9, 3.713780666756604*^9}, {
   3.713780727077208*^9, 3.713780727605567*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[231]:=",ExpressionUUID->"886b4b1e-4367-460b-94fc-7c0b5d8f9797"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[232]:=",ExpressionUUID->"6e25b713-5087-4f31-80a3-aae947207983"]
}, Closed]],

Cell[CellGroupData[{

Cell["NonlinearLeastSquares", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.684646660758275*^9, 
   3.684646660811885*^9}, {3.684679409191053*^9, 3.684679411222722*^9}, {
   3.6846811176191063`*^9, 3.684681119497213*^9}, {3.6846813101581917`*^9, 
   3.6846813119644547`*^9}, 
   3.687761445243544*^9},ExpressionUUID->"40a83651-223f-4c00-8dba-\
5817bf6e2b8d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[233]:=",ExpressionUUID->"9c3362de-47c4-4d14-85b1-a1bba4ffb688"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NonlinearLeastSquares", "::", "check"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a recognised check \
method.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NonlinearLeastSquares", "::", "stop"}], "=", 
    "\"\<Procedure stopped at iteration `1`.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "NonlinearLeastSquares"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<ConvergenceCheck\>\"", "\[Rule]", "\"\<Shift\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ConvergenceLimit\>\"", "\[Rule]", "0.0001"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<IterationStop\>\"", "\[Rule]", "10"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Iterations\>\"", "\[Rule]", "False"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.684681427747033*^9, 3.68468144428977*^9}, {
   3.684681710622183*^9, 3.6846817431468554`*^9}, {3.687761446820731*^9, 
   3.687761502760914*^9}, 3.687761926389079*^9, {3.68776236079217*^9, 
   3.687762389067876*^9}, {3.687762697699806*^9, 3.687762706247756*^9}, {
   3.687762756949634*^9, 3.687762809748589*^9}, {3.687762960159795*^9, 
   3.687762975932385*^9}, 3.687766642526452*^9, {3.687775566640523*^9, 
   3.687775587435358*^9}, {3.6877756191282797`*^9, 3.687775619322447*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[234]:=",ExpressionUUID->"31cb6be3-296d-4b79-85af-33ae5e622e0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[237]:=",ExpressionUUID->"189e71a9-a784-427e-81aa-3fb2ebfa6d87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NonlinearLeastSquares", "[", 
   RowBox[{"f_Symbol", ",", "data_List", ",", "\[Beta]_List", ",", 
    RowBox[{"OptionsPattern", "@", "NonlinearLeastSquares"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "X", ",", "m", ",", "v", ",", "n", ",", "\[IndentingNewLine]", "dummyV", 
      ",", "dummy\[Beta]", ",", "\[IndentingNewLine]", "p", ",", "i", ",", 
      "\[CapitalDelta]", ",", "R", ",", "\[IndentingNewLine]", "c", ",", "l", 
      ",", "stop", ",", "test", ",", "\[IndentingNewLine]", "j", ",", 
      "subst\[Beta]", ",", "substV", ",", "J", ",", "\[IndentingNewLine]", 
      "S", ",", "S0"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Number", " ", "of", " ", "data", " ", "variables"}], ",", " ", 
      
      RowBox[{
      "unknown", " ", "parameters", " ", "and", " ", "data", " ", 
       "points"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X", "=", 
      RowBox[{"Transpose", "@", "data"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"Length", "@", "X"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "@", "\[Beta]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dummy", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dummyV", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Unique", "[", "\"\<dummyV\>\"", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "v"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dummy\[Beta]", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Unique", "[", "\"\<dummy\[Beta]\>\"", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Initial", " ", "setting", " ", "of", " ", "parameters", " ", "and", 
       " ", "partial", " ", "derivatives"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"p", "=", "\[Beta]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"{", "0", "}"}]}], ";", 
     RowBox[{"S", "=", "1000"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"Initial", " ", "sum", " ", "of", " ", "squares"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]", "=", "1000"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"Inital", " ", "shift", " ", "in", " ", "parameters"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"i", "=", "0"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"Iteration", " ", "count"}], " ", "*)"}], "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Convergence", " ", "check", " ", "method", " ", "and", " ", "limit"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"OptionValue", "[", "\"\<ConvergenceCheck\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"l", "=", 
      RowBox[{"OptionValue", "[", "\"\<ConvergenceLimit\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stop", "=", 
      RowBox[{"OptionValue", "[", "\"\<IterationStop\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "\[Equal]", "\"\<Shift\>\""}], ",", 
       RowBox[{"test", ":=", "\[CapitalDelta]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"c", "\[Equal]", "\"\<Squares\>\""}], ",", 
       RowBox[{"test", ":=", "S"}], ",", "\[IndentingNewLine]", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"NonlinearLeastSquares", "::", "check"}], ",", "c"}], "]"}],
         ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "Iteration", " ", "start"}], " ", "**)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"test", ">", "l"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "++"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"dummyV", ",", 
               RowBox[{"dummy\[Beta]", "/.", 
                RowBox[{"List", "\[Rule]", "Sequence"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"dummy\[Beta]", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Substituting", " ", "in", " ", "parameter", " ", "values"}],
          " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"subst\[Beta]", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"dummy\[Beta]", "\[Rule]", "p"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"j", "/.", "subst\[Beta]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Preparing", " ", "list", " ", "of", " ", "data", " ", "points"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"substV", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"dummyV", "\[Rule]", 
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "m"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Jacobian", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"J", "=", 
         RowBox[{"N", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"j", "/.", 
             RowBox[{"substV", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "m"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Sum", " ", "of", " ", "squares", " ", 
          RowBox[{"(", 
           RowBox[{
           "and", " ", "difference", " ", "from", " ", "last", " ", 
            "iteration"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"S0", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"R", "^", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"N", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"p", "/.", 
               RowBox[{"List", "\[Rule]", "Sequence"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "m"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"S", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"R", "^", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"New", " ", "parameters"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{"p", "-", 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "J", "]"}], ".", "J"}], "]"}], ".", 
           RowBox[{"Transpose", "[", "J", "]"}], ".", "R"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"S0", "-", "S"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Stop", "?"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "stop"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"NonlinearLeastSquares", "::", "stop"}], ",", "i"}], 
            "]"}], ";", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Iterations\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "p"}], "}"}], ",", "p"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6877299705538063`*^9, 3.68773000320055*^9}, {
   3.6877300916315937`*^9, 3.6877300993355083`*^9}, {3.687730218420662*^9, 
   3.687730223475299*^9}, {3.687730302882559*^9, 3.687730342280218*^9}, {
   3.6877304230864973`*^9, 3.6877304594219503`*^9}, {3.687730576666823*^9, 
   3.687730592179576*^9}, 3.687730653305067*^9, {3.687730693897223*^9, 
   3.687730716311364*^9}, {3.687730835564534*^9, 3.6877308417323713`*^9}, {
   3.687731150484981*^9, 3.6877311872758827`*^9}, {3.687731262593848*^9, 
   3.687731269569866*^9}, 3.687754560721229*^9, {3.687754625245038*^9, 
   3.687754647436564*^9}, {3.687754830597731*^9, 3.6877549272317953`*^9}, {
   3.68775499009557*^9, 3.687754995460417*^9}, {3.687755050034011*^9, 
   3.687755075347661*^9}, {3.687755222867353*^9, 3.687755225420813*^9}, {
   3.6877553105338163`*^9, 3.687755332408998*^9}, {3.6877554031616383`*^9, 
   3.687755466785995*^9}, {3.6877556396342697`*^9, 3.687755668011639*^9}, {
   3.68775596856956*^9, 3.687756064446072*^9}, {3.687756140913396*^9, 
   3.68775615753561*^9}, {3.6877562842374487`*^9, 3.6877564113833857`*^9}, {
   3.687756450288632*^9, 3.687756458484619*^9}, {3.6877565303968782`*^9, 
   3.6877566353257427`*^9}, {3.687756670496087*^9, 3.68775667093337*^9}, {
   3.6877567210139*^9, 3.687756728991193*^9}, {3.687757043067391*^9, 
   3.687757172182516*^9}, {3.687757329481772*^9, 3.687757351653824*^9}, {
   3.687757472895069*^9, 3.687757477167718*^9}, {3.6877575241306963`*^9, 
   3.6877575656192703`*^9}, {3.687757624760798*^9, 3.6877576250208693`*^9}, {
   3.687757747169722*^9, 3.6877577945248537`*^9}, {3.687757824607378*^9, 
   3.687757906406055*^9}, {3.687757937222622*^9, 3.687758118086667*^9}, {
   3.687758185236473*^9, 3.687758186733927*^9}, {3.687758260018261*^9, 
   3.6877583185397987`*^9}, {3.6877585630545607`*^9, 3.687758564521287*^9}, {
   3.687758658977665*^9, 3.687758763158144*^9}, {3.687758800067567*^9, 
   3.68775880072235*^9}, {3.6877588346832857`*^9, 3.687759351187215*^9}, {
   3.687759390213161*^9, 3.6877595793632298`*^9}, {3.6877596354426126`*^9, 
   3.687759916271471*^9}, {3.6877600283114023`*^9, 3.687760049295339*^9}, {
   3.687760091029286*^9, 3.687760101209504*^9}, {3.687760147058825*^9, 
   3.687760170046665*^9}, {3.6877605607419577`*^9, 3.687760582960415*^9}, {
   3.6877606515704927`*^9, 3.687760666066464*^9}, {3.687760710144994*^9, 
   3.687760714886258*^9}, {3.687760746917014*^9, 3.687760792598665*^9}, {
   3.687760824887515*^9, 3.6877608616672907`*^9}, {3.6877609090005627`*^9, 
   3.6877609119436073`*^9}, {3.687760967227778*^9, 3.687760968780664*^9}, {
   3.687761170147029*^9, 3.687761183820777*^9}, {3.6877612175926313`*^9, 
   3.687761252846713*^9}, {3.687761320243919*^9, 3.687761412149925*^9}, {
   3.6877617343564587`*^9, 3.687761788403249*^9}, {3.687761823319521*^9, 
   3.687761923520043*^9}, {3.687761966723089*^9, 3.6877620367012463`*^9}, {
   3.687762073500799*^9, 3.687762080504332*^9}, {3.687762127722169*^9, 
   3.687762133043429*^9}, {3.687762197962512*^9, 3.6877622470184917`*^9}, {
   3.687762311936281*^9, 3.6877623443704243`*^9}, {3.687762397409442*^9, 
   3.687762410261115*^9}, {3.687762474086087*^9, 3.687762500787753*^9}, {
   3.687762611880907*^9, 3.687762662679175*^9}, {3.687762721076819*^9, 
   3.687762751345072*^9}, {3.6877628219456*^9, 3.6877628607798643`*^9}, {
   3.6877629829550543`*^9, 3.687762998000442*^9}, {3.6877681413368196`*^9, 
   3.687768152347498*^9}, {3.687768192649106*^9, 3.687768233921425*^9}, {
   3.687768264159709*^9, 3.687768536873348*^9}, {3.6877707864574013`*^9, 
   3.687771039267853*^9}, {3.687771069812886*^9, 3.687771197409918*^9}, {
   3.6877713175346127`*^9, 3.687771345093755*^9}, {3.687771542202924*^9, 
   3.687771551308329*^9}, 3.687771581473814*^9, {3.687771777800501*^9, 
   3.687771794268906*^9}, {3.6877718335278883`*^9, 3.6877718356566*^9}, {
   3.687771871528183*^9, 3.6877718835116*^9}, {3.687771931984746*^9, 
   3.6877719823496017`*^9}, {3.6877751977629337`*^9, 3.687775374753765*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[238]:=",ExpressionUUID->"d22aa2e1-6f53-4d31-aeeb-8a976dd994d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[239]:=",ExpressionUUID->"1c351972-761d-478d-ae2a-8da7c68ef326"]
}, Closed]],

Cell[CellGroupData[{

Cell["LeastSquaresFit", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.684646660758275*^9, 
   3.684646660811885*^9}, {3.684679409191053*^9, 3.684679411222722*^9}, {
   3.6846811176191063`*^9, 3.684681119497213*^9}, {3.6846813101581917`*^9, 
   3.6846813119644547`*^9}, {3.6846922186695633`*^9, 3.68469222103603*^9}, 
   3.6847357008667507`*^9},ExpressionUUID->"c080b693-1415-4e12-ad21-\
98ca6f310069"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[240]:=",ExpressionUUID->"ac3ba12c-ce0f-483a-8bd7-1773df80064d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LeastSquaresFit", "::", "numeric"}], "=", 
   "\"\<Numeric input only.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeastSquaresFit", "::", "invalid"}], "=", 
   "\"\<Invalid input form.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeastSquaresFit", "::", "data"}], "=", 
   "\"\<More data required.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[241]:=",ExpressionUUID->"6c6d91fb-134f-478a-b97e-1ee4ef8c17dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[244]:=",ExpressionUUID->"07ae68d6-d917-491a-88fc-8f9453463699"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LeastSquaresFit", "[", "data_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "n", ",", "x", ",", "y", ",", "X", ",", "Y", ",", "\[IndentingNewLine]", 
      "sumx2", ",", "sumy2", ",", "sumxy", ",", "s2y", ",", 
      "\[IndentingNewLine]", "a", ",", "b", ",", "\[Delta]a", ",", 
      "\[Delta]b", ",", "r", ",", "\[IndentingNewLine]", "\[Delta]y", ",", 
      "\[CapitalDelta]", ",", "w", ",", "sumx", ",", "sumy", ",", "sumw", ",",
       "wsumx2", ",", "wsumy2", ",", "wsumxy"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Check", " ", "input", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "data"}], ",", "NumericQ"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"LeastSquaresFit", "::", "numeric"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "data", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Goto", "[", "\"\<WithoutWeights\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "data", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"Goto", "[", "\"\<WithWeights\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"LeastSquaresFit", "::", "invalid"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "data"}], "<", "3"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"LeastSquaresFit", "::", "data"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Data", " ", "without", " ", "weights", 
       " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<WithoutWeights\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Useful", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "=", 
      RowBox[{"Transpose", "@", "data"}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", "Y"}], "}"}], "=", 
      RowBox[{"Mean", "/@", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"sumx2", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "X"}], ")"}], "^", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sumy2", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", "Y"}], ")"}], "^", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sumxy", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "X"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"y", "-", "Y"}], ")"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"s2y", "=", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"n", "-", "2"}], ")"}]}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sumx2", "*", "sumy2"}], "-", 
          RowBox[{"sumxy", "^", "2"}]}], ")"}], "/", "sumx2"}]}]}], ";", "\t",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Coefficients", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"b", "=", 
      RowBox[{"sumxy", "/", "sumx2"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"a", "=", 
      RowBox[{"Y", "-", 
       RowBox[{"b", "*", "X"}]}]}], ";", "\t", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Uncertainties", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"\[Delta]a", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"s2y", "*", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"x", "^", "2"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"n", "*", "sumx2"}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]b", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"s2y", "/", "sumx2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Correlation", " ", "coefficient"}], " ", "*)"}], "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sumx2", "\[Equal]", "0"}], "||", 
        RowBox[{"sumy2", "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"r", "=", "1"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"r", "=", 
        RowBox[{"sumxy", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"sumx2", "*", "sumy2"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "\[Delta]a"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "\[Delta]b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "s2y"}], "}"}]}], "}"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Data", " ", "with", " ", "weights", 
       " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<WithWeights\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Useful", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "\[Delta]y"}], "}"}], "=", 
      RowBox[{"N", "@", 
       RowBox[{"Transpose", "@", "data"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"w", "=", 
      RowBox[{"1", "/", 
       RowBox[{"\[Delta]y", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Sum", " ", "of", " ", "weighted", " ", "lists", " ", "and", " ", 
       "weighted", " ", "means"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sumx", ",", "sumy", ",", "sumw"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"w", ".", "x"}], ",", 
        RowBox[{"w", ".", "y"}], ",", 
        RowBox[{"Total", "[", "w", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", "Y"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sumx", ",", "sumy"}], "}"}], "/", "sumw"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sumx2", ",", "sumy2", ",", "sumxy"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"w", ".", 
         RowBox[{"x", "^", "2"}]}], ",", 
        RowBox[{"w", ".", 
         RowBox[{"y", "^", "2"}]}], ",", 
        RowBox[{"Total", "[", 
         RowBox[{"w", "*", "x", "*", "y"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[CapitalDelta]", "=", 
      RowBox[{
       RowBox[{"sumw", "*", "sumx2"}], "-", 
       RowBox[{"sumx", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Coefficients", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"a", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sumx2", "*", "sumy"}], "-", 
         RowBox[{"sumx", "*", "sumxy"}]}], ")"}], "/", "\[CapitalDelta]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"b", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sumw", "*", "sumxy"}], "-", 
         RowBox[{"sumx", "*", "sumy"}]}], ")"}], "/", "\[CapitalDelta]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Uncertainties", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"wsumx2", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"w", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", "X"}], ")"}], "^", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"wsumy2", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"w", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y", "-", "Y"}], ")"}], "^", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"wsumxy", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"w", "*", 
        RowBox[{"(", 
         RowBox[{"x", "-", "X"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"y", "-", "Y"}], ")"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]a", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"sumx2", "/", "\[CapitalDelta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]b", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"sumw", "/", "\[CapitalDelta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Correclation", " ", "coefficient"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"wsumx2", "\[Equal]", "0"}], "||", 
        RowBox[{"wsumy2", "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"r", "=", "1"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"r", "=", 
        RowBox[{"wsumxy", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"wsumx2", "*", "wsumy2"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "\[Delta]a"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "\[Delta]b"}], "}"}], ",", 
        RowBox[{"{", "r", "}"}]}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.684681126098569*^9, 3.68468113261707*^9}, {
   3.684681314799778*^9, 3.684681395619067*^9}, {3.684681505457395*^9, 
   3.684681556063126*^9}, {3.6846815878074408`*^9, 3.6846818093068333`*^9}, {
   3.684685030178719*^9, 3.684685100167528*^9}, {3.68468520231924*^9, 
   3.684685234012491*^9}, {3.684685281091477*^9, 3.684685439768339*^9}, {
   3.684685587884272*^9, 3.684685671506892*^9}, {3.684685805889974*^9, 
   3.684685908701192*^9}, {3.684685949581909*^9, 3.6846861238240957`*^9}, {
   3.684688760297517*^9, 3.684688760975606*^9}, {3.6846888319429092`*^9, 
   3.684688868964966*^9}, {3.684688936172331*^9, 3.6846889580267563`*^9}, {
   3.684689140823488*^9, 3.6846892517314787`*^9}, {3.6846893353940983`*^9, 
   3.684689347937306*^9}, {3.684689397904675*^9, 3.684689398176662*^9}, {
   3.6846894450874567`*^9, 3.6846895630529423`*^9}, {3.68468959606793*^9, 
   3.684689652778881*^9}, {3.684689724177442*^9, 3.684689740865003*^9}, 
   3.684689840439896*^9, 3.6846898903814*^9, {3.684690123408786*^9, 
   3.684690167350737*^9}, {3.684690205488257*^9, 3.6846902865736523`*^9}, {
   3.684690376428082*^9, 3.684690409930132*^9}, {3.684690573246892*^9, 
   3.6846905870395203`*^9}, {3.6846906279888163`*^9, 3.684690811367805*^9}, {
   3.684690904830155*^9, 3.6846909228530283`*^9}, {3.684691045330447*^9, 
   3.684691055954417*^9}, {3.6846910934271107`*^9, 3.6846911148174763`*^9}, {
   3.6846911666652813`*^9, 3.68469121004055*^9}, {3.684692475113056*^9, 
   3.684692487392627*^9}, {3.684692532685972*^9, 3.6846925396928*^9}, {
   3.684692602549025*^9, 3.6846926751139097`*^9}, {3.6846929982919903`*^9, 
   3.6846929987940893`*^9}, {3.6846930883602467`*^9, 3.68469311500976*^9}, {
   3.684729227741404*^9, 3.684729290329463*^9}, {3.684729359290189*^9, 
   3.6847294931064453`*^9}, {3.684729524042018*^9, 3.6847296383060007`*^9}, {
   3.6847300522980328`*^9, 3.684730074275227*^9}, {3.684730181500654*^9, 
   3.684730194809558*^9}, {3.684730716661162*^9, 3.684730724551757*^9}, {
   3.684731104330513*^9, 3.684731135721141*^9}, {3.6847313994066067`*^9, 
   3.6847315632974157`*^9}, {3.684731657154348*^9, 3.684731798358251*^9}, {
   3.684731970877541*^9, 3.684731993265665*^9}, {3.684732121078611*^9, 
   3.684732341492091*^9}, {3.684732413466104*^9, 3.684732452653655*^9}, {
   3.684732484165422*^9, 3.684732564028389*^9}, {3.684732646728675*^9, 
   3.6847326935623713`*^9}, {3.6847327484471827`*^9, 3.684732758900649*^9}, {
   3.6847329430709887`*^9, 3.684732946284733*^9}, {3.6847329941232853`*^9, 
   3.684733078517181*^9}, {3.684733192030521*^9, 3.684733237889316*^9}, {
   3.6847332775117807`*^9, 3.6847333140931797`*^9}, {3.684733406559223*^9, 
   3.684733409955249*^9}, {3.684733443614902*^9, 3.6847336646864023`*^9}, {
   3.684734398369718*^9, 3.684734400340604*^9}, {3.684735164347459*^9, 
   3.684735165245298*^9}, {3.684735733875525*^9, 3.6847357425609694`*^9}, {
   3.6847587424609003`*^9, 3.684758794330977*^9}, {3.716787954100358*^9, 
   3.716787973034396*^9}, {3.7167880197632627`*^9, 3.716788023977055*^9}, {
   3.716788300434854*^9, 3.716788430174656*^9}, {3.716788473965499*^9, 
   3.716788490325077*^9}, {3.716788525149611*^9, 3.716788626624771*^9}, {
   3.7167887156638727`*^9, 3.716788831459537*^9}, {3.716788862410268*^9, 
   3.716788935265624*^9}, {3.716788972593706*^9, 3.716788974881309*^9}, {
   3.716789005345083*^9, 3.716789047997787*^9}, {3.716789206874614*^9, 
   3.716789216321507*^9}, {3.716789248928537*^9, 3.716789332446575*^9}, {
   3.716789421390912*^9, 3.716789509523237*^9}, {3.7167895576519527`*^9, 
   3.716789559587049*^9}, {3.716789615562746*^9, 3.7167896256720543`*^9}, {
   3.71678978709198*^9, 3.7167897884045362`*^9}, {3.716789838812006*^9, 
   3.716789919082262*^9}, {3.7167900233453197`*^9, 3.71679004812057*^9}, {
   3.716790103198382*^9, 3.716790108663022*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[245]:=",ExpressionUUID->"d09b283c-745c-4550-935c-17d2414fa3a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[246]:=",ExpressionUUID->"a66a5896-63cc-496e-96fa-25efeb768265"]
}, Closed]],

Cell[CellGroupData[{

Cell["PeakTableInspection", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.6678183871702337`*^9, 3.667818392882043*^9}, 
   3.679727589299858*^9, {3.713761079342855*^9, 
   3.713761081117041*^9}},ExpressionUUID->"a5381ce5-59b6-4b1c-86ed-\
5916e748fa74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[247]:=",ExpressionUUID->"fe565d70-3102-4bc2-ab05-790cf46f56cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PeakTableInspection", "::", "cutoff"}], "=", 
   "\"\<The cutoff intensity is relative to the maximum intensity and must be \
a number between 0 and 1.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PeakTableInspection", "::", "width"}], "=", 
   "\"\<The group width must be a positive number.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PeakTableInspection", "::", "goniometer"}], "=", 
   "\"\<Invalid goniometer data in \
\[LeftGuillemet]`1`\[RightGuillemet].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PeakTableInspection", "::", "tab"}], "=", 
    "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is an invalid \
\!\(\*StyleBox[\".\", \"Program\"]\)\!\(\*StyleBox[\"tab\", \"Program\"]\) \
file.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "PeakTableInspection"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Cutoff\>\"", "\[Rule]", "0.85"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<GroupWidth\>\"", "\[Rule]", "5"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7137616795929832`*^9, 3.713761725888838*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"8ed0a971-3df3-4780-a433-b9020972b800"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PeakTableInspection", "[", 
   RowBox[{"set_", ",", 
    RowBox[{"OptionsPattern", "@", "PeakTableInspection"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "cutoff", ",", "width", ",", "\[IndentingNewLine]", "lim", ",", "top", 
      ",", "groups", ",", "newset", ",", "sort", ",", "\[Phi]max", ",", 
      "\[Phi]", ",", "j", ",", "keep"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"cutoff", "=", 
      RowBox[{"OptionValue", "[", "\"\<Cutoff\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"0", "\[LessEqual]", "cutoff", "\[LessEqual]", "1"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"PeakTableInspection", "::", "cutoff"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"width", "=", 
      RowBox[{"OptionValue", "[", "\"\<GroupWidth\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "width", "]"}]}], "||", 
        RowBox[{"Negative", "[", "width", "]"}]}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"PeakTableInspection", "::", "width"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Keeping", " ", "the", " ", "top", " ", "part", " ", "of", " ", "the", 
       " ", "registrations"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"lim", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"cutoff", "*", 
        RowBox[{"Max", "@", 
         RowBox[{"set", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "6"}], "]"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"top", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"set", ",", 
        RowBox[{"i_", "/;", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "<", "lim"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Groping", " ", "registrated", " ", "reflections"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"groups", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"newset", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"top", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Finding", " ", "the", " ", "value", " ", "of", " ", "\[Phi]", " ", 
           "at", " ", "maximum"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"sort", "=", 
           RowBox[{"Sort", "[", 
            RowBox[{"top", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "6", "]"}], "]"}], ">", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\[Phi]max", "=", 
           RowBox[{"sort", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "5"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Group", " ", "reflections", " ", "that", " ", "are", " ", 
            "within", " ", "5", "\[Degree]", " ", "of", " ", "\[Phi]max"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Phi]", "=", 
              RowBox[{"top", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "5"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "IntervalMemberQ", "[", "\[IndentingNewLine]", "\t\t", 
                RowBox[{
                 RowBox[{"Interval", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Phi]max", "-", "#"}], ",", 
                    RowBox[{"\[Phi]max", "+", "#"}]}], "}"}], "&"}], "[", 
                   "width", "]"}], "]"}], ",", "\[Phi]"}], "]"}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"groups", ",", 
                 RowBox[{"top", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "@", "top"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Clear", " ", "group", " ", "from", " ", "the", " ", "set", " ", 
            "and", " ", "repeat"}], " ", "*)"}], "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"top", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{"top", ",", "groups"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"newset", ",", 
            RowBox[{"{", "groups", "}"}]}], "]"}], ";", "\[IndentingNewLine]",
           "\t\t", 
          RowBox[{"groups", "=", 
           RowBox[{"{", "}"}]}]}]}], "\[IndentingNewLine]", "\t", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "@", "top"}]}], "}"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Keeping", " ", "only", " ", "the", " ", "peak", " ", "from", " ", 
       "each", " ", "group"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"keep", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TakeLargestBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"First", "@", 
             RowBox[{"Transpose", "@", "newset"}]}], ")"}], "[", 
           RowBox[{"[", "#", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "&"}], ",", "1"}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "newset"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"First", "@", 
        RowBox[{"Transpose", "@", "keep"}]}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667818307063534*^9, {3.68690525820405*^9, 
   3.686905318950204*^9}, {3.6869053506805887`*^9, 3.6869053694385233`*^9}, {
   3.686908049556444*^9, 3.686908058799263*^9}, {3.686908139095263*^9, 
   3.686908217077656*^9}, {3.686908256966238*^9, 3.686908273989725*^9}, {
   3.6869083173044653`*^9, 3.686908363614129*^9}, {3.686908417831101*^9, 
   3.6869084240299263`*^9}, {3.713761726930049*^9, 3.7137617630415697`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[253]:=",ExpressionUUID->"977a2afe-c0ab-4804-9ddc-ed0525deb087"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PeakTableInspection", "[", 
   RowBox[{"goniometerfile_", "?", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"FileExtension", "[", "#", "]"}], "\[Equal]", "\"\<dat\>\""}], 
      "&"}], ")"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "import", ",", "data", ",", "gathered", ",", "multi", ",", 
      "\[IndentingNewLine]", "inspected", ",", "keepsingles", ",", "keep", 
      ",", "in", ",", "delete"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "goniometerfile"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"PeakTableInspection", "::", "goniometer"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"FileNameTake", "@", "goniometerfile"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Extracting", " ", "the", " ", "necessary", " ", "data"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"import", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"goniometerfile", ",", "\"\<Data\>\""}], "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"data", "=", 
      RowBox[{"import", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "8", ",", "10"}], 
          "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Gather", " ", 
       RowBox[{"by", " ", "'"}], 
       RowBox[{"hkl", "'"}], " ", "values"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"gathered", "=", 
      RowBox[{"GatherBy", "[", 
       RowBox[{"data", ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", "4"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Delete", " ", "cases", " ", "with", " ", "only", " ", "one", " ", 
       "registration"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"multi", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"gathered", ",", 
        RowBox[{"L_", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "L", "]"}], "\[Equal]", "1"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Finding", " ", "which", " ", "registrations", " ", "to", " ", 
       "delete"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Analysed", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     
     RowBox[{"inspected", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"PeakTableInspection", "/@", "multi"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Single", " ", "reflections"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"keepsingles", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"gathered", ",", 
        RowBox[{"L_", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "L", "]"}], "\[NotEqual]", "1"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"keepsingles", "=", 
      RowBox[{"keepsingles", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"keep", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"inspected", ",", "keepsingles"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"in", "=", 
      RowBox[{"import", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\t", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"delete", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"in", ",", "keep"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.6678183135113707`*^9, 3.667818329825341*^9}, {
   3.669556336027816*^9, 3.6695563362909193`*^9}, {3.669556547302552*^9, 
   3.669556547661715*^9}, {3.679727638715199*^9, 3.679727644033752*^9}, {
   3.685954947969742*^9, 3.685954951348892*^9}, {3.685955052382823*^9, 
   3.685955058708202*^9}, {3.6859551586373863`*^9, 3.685955182685789*^9}, {
   3.685955337364159*^9, 3.6859553395915194`*^9}, {3.685955373559456*^9, 
   3.685955395197534*^9}, {3.685955435278266*^9, 3.685955463183543*^9}, {
   3.6859555017997847`*^9, 3.685955534198433*^9}, {3.685955754283692*^9, 
   3.685955945184227*^9}, {3.685956006601611*^9, 3.685956120501299*^9}, {
   3.6859561621151867`*^9, 3.685956299372038*^9}, {3.685956331624157*^9, 
   3.6859563372484617`*^9}, {3.6859564070034513`*^9, 3.685956422259562*^9}, {
   3.6859565195128193`*^9, 3.685956584100934*^9}, {3.685956640412599*^9, 
   3.685956739171651*^9}, {3.6859567967753353`*^9, 3.685956876382988*^9}, {
   3.685956986053584*^9, 3.6859570506992493`*^9}, {3.685957088001089*^9, 
   3.685957167440658*^9}, {3.685957248057948*^9, 3.685957341863412*^9}, {
   3.685957621141923*^9, 3.685957732777804*^9}, {3.6859582610006027`*^9, 
   3.685958429271571*^9}, {3.6859585516862*^9, 3.6859585567485228`*^9}, {
   3.685958622906004*^9, 3.685958855291971*^9}, {3.685958894244762*^9, 
   3.685958988081737*^9}, {3.6859590225090647`*^9, 3.685959079799382*^9}, {
   3.685959332425132*^9, 3.685959343273937*^9}, {3.685959718739786*^9, 
   3.685959734190813*^9}, {3.686299618056726*^9, 3.686299618635071*^9}, {
   3.71376015215895*^9, 3.713760168867214*^9}, {3.713761769480782*^9, 
   3.713761780560401*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[254]:=",ExpressionUUID->"e87295ad-15e5-46d5-bad5-5402c709f3b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Pending", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PeakTableInspection", "[", 
    RowBox[{
     RowBox[{"goniometerfile_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"FileExtension", "[", "#", "]"}], "\[Equal]", 
         "\"\<dat\>\""}], "&"}], ")"}]}], ",", 
     RowBox[{"tabfile_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"FileExtension", "[", "#", "]"}], "\[Equal]", 
         "\"\<tab\>\""}], "&"}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "delete", ",", "tab", ",", "head", ",", "n", ",", "nn", ",", 
       "newfile"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FileExistsQ", "@", "goniometerfile"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"PeakTableInspection", "::", "goniometer"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"FileNameTake", "@", "goniometerfile"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FileExistsQ", "@", "tabfile"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"PeakTableInspection", "::", "tab"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"FileNameTake", "@", "tabfile"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Finding", " ", "which", " ", "registrations", " ", "to", " ", 
        "delete"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"delete", "=", 
       RowBox[{"PeakTableInspection", "[", "goniometerfile", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Loading", " ", ".", "tab"}], " ", "file"}], " ", "*)"}], 
      "\t", "\[IndentingNewLine]", "\t", 
      RowBox[{"tab", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"tabfile", ",", "\"\<TSV\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"New", " ", "header"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"head", "=", 
       RowBox[{"tab", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"n", "=", 
       RowBox[{"First", "@", 
        RowBox[{"StringSplit", "@", "head"}]}]}], ";", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"nn", "=", 
       RowBox[{
        RowBox[{"ToExpression", "[", "n", "]"}], "-", 
        RowBox[{"Length", "@", "delete"}]}]}], ";", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{
       RowBox[{"tab", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"head", ",", 
         RowBox[{"n", "\[Rule]", 
          RowBox[{"ToString", "[", "nn", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Delete", " ", "entries"}], " ", "*)"}], "\[IndentingNewLine]",
       "\t", 
      RowBox[{"tab", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"tab", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "#", "}"}], "&"}], ",", "delete"}], "]"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Export", " ", 
        RowBox[{"modiefied", " ", ".", "tab"}], " ", "file"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"newfile", "=", 
       RowBox[{"StringInsert", "[", 
        RowBox[{"tabfile", ",", "\"\<_modified\>\"", ",", 
         RowBox[{"-", "5"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"Export", "[", 
       RowBox[{"newfile", ",", "tab", ",", "\"\<Table\>\""}], "]"}]}]}], "\t",
     "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.6678183135113707`*^9, 3.667818329825341*^9}, {
   3.669556336027816*^9, 3.6695563362909193`*^9}, {3.669556547302552*^9, 
   3.669556547661715*^9}, {3.679727638715199*^9, 3.679727644033752*^9}, {
   3.685954947969742*^9, 3.685954951348892*^9}, {3.685955052382823*^9, 
   3.685955058708202*^9}, {3.6859551586373863`*^9, 3.685955182685789*^9}, {
   3.685955337364159*^9, 3.6859553395915194`*^9}, {3.685955373559456*^9, 
   3.685955395197534*^9}, {3.685955435278266*^9, 3.685955463183543*^9}, {
   3.6859555017997847`*^9, 3.685955534198433*^9}, {3.685955754283692*^9, 
   3.685955945184227*^9}, {3.685956006601611*^9, 3.685956120501299*^9}, {
   3.6859561621151867`*^9, 3.685956299372038*^9}, {3.685956331624157*^9, 
   3.6859563372484617`*^9}, {3.6859564070034513`*^9, 3.685956422259562*^9}, {
   3.6859565195128193`*^9, 3.685956584100934*^9}, {3.685956640412599*^9, 
   3.685956739171651*^9}, {3.6859567967753353`*^9, 3.685956876382988*^9}, {
   3.685956986053584*^9, 3.6859570506992493`*^9}, {3.685957088001089*^9, 
   3.685957167440658*^9}, {3.685957248057948*^9, 3.685957341863412*^9}, {
   3.685957621141923*^9, 3.685957732777804*^9}, {3.6859582610006027`*^9, 
   3.685958429271571*^9}, {3.6859585516862*^9, 3.6859585567485228`*^9}, {
   3.685958622906004*^9, 3.685958855291971*^9}, {3.685958894244762*^9, 
   3.685958988081737*^9}, {3.6859590225090647`*^9, 3.685959079799382*^9}, {
   3.685959332425132*^9, 3.685959343273937*^9}, {3.685959760425982*^9, 
   3.6859597830652943`*^9}, {3.686299629097064*^9, 3.686299642460539*^9}, {
   3.713760198005303*^9, 3.713760204250717*^9}, {3.7137617952397423`*^9, 
   3.713761813631722*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[255]:=",ExpressionUUID->"f607695a-756f-4986-8172-219fec5dcd19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[256]:=",ExpressionUUID->"6d3f9cc6-94d7-4dee-8de0-dd80efba362c"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReciprocalImageCheck", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.6678188399987793`*^9, 3.667818878319042*^9}, {
   3.667818936985889*^9, 3.667818938625092*^9}, 3.667819218919221*^9, {
   3.668104207926056*^9, 3.668104209242962*^9}, 3.687243315679677*^9, 
   3.6878672655456343`*^9, {3.7138707345449533`*^9, 3.713870750699418*^9}, 
   3.715852050034526*^9},ExpressionUUID->"1c036039-a160-4350-b735-\
abc7d969c17f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[257]:=",ExpressionUUID->"4d108843-03ee-47eb-8d30-c541dd362226"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "file"}], "=", 
   "\"\<Input file was not found.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "method"}], "=", 
   "\"\<The method \[LeftGuillemet]`1`\[RightGuillemet] was not recognised.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "system"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid lattice system.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "angles"}], "=", 
   "\"\<Invalid angle input for the given system.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "load"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] cannot be loaded.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "form"}], "=", 
   "\"\<The file does not appear to be on the correct Association \
form.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "asn"}], "=", 
   "\"\<\[LeftGuillemet]$PixelData\[RightGuillemet] does not appear to be an \
Association.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "threshold"}], "=", 
   "\"\<`1` reflection`2` outside the threshold for integer \
determination.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "all"}], "=", 
   "\"\<All reflections were inside the threshold for integer \
determination.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "ambiguous"}], "=", 
   "\"\<Ambiguous image orientation. Use different correspondence \
points.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "data"}], "=", 
   "\"\<At least two data points are required.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReciprocalImageCheck", "::", "grid"}], "=", 
    "\"\<The option \[LeftGuillemet]ShowLattice\[RightGuillemet] must either \
be set to \[LeftGuillemet]True\[RightGuillemet] or a non-negative \
integer.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ReciprocalImageCheck"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"FindPixelClusters", " ", "options"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<ClearStatus\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ClusterRange\>\"", "\[Rule]", "3"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Method", "\[Rule]", "\"\<Auto\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ReturnBinaryImage\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"ReciprocalImageCheck", " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Threshold\>\"", "\[Rule]", "0.15"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<RoundPixels\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<LoadPixelData\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<RetrieveData\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<CountNonInteger\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<StoreData\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ShowLattice\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Colours\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"97", ",", "2"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"97", ",", "1"}], "]"}], ",", "LightGray"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<TooltipStyle\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Inconsolata\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Plot", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", "\"\<ImageDimension\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PointSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, {3.6678192645731707`*^9, 3.667819270555752*^9}, {
   3.6679268272189693`*^9, 3.667926827530929*^9}, {3.667926865314499*^9, 
   3.667926879234667*^9}, {3.667932793543994*^9, 3.6679327970955763`*^9}, 
   3.667932835740869*^9, {3.667932872004774*^9, 3.667932872923719*^9}, {
   3.667933478854928*^9, 3.6679334921815147`*^9}, {3.667937136249467*^9, 
   3.66793713683991*^9}, {3.667938254326214*^9, 3.667938259486877*^9}, {
   3.667939157392975*^9, 3.6679391759273643`*^9}, {3.6679395892626457`*^9, 
   3.6679396251018553`*^9}, {3.6679396662931337`*^9, 3.66793967041187*^9}, {
   3.667969062724923*^9, 3.6679690866593513`*^9}, {3.667971558545974*^9, 
   3.667971570791375*^9}, {3.66797175965112*^9, 3.667971761018065*^9}, 
   3.667973400059704*^9, 3.667980455575898*^9, 3.667990364351841*^9, 
   3.6679914744706078`*^9, {3.667995091765997*^9, 3.6679950981728687`*^9}, {
   3.667995848573064*^9, 3.667995849419979*^9}, {3.6680190786132174`*^9, 
   3.668019095188184*^9}, {3.668020053716372*^9, 3.668020060218075*^9}, {
   3.6680201410335283`*^9, 3.668020151647107*^9}, {3.668057763273326*^9, 
   3.668057801302511*^9}, {3.668058628257262*^9, 3.6680586519993153`*^9}, 
   3.6680586831987753`*^9, {3.668059310968914*^9, 3.668059345638503*^9}, {
   3.6680593969584103`*^9, 3.66805941238801*^9}, {3.668059512633687*^9, 
   3.6680595196012506`*^9}, {3.6680596063927727`*^9, 3.668059614803205*^9}, {
   3.6680982548367653`*^9, 3.668098258731867*^9}, 3.6681034770498257`*^9, 
   3.6681434966601543`*^9, {3.6695197388121567`*^9, 3.669519739484033*^9}, 
   3.6695198100421457`*^9, {3.6703497772124653`*^9, 3.6703497791230783`*^9}, {
   3.670349812772047*^9, 3.670349826517558*^9}, {3.671389215213585*^9, 
   3.671389249836089*^9}, {3.671389297045927*^9, 3.671389306618927*^9}, {
   3.6719110883031588`*^9, 3.6719110885974483`*^9}, {3.687165575358741*^9, 
   3.687165638515873*^9}, {3.687507491201261*^9, 3.6875075124540987`*^9}, {
   3.687507570577013*^9, 3.68750761179244*^9}, {3.687512071516636*^9, 
   3.687512097815074*^9}, {3.687514871153606*^9, 3.687514874756731*^9}, {
   3.687514973533998*^9, 3.687515013595488*^9}, {3.687520393077942*^9, 
   3.687520407914579*^9}, {3.687521238012498*^9, 3.687521257345623*^9}, {
   3.687865768052176*^9, 3.687865768352976*^9}, {3.6878659560830936`*^9, 
   3.687865975589882*^9}, 3.687866368125998*^9, {3.688100200710231*^9, 
   3.6881002081876507`*^9}, {3.688100604833289*^9, 3.6881006099071083`*^9}, {
   3.688107997969265*^9, 3.6881080214126472`*^9}, {3.688108400184894*^9, 
   3.6881084154348392`*^9}, {3.6881280727953053`*^9, 
   3.6881281273768167`*^9}, {3.688128294183939*^9, 3.688128294543211*^9}, {
   3.688191590995892*^9, 3.688191597523514*^9}, {3.6881975513508463`*^9, 
   3.688197562958654*^9}, 3.688284217856106*^9, {3.688889672275766*^9, 
   3.688889672421276*^9}, {3.714201028367544*^9, 3.714201029342231*^9}, {
   3.7142020649596653`*^9, 3.71420209340727*^9}, {3.714202883384715*^9, 
   3.7142029121766233`*^9}, {3.715336114709093*^9, 3.7153361213929033`*^9}, {
   3.715852050070547*^9, 3.715852050154768*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"2512389a-7af0-4566-bf47-49fe0908ee7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[271]:=",ExpressionUUID->"220ccaa5-f6dc-4a1f-8aa2-afc3c7c23238"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$PixelData", "=", 
   RowBox[{"<|", "|>"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667991880825115*^9, 3.667991885921834*^9}, {
  3.688359763770588*^9, 3.6883597639539633`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[272]:=",ExpressionUUID->"813abb72-097c-456a-a747-1295efb6ecaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReciprocalImageCheck", "[", "\[IndentingNewLine]", 
   RowBox[{
   "input_String", ",", "\[IndentingNewLine]", "system_", ",", 
    "\[IndentingNewLine]", "data_List", ",", "\[IndentingNewLine]", 
    RowBox[{"Optional", "[", 
     RowBox[{"pattern_Condition", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", "False"}]}], 
     "]"}], ",", 
    RowBox[{"OptionsPattern", "@", "ReciprocalImageCheck"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "systems", ",", "sys", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", 
      ",", "\[IndentingNewLine]", "image", ",", "imgdim", ",", "adjust", ",", 
      "tx", ",", "ty", ",", "load", ",", "hash", ",", "pixlist", ",", 
      "\[IndentingNewLine]", "hkls", ",", "sub", ",", "s", ",", "sel", ",", 
      "normhkl", ",", "normorder", ",", "L", ",", "X", ",", "P", ",", "Pinv", 
      ",", "method", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Lattice", " ", "*)"}], "\[IndentingNewLine]", "L1x",
       ",", "L2x", ",", "L1y", ",", "L2y", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Conversion", " ", "functions"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[CapitalLambda]", ",", "\[CapitalGamma]", ",", 
      "\[Xi]", ",", "convert", ",", "residue", ",", "threshold", ",", 
      "result", ",", "i", ",", "\[Chi]", ",", "\[IndentingNewLine]", 
      "meddist", ",", "xy", ",", "rest", ",", "neighbour", ",", "distance", 
      ",", "median", ",", "\[IndentingNewLine]", "selection", ",", "range", 
      ",", "nearest", ",", "\[IndentingNewLine]", "clusters", ",", "off", ",",
       "groupfix", ",", "tooltip", ",", "\[IndentingNewLine]", "nodes", ",", 
      "l", ",", "hkl", ",", "count", ",", "selection2D", ",", "pos", ",", 
      "matching", ",", "pr", ",", "colourmatch", ",", "colourrest", ",", 
      "colouroff", ",", "\[IndentingNewLine]", "temp", ",", "temp1", ",", 
      "temp2", ",", "temp3", ",", "temp4", ",", "temp5", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Overalying", " ", "grid"}], " ", "*)"}], 
      "\[IndentingNewLine]", "colours", ",", "V", ",", "c", ",", "L1", ",", 
      "L2", ",", "t", ",", "tt", ",", "\[IndentingNewLine]", "gz", ",", 
      "showgrid", ",", "del", ",", "grid", ",", "u", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Other", " ", "*)"}], "\[IndentingNewLine]", "test", 
      ",", "r", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", "data2D", ",", 
      "\[IndentingNewLine]", "plot", ",", "plotdata", ",", "plotoptions", ",",
       "\[IndentingNewLine]", "SD", ",", "grids"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "Input", " ", "check"}], " ", "**)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "input"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReciprocalImageCheck", "::", "file"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"systems", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "\"\<Triclinic\>\"", ",", "\"\<Monoclinic\>\"", ",", 
        "\"\<Orthorhombic\>\"", ",", "\"\<Tetragonal\>\"", ",", 
        "\[IndentingNewLine]", "\t", "\"\<Rhombohedral\>\"", ",", 
        "\"\<Hexagonal\>\"", ",", "\"\<Cubic\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sys", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "@", "system"}], ",", 
        RowBox[{"First", "@", "system"}], ",", "system"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "valid", " ", "lattice", " ", "system"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"systems", ",", "sys"}], "]"}]}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ReciprocalImageCheck", "::", "system"}], ",", "system"}], 
         "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "angles", " ", "are", " ", "required"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "system"}], ",", "\t", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<Triclinic\>\"", ",", "\"\<Monoclinic\>\"", ",", 
             "\"\<Rhombohedral\>\""}], "}"}], ",", "sys"}], "]"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"ReciprocalImageCheck", "::", "angles"}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"If", " ", "angles", " ", "given"}], ",", " ", 
       RowBox[{"check", " ", "if", " ", "form", " ", "is", " ", "valid"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "@", "system"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"sys", "\[Equal]", "\"\<Triclinic\>\""}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"Rest", "@", "system"}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], 
            "=", 
            RowBox[{
             RowBox[{"Rest", "@", "system"}], "*", "Degree"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{"ReciprocalImageCheck", "::", "angles"}], "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
         RowBox[{"sys", "\[Equal]", "\"\<Monoclinic\>\""}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"Rest", "@", "system"}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"{", 
              RowBox[{"_", "?", "NumericQ"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"{", "\[Beta]", "}"}], "=", 
            RowBox[{
             RowBox[{"Rest", "@", "system"}], "*", "Degree"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{"ReciprocalImageCheck", "::", "angles"}], "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
         RowBox[{"sys", "\[Equal]", "\"\<Rhombohedral\>\""}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"Rest", "@", "system"}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"{", 
              RowBox[{"_", "?", "NumericQ"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"{", "\[Alpha]", "}"}], "=", 
            RowBox[{
             RowBox[{"Rest", "@", "system"}], "*", "Degree"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{"ReciprocalImageCheck", "::", "angles"}], "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
        "\t", "]"}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "for", " ", "sufficient", " ", "data"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "data"}], "<", "2"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReciprocalImageCheck", "::", "data"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", 
       RowBox[{"for", " ", "'"}], 
       RowBox[{"ShowLattice", "'"}], " ", 
       RowBox[{"and", " ", "'"}], 
       RowBox[{"StoreData", "'"}], " ", "option"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"SD", "=", 
      RowBox[{"OptionValue", "[", "\"\<StoreData\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"gz", "=", 
      RowBox[{"OptionValue", "[", "\"\<ShowLattice\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"SD", ",", 
       RowBox[{"gz", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gz", "\[Equal]", "True"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "gz", "]"}], "&&", 
          RowBox[{"NonNegative", "[", "gz", "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"showgrid", "=", "True"}], ",", 
       RowBox[{"showgrid", "=", "False"}], ",", 
       RowBox[{"showgrid", "=", "False"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"gz", "\[Equal]", "True"}], ",", 
       RowBox[{"gz", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "Preparations", " ", "for", " ", "extracting", " ", "two", 
       " ", "dimensions", " ", 
       RowBox[{"(", 
        RowBox[{"image", " ", "plane"}], ")"}]}], " ", "**)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"hkls", "=", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Test", ":", " ", 
       RowBox[{
       "Check", " ", "for", " ", "any", " ", "column", " ", "with", " ", 
        "the", " ", "same", " ", "element"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"DeleteDuplicates", "/@", 
       RowBox[{"Transpose", "@", "hkls"}]}]}], ";", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"test", "=", 
      RowBox[{"Boole", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "#", "]"}], "\[NotEqual]", "1"}], "&"}], "/@",
         "temp"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"test", ",", "0"}], "]"}], "\[NotEqual]", "1"}], ",", 
       "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReciprocalImageCheck", "::", "ambiguous"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Values", " ", "describing", " ", "the", " ", "plane"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"normorder", "=", 
      RowBox[{"First", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", 
         RowBox[{"test", ",", "0"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"normhkl", "=", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", 
         RowBox[{"normorder", "+", "2"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sel", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "normorder"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Planar", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"data2D", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", "data"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", "+", "normorder"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "Check", " ", "if", " ", "image", " ", "is", " ", "known"}], 
      " ", "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"image", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"Import", "@", "input"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"imgdim", "=", 
      RowBox[{"ImageDimensions", "@", "image"}]}], ";", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"adjust", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tx", ",", "ty"}], "}"}], "=", 
       RowBox[{"imgdim", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<ReturnBinaryImage\>\"", "]"}], ",", 
       RowBox[{"Goto", "[", "\"\<FindPixelClusters\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Load", " ", "file", " ", "containing", " ", "pixel", " ", "data"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"load", "=", 
      RowBox[{"OptionValue", "[", "\"\<LoadPixelData\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "load"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "@", "load"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"$PixelData", "=", "\[IndentingNewLine]", "\t", 
          RowBox[{"Check", "[", 
           RowBox[{
            RowBox[{"ToExpression", "@", 
             RowBox[{"Import", "[", 
              RowBox[{"load", ",", "\"\<String\>\""}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"ReciprocalImageCheck", "::", "form"}], "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"ReciprocalImageCheck", "::", "load"}], ",", "load"}], 
           "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AssociationQ", "@", "$PixelData"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReciprocalImageCheck", "::", "asn"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Hash", " ", "procedure"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"hash", "=", 
      RowBox[{"IntegerString", "[", 
       RowBox[{
        RowBox[{"FileHash", "[", 
         RowBox[{"input", ",", "\"\<MD5\>\""}], "]"}], ",", "16", ",", "32"}],
        "]"}]}], ";", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$PixelData", ",", "hash"}], "]"}], "\[IndentingNewLine]", 
        "\t", "&&", 
        RowBox[{"OptionValue", "[", "\"\<RetrieveData\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"pixlist", "=", 
         RowBox[{"$PixelData", "[", "hash", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<PixelDone\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Converting", " ", "image", " ", "to", " ", "a", " ", "list", " ", "of",
        " ", "pixels"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<FindPixelClusters\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"pixlist", "=", 
      RowBox[{"FindPixelClusters", "[", 
       RowBox[{"image", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[Rule]", 
           RowBox[{"OptionValue", "[", "#", "]"}]}], "&"}], "/@", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<ReturnBinaryImage\>\"", ",", "Method", ",", 
           "\"\<ClusterRange\>\"", ",", "\"\<ClearStatus\>\""}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Option", " ", "for", " ", "returning", " ", "binarised", " ", 
       "image"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<ReturnBinaryImage\>\"", "]"}], ",", 
       RowBox[{"Return", "@", "pixlist"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Storing", " ", "image", " ", "hash", " ", "along", " ", "with", " ", 
       "pixel", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"$PixelData", ",", 
       RowBox[{"hash", "\[Rule]", "pixlist"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "Setting", " ", "up", " ", "lattice"}], " ", "**)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<PixelDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Determining", " ", "reciprocal", " ", "lattice", " ", "used", " ", 
       "in", " ", "CrysAlis"}], " ", "*)"}], "\t", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"sys", "\[Equal]", "\"\<Triclinic\>\""}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"L", "=", 
        RowBox[{"N", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Cot", "[", "\[Gamma]", "]"}]}], "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Cot", "[", "\[Gamma]", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"Csc", "[", "\[Gamma]", "]"}], "2"]}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Csc", "[", "\[Gamma]", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
                   RowBox[{"Cot", "[", "\[Gamma]", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
                   RowBox[{"Csc", "[", "\[Gamma]", "]"}]}]}], ")"}]}], ")"}], 
              "/", 
              RowBox[{"(", 
               RowBox[{"\[Sqrt]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], "2"]}], ")"}], " ", 
                    
                    SuperscriptBox[
                    RowBox[{"Cot", "[", "\[Gamma]", "]"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}], "2"]}], "-", 
                    RowBox[{"4", " ", 
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
                    RowBox[{"Cot", "[", "\[Gamma]", "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}], "3"]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], "2"]}], ")"}], " ", 
                    
                    SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}], "4"]}]}], ")"}], 
                  " ", 
                  RowBox[{"Sign", "[", 
                   RowBox[{"1", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
                    RowBox[{"Cot", "[", "\[Gamma]", "]"}], " ", 
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], "2"]}], ")"}], " ", 
                    
                    SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}], "2"]}]}], "]"}]}], 
                 ")"}]}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
           
           RowBox[{"{", 
            RowBox[{"0", ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Csc", "[", "\[Gamma]", "]"}], "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Cot", "[", "\[Gamma]", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"Csc", "[", "\[Gamma]", "]"}], "2"]}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Csc", "[", "\[Gamma]", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
                   RowBox[{"Cot", "[", "\[Gamma]", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
                   RowBox[{"Csc", "[", "\[Gamma]", "]"}]}]}], ")"}]}], ")"}], 
              "/", 
              RowBox[{"(", 
               RowBox[{"\[Sqrt]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], "2"]}], ")"}], " ", 
                    
                    SuperscriptBox[
                    RowBox[{"Cot", "[", "\[Gamma]", "]"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}], "2"]}], "-", 
                    RowBox[{"4", " ", 
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
                    RowBox[{"Cot", "[", "\[Gamma]", "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}], "3"]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], "2"]}], ")"}], " ", 
                    
                    SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}], "4"]}]}], ")"}], 
                  " ", 
                  RowBox[{"Sign", "[", 
                   RowBox[{"1", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
                    RowBox[{"Cot", "[", "\[Gamma]", "]"}], " ", 
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], "2"]}], ")"}], " ", 
                    
                    SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}], "2"]}]}], "]"}]}], 
                 ")"}]}], ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
           
           RowBox[{"{", 
            RowBox[{
            "0", ",", "\[IndentingNewLine]", "\t", "0", ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], "2"]}], ")"}], " ", 
                   
                   SuperscriptBox[
                    RowBox[{"Cot", "[", "\[Gamma]", "]"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}], "2"]}], "-", 
                  RowBox[{"4", " ", 
                   RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
                   RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
                   RowBox[{"Cot", "[", "\[Gamma]", "]"}], " ", 
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}], "3"]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], "2"]}], ")"}], " ", 
                   
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}], "4"]}]}], ")"}], 
                " ", 
                RowBox[{"Sign", "[", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", " ", 
                   RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
                   RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
                   RowBox[{"Cot", "[", "\[Gamma]", "]"}], " ", 
                   RowBox[{"Csc", "[", "\[Gamma]", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Beta]", "]"}], "2"]}], ")"}], " ", 
                   
                   SuperscriptBox[
                    RowBox[{"Csc", "[", "\[Gamma]", "]"}], "2"]}]}], "]"}]}], 
               "]"}]}]}], "\[IndentingNewLine]", "\t", "}"}]}], "}"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"sys", "\[Equal]", "\"\<Monoclinic\>\""}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"L", "=", 
        RowBox[{"N", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Cos", "[", "\[Beta]", "]"}]}], "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", "+", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Beta]", "]"}], "2"]}], "]"}]}]}], 
            "}"}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", "+", 
                SuperscriptBox[
                 RowBox[{"Cos", "[", "\[Beta]", "]"}], "2"]}], "]"}]}]}], 
            "}"}]}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"sys", "\[Equal]", "\"\<Hexagonal\>\""}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"L", "=", 
        RowBox[{"N", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", "0"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "True", ",", 
       RowBox[{"L", "=", 
        RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Extracting", " ", "two", " ", "dimensions", " ", 
       RowBox[{"(", 
        RowBox[{"image", " ", "plane"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"L", "=", 
      RowBox[{"L", "[", 
       RowBox[{"[", 
        RowBox[{"sel", ",", "sel"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Lattice", " ", "components"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"L1x", ",", "L2x"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"L1y", ",", "L2y"}], "}"}]}], "}"}], "=", "L"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Function", " ", "for", " ", "calculating", " ", "residue"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "h1_", ",", "h2_"}], "}"}], ",", 
        "\[Lambda]1_", ",", "\[Lambda]2_"}], "]"}], ":=", 
      RowBox[{"N", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}], "]"}], "-", "\[IndentingNewLine]", "\t", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"tx", "+", 
             RowBox[{"h1", "*", "L1x", "*", "\[Lambda]1"}], "+", 
             RowBox[{"h2", "*", "L2x", "*", "\[Lambda]2"}]}], ")"}], "2"], 
          "+", "\[IndentingNewLine]", "\t", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"ty", "+", 
             RowBox[{"h1", "*", "L1y", "*", "\[Lambda]1"}], "+", 
             RowBox[{"h2", "*", "L2y", "*", "\[Lambda]2"}]}], ")"}], "2"]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Determining", " ", "scaling", " ", "factors", " ", "by", " ", 
       "iteration"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{"NonlinearLeastSquares", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"r", ",", "data2D", ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "50"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Scaled", " ", "lattice"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"\[CapitalLambda]", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "L", "]"}], "*", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[CapitalGamma]", "=", 
      RowBox[{"Inverse", "[", "\[CapitalLambda]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Conversion", " ", "functions"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"\[Xi]", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
      RowBox[{"\[CapitalGamma]", ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "-", "tx"}], ",", 
         RowBox[{"y", "-", "ty"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{"h_", ",", "k_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"\[CapitalLambda]", ".", 
        RowBox[{"{", 
         RowBox[{"h", ",", "k"}], "}"}]}], "+", 
       RowBox[{"{", 
        RowBox[{"tx", ",", "ty"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "Conversion", " ", "functions"}], " ", "**)"}], 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Pixel", " ", "to", " ", "node"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"\[Xi]", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Calculation", " ", "and", " ", "discrepancy", " ", "check"}],
         " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"convert", "=", 
         RowBox[{"\[CapitalGamma]", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "-", "tx"}], ",", 
            RowBox[{"y", "-", "ty"}]}], "}"}]}]}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"residue", "=", 
         RowBox[{"Abs", "/@", 
          RowBox[{"FractionalPart", "/@", 
           RowBox[{"N", "[", "convert", "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Decide", " ", "whether", " ", "to", " ", "round", " ", "to", " ", 
          "integer"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"threshold", "=", 
         RowBox[{"OptionValue", "[", "\"\<Threshold\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"result", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"residue", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", "threshold"}], 
            ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"result", ",", 
              RowBox[{"Round", "@", 
               RowBox[{"convert", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"1", "-", 
              RowBox[{"residue", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "\[LessEqual]", 
             "threshold"}], ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"result", ",", 
              RowBox[{"Round", "@", 
               RowBox[{"convert", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"result", ",", 
              RowBox[{"N", "@", 
               RowBox[{"convert", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", "\t", "]"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "result"}], 
       ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Node", " ", "to", " ", "pixel"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{"H_", ",", 
        RowBox[{"round_:", 
         RowBox[{"OptionValue", "[", "\"\<RoundPixels\>\"", "]"}]}]}], "]"}], 
      ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", "Calculation", " ", "*)"}], "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"convert", "=", 
         RowBox[{
          RowBox[{"\[CapitalLambda]", ".", "H"}], "+", "adjust"}]}], ";", 
        "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Decide", " ", "whether", " ", "to", " ", "round", " ", "to", " ", 
          "integer"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"round", ",", 
          RowBox[{"Round", "@", "convert"}], ",", "convert"}], "]"}]}], 
       ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", 
       RowBox[{"Optional", ":", " ", 
        RowBox[{"Overlaying", " ", 
         RowBox[{"grid", "/", "lattice"}]}]}]}], " ", "**)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "showgrid"}], ",", 
       RowBox[{"Goto", "[", "\"\<LatticeDone\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Preparations", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"colours", "=", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"1", "\[Rule]", "Red"}], ",", 
        RowBox[{"2", "\[Rule]", "Green"}], ",", 
        RowBox[{"3", "\[Rule]", "Blue"}]}], "|>"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"c", "=", 
      RowBox[{"Values", "@", 
       RowBox[{"colours", "[", 
        RowBox[{"[", "sel", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"L1", ",", "L2"}], "}"}], "=", 
      RowBox[{"Transpose", "[", "\[CapitalLambda]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Lattice", " ", "setup"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"V", "[", 
       RowBox[{"x0_", ",", "y0_"}], "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{
          RowBox[{"\[CapitalLambda]", ".", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "y0"}], "}"}]}], "+", "adjust"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"tt", "=", 
         RowBox[{"{", 
          RowBox[{"t", ",", "t"}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x0", "\[Equal]", "y0", "\[Equal]", "0"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Origin", " ", "arrows"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"adjust", ",", 
                 RowBox[{"adjust", "+", "L1"}]}], "}"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"adjust", ",", 
                 RowBox[{"adjust", "+", "L2"}]}], "}"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "\t", "}"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Translated", " ", "arrows"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "Dashed", ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", "L1"}], "}"}], "+", 
                "tt"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "Dashed", ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", "L2"}], "}"}], "+", 
                "tt"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "\t", 
           "}"}]}], "]"}]}], "\[IndentingNewLine]", "\t", ")"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Lattice", " ", "generation"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"grids", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<StartGrid\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"-", "gz"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", "gz"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"-", "gz"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", "gz"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"temp", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"gz", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"temp", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "3", "}"}], ",", 
             RowBox[{"{", "4", "}"}], ",", 
             RowBox[{"{", "5", "}"}], ",", 
             RowBox[{"{", "6", "}"}], ",", 
             RowBox[{"{", "7", "}"}], ",", 
             RowBox[{"{", "8", "}"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<One\>\"", "]"}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp2", "=", 
      RowBox[{
       RowBox[{"4", "gz"}], "+", "2"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"u", "=", 
      RowBox[{"2", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "gz"}], "+", "1"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"x1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "temp2", ",", "u", ",", "temp2"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"x1", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"x1", ",", 
        RowBox[{"x_", "\[RuleDelayed]", 
         RowBox[{"{", "x", "}"}]}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"x2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"j", ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"u", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", "gz"}], "+", "1"}], ")"}]}], ",", 
          RowBox[{"u", "-", "1"}], ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"x2", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"x2", ",", 
        RowBox[{"x_", "\[RuleDelayed]", 
         RowBox[{"{", "x", "}"}]}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"del", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Join", "[", 
        RowBox[{"x1", ",", "x2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"temp", ",", "del"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Label", "[", "\"\<One\>\"", "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"Arrowheads", "[", "Medium", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"grid", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"temp", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"Axes", "\[Rule]", "False"}]}], "\[IndentingNewLine]", "\t", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Generate", " ", "several", " ", "grids"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SD", "&&", 
        RowBox[{"gz", "<", "8"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"grids", ",", "grid"}], "]"}], ";", 
        RowBox[{"gz", "++"}], ";", 
        RowBox[{"Goto", "[", "\"\<StartGrid\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<LatticeDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Consider", " ", "relfections", " ", "outside", " ", "threshold", " ", 
       "to", " ", "be", " ", 
       RowBox[{"wrong", "/", "off"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"off", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"pixlist", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{"\[Xi]", "[", "#", "]"}], ",", "IntegerQ"}], "]"}]}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "Selecting", " ", "nodes", " ", "that", " ", "match", " ", 
       "the", " ", "pattern"}], " ", "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Setup", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"nodes", "=", 
      RowBox[{"\[Xi]", "/@", "pixlist"}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"hkl", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Riffle", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Flatten", "@", "nodes"}], ",", "normhkl", ",", 
          RowBox[{"{", 
           RowBox[{"normorder", ",", 
            RowBox[{"-", "1"}], ",", "3"}], "}"}]}], "]"}], ",", "3"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "for", " ", "non"}], "-", 
       RowBox[{"integer", " ", "cases"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<CountNonInteger\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"hkl", ",", "_Real"}], "]"}]}], ",", "\[IndentingNewLine]",
          "\t\t", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ReciprocalImageCheck", "::", "threshold"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"count", "=", 
            RowBox[{"Count", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"FreeQ", "[", 
                 RowBox[{"#", ",", "_Real"}], "]"}], "&"}], "/@", "hkl"}], 
              ",", "False"}], "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"count", ">", "1"}], ",", "\"\<s were\>\"", ",", 
             "\"\< was\>\""}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"Message", "[", 
          RowBox[{"ReciprocalImageCheck", "::", "all"}], "]"}]}], 
        "\[IndentingNewLine]", "\t\t", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"selection", "=", 
      RowBox[{"Quiet", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{"hkl", ",", "pattern"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Backtracking", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"selection2D", "=", 
      RowBox[{"selection", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "sel"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"pos", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"nodes", ",", "#"}], "]"}], "&"}], "/@", "selection2D"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"matching", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"pixlist", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Selection", " ", "managment"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"matching", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"matching", ",", "off"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"rest", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"pixlist", ",", "matching", ",", "off"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Tooltip", " ", "styling", " ", "and", " ", "managment"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"groupfix", "[", "x_", "]"}], ":=", 
      RowBox[{"Quiet", "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"ToMiller", "@", "\[IndentingNewLine]", "\t", 
          RowBox[{"Insert", "[", 
           RowBox[{
            RowBox[{"\[Xi]", "[", "x", "]"}], ",", "normhkl", ",", 
            RowBox[{"{", "normorder", "}"}]}], "]"}]}]}], "}"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"tooltip", "=", 
      RowBox[{
       RowBox[{"Tooltip", "[", 
        RowBox[{"#1", ",", "#2", ",", 
         RowBox[{"TooltipStyle", "\[Rule]", "\[IndentingNewLine]", "\t", 
          RowBox[{"OptionValue", "[", "\"\<TooltipStyle\>\"", "]"}]}]}], 
        "]"}], "&"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", 
        RowBox[{"Empty", " ", "selections"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"off", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"off", "=", 
        RowBox[{"{", 
         RowBox[{"Null", ",", "Null"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rest", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"rest", "=", 
        RowBox[{"{", 
         RowBox[{"Null", ",", "Null"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"matching", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"matching", "=", 
         RowBox[{"{", 
          RowBox[{"Null", ",", "Null"}], "}"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"Goto", "[", "\"\<SkipMatching\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Adding", " ", "tooltip"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"matching", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"tooltip", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"pixlist", "[", 
              RowBox[{"[", "#", "]"}], "]"}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"ToMiller", "@", 
              RowBox[{"hkl", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
            "\t", "}"}], "&"}], "/@", "pos"}], "]"}]}], "\[IndentingNewLine]",
        "\t", "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<SkipMatching\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"rest", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"tooltip", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"groupfix", "/@", "rest"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"off", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"tooltip", ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"groupfix", "/@", "off"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "Plot"}], " ", "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", 
       RowBox[{"Custom", " ", "PlotRange"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"pr", "=", 
      RowBox[{"OptionValue", "[", "\"\<PlotRange\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"pr", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#", ",", "#"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "#"}], "}"}]}], "}"}], "&"}], "[", 
           "_Integer", "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"pr", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "#"}], "}"}], "&"}], "/@", "imgdim"}]}]}], "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"colourmatch", ",", "colourrest", ",", "colouroff"}], "}"}], 
      "=", 
      RowBox[{"OptionValue", "[", "\"\<Colours\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"plotoptions", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Frame", "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"OptionValue", "[", "ImageSize", "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"PlotRange", "\[Rule]", "pr"}], ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"1", "/", 
          RowBox[{"Divide", "@@", "imgdim"}]}]}], ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "\[Rule]", 
              RowBox[{"OptionValue", "[", "PointSize", "]"}]}], ",", 
             "Automatic", ",", "colouroff"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "\[Rule]", 
              RowBox[{"OptionValue", "[", "PointSize", "]"}]}], ",", 
             "Automatic", ",", "colourrest"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "\[Rule]", 
              RowBox[{"OptionValue", "[", "PointSize", "]"}]}], ",", 
             "Automatic", ",", "colourmatch"}], "}"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "\t", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"plotdata", "=", 
      RowBox[{"{", 
       RowBox[{"off", ",", "rest", ",", "matching"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"plot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"plotdata", ",", "plotoptions"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "End"}], " ", "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Store", " ", "data"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<StoreData\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Return", "[", 
        RowBox[{"<|", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"\"\<Image\>\"", "\[Rule]", "image"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<ImageGrayscale\>\"", "\[Rule]", 
           RowBox[{"ColorConvert", "[", 
            RowBox[{"image", ",", "\"\<Grayscale\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<ImageNegative\>\"", "\[Rule]", 
           RowBox[{"ColorNegate", "[", "image", "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
          "\"\<ImageGrayscaleNegative\>\"", "\[Rule]", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"ColorConvert", "[", 
            RowBox[{
             RowBox[{"ColorNegate", "[", "image", "]"}], ",", 
             "\"\<Grayscale\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"\"\<ImageBinarised\>\"", "\[Rule]", 
           RowBox[{"Binarize", "[", "image", "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Lattice\>\"", "\[Rule]", "\[CapitalLambda]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<LatticeBasic\>\"", "\[Rule]", "L"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Adjust\>\"", "\[Rule]", "adjust"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Plotdata\>\"", "\[Rule]", "rest"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<PlotdataMatch\>\"", "\[Rule]", "matching"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\"\<PlotdataWrong\>\"", "\[Rule]", "off"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Grids\>\"", "\[Rule]", "grids"}]}], 
         "\[IndentingNewLine]", "\t", "|>"}], "\[IndentingNewLine]", "\t", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", "Plot", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"showgrid", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Show", "[", 
        RowBox[{"grid", ",", "plot", ",", "plotoptions"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", "plot"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.66781928258258*^9, {3.667927651314351*^9, 
   3.667927654536632*^9}, {3.667929095288192*^9, 3.6679291258239803`*^9}, {
   3.667929267909597*^9, 3.6679293218335447`*^9}, {3.667929372921582*^9, 
   3.667929415065257*^9}, {3.667929450855839*^9, 3.667929465310821*^9}, {
   3.667929674490491*^9, 3.667929695296151*^9}, {3.667932801543818*^9, 
   3.667932831774096*^9}, {3.667932972267625*^9, 3.667933072145303*^9}, {
   3.6679331209365664`*^9, 3.6679331662069387`*^9}, {3.667933209078788*^9, 
   3.667933227509615*^9}, {3.6679332584155407`*^9, 3.6679334381219397`*^9}, {
   3.667933545119546*^9, 3.667933638124634*^9}, {3.667933670396723*^9, 
   3.6679337557378597`*^9}, {3.667933854434494*^9, 3.6679339195341597`*^9}, {
   3.6679341282991962`*^9, 3.667934134873889*^9}, {3.6679341782737226`*^9, 
   3.6679341840020323`*^9}, {3.6679362918882227`*^9, 3.66793629955867*^9}, 
   3.6679368778672867`*^9, {3.6679369198504763`*^9, 3.667936939064159*^9}, {
   3.6679369707445602`*^9, 3.667937040468952*^9}, {3.667937292923864*^9, 
   3.667937348973225*^9}, {3.6679374182060013`*^9, 3.667937480746695*^9}, {
   3.667937526410141*^9, 3.667937526969555*^9}, {3.667937583425147*^9, 
   3.667937674742606*^9}, {3.6679377238633833`*^9, 3.667937724894253*^9}, {
   3.667937808371294*^9, 3.6679378269471397`*^9}, {3.6679378802105713`*^9, 
   3.6679379711123447`*^9}, {3.667938005718261*^9, 3.6679380215741*^9}, {
   3.6679380570319643`*^9, 3.667938083541068*^9}, 3.6679381599247704`*^9, {
   3.66793820112397*^9, 3.66793823159343*^9}, {3.6679382956572037`*^9, 
   3.667938323449614*^9}, {3.667938366874012*^9, 3.667938389394507*^9}, {
   3.667938438128626*^9, 3.667938482933886*^9}, {3.6679385245828333`*^9, 
   3.667938637513776*^9}, {3.667938678441284*^9, 3.6679386932649508`*^9}, {
   3.667938766302857*^9, 3.667938772390689*^9}, {3.6679388267453012`*^9, 
   3.66793883006816*^9}, {3.667938882518243*^9, 3.6679389128181973`*^9}, {
   3.667938969803068*^9, 3.667939039336431*^9}, {3.667939320219082*^9, 
   3.667939341625779*^9}, 3.6679393770581408`*^9, {3.667939469232902*^9, 
   3.667939497964835*^9}, {3.667939532149186*^9, 3.6679395720840807`*^9}, 
   3.667939642501049*^9, 3.667939694842989*^9, {3.667939989576542*^9, 
   3.6679399917123747`*^9}, {3.6679401365541153`*^9, 
   3.6679401648221617`*^9}, {3.6679692529322023`*^9, 
   3.6679692701706533`*^9}, {3.667969341866721*^9, 3.667969376607637*^9}, {
   3.667970147145928*^9, 3.667970151592761*^9}, {3.667970216297092*^9, 
   3.6679702636391077`*^9}, {3.667970383427594*^9, 3.667970398444811*^9}, {
   3.667970463193151*^9, 3.667970504208695*^9}, {3.667971051562167*^9, 
   3.667971074354063*^9}, {3.667971771279505*^9, 3.667971780398533*^9}, {
   3.667973403161166*^9, 3.667973405361252*^9}, 3.667990367536018*^9, 
   3.6679914757391148`*^9, 3.667992175946229*^9, {3.667995104529952*^9, 
   3.667995106057413*^9}, {3.667995855313924*^9, 3.6679958569938917`*^9}, {
   3.668019108513597*^9, 3.668019128352426*^9}, {3.668019279072505*^9, 
   3.668019279848213*^9}, {3.668021278816801*^9, 3.668021282112631*^9}, {
   3.668021313401822*^9, 3.668021390441625*^9}, {3.6680214213580303`*^9, 
   3.668021451698588*^9}, {3.668021555880783*^9, 3.6680215849273357`*^9}, 
   3.668057813132045*^9, {3.668058136762526*^9, 3.668058164915876*^9}, {
   3.668058379699932*^9, 3.668058399154965*^9}, {3.6680584419942427`*^9, 
   3.668058535166953*^9}, {3.6680585771843357`*^9, 3.668058585352005*^9}, {
   3.668058667869895*^9, 3.668058671764526*^9}, {3.668059350708185*^9, 
   3.668059390641903*^9}, {3.668059561240314*^9, 3.668059570492672*^9}, {
   3.66805963935712*^9, 3.668059696425672*^9}, {3.668098237468328*^9, 
   3.668098249995756*^9}, {3.6681000141884813`*^9, 3.66810004431769*^9}, {
   3.668102295375621*^9, 3.668102328261784*^9}, {3.668143501205806*^9, 
   3.66814352368707*^9}, {3.668149871172584*^9, 3.668149875216461*^9}, {
   3.669519749593667*^9, 3.669519751591695*^9}, {3.6695563106568947`*^9, 
   3.669556316832087*^9}, {3.669556375703582*^9, 3.669556375942615*^9}, {
   3.669556527484511*^9, 3.6695565277148*^9}, {3.671344373430882*^9, 
   3.6713443736693897`*^9}, {3.6713446182723618`*^9, 3.671344618519547*^9}, {
   3.671344657281046*^9, 3.671344657415612*^9}, {3.671346974817726*^9, 
   3.671347016688924*^9}, {3.671347556830886*^9, 3.671347635440847*^9}, {
   3.6713476776843443`*^9, 3.671347679288475*^9}, {3.671347719383917*^9, 
   3.671347795245021*^9}, {3.671347853822792*^9, 3.6713478877165747`*^9}, {
   3.671348259934767*^9, 3.671348271084628*^9}, {3.671348314653845*^9, 
   3.6713483159313307`*^9}, {3.671351806693378*^9, 3.671351808371985*^9}, {
   3.671351925105709*^9, 3.6713519328813066`*^9}, {3.671352042856463*^9, 
   3.6713520444954348`*^9}, {3.671352141564987*^9, 3.6713521418921757`*^9}, {
   3.67135433001543*^9, 3.671354354775991*^9}, {3.6713543903521852`*^9, 
   3.671354407759055*^9}, {3.671354507228725*^9, 3.671354510406054*^9}, {
   3.671354581932342*^9, 3.67135461566549*^9}, {3.671354653643035*^9, 
   3.671354653697824*^9}, {3.6713547964307623`*^9, 3.6713547984468317`*^9}, {
   3.671354832134036*^9, 3.671354833102087*^9}, {3.67135529549364*^9, 
   3.671355302546892*^9}, {3.671355573087512*^9, 3.671355582974106*^9}, {
   3.671356555785466*^9, 3.6713565631134987`*^9}, {3.671356796908342*^9, 
   3.671356807093913*^9}, {3.671356934530822*^9, 3.671356940432358*^9}, {
   3.671356982272311*^9, 3.671357013320292*^9}, {3.6713574599357767`*^9, 
   3.6713574887658043`*^9}, 3.671357559702499*^9, {3.671358859881794*^9, 
   3.6713588975738163`*^9}, {3.6713589308612833`*^9, 3.671358950341908*^9}, 
   3.671359851957679*^9, {3.671360146383136*^9, 3.671360211557448*^9}, {
   3.671361450673636*^9, 3.671361450855844*^9}, {3.671361547079302*^9, 
   3.6713615655118837`*^9}, {3.6713722035701437`*^9, 3.671372204879589*^9}, 
   3.6713885646487226`*^9, {3.6713886420824947`*^9, 3.671388651920701*^9}, {
   3.6713887667366743`*^9, 3.671388767616539*^9}, {3.671389203847748*^9, 
   3.6713892089594584`*^9}, {3.67138931525079*^9, 3.6713893249230957`*^9}, {
   3.671389403263423*^9, 3.671389448584199*^9}, {3.671389482721499*^9, 
   3.671389552266603*^9}, {3.6713895972521553`*^9, 3.671389638503859*^9}, {
   3.671389675267129*^9, 3.6713896774792337`*^9}, 3.6713897131154537`*^9, {
   3.671806709661995*^9, 3.671806728097248*^9}, 3.6718073146802807`*^9, {
   3.671911114402894*^9, 3.671911120386015*^9}, {3.67195946711077*^9, 
   3.671959474991378*^9}, {3.6719595218231688`*^9, 3.67195952199016*^9}, {
   3.674582941255888*^9, 3.674582961526577*^9}, {3.674583042374473*^9, 
   3.674583044373474*^9}, {3.674583075638014*^9, 3.674583124381897*^9}, {
   3.6745831719336767`*^9, 3.674583173804262*^9}, 3.67458324742804*^9, {
   3.687156775422434*^9, 3.687156781933877*^9}, 3.687164508774666*^9, {
   3.6871645394569683`*^9, 3.687164718554234*^9}, {3.687165246225195*^9, 
   3.687165390883108*^9}, {3.687165450522169*^9, 3.6871655616493053`*^9}, {
   3.687165646846031*^9, 3.687165664977735*^9}, {3.687165710844844*^9, 
   3.687165717857222*^9}, {3.6871657857219877`*^9, 3.6871657877356358`*^9}, {
   3.6871658493381023`*^9, 3.687165871669606*^9}, {3.687165904197296*^9, 
   3.687165996079699*^9}, {3.6871660295334883`*^9, 3.687166153093152*^9}, {
   3.687166192079156*^9, 3.687166246078738*^9}, {3.6871668605632353`*^9, 
   3.6871669433889227`*^9}, 3.687166977069869*^9, {3.687167109987769*^9, 
   3.687167208870311*^9}, {3.687167238984859*^9, 3.6871677862844477`*^9}, 
   3.687167881607252*^9, {3.6871679214931793`*^9, 3.687168147685855*^9}, {
   3.6871682126935883`*^9, 3.687168275207411*^9}, {3.687168432381917*^9, 
   3.687168586540969*^9}, 3.687168628404684*^9, {3.687168658442284*^9, 
   3.687168663527091*^9}, 3.687169005717609*^9, 3.687169293454012*^9, {
   3.68750633090869*^9, 3.68750633648623*^9}, {3.6875071841161757`*^9, 
   3.687507184303252*^9}, {3.687507329340541*^9, 3.68750734744081*^9}, {
   3.687507400920726*^9, 3.687507423975339*^9}, {3.6875076419535522`*^9, 
   3.687507642224166*^9}, {3.687507713412353*^9, 3.6875077551581697`*^9}, {
   3.6875078576324587`*^9, 3.6875078877691603`*^9}, {3.687509544613727*^9, 
   3.6875095534866037`*^9}, {3.687509706784939*^9, 3.6875097103088217`*^9}, {
   3.687509833577773*^9, 3.68750989972786*^9}, {3.687509935327718*^9, 
   3.687509937855692*^9}, {3.687510167577135*^9, 3.6875101802065897`*^9}, {
   3.687510280296921*^9, 3.6875103742068367`*^9}, {3.687510514864278*^9, 
   3.687510517693245*^9}, {3.687510833967678*^9, 3.687510836634856*^9}, {
   3.687511073932612*^9, 3.687511074191729*^9}, {3.687512065559246*^9, 
   3.6875120662299633`*^9}, {3.68751234598036*^9, 3.687512347377809*^9}, {
   3.687514748805332*^9, 3.687514762556086*^9}, {3.6875147988089447`*^9, 
   3.687514862911953*^9}, {3.6875150221086493`*^9, 3.687515113015212*^9}, {
   3.687515242879355*^9, 3.6875152576859617`*^9}, {3.6875153755411043`*^9, 
   3.6875153761781673`*^9}, {3.687516002196384*^9, 3.687516030150734*^9}, {
   3.6875165012670918`*^9, 3.6875165247399*^9}, {3.6875165694845133`*^9, 
   3.687516572040914*^9}, {3.687516612818783*^9, 3.687516645184465*^9}, {
   3.687516683884563*^9, 3.687516724914262*^9}, {3.687516944466934*^9, 
   3.687516945219212*^9}, {3.687517002357984*^9, 3.687517023874254*^9}, 
   3.6875171351822653`*^9, {3.6875183237381067`*^9, 3.687518324957768*^9}, {
   3.687518398182641*^9, 3.68751841327169*^9}, {3.6875185644568996`*^9, 
   3.687518565549593*^9}, {3.68751886454458*^9, 3.687518891383182*^9}, {
   3.687519022393402*^9, 3.687519061776618*^9}, {3.6875190956572533`*^9, 
   3.687519182765481*^9}, {3.687519279346684*^9, 3.687519413303564*^9}, {
   3.6875194796623383`*^9, 3.687519523955543*^9}, 3.687519663585091*^9, {
   3.687519806348749*^9, 3.6875199887548847`*^9}, {3.6875200763660994`*^9, 
   3.687520141546947*^9}, {3.687520178418494*^9, 3.687520343242195*^9}, {
   3.687520527435096*^9, 3.6875205422137814`*^9}, {3.687520703883664*^9, 
   3.687520714415331*^9}, {3.687520748045477*^9, 3.6875207525783157`*^9}, {
   3.687521196110949*^9, 3.687521217133346*^9}, {3.6875212614386787`*^9, 
   3.6875212689137173`*^9}, {3.687521699605805*^9, 3.687521728841394*^9}, {
   3.6875217702469683`*^9, 3.687521790955085*^9}, {3.687521965231024*^9, 
   3.68752196773971*^9}, {3.6875220762878723`*^9, 3.68752207955971*^9}, 
   3.6875221341628*^9, {3.687522181579337*^9, 3.6875221857643147`*^9}, {
   3.687522225843388*^9, 3.6875223170336237`*^9}, {3.68752234812294*^9, 
   3.6875223735999107`*^9}, {3.6876686273963747`*^9, 3.687668651273189*^9}, {
   3.687669052317815*^9, 3.687669072963629*^9}, {3.687669221852079*^9, 
   3.687669231600322*^9}, 3.687669412928665*^9, {3.6876694739967422`*^9, 
   3.6876695144406843`*^9}, {3.6876708510183077`*^9, 3.687670879758339*^9}, {
   3.6876719237499723`*^9, 3.687671956628632*^9}, {3.6876719935829067`*^9, 
   3.687672018688109*^9}, {3.687672049692421*^9, 3.687672059143203*^9}, {
   3.687678052571329*^9, 3.687678061479775*^9}, {3.6876815475701523`*^9, 
   3.687681601640286*^9}, {3.687691708586556*^9, 3.6876917119783363`*^9}, {
   3.6876920372162*^9, 3.687692037367296*^9}, {3.687861711022195*^9, 
   3.687861735186718*^9}, {3.6878617699180517`*^9, 3.687861821841461*^9}, {
   3.687861855943221*^9, 3.687861900257381*^9}, 3.6878631121381683`*^9, {
   3.687863166001348*^9, 3.6878632357037086`*^9}, {3.687863297125453*^9, 
   3.6878633093477488`*^9}, {3.6878634144485273`*^9, 3.687863440543641*^9}, {
   3.6878635134405622`*^9, 3.6878635475897827`*^9}, {3.687863656295929*^9, 
   3.687863717150881*^9}, {3.687863768602734*^9, 3.687863813012793*^9}, {
   3.687863891791483*^9, 3.687863892735425*^9}, {3.68786392314459*^9, 
   3.687863938361341*^9}, {3.687864241126114*^9, 3.687864381110055*^9}, {
   3.68786442924084*^9, 3.687864552200337*^9}, {3.687864599173511*^9, 
   3.687864618328858*^9}, {3.687864667932199*^9, 3.687864692086171*^9}, {
   3.687864753006353*^9, 3.687864894596149*^9}, {3.687865192458065*^9, 
   3.687865227041898*^9}, {3.687865400024457*^9, 3.687865406423842*^9}, {
   3.6878659096425047`*^9, 3.687865947266676*^9}, {3.687865981660466*^9, 
   3.687865989851564*^9}, {3.6881267638468*^9, 3.688126781856586*^9}, {
   3.688126813279327*^9, 3.6881271692244463`*^9}, {3.688127225652492*^9, 
   3.688127281666382*^9}, {3.688127439709325*^9, 3.688127480871084*^9}, 
   3.688127512373879*^9, {3.688127553320573*^9, 3.68812755398044*^9}, {
   3.688127650793001*^9, 3.6881278726644087`*^9}, {3.688127919436009*^9, 
   3.688128024792449*^9}, {3.688128064984997*^9, 3.688128065652214*^9}, {
   3.688128133919053*^9, 3.688128219141905*^9}, {3.688128331504766*^9, 
   3.688128348212882*^9}, {3.68812842135893*^9, 3.688128501203792*^9}, {
   3.688128578509428*^9, 3.688128601410139*^9}, {3.688128690322328*^9, 
   3.688128735595336*^9}, {3.688128822364902*^9, 3.688128861848989*^9}, {
   3.688128921153905*^9, 3.6881289463480663`*^9}, {3.688128990765437*^9, 
   3.688129029272183*^9}, {3.688129089255213*^9, 3.688129094279276*^9}, {
   3.688129134305854*^9, 3.6881292730710773`*^9}, {3.6881465195183*^9, 
   3.688146524995182*^9}, {3.68814655619547*^9, 3.688146641081154*^9}, {
   3.688146684212517*^9, 3.688146807271761*^9}, {3.688146962193809*^9, 
   3.688146962567013*^9}, {3.688147017668222*^9, 3.688147052517234*^9}, {
   3.6881471414269114`*^9, 3.688147177803094*^9}, {3.688147247579743*^9, 
   3.688147297679015*^9}, {3.688147346935234*^9, 3.688147354976241*^9}, {
   3.688147391222777*^9, 3.688147395894573*^9}, {3.688147444480929*^9, 
   3.688147499317027*^9}, {3.6881475781337633`*^9, 3.688147610577223*^9}, {
   3.6881476745811653`*^9, 3.6881477683213873`*^9}, {3.688186721038027*^9, 
   3.6881867215562563`*^9}, {3.688186966939413*^9, 3.688186967535561*^9}, {
   3.68819148816154*^9, 3.6881915822168627`*^9}, {3.688191679333376*^9, 
   3.688191715244688*^9}, {3.6881917649517107`*^9, 3.688191766155924*^9}, {
   3.688192180136743*^9, 3.688192192228733*^9}, {3.688192366353334*^9, 
   3.688192439675796*^9}, {3.688192601562984*^9, 3.68819261857239*^9}, {
   3.688192693418126*^9, 3.6881927823590183`*^9}, {3.688192835817779*^9, 
   3.688192837581232*^9}, {3.688192876509275*^9, 3.688192885736589*^9}, {
   3.688192933504092*^9, 3.688192962975136*^9}, {3.688193016864141*^9, 
   3.688193147605221*^9}, {3.688193226631628*^9, 3.688193250588456*^9}, 
   3.6881932871489553`*^9, {3.6881934369086227`*^9, 3.6881934377091017`*^9}, 
   3.688193888436359*^9, {3.68827870320015*^9, 3.688278745786932*^9}, {
   3.688279867027066*^9, 3.688279873328266*^9}, {3.688281310768528*^9, 
   3.6882813540220747`*^9}, {3.688281401439827*^9, 3.688281443632139*^9}, {
   3.688281489159092*^9, 3.688281522219717*^9}, 3.688281585283691*^9, {
   3.688281629377688*^9, 3.6882816382592497`*^9}, {3.688281827595358*^9, 
   3.688281837415002*^9}, {3.688281895131445*^9, 3.688281986560493*^9}, {
   3.6882840199216003`*^9, 3.688284062897357*^9}, 3.688284096387642*^9, {
   3.688284218942671*^9, 3.688284275867519*^9}, {3.688284394168859*^9, 
   3.6882844495841*^9}, {3.688285129326865*^9, 3.6882851308678083`*^9}, {
   3.688288327231152*^9, 3.688288384783165*^9}, {3.688293063190908*^9, 
   3.6882930641267643`*^9}, {3.688297537916748*^9, 3.6882975833392277`*^9}, {
   3.68829801661409*^9, 3.6882980731607018`*^9}, {3.688299551066402*^9, 
   3.688299562144874*^9}, {3.688300900482009*^9, 3.688300910395095*^9}, {
   3.688360492469249*^9, 3.688360511436487*^9}, {3.688360624931951*^9, 
   3.688360627463565*^9}, {3.688880504257531*^9, 3.6888805253276567`*^9}, {
   3.688891789432199*^9, 3.6888917903726683`*^9}, {3.688894187838941*^9, 
   3.688894207337967*^9}, {3.6889003583112717`*^9, 3.688900368289029*^9}, {
   3.688937564965316*^9, 3.688937567425077*^9}, {3.6889376607109337`*^9, 
   3.688937678117669*^9}, {3.68893774692369*^9, 3.688937755983369*^9}, {
   3.6889377924952507`*^9, 3.6889378358089857`*^9}, {3.6889378986873407`*^9, 
   3.688937999505767*^9}, {3.688938099054064*^9, 3.688938168750766*^9}, {
   3.688938233749807*^9, 3.68893824083641*^9}, {3.688938308543055*^9, 
   3.6889383454914627`*^9}, {3.688938390207061*^9, 3.688938390924144*^9}, {
   3.713874107520574*^9, 3.7138741424861526`*^9}, {3.714129943250423*^9, 
   3.714129954600395*^9}, {3.71412999923943*^9, 3.714130005919458*^9}, {
   3.714199796296146*^9, 3.714199797509729*^9}, {3.714201044679081*^9, 
   3.714201053314817*^9}, {3.7142024150579453`*^9, 3.7142024269417686`*^9}, {
   3.715333526187746*^9, 3.715333552478838*^9}, {3.715333596840613*^9, 
   3.7153336189267*^9}, 3.7153347036928*^9, {3.7153347801787357`*^9, 
   3.715334822889534*^9}, {3.715335703580905*^9, 3.715335733109145*^9}, {
   3.715336054049705*^9, 3.7153360541917477`*^9}, {3.715336155641518*^9, 
   3.715336265520912*^9}, {3.715336320107382*^9, 3.715336330751687*^9}, {
   3.715336448177416*^9, 3.7153364577322807`*^9}, {3.7153364956595173`*^9, 
   3.715336495804838*^9}, 3.715336550828467*^9, 3.715336642896287*^9, {
   3.715852050263661*^9, 3.715852050597019*^9}, {3.7177408404502277`*^9, 
   3.717740856188644*^9}, {3.717740897228889*^9, 3.717740915600151*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[273]:=",ExpressionUUID->"3b83ef0b-0c8c-4ac7-9196-92cf80e66ed5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[274]:=",ExpressionUUID->"1b3f4c1b-87f9-4af0-bdf7-c3f161486632"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReciprocalSpaceTool", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.6846465171332808`*^9, 
   3.684646521502282*^9}, {3.688187362458959*^9, 
   3.68818736898453*^9}},ExpressionUUID->"9bd7a065-171d-467a-b863-\
5ea43593a2ec"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[275]:=",ExpressionUUID->"19ab0f63-116c-4295-a827-64eec93fdeb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ReciprocalSpaceTool"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<TooltipStyle\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Inconsolata\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[276]:=",ExpressionUUID->"eb758cc0-e57a-4769-b494-8d15ad3f0765"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[277]:=",ExpressionUUID->"521364a0-76d2-411d-bea3-66fb350aefde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReciprocalSpaceTool", "[", "\[IndentingNewLine]", 
   RowBox[{
   "input_String", ",", "\[IndentingNewLine]", "system_", ",", 
    "\[IndentingNewLine]", "data_List", ",", "\[IndentingNewLine]", 
    RowBox[{"Optional", "[", 
     RowBox[{"pattern_Condition", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", "False"}]}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "ReciprocalSpaceTool"}]}], 
   "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "xraytemp", ",", "lastinput", ",", "\[IndentingNewLine]", "adjust", 
        ",", "\[IndentingNewLine]", "img", ",", "imgN", ",", "imgG", ",", 
        "imgNG", ",", "imgB", ",", "\[IndentingNewLine]", "L", ",", "pd", ",",
         "pdMatch", ",", "pdOff", ",", "grids", ",", "\[IndentingNewLine]", 
        "sim1", ",", "tooltip", ",", "SIM1", ",", "data2D", ",", 
        "\[IndentingNewLine]", "\[CapitalLambda]", ",", "\[CapitalGamma]", 
        ",", "\[Xi]", ",", "\[Chi]", ",", "r", ",", "\[CapitalLambda]1x", ",",
         "\[CapitalLambda]1y", ",", "\[CapitalLambda]2x", ",", 
        "\[CapitalLambda]2y", ",", "p", ",", "\[Lambda]1", ",", "\[Lambda]2", 
        ",", "tx", ",", "ty", ",", "h1h2", ",", "xy", ",", 
        "\[IndentingNewLine]", "\[Sigma]", ",", "\[Tau]x", ",", "\[Tau]y", 
        ",", "xysim1", ",", "hksim1", ",", "sim1data", ",", 
        "\[IndentingNewLine]", "plots", ",", "\[IndentingNewLine]", 
        "plotbackground", ",", "\[IndentingNewLine]", "N1", ",", "N2", ",", 
        "N3", ",", "plotoptions", ",", "plotaxes", ",", "plotgrid"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"*", " ", "Input", " ", "check"}], " ", "**)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "temporary", " ", "variables"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"Label", "[", "\"\<CollectData\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"xraytemp", "=", "$XrayTemp"}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"lastinput", "=", "$XrayTempLast"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{"update", ",", 
         RowBox[{
          RowBox[{"lastinput", "=", "\"\<False\>\""}], ";", 
          RowBox[{"update", "=", "False"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"lastinput", "===", "input"}], "&&", 
          RowBox[{"AssociationQ", "@", "$XrayTemp"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"Use", " ", "stored", " ", "data"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "img", ",", "imgN", ",", "imgG", ",", "imgNG", ",", "imgB", ",", 
            "\[IndentingNewLine]", "\t", "\[CapitalLambda]", ",", "L", ",", 
            "adjust", ",", "\[IndentingNewLine]", "\t", "pd", ",", "pdMatch", 
            ",", "pdOff", ",", "\[IndentingNewLine]", "\t", "grids"}], "}"}], 
          "=", "\[IndentingNewLine]", "\t", 
          RowBox[{"Values", "@", 
           RowBox[{"xraytemp", "[", 
            RowBox[{"[", 
             RowBox[{"{", "\[IndentingNewLine]", "\t", 
              RowBox[{
              "\"\<Image\>\"", ",", "\"\<ImageNegative\>\"", ",", 
               "\"\<ImageGrayscale\>\"", ",", "\[IndentingNewLine]", "\t", 
               "\"\<ImageGrayscaleNegative\>\"", ",", 
               "\"\<ImageBinarised\>\"", ",", "\[IndentingNewLine]", "\t", 
               "\"\<Lattice\>\"", ",", "\"\<LatticeBasic\>\"", ",", 
               "\"\<Adjust\>\"", ",", "\[IndentingNewLine]", "\t", 
               "\"\<Plotdata\>\"", ",", "\"\<PlotdataMatch\>\"", ",", 
               "\"\<PlotdataWrong\>\"", ",", "\[IndentingNewLine]", "\t", 
               "\"\<Grids\>\""}], "\[IndentingNewLine]", "\t", "}"}], "]"}], 
            "]"}]}]}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"Collect", " ", "new", " ", "data"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"Update", " ", "temporary", " ", "variables"}], " ", "*)"}],
          "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"$XrayTemp", "=", 
           RowBox[{"ReciprocalImageCheck", "[", "\[IndentingNewLine]", "\t\t", 
            RowBox[{
            "input", ",", "system", ",", "data", ",", "pattern", ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"\"\<StoreData\>\"", "\[Rule]", "True"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", "Update", "  ", "*)"}], "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"$XrayTempLast", "=", "input"}], ";", "\[IndentingNewLine]",
           "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Go", " ", "back", " ", "and", " ", "load", " ", "data"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Goto", "[", "\"\<CollectData\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"*", " ", "Plot", " ", "layers"}], " ", "**)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"plots", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Background", " ", "image", " ", "processing"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"plotbackground", "=", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"LAimage", "\[Equal]", "\"\<Original\>\""}], ",", "img", 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"LAimage", "\[Equal]", "\"\<Negative\>\""}], ",", "imgN", 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"LAimage", "\[Equal]", "\"\<Grayscale\>\""}], ",", "imgG", 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"LAimage", "\[Equal]", "\"\<Negative + Grayscale\>\""}], 
          ",", "imgNG", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"LAimage", "\[Equal]", "\"\<Binarised\>\""}], ",", "imgB", 
          ",", "\[IndentingNewLine]", "\t", "True", ",", "False"}], 
         "\[IndentingNewLine]", "\t", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ImageQ", "@", "plotbackground"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"plots", ",", "plotbackground"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", "Grid", " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IntegerQ", "@", "LAsize"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{
          RowBox[{"plotgrid", "=", 
           RowBox[{"grids", "[", 
            RowBox[{"[", "LAsize", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
           "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", "plotgrid"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Extracted", " ", "nodes"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pd", "\[NotEqual]", 
          RowBox[{"{", 
           RowBox[{"Null", ",", "Null"}], "}"}]}], ",", "\[IndentingNewLine]",
          "\t", 
         RowBox[{"N1enable", "=", "True"}], ",", "\[IndentingNewLine]", "\t", 
         
         RowBox[{"N1enable", "=", "False"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"N1", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"pd", ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", "\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "\[Rule]", "Large"}], ",", 
              "\[IndentingNewLine]", "\t", "Automatic", ",", 
              "\[IndentingNewLine]", "\t", "N1colour", ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"Opacity", "[", "N1opacity", "]"}]}], "}"}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{"N1show", ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"plots", ",", "N1"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Nodes", " ", "matching", " ", "condition"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pdMatch", "\[NotEqual]", 
          RowBox[{"{", 
           RowBox[{"Null", ",", "Null"}], "}"}]}], ",", "\[IndentingNewLine]",
          "\t", 
         RowBox[{"N2enable", "=", "True"}], ",", "\[IndentingNewLine]", "\t", 
         
         RowBox[{"N2enable", "=", "False"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"N2", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"pdMatch", ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", "\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "\[Rule]", "Large"}], ",", 
              "\[IndentingNewLine]", "\t", "Automatic", ",", 
              "\[IndentingNewLine]", "\t", "N2colour", ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"Opacity", "[", "N2opacity", "]"}]}], "}"}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{"N2show", ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"plots", ",", "N2"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Wrong", " ", "nodes"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pdOff", "\[NotEqual]", 
          RowBox[{"{", 
           RowBox[{"Null", ",", "Null"}], "}"}]}], ",", "\[IndentingNewLine]",
          "\t", 
         RowBox[{"N3enable", "=", "True"}], ",", "\[IndentingNewLine]", "\t", 
         
         RowBox[{"N3enable", "=", "False"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"N3", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"pdOff", ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", "\[IndentingNewLine]", "\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "\[Rule]", "Large"}], ",", 
              "\[IndentingNewLine]", "\t", "Automatic", ",", 
              "\[IndentingNewLine]", "\t", "N3colour", ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"Opacity", "[", "N3opacity", "]"}]}], "}"}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{"N3show", ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"plots", ",", "N3"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"*", " ", "Simulated", " ", "nodes"}], " ", "**)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{"SIM1calc", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"Generate", " ", "simulated", " ", "nodes"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"sim1", "=", 
           RowBox[{
           "ReciprocalSpaceSimulation", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
            "SIM1name", ",", "SIM1plane", ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{
               RowBox[{"Total", "[", "SIM1plane", "]"}], "-", "1"}], "/.", 
              RowBox[{
               RowBox[{"-", "1"}], "\[Rule]", "SIM1level"}]}], ",", 
             "\[IndentingNewLine]", "\t", "SIM1res", ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<ReturnData\>\"", "\[Rule]", "True"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Lattice", " ", "components", " ", "and", " ", "misc"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[CapitalLambda]1x", ",", "\[CapitalLambda]2x"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[CapitalLambda]1y", ",", "\[CapitalLambda]2y"}], 
              "}"}]}], "}"}], "=", "\[CapitalLambda]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tx", ",", "ty"}], "}"}], "=", "adjust"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"p", "=", 
           RowBox[{"First", "@", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Total", "[", "SIM1plane", "]"}], ",", "0"}], 
              "]"}]}]}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"sim1", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"sim1", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", "2", ",", "p"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "@", "sim1"}]}], "}"}]}], "]"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"data2D", "=", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", "sim1"}], ",", "4"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Function", " ", "for", " ", "calculating", " ", "residue"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x_", ",", "y_", ",", "h1_", ",", "h2_"}], "}"}], ",", 
             "\[Sigma]_", ",", "\[Tau]x_", ",", "\[Tau]y_"}], "]"}], ":=", 
           RowBox[{"N", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "*", "x"}], "+", "\[Tau]x"}], ")"}], 
                "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "*", "y"}], "+", "\[Tau]y"}], ")"}], 
                "2"]}], "]"}], "-", "\[IndentingNewLine]", "\t", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"tx", "+", 
                  RowBox[{"h1", "*", "\[CapitalLambda]1x"}], "+", 
                  RowBox[{"h2", "*", "\[CapitalLambda]2x"}]}], ")"}], "2"], 
               "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"ty", "+", 
                  RowBox[{"h1", "*", "\[CapitalLambda]1y"}], "+", 
                  RowBox[{"h2", "*", "\[CapitalLambda]2y"}]}], ")"}], "2"]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Determining", " ", "scaling", " ", "factors", " ", "by", " ", 
            "iteration"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "\[Tau]x", ",", "\[Tau]y"}], "}"}], "=", 
           
           RowBox[{
           "NonlinearLeastSquares", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"r", ",", "data2D", ",", 
             RowBox[{"{", 
              RowBox[{"1000", ",", "tx", ",", "ty"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Scaling", " ", "and", " ", "preparing", " ", "simulated", " ", 
            "nodes"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"xysim1", "=", 
           RowBox[{"data2D", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"xysim1", "=", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Tau]x", ",", "\[Tau]y"}], "}"}], "+", "#"}], "&"}],
              "/@", 
             RowBox[{"(", 
              RowBox[{"\[Sigma]", "*", "xysim1"}], ")"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"hksim1", "=", 
           RowBox[{"data2D", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"hksim1", "=", 
           RowBox[{"Map", "[", 
            RowBox[{"ToMiller", ",", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"Insert", "[", 
                RowBox[{"#", ",", "SIM1level", ",", 
                 RowBox[{"{", "3", "}"}]}], "]"}], "&"}], "/@", "hksim1"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          
          RowBox[{"(*", " ", 
           RowBox[{
           "Add", " ", "tooltip", " ", "and", " ", "prepare", " ", "plot"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"sim1data", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", "\t", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{
                 "OptionValue", "[", "\"\<TooltipStyle\>\"", "]"}]}]}], "]"}],
               "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"xysim1", ",", "hksim1"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
          RowBox[{"SIM1", "=", 
           RowBox[{"ListPlot", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"sim1data", ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]",
              "\t", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", "\[IndentingNewLine]", "\t", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "\[Rule]", "Large"}], ",", 
                 "\[IndentingNewLine]", "\t", "Automatic", ",", 
                 "\[IndentingNewLine]", "\t", "SIM1colour", ",", 
                 "\[IndentingNewLine]", "\t", 
                 RowBox[{"Opacity", "[", "SIM1opacity", "]"}]}], "}"}], 
               "}"}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{"SIM1add", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"plots", ",", "SIM1"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"*", " ", "Plot"}], " ", "**)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"plotoptions", "=", 
        RowBox[{"{", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"OUTx", ",", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"1475", "/", "1679"}], "*", "OUTx"}], "]"}]}], "}"}]}],
           ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1679"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1475"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1475", "/", "1679"}]}], ",", "\[IndentingNewLine]", "\t", 
          
          RowBox[{"ToExpression", "@", "OUTframe"}]}], "\[IndentingNewLine]", 
         "\t", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"plotaxes", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "plotoptions"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"PrependTo", "[", 
        RowBox[{"plots", ",", "plotaxes"}], "]"}], ";", "\[IndentingNewLine]",
        "\t", 
       RowBox[{"output", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"plots", ",", "plotoptions"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "Manipulation", " ", "controls"}], " ", "**)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Misc", " ", "initial", " ", "parameters"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"update", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"OUTx", ",", "520", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"OUTframe", ",", 
      RowBox[{"{", "\"\<Frame->True\>\"", "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"LAswitch", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"LAsize", ",", "\"\<Off\>\"", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"LAimage", ",", "\"\<Off\>\"", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N1enable", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N1switch", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N1show", ",", "True", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N1colour", ",", 
      RowBox[{"ColorData", "[", 
       RowBox[{"97", ",", "1"}], "]"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N1opacity", ",", "1", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N2enable", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N2switch", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N2show", ",", "True", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N2colour", ",", 
      RowBox[{"ColorData", "[", 
       RowBox[{"97", ",", "2"}], "]"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N2opacity", ",", "1", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N3enable", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N3switch", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N3show", ",", "True", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N3colour", ",", "LightGray", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"N3opacity", ",", "1", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"SIM1switch", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"SIM1colour", ",", 
      RowBox[{"ColorData", "[", 
       RowBox[{"97", ",", "3"}], "]"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"SIM1opacity", ",", "1", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"SIM1name", ",", "\"\<\>\"", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"SIM1plane", ",", "\"\<None\>\"", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"SIM1level", ",", "0", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"SIM1res", ",", "0.8", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"SIM1calc", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"SIM1add", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"POswitch", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"EPswitch", ",", "False", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"EPformat", ",", "\"\<pdf\>\"", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"EPname", ",", "\"\<\>\"", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"{", 
     RowBox[{"output", ",", "True", ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Extracted", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"Row", "[", 
     RowBox[{"{", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<Extracted data\>\"", ",", "Bold", ",", "Medium", ",", "16"}], 
        "]"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Spacer", "[", "160", "]"}], ",", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Update\>\"", ",", 
         RowBox[{"update", "=", "True"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"65", ",", "Automatic"}], "}"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "\t", "}"}], "]"}], ",", "\[IndentingNewLine]", 
    "\t", "Delimiter", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Lattice", " ", "and", " ", "background"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{"Row", "[", 
     RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"Toggler", "[", 
        RowBox[{
         RowBox[{"Dynamic", "@", "LAswitch"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"True", "\[Rule]", "#"}], ",", 
             RowBox[{"False", "\[Rule]", "#"}]}], "}"}], "&"}], 
          "\[IndentingNewLine]", "\t\t", "@", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Lattice and background\>\"", ",", "14"}], "]"}]}]}], 
        "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       
       RowBox[{"Opener", "@", 
        RowBox[{"Dynamic", "@", "LAswitch"}]}]}], "\[IndentingNewLine]", 
      "\t\t", "}"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]",
     "\t\t", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"If", "[", 
      RowBox[{"LAswitch", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Panel", "@", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Lattice\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "50", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"SetterBar", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "LAsize"}], ",", 
                RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
                 RowBox[{
                  RowBox[{"\"\<Off\>\"", "\[Rule]", "\"\<Off\>\""}], ",", 
                  "\[IndentingNewLine]", "\t\t", 
                  RowBox[{"1", "\[Rule]", "\"\<Unit vectors\>\""}], ",", 
                  "\[IndentingNewLine]", "\t\t", 
                  RowBox[{"2", "\[Rule]", "\"\<1\>\""}], ",", 
                  RowBox[{"3", "\[Rule]", "\"\<2\>\""}], ",", 
                  RowBox[{"4", "\[Rule]", "\"\<3\>\""}], ",", 
                  RowBox[{"5", "\[Rule]", "\"\<4\>\""}], ",", 
                  RowBox[{"6", "\[Rule]", "\"\<5\>\""}], ",", 
                  RowBox[{"7", "\[Rule]", "\"\<6\>\""}]}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Background\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "25", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"PopupMenu", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "LAimage"}], ",", 
                RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
                 RowBox[{
                 "\"\<Off\>\"", ",", "\"\<Original\>\"", ",", 
                  "\"\<Negative\>\"", ",", "\"\<Grayscale\>\"", ",", 
                  "\[IndentingNewLine]", "\t\t", 
                  "\"\<Negative + Grayscale\>\"", ",", "\"\<Binarised\>\""}], 
                 "}"}]}], "]"}]}], "\[IndentingNewLine]", "\t\t", "}"}], 
            "]"}]}], "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", 
          "\t\t", "}"}], "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}]}], 
    ",", "\[IndentingNewLine]", "\t", "Delimiter", ",", "\[IndentingNewLine]",
     "\[IndentingNewLine]", "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Extracted", " ", "nodes"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t\t", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"If", "[", 
      RowBox[{"N1enable", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"Toggler", "[", 
           RowBox[{
            RowBox[{"Dynamic", "@", "N1switch"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"True", "\[Rule]", "#"}], ",", 
                RowBox[{"False", "\[Rule]", "#"}]}], "}"}], "&"}], 
             "\[IndentingNewLine]", "\t\t", "@", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Extracted nodes\>\"", ",", "14"}], "]"}]}]}], 
           "]"}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"Opener", "@", 
           RowBox[{"Dynamic", "@", "N1switch"}]}]}], "\[IndentingNewLine]", 
         "\t\t", "}"}], "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Extracted nodes\>\"", ",", "14", ",", "Gray"}], "]"}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"If", "[", 
      RowBox[{"N1switch", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Panel", "@", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Show\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "77", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Checkbox", "@", 
               RowBox[{"Dynamic", "@", "N1show"}]}]}], "\[IndentingNewLine]", 
             "\t\t", "}"}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Node colour\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "50", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"ColorSlider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "N1colour"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"190", ",", "30"}], "}"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Opacity of nodes\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "28", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "N1opacity"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
                "\t\t", 
                RowBox[{"ImageSize", "\[Rule]", "190"}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Appearance", "\[Rule]", "Medium"}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Spacer", "[", "150", "]"}], ",", "\[IndentingNewLine]",
               "\t\t", 
              RowBox[{"Button", "[", 
               RowBox[{
               "\"\<Reset colour\>\"", ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{
                 RowBox[{"N1colour", "=", 
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "1"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"N1opacity", "=", "1"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}]}], 
          "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", "}"}],
          "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}]}], 
    ",", "\[IndentingNewLine]", "\t", "Delimiter", ",", "\[IndentingNewLine]",
     "\[IndentingNewLine]", "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Conditional", " ", "selection"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"If", "[", 
      RowBox[{"N2enable", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"Toggler", "[", 
           RowBox[{
            RowBox[{"Dynamic", "@", "N2switch"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"True", "\[Rule]", "#"}], ",", 
                RowBox[{"False", "\[Rule]", "#"}]}], "}"}], "&"}], 
             "\[IndentingNewLine]", "\t\t", "@", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Conditional selection\>\"", ",", "14"}], "]"}]}]}],
            "]"}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"Opener", "@", 
           RowBox[{"Dynamic", "@", "N2switch"}]}]}], "\[IndentingNewLine]", 
         "\t\t", "}"}], "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Conditional selection\>\"", ",", "14", ",", "Gray"}], 
        "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"If", "[", 
      RowBox[{"N2switch", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Panel", "@", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Show\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "77", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Checkbox", "@", 
               RowBox[{"Dynamic", "@", "N2show"}]}]}], "\[IndentingNewLine]", 
             "\t\t", "}"}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Node colour\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "50", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"ColorSlider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "N2colour"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"190", ",", "30"}], "}"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Opacity of nodes\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "28", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "N2opacity"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
                "\t\t", 
                RowBox[{"ImageSize", "\[Rule]", "190"}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Appearance", "\[Rule]", "Medium"}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Spacer", "[", "150", "]"}], ",", "\[IndentingNewLine]",
               "\t\t", 
              RowBox[{"Button", "[", 
               RowBox[{
               "\"\<Reset colour\>\"", ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{
                 RowBox[{"N2colour", "=", 
                  RowBox[{"ColorData", "[", 
                   RowBox[{"97", ",", "2"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"N2opacity", "=", "1"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}]}], 
          "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", "}"}],
          "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}]}], 
    ",", "\[IndentingNewLine]", "\t", "Delimiter", ",", "\[IndentingNewLine]",
     "\[IndentingNewLine]", "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Wrong", " ", "nodes"}], " ", "*)"}], "\t\t", 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"If", "[", 
      RowBox[{"N3enable", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"Toggler", "[", 
           RowBox[{
            RowBox[{"Dynamic", "@", "N3switch"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"True", "\[Rule]", "#"}], ",", 
                RowBox[{"False", "\[Rule]", "#"}]}], "}"}], "&"}], 
             "\[IndentingNewLine]", "\t\t", "@", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Wrong nodes\>\"", ",", "14"}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"Opener", "@", 
           RowBox[{"Dynamic", "@", "N3switch"}]}]}], "\[IndentingNewLine]", 
         "\t\t", "}"}], "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Wrong nodes\>\"", ",", "14", ",", "Gray"}], "]"}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"If", "[", 
      RowBox[{"N3switch", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Panel", "@", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Show\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "77", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Checkbox", "@", 
               RowBox[{"Dynamic", "@", "N3show"}]}]}], "\[IndentingNewLine]", 
             "\t\t", "}"}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Node colour\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "50", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"ColorSlider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "N3colour"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"190", ",", "30"}], "}"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Opacity of nodes\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "28", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "N3opacity"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
                "\t\t", 
                RowBox[{"ImageSize", "\[Rule]", "190"}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Appearance", "\[Rule]", "Medium"}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Spacer", "[", "150", "]"}], ",", "\[IndentingNewLine]",
               "\t\t", 
              RowBox[{"Button", "[", 
               RowBox[{
               "\"\<Reset colour\>\"", ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{
                 RowBox[{"N3colour", "=", "LightGray"}], ";", 
                 "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"N3opacity", "=", "1"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}]}], 
          "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", "}"}],
          "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}]}], 
    ",", "\[IndentingNewLine]", "\t", "Delimiter", ",", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{"Spacer", "[", 
     RowBox[{"{", 
      RowBox[{"15", ",", "15"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Simulated", " ", "data"}], " ", "*)"}], "\t", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<Simulated data\>\"", ",", "Bold", ",", "Medium", ",", "16"}], "]"}],
     ",", "\[IndentingNewLine]", "\t", "Delimiter", ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Simulation", " ", "input", " ", "1"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{"Row", "[", 
     RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"Toggler", "[", 
        RowBox[{
         RowBox[{"Dynamic", "@", "SIM1switch"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"True", "\[Rule]", "#"}], ",", 
             RowBox[{"False", "\[Rule]", "#"}]}], "}"}], "&"}], 
          "\[IndentingNewLine]", "\t\t", "@", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Simulation input\>\"", ",", "14"}], "]"}]}]}], "]"}], 
       ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       
       RowBox[{"Opener", "@", 
        RowBox[{"Dynamic", "@", "SIM1switch"}]}]}], "\[IndentingNewLine]", 
      "\t\t", "}"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]",
     "\t\t", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"If", "[", 
      RowBox[{"SIM1switch", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Panel", "@", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Input data\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "7", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"InputField", "[", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
                RowBox[{"Dynamic", "[", "SIM1name", "]"}], ",", 
                "\[IndentingNewLine]", "\t\t", "String", ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"FieldHint", "\[Rule]", "\"\<Crystal name\>\""}], ",",
                 "\[IndentingNewLine]", "\t\t", 
                RowBox[{"FieldSize", "\[Rule]", "14"}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Image plane normal\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "3", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"SetterBar", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "SIM1plane"}], ",", 
                RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                   "\[Rule]", 
                   "\"\<\!\(\*SuperscriptBox[\(a\), \(*\)]\)\>\""}], ",", 
                  "\[IndentingNewLine]", "\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                   "\[Rule]", 
                   "\"\<\!\(\*SuperscriptBox[\(b\), \(*\)]\)\>\""}], ",", 
                  "\[IndentingNewLine]", "\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], 
                   "\[Rule]", 
                   "\"\<\!\(\*SuperscriptBox[\(c\), \(*\)]\)\>\""}]}], 
                 "\[IndentingNewLine]", "\t\t", "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Text", "[", "\"\<intersecting the plane at\>\"", "]"}],
               ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"PopupMenu", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "SIM1level"}], ",", 
                RowBox[{"Reverse", "@", 
                 RowBox[{"Range", "[", 
                  RowBox[{
                   RowBox[{"-", "5"}], ",", "5"}], "]"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Resolution\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "SIM1res"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.1", ",", "5.0", ",", "0.05"}], "}"}]}], "]"}], 
              ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"Row", "[", 
                RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
                 RowBox[{
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"SIM1res", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", "\t\t", 
                  "\"\< \!\(\*SuperscriptBox[\(\[CapitalARing]\), \(-1\)]\)\>\
\""}], "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", "\t\t", "}"}], "]"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Node colour\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "60", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"ColorSlider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "SIM1colour"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"192", ",", "31"}], "}"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Opacity of nodes\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "SIM1opacity"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{"\"\<Add\>\"", ",", 
                RowBox[{"SIM1calc", "=", 
                 RowBox[{"SIM1add", "=", "True"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"SIM1plane", "===", "\"\<None\>\""}], "||", 
                   RowBox[{"SIM1name", "===", "\"\<\>\""}]}], ",", 
                  "\[IndentingNewLine]", "\t\t", 
                  RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], "]"}], 
              ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<Remove\>\"", ",", 
                RowBox[{"SIM1calc", "=", 
                 RowBox[{"SIM1add", "=", "False"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}]}], 
          "\[IndentingNewLine]", "\t\t", "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}]}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    
    RowBox[{"Spacer", "[", 
     RowBox[{"{", 
      RowBox[{"15", ",", "15"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Image", " ", "controls"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<Image controls\>\"", ",", "Bold", ",", "Medium", ",", "16"}], "]"}],
     ",", "\[IndentingNewLine]", "\t", "Delimiter", ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Plot", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t\t", 
    RowBox[{"Row", "[", 
     RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"Toggler", "[", 
        RowBox[{
         RowBox[{"Dynamic", "@", "POswitch"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"True", "\[Rule]", "#"}], ",", 
             RowBox[{"False", "\[Rule]", "#"}]}], "}"}], "&"}], 
          "\[IndentingNewLine]", "\t\t", "@", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Plot options\>\"", ",", "14"}], "]"}]}]}], "]"}], ",",
        "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       
       RowBox[{"Opener", "@", 
        RowBox[{"Dynamic", "@", "POswitch"}]}]}], "\[IndentingNewLine]", 
      "\t\t", "}"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]",
     "\t\t", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"If", "[", 
      RowBox[{"POswitch", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Panel", "@", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Plot size\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "OUTx"}], ",", 
                RowBox[{"{", 
                 RowBox[{"320", ",", "1024", ",", "1"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Pixel dimensions\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "OUTx"}], ",", "Number", ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", "\"\< \[Times] \>\"", ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"1475", "/", "1679"}], "*", "OUTx"}], "]"}]}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Plot frame\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"SetterBar", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "OUTframe"}], ",", 
                RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", "\"\<Frame->True\>\"", "}"}], "\[Rule]", 
                   "\"\<Frame\>\""}], ",", "\[IndentingNewLine]", "\t\t", 
                  RowBox[{
                   RowBox[{"{", "\"\<Axes->True\>\"", "}"}], "\[Rule]", 
                   "\"\<Axes\>\""}], ",", "\[IndentingNewLine]", "\t\t", 
                  RowBox[{
                   RowBox[{"{", "\"\<Axes->False\>\"", "}"}], "\[Rule]", 
                   "\"\<None\>\""}]}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "}"}], "]"}]}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}]}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Export", " ", "plot"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t\t", 
    RowBox[{"Row", "[", 
     RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"Toggler", "[", 
        RowBox[{
         RowBox[{"Dynamic", "@", "EPswitch"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"True", "\[Rule]", "#"}], ",", 
             RowBox[{"False", "\[Rule]", "#"}]}], "}"}], "&"}], 
          "\[IndentingNewLine]", "\t\t", "@", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Export plot\>\"", ",", "14"}], "]"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Spacer", "[", "5", "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       
       RowBox[{"Opener", "@", 
        RowBox[{"Dynamic", "@", "EPswitch"}]}]}], "\[IndentingNewLine]", 
      "\t\t", "}"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]",
     "\t\t", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"If", "[", 
      RowBox[{"EPswitch", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Panel", "@", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Filename\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "EPname"}], ",", "String", ",", 
                RowBox[{"FieldHint", "\[Rule]", "\"\<Name\>\""}]}], "]"}]}], 
             "\[IndentingNewLine]", "\t\t", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<File format\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"SetterBar", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "EPformat"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<jpg\>\"", ",", "\"\<png\>\"", ",", "\"\<pdf\>\""}], 
                 "}"}]}], "]"}]}], "\[IndentingNewLine]", "\t\t", "}"}], 
            "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Output directory\>\"", "]"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"Button", "[", 
               RowBox[{
               "\"\<Desktop\>\"", ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Export", "[", 
                 RowBox[{
                  RowBox[{"FileNameJoin", "[", 
                   RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
                    RowBox[{
                    "$HomeDirectory", ",", "\"\<Desktop\>\"", ",", 
                    "\[IndentingNewLine]", "\t\t", 
                    RowBox[{"EPname", "<>", "\"\<.\>\"", "<>", "EPformat"}]}],
                     "}"}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
                  "output"}], "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}]}],
              "\[IndentingNewLine]", "\t\t", "}"}], "]"}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "}"}], "]"}]}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}]}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Paneled", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.684745337599188*^9, 3.68474537980447*^9}, {
   3.684745683328042*^9, 3.6847456907977457`*^9}, {3.6847457891850033`*^9, 
   3.684746061305086*^9}, {3.684746141124728*^9, 3.684746199596496*^9}, {
   3.684746239968897*^9, 3.684746476906747*^9}, 3.684746516183593*^9, {
   3.684746565602297*^9, 3.684746701504117*^9}, {3.684747704997624*^9, 
   3.684747714320107*^9}, {3.6847478257793713`*^9, 3.684747830808964*^9}, {
   3.684747904590282*^9, 3.684747909027731*^9}, {3.684747987584041*^9, 
   3.6847479901077967`*^9}, {3.6847480366430817`*^9, 3.684748399057756*^9}, {
   3.684749405159607*^9, 3.684749488355398*^9}, {3.684749543943878*^9, 
   3.6847496737773943`*^9}, {3.684749730279647*^9, 3.684749913917756*^9}, {
   3.684749985476234*^9, 3.684750039391656*^9}, {3.6847500890619307`*^9, 
   3.68475009107802*^9}, {3.6847503748919067`*^9, 3.684750422744948*^9}, {
   3.6847506849349947`*^9, 3.684750753350258*^9}, {3.684750809214427*^9, 
   3.684750839528977*^9}, {3.684750911740037*^9, 3.684751027853921*^9}, {
   3.6847510958058243`*^9, 3.684751169395117*^9}, {3.684751226987747*^9, 
   3.684751247567849*^9}, {3.684751383586632*^9, 3.684751386819116*^9}, {
   3.68475158838805*^9, 3.684751675188871*^9}, {3.684754099955616*^9, 
   3.684754130897352*^9}, {3.685093713849648*^9, 3.685093714753817*^9}, {
   3.6852517446001863`*^9, 3.6852517477297363`*^9}, {3.685767547708188*^9, 
   3.685767548831842*^9}, {3.687001964745152*^9, 3.6870019744028*^9}, {
   3.688107597786675*^9, 3.688107665612611*^9}, 3.688187393541828*^9, {
   3.688187432108532*^9, 3.688187457895165*^9}, 3.688191356512495*^9, {
   3.688191921835215*^9, 3.688191921962541*^9}, {3.6881920541770973`*^9, 
   3.688192062988988*^9}, {3.688192096561056*^9, 3.688192173391622*^9}, {
   3.6881922192278013`*^9, 3.688192223740445*^9}, {3.6881922546583033`*^9, 
   3.688192272545162*^9}, {3.688192449333951*^9, 3.688192449645548*^9}, {
   3.688193253927661*^9, 3.6881932589695997`*^9}, {3.688193525230608*^9, 
   3.688193572112845*^9}, {3.68819389783714*^9, 3.688193913239666*^9}, {
   3.6881943397030973`*^9, 3.688194384201673*^9}, {3.688194423379434*^9, 
   3.688194433494541*^9}, {3.688194463690721*^9, 3.688194499410877*^9}, {
   3.688195539904729*^9, 3.688195544462328*^9}, {3.688196379115757*^9, 
   3.688196489866213*^9}, {3.688197507676092*^9, 3.688197508387739*^9}, {
   3.68819757718718*^9, 3.688197613861766*^9}, {3.688197743351756*^9, 
   3.688197782298257*^9}, {3.688199036231591*^9, 3.688199109239403*^9}, {
   3.688199224476853*^9, 3.688199248450754*^9}, {3.688199419783801*^9, 
   3.6881994204629602`*^9}, {3.688199463475759*^9, 3.688199469756166*^9}, {
   3.688199632748536*^9, 3.688199639739724*^9}, {3.6881996713166857`*^9, 
   3.688199750196123*^9}, {3.6882058232138147`*^9, 3.6882058233835173`*^9}, {
   3.688205872736877*^9, 3.6882058924219217`*^9}, {3.688206168807418*^9, 
   3.68820618960297*^9}, {3.688206788482258*^9, 3.688206948466836*^9}, {
   3.68820707338017*^9, 3.688207170707225*^9}, {3.688273602742978*^9, 
   3.6882736163735*^9}, {3.688273744814283*^9, 3.688273745561241*^9}, {
   3.688273784880596*^9, 3.688273889650998*^9}, {3.6882765762730618`*^9, 
   3.688276593736793*^9}, {3.688276687498521*^9, 3.68827670781852*^9}, {
   3.688276773303253*^9, 3.6882768054381847`*^9}, {3.6882769622069273`*^9, 
   3.688276962349667*^9}, {3.688277074250326*^9, 3.688277075722179*^9}, {
   3.688277112422038*^9, 3.6882771381764593`*^9}, {3.688277869113379*^9, 
   3.688277869480307*^9}, 3.688278818225094*^9, {3.6882799618078814`*^9, 
   3.688279962925933*^9}, {3.688280175351775*^9, 3.688280181437064*^9}, {
   3.6882806019038773`*^9, 3.688280629461904*^9}, {3.6882806621685762`*^9, 
   3.6882807018923492`*^9}, {3.688281019517407*^9, 3.688281101858042*^9}, {
   3.6882811871688023`*^9, 3.688281189541559*^9}, {3.68828186863706*^9, 
   3.6882818795359*^9}, {3.688282245518786*^9, 3.6882822555295773`*^9}, {
   3.68828249555583*^9, 3.6882825545381527`*^9}, {3.688282680728904*^9, 
   3.688282745627604*^9}, {3.688283937513966*^9, 3.688284002229107*^9}, {
   3.688284145414229*^9, 3.688284189761941*^9}, {3.688284557027494*^9, 
   3.688284569113245*^9}, {3.6882846054743767`*^9, 3.6882846092529*^9}, {
   3.688284645059832*^9, 3.688284671367427*^9}, {3.6882848138060617`*^9, 
   3.688284817788643*^9}, {3.6882849366954117`*^9, 3.6882849369374113`*^9}, {
   3.68828496871418*^9, 3.688285082219194*^9}, 3.688285204568668*^9, {
   3.68828524408731*^9, 3.688285530875725*^9}, {3.688285816920663*^9, 
   3.688285830944255*^9}, {3.688285861228406*^9, 3.688285935906403*^9}, 
   3.68828603152139*^9, 3.688286077391507*^9, {3.688286115173058*^9, 
   3.688286132274939*^9}, {3.688286182565303*^9, 3.688286280543948*^9}, {
   3.688286478297864*^9, 3.688286535988381*^9}, {3.688286863305458*^9, 
   3.688286892368195*^9}, {3.688286976845705*^9, 3.688287061464653*^9}, {
   3.6882871994606113`*^9, 3.688287208084422*^9}, {3.688287506482827*^9, 
   3.688287561949996*^9}, {3.688287611516548*^9, 3.688287685750383*^9}, {
   3.688288433542831*^9, 3.688288488259069*^9}, {3.688297434959114*^9, 
   3.688297441533389*^9}, 3.688297944171204*^9, {3.688297977839176*^9, 
   3.688297990346871*^9}, {3.688298449796404*^9, 3.6882985326835213`*^9}, {
   3.688298836351548*^9, 3.6882988379800053`*^9}, {3.68829897159829*^9, 
   3.6882990426777678`*^9}, {3.6882992854384203`*^9, 
   3.6882992866035023`*^9}, {3.688299421145031*^9, 3.6882994289927893`*^9}, {
   3.6882995706139708`*^9, 3.688299606248048*^9}, {3.6882996611909943`*^9, 
   3.6882996670841007`*^9}, {3.688300057462603*^9, 3.6883000999459743`*^9}, {
   3.6883001325325403`*^9, 3.688300201216641*^9}, {3.6883002464246807`*^9, 
   3.688300487947217*^9}, {3.68836017188616*^9, 3.688360176144965*^9}, 
   3.6883602917604103`*^9, {3.688360328680934*^9, 3.68836033235811*^9}, {
   3.688360373625024*^9, 3.688360374183433*^9}, {3.688360419086863*^9, 
   3.6883604199361467`*^9}, 3.688361548790563*^9, 3.688361979489373*^9, {
   3.6883620809317837`*^9, 3.688362221906539*^9}, 3.6883624298780212`*^9, {
   3.688365046224038*^9, 3.688365065724074*^9}, {3.688365252534709*^9, 
   3.688365290444251*^9}, {3.688365341809264*^9, 3.688365404657743*^9}, {
   3.688365445457045*^9, 3.688365446139779*^9}, {3.688365492971512*^9, 
   3.6883655012740726`*^9}, {3.6883658192783203`*^9, 
   3.6883658215028276`*^9}, {3.688365889899865*^9, 3.6883659575088*^9}, {
   3.6883662953424187`*^9, 3.6883665364528112`*^9}, {3.688366679435656*^9, 
   3.688366728049654*^9}, {3.688367217836081*^9, 3.688367275330727*^9}, {
   3.688367321921103*^9, 3.688367339218223*^9}, {3.688367680272641*^9, 
   3.6883676936696863`*^9}, {3.688367749527986*^9, 3.688367795152219*^9}, {
   3.6883678352248163`*^9, 3.6883681438486357`*^9}, {3.688368175697941*^9, 
   3.688368176459059*^9}, {3.6883682296768417`*^9, 3.688368285593049*^9}, {
   3.688368354930299*^9, 3.68836838142062*^9}, {3.688368414026741*^9, 
   3.688368428958004*^9}, {3.6883685121444693`*^9, 3.688368611938629*^9}, {
   3.6883686427289467`*^9, 3.688368675837186*^9}, {3.688368725662798*^9, 
   3.6883688174874153`*^9}, {3.6883688663555*^9, 3.6883688840646276`*^9}, {
   3.688368939381682*^9, 3.688368944638883*^9}, {3.688368990244741*^9, 
   3.688369058436749*^9}, {3.688369117899687*^9, 3.688369123752055*^9}, {
   3.6883691547959347`*^9, 3.688369166732929*^9}, {3.688369702381153*^9, 
   3.688369791313662*^9}, {3.6883698686468763`*^9, 3.6883698708301077`*^9}, {
   3.688370016922091*^9, 3.688370037748988*^9}, {3.688370655817317*^9, 
   3.688370661796994*^9}, {3.688370731696389*^9, 3.688370812674123*^9}, {
   3.688370900468206*^9, 3.6883709432061853`*^9}, 3.688370981133849*^9, {
   3.688371123248744*^9, 3.6883712729412327`*^9}, {3.6883713711227303`*^9, 
   3.688371390451213*^9}, {3.6883714278458138`*^9, 3.688371436720551*^9}, {
   3.688371483994458*^9, 3.688371538547368*^9}, {3.688371574001493*^9, 
   3.688371600031142*^9}, 3.688371648575631*^9, {3.688371790589094*^9, 
   3.68837180545759*^9}, {3.68837185706915*^9, 3.688371901324605*^9}, 
   3.688371934303348*^9, {3.688371973562417*^9, 3.6883720796165657`*^9}, {
   3.6883722047426662`*^9, 3.6883722084691887`*^9}, {3.6883722949531307`*^9, 
   3.6883722972143383`*^9}, {3.688372370525456*^9, 3.688372371952628*^9}, {
   3.688372433885974*^9, 3.688372435766345*^9}, {3.688372469993311*^9, 
   3.688372506524522*^9}, {3.688373003734763*^9, 3.6883730185185947`*^9}, {
   3.688373070735916*^9, 3.68837314082928*^9}, {3.68837373104961*^9, 
   3.6883737352603083`*^9}, 3.6883737875706778`*^9, {3.688379583481531*^9, 
   3.688379585543952*^9}, {3.688379698974032*^9, 3.688379739360207*^9}, {
   3.688379952712682*^9, 3.688379977652646*^9}, {3.688380642074852*^9, 
   3.688380669536026*^9}, {3.688380741668557*^9, 3.688380819791953*^9}, {
   3.688380851363862*^9, 3.6883809401942863`*^9}, {3.6883809940259123`*^9, 
   3.6883810325941896`*^9}, {3.688381065822733*^9, 3.6883811145661373`*^9}, {
   3.68838116123351*^9, 3.688381162472266*^9}, {3.688381233614677*^9, 
   3.6883812693834047`*^9}, {3.688381323732773*^9, 3.688381342730275*^9}, {
   3.688381397664278*^9, 3.688381399123969*^9}, {3.68838149378391*^9, 
   3.688381496352409*^9}, {3.688381560063979*^9, 3.688381601455184*^9}, {
   3.6883817356522703`*^9, 3.688381752674206*^9}, {3.6883818036698837`*^9, 
   3.688381821016157*^9}, {3.688381869443632*^9, 3.688381953743968*^9}, {
   3.68838207583414*^9, 3.688382078961708*^9}, {3.688382151485796*^9, 
   3.688382176355379*^9}, {3.688382223231316*^9, 3.6883823309354753`*^9}, {
   3.688382370621058*^9, 3.6883823831495953`*^9}, {3.688382413351246*^9, 
   3.68838241354773*^9}, {3.688382483939468*^9, 3.688382508326436*^9}, {
   3.688382748877859*^9, 3.688382763274201*^9}, {3.688382806711913*^9, 
   3.6883828109585133`*^9}, {3.688382931784306*^9, 3.688382934761723*^9}, {
   3.6883830538344707`*^9, 3.688383101651906*^9}, {3.688383148145788*^9, 
   3.6883831547060966`*^9}, {3.688383249311288*^9, 3.688383281209132*^9}, {
   3.688383363577158*^9, 3.688383386614254*^9}, {3.6883834214669733`*^9, 
   3.688383422185629*^9}, {3.6883834775096483`*^9, 3.688383544910502*^9}, {
   3.688383587693899*^9, 3.688383588086437*^9}, {3.688383619924201*^9, 
   3.688383676911875*^9}, {3.688383755008466*^9, 3.688383763647029*^9}, {
   3.688383882146209*^9, 3.688383993939913*^9}, {3.688384041207402*^9, 
   3.68838404301714*^9}, {3.688384112014928*^9, 3.68838411244832*^9}, {
   3.688384511806028*^9, 3.688384541830748*^9}, {3.688384953536529*^9, 
   3.6883849742994556`*^9}, {3.688385007294704*^9, 3.6883850782497377`*^9}, {
   3.688412533466557*^9, 3.688412547321186*^9}, 3.688412587891268*^9, {
   3.688413824339501*^9, 3.688413831737144*^9}, {3.688413897391354*^9, 
   3.6884138978859797`*^9}, {3.6884142668569717`*^9, 3.688414340333947*^9}, {
   3.688415666418586*^9, 3.688415667281588*^9}, {3.6884158237932987`*^9, 
   3.688415832534972*^9}, {3.6884158789663467`*^9, 3.6884158791332684`*^9}, {
   3.6884693076996603`*^9, 3.6884693078306017`*^9}, {3.6884694574889717`*^9, 
   3.688469466757045*^9}, {3.6884695337842417`*^9, 3.688469570645245*^9}, {
   3.688469737887363*^9, 3.688469745878036*^9}, {3.688470193873653*^9, 
   3.688470202660018*^9}, {3.6887106256213093`*^9, 3.6887106316462*^9}, {
   3.688715916574808*^9, 3.688715921602603*^9}, {3.688715975335972*^9, 
   3.688716022682687*^9}, {3.6887171055130653`*^9, 3.688717150046289*^9}, {
   3.688717194795334*^9, 3.688717196838621*^9}, {3.6887173257188873`*^9, 
   3.688717423430872*^9}, {3.688717455568035*^9, 3.688717475153871*^9}, {
   3.688717562792963*^9, 3.688717564325161*^9}, {3.688717889885922*^9, 
   3.688717922956546*^9}, {3.688718046379628*^9, 3.6887180751994257`*^9}, {
   3.688718208905373*^9, 3.688718213272984*^9}, {3.688718376981533*^9, 
   3.688718381139826*^9}, {3.688719247648033*^9, 3.688719439080305*^9}, {
   3.68871957366168*^9, 3.6887196484565573`*^9}, {3.688720272145569*^9, 
   3.688720274180472*^9}, {3.688720520658091*^9, 3.688720701818386*^9}, {
   3.688720810168166*^9, 3.6887208340197906`*^9}, {3.6887208653379517`*^9, 
   3.68872086653406*^9}, {3.688720939339168*^9, 3.688720940618023*^9}, {
   3.688721164886326*^9, 3.688721206525474*^9}, {3.6887216356658278`*^9, 
   3.688721714701789*^9}, {3.688721761860014*^9, 3.688721888258545*^9}, {
   3.688721923562722*^9, 3.688721951184944*^9}, {3.688722012480411*^9, 
   3.6887220253345423`*^9}, {3.688722120264771*^9, 3.6887221675702553`*^9}, {
   3.6887223904703627`*^9, 3.688722399743865*^9}, {3.6887226553448277`*^9, 
   3.6887226684889174`*^9}, {3.688722863654044*^9, 3.6887228864406977`*^9}, {
   3.688722935475724*^9, 3.6887229445481243`*^9}, {3.688723000657322*^9, 
   3.688723120662717*^9}, {3.688723207014954*^9, 3.68872321946358*^9}, {
   3.688723258752293*^9, 3.6887232824239187`*^9}, {3.68872331999594*^9, 
   3.688723368523353*^9}, {3.6887234169040747`*^9, 3.688723498142845*^9}, {
   3.688723565576768*^9, 3.6887235815397243`*^9}, {3.688723634057341*^9, 
   3.688723651891625*^9}, {3.688723687951017*^9, 3.6887236968841963`*^9}, {
   3.688723779519454*^9, 3.688723788848905*^9}, {3.688723826110693*^9, 
   3.688723827711746*^9}, {3.688723870023592*^9, 3.6887239943519487`*^9}, {
   3.688724028536162*^9, 3.688724091464603*^9}, {3.6887241291553183`*^9, 
   3.688724140160657*^9}, {3.688724235802826*^9, 3.688724313607534*^9}, {
   3.688724362911943*^9, 3.6887248716910048`*^9}, {3.68872491176723*^9, 
   3.688724912100616*^9}, {3.688724944098531*^9, 3.68872497345995*^9}, {
   3.6887250042530413`*^9, 3.688725022564766*^9}, {3.68872527341259*^9, 
   3.688725295994483*^9}, {3.688725340615555*^9, 3.68872536644137*^9}, {
   3.688725398645979*^9, 3.688725407093004*^9}, {3.6887255066982594`*^9, 
   3.688725534188752*^9}, {3.6887258689572773`*^9, 3.688725926342456*^9}, {
   3.688725971594397*^9, 3.68872607015725*^9}, {3.688726108303121*^9, 
   3.688726127039158*^9}, {3.688726180744391*^9, 3.688726234602315*^9}, {
   3.6887262683509607`*^9, 3.688726298049622*^9}, {3.688726333052865*^9, 
   3.688726473317025*^9}, {3.688726535302548*^9, 3.688726549614936*^9}, {
   3.6887266076717243`*^9, 3.688726753896302*^9}, {3.688726789157321*^9, 
   3.688726794344153*^9}, {3.688726825433799*^9, 3.688726855958111*^9}, {
   3.68872689842799*^9, 3.688726904804707*^9}, {3.688727278771668*^9, 
   3.6887273031688757`*^9}, {3.68872743244801*^9, 3.688727444223064*^9}, {
   3.688727508627112*^9, 3.688727581810495*^9}, {3.688728319381282*^9, 
   3.688728333221733*^9}, {3.6887286669852743`*^9, 3.688728678803669*^9}, {
   3.688728876661017*^9, 3.6887288768237886`*^9}, {3.688728963915854*^9, 
   3.6887289715068274`*^9}, {3.6887290465867977`*^9, 3.688729098568931*^9}, {
   3.688729218272547*^9, 3.688729407938739*^9}, {3.688729439397183*^9, 
   3.6887295020890903`*^9}, {3.68872954860353*^9, 3.688729560643612*^9}, {
   3.68872993001188*^9, 3.6887299483714457`*^9}, {3.6887300393662453`*^9, 
   3.688730040076292*^9}, {3.6887301020438557`*^9, 3.6887302397582617`*^9}, {
   3.688730300473332*^9, 3.688730307124331*^9}, {3.688730462423807*^9, 
   3.688730464455422*^9}, {3.6887305391015387`*^9, 3.688730617773288*^9}, {
   3.688730652999529*^9, 3.688730747167839*^9}, {3.6887307968726797`*^9, 
   3.688730802352521*^9}, {3.6887308519531927`*^9, 3.6887308898490143`*^9}, {
   3.688730923421349*^9, 3.6887309855724487`*^9}, {3.688731027416718*^9, 
   3.688731068248067*^9}, {3.68873112188993*^9, 3.688731253857031*^9}, {
   3.688731298436944*^9, 3.688731433966876*^9}, {3.688731488677355*^9, 
   3.688731519803687*^9}, {3.688731602205064*^9, 3.688731745998415*^9}, {
   3.688731786349728*^9, 3.68873181885561*^9}, {3.688731875076459*^9, 
   3.688732103887988*^9}, {3.688820722829179*^9, 3.6888207559189653`*^9}, {
   3.6888214548103323`*^9, 3.688821563032465*^9}, {3.6888216111211863`*^9, 
   3.688821658645171*^9}, {3.688880561507181*^9, 3.6888806166152697`*^9}, {
   3.6888807426962337`*^9, 3.688880766921464*^9}, {3.688881515416383*^9, 
   3.688881574958947*^9}, {3.688881605023391*^9, 3.688881849333637*^9}, {
   3.688881943452387*^9, 3.6888819576679163`*^9}, {3.688881995113439*^9, 
   3.68888200597932*^9}, {3.688882076632834*^9, 3.6888820849785852`*^9}, {
   3.6888822174013157`*^9, 3.688882218029351*^9}, {3.688882254943294*^9, 
   3.6888822591282673`*^9}, {3.6888825179566507`*^9, 3.688882561373372*^9}, {
   3.688883148891746*^9, 3.688883149530191*^9}, {3.688883542695879*^9, 
   3.688883603137027*^9}, {3.6888837027125807`*^9, 3.688883718852215*^9}, {
   3.68888375660098*^9, 3.688883769436098*^9}, {3.6888838754742937`*^9, 
   3.688883875881736*^9}, {3.688883932596631*^9, 3.688883984112029*^9}, {
   3.688884016119833*^9, 3.688884033920843*^9}, {3.688884066443245*^9, 
   3.688884299913093*^9}, {3.688884333258216*^9, 3.688884411346899*^9}, {
   3.6888845740392637`*^9, 3.688884671646585*^9}, {3.688885301977813*^9, 
   3.688885327193623*^9}, {3.6888853712649717`*^9, 3.688885381261702*^9}, {
   3.688885415095223*^9, 3.688885419146516*^9}, {3.688885480125342*^9, 
   3.6888854963809137`*^9}, {3.688885564679582*^9, 3.688885671127782*^9}, {
   3.68888574983959*^9, 3.688885867522853*^9}, {3.6888859814800797`*^9, 
   3.6888859895556307`*^9}, {3.688886075206634*^9, 3.688886103803995*^9}, {
   3.688886142033185*^9, 3.688886362460281*^9}, {3.6888864046482887`*^9, 
   3.688886405190534*^9}, 3.688886440416807*^9, {3.688886496647683*^9, 
   3.688886614255052*^9}, {3.6888866470167503`*^9, 3.6888866787360477`*^9}, {
   3.6888869307196503`*^9, 3.688886931304778*^9}, {3.68888714380344*^9, 
   3.6888871932967787`*^9}, {3.688887277732609*^9, 3.688887334649456*^9}, {
   3.688887403098558*^9, 3.6888874128714943`*^9}, {3.688887445702457*^9, 
   3.688887475126939*^9}, {3.688887527895865*^9, 3.688887551378882*^9}, {
   3.688887622170032*^9, 3.688887622576388*^9}, {3.688887683401148*^9, 
   3.6888877219974813`*^9}, {3.688887808549309*^9, 3.6888878602559013`*^9}, {
   3.6888878957803717`*^9, 3.68888798137081*^9}, {3.688888046426093*^9, 
   3.688888120363359*^9}, {3.68888817542372*^9, 3.6888882853086567`*^9}, {
   3.688888425463152*^9, 3.6888884683965187`*^9}, {3.688888797958138*^9, 
   3.688888799132504*^9}, {3.688888855654704*^9, 3.688888880379723*^9}, {
   3.688889195485331*^9, 3.688889234428309*^9}, {3.688889267605335*^9, 
   3.688889286908716*^9}, 3.688889360992034*^9, 3.688889449720807*^9, {
   3.6888897328086357`*^9, 3.688889778102206*^9}, 3.688889830502931*^9, {
   3.688889892143968*^9, 3.6888898927465878`*^9}, {3.688889949680038*^9, 
   3.688889953497878*^9}, {3.688889995583117*^9, 3.688890054046508*^9}, {
   3.6888904921261883`*^9, 3.688890493858288*^9}, {3.688890572759881*^9, 
   3.688890573027338*^9}, {3.688890609801099*^9, 3.688890681164501*^9}, {
   3.688891044417325*^9, 3.68889107888306*^9}, {3.688891313710175*^9, 
   3.688891324293086*^9}, {3.6888918068734617`*^9, 3.6888918105346413`*^9}, {
   3.68889185613771*^9, 3.688891896427363*^9}, {3.6888932268807707`*^9, 
   3.688893370801464*^9}, {3.688893437661771*^9, 3.688893450758202*^9}, {
   3.6888935042501907`*^9, 3.68889350529464*^9}, {3.688893606888598*^9, 
   3.6888936366294127`*^9}, {3.688893803447845*^9, 3.688893805129158*^9}, {
   3.688894561781907*^9, 3.688894562391205*^9}, {3.688894604702033*^9, 
   3.688894605800231*^9}, {3.688894692685596*^9, 3.688894694921898*^9}, {
   3.6888947949720297`*^9, 3.6888948234590693`*^9}, {3.688894950473453*^9, 
   3.688894962022049*^9}, {3.688895009927999*^9, 3.6888950174731407`*^9}, {
   3.688895094046125*^9, 3.688895115604026*^9}, {3.688895418364194*^9, 
   3.688895453567012*^9}, {3.688895497612961*^9, 3.6888955005904427`*^9}, {
   3.688896246782501*^9, 3.68889628069715*^9}, {3.6888963538356657`*^9, 
   3.68889638432589*^9}, {3.688896530135466*^9, 3.688896647139607*^9}, 
   3.6888971485470963`*^9, 3.688897285964571*^9, {3.688897635952179*^9, 
   3.6888976533745813`*^9}, {3.688897829164626*^9, 3.688897829470894*^9}, {
   3.6888981793529577`*^9, 3.688898180195538*^9}, {3.688898403393675*^9, 
   3.6888984051464167`*^9}, {3.6888984421174393`*^9, 
   3.6888984428881063`*^9}, {3.688898610293371*^9, 3.688898655119364*^9}, {
   3.688898685288208*^9, 3.688898695284464*^9}, {3.688898740577579*^9, 
   3.688898749581698*^9}, {3.688898795480421*^9, 3.688898797509375*^9}, {
   3.688898848492169*^9, 3.688898849795124*^9}, {3.688898974348111*^9, 
   3.688898976921692*^9}, {3.688899382589696*^9, 3.688899384051035*^9}, {
   3.688899417749552*^9, 3.688899421167286*^9}, {3.688899453830834*^9, 
   3.688899455459816*^9}, {3.688900214186232*^9, 3.688900219075275*^9}, {
   3.688900268813326*^9, 3.688900272288824*^9}, {3.688900391896223*^9, 
   3.688900409605085*^9}, {3.6889004925667152`*^9, 3.688900500749811*^9}, 
   3.688937508095537*^9, {3.689617960041312*^9, 3.689617971180437*^9}, {
   3.689618340063038*^9, 3.689618416988483*^9}, {3.689618474058797*^9, 
   3.689618496842525*^9}, 3.6896185678073587`*^9, 3.689618639354116*^9, {
   3.689618747261505*^9, 3.689618774157618*^9}, {3.6896202591110773`*^9, 
   3.689620321213889*^9}, {3.689620370508799*^9, 3.68962037146173*^9}, 
   3.689620439851973*^9, {3.68962054524196*^9, 3.689620546233873*^9}, 
   3.689620905964918*^9, {3.689620954793437*^9, 3.689620955312237*^9}, {
   3.689621843318009*^9, 3.6896218583898087`*^9}, 3.6896221251389627`*^9, 
   3.689679439483789*^9, {3.689680208930934*^9, 3.689680235279633*^9}, {
   3.689702772769565*^9, 3.689702776362083*^9}, {3.689702955042224*^9, 
   3.689703071072604*^9}, {3.689703102160236*^9, 3.689703125615221*^9}, {
   3.6897033532712927`*^9, 3.6897033821981564`*^9}, {3.689703416356786*^9, 
   3.689703418467318*^9}, {3.689703501422708*^9, 3.689703544595126*^9}, {
   3.689703576621763*^9, 3.6897035797695913`*^9}, {3.689703689396224*^9, 
   3.689703725401431*^9}, {3.689703767051588*^9, 3.689703793040707*^9}, {
   3.689703889983645*^9, 3.689703897134975*^9}, {3.689704232826089*^9, 
   3.689704243866418*^9}, {3.6897042960100527`*^9, 3.689704316635892*^9}, {
   3.689704609790207*^9, 3.689704632274337*^9}, {3.6897046662680187`*^9, 
   3.689704682913583*^9}, {3.6897047380750093`*^9, 3.689704820487657*^9}, {
   3.6897049853711863`*^9, 3.689705014396738*^9}, {3.68970504664723*^9, 
   3.689705056267849*^9}, 3.689705092279093*^9, {3.689705173235333*^9, 
   3.689705175011661*^9}, 3.6897052259624243`*^9, {3.6897052709693832`*^9, 
   3.6897053273291883`*^9}, {3.689705365385768*^9, 3.689705368801379*^9}, {
   3.6897054158897467`*^9, 3.6897054441336203`*^9}, {3.689705494904895*^9, 
   3.689705498750948*^9}, {3.68970573131789*^9, 3.689705887393858*^9}, 
   3.7158522267987623`*^9, 3.71585514053936*^9, {3.716040418737607*^9, 
   3.716040422257596*^9}, 3.717740863076173*^9, {3.717740897310025*^9, 
   3.717740915407414*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[278]:=",ExpressionUUID->"8b8f800f-b36e-4d1b-b4eb-afd5f8ee2586"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[279]:=",ExpressionUUID->"b4eec69b-5757-4449-be71-eb4a852bd7a3"]
}, Closed]],

Cell[CellGroupData[{

Cell["RefinedValues", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
  3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
  3.667811516189644*^9}, {3.667818136663406*^9, 
  3.667818153735055*^9}},ExpressionUUID->"7fa89887-046d-465b-ac16-\
eabca80de3bc"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[280]:=",ExpressionUUID->"94bb2882-bd49-4931-9924-e7276221eeb2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RefinedValues", "::", "label"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a recognised \
label.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RefinedValues", "::", "log"}], "=", 
   "\"\<Search for log files has failed.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RefinedValues", "::", "residue"}], "=", 
   "\"\<No residue value found.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RefinedValues", "::", "matrix"}], "=", 
   "\"\<No `1` matrix was found.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RefinedValues", "::", "mosaicity"}], "=", 
   "\"\<No mosaicity values found in \
\[LeftGuillemet]`1`\[RightGuillemet].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RefinedValues", "::", "wavelength"}], "=", 
    "\"\<No wavelength found in \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "RefinedValues", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<ConstrainedCell\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Uncertainties\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[281]:=",ExpressionUUID->"0b7ef6d9-16d7-4c78-b8de-39a0750838da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[288]:=",ExpressionUUID->"62bd9d9f-872c-477f-b794-9a552e5f8dff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RefinedValues", "[", 
   RowBox[{"input_String", ",", "label_String", ",", 
    RowBox[{"OptionsPattern", "@", "RefinedValues"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Setup", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "files", ",", "import", ",", "\[IndentingNewLine]", "constrained", ",", 
      "uncertainties", ",", "units", ",", "\[IndentingNewLine]", "allvalues", 
      ",", "take", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"'", 
        RowBox[{"Refinement", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "n0", ",", "n", ",", "r", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"'", 
        RowBox[{"Wavelength", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[Lambda]", ",", "c", ",", "cInverse", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"'", 
        RowBox[{"InstrumentModel", "'"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "lattice", ",", "latticeU", ",", "X", ",", "x", 
      ",", "\[Delta]", ",", "\[IndentingNewLine]", "goniometer", ",", 
      "detector", ",", "rotation", ",", "instrument", ",", "parameters", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"'", 
         RowBox[{"UB", "'"}]}], ",", " ", 
        RowBox[{"'", 
         RowBox[{"U", "'"}], " ", 
         RowBox[{"and", " ", "'"}], 
         RowBox[{"B", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "UB", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"'", 
        RowBox[{"Angles", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "num", 
      ",", "angles", ",", "\[Alpha]\[Beta]", ",", "\[Omega]", ",", "\[Theta]",
       ",", "\[Kappa]", ",", "\[Phi]", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"'", 
        RowBox[{"CorrelationMatrix", "'"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "m", ",", "tags", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Miscellaneous", " ", "*)"}], "\[IndentingNewLine]", 
      "temp"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Setup", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Label", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", "\t", 
           RowBox[{
           "\"\<Refinement\>\"", ",", "\"\<UnitCell\>\"", ",", 
            "\"\<Wavelength\>\"", ",", "\[IndentingNewLine]", "\t", 
            "\"\<InstrumentModel\>\"", ",", "\"\<UB\>\"", ",", "\"\<U\>\"", 
            ",", "\"\<B\>\"", ",", "\"\<Mosaicity\>\"", ",", 
            "\[IndentingNewLine]", "\t", "\"\<Angles\>\"", ",", 
            "\"\<CorrelationMatrix\>\""}], "}"}], ",", "label"}], "]"}]}], 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"RefinedValues", "::", "label"}], ",", "label"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Scenario", " ", "1"}], ":", " ", 
       RowBox[{"Log", " ", "information", " ", "given", " ", "directly"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"Quiet", "@", 
      RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"input", ",", "27"}], "]"}], "\[Equal]", 
         "\"\<Your current setup file is:\>\""}], ",", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{
         RowBox[{"import", "=", "input"}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Goto", "[", "\"\<ImportDone\>\"", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Scenario", " ", "2"}], ":", " ", 
       RowBox[{"Single", " ", "log", " ", "file", " ", "given"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FileExistsQ", "[", "input", "]"}], "&&", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"input", ",", 
           RowBox[{"-", "3"}]}], "]"}], "\[Equal]", "\"\<txt\>\""}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"import", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"input", ",", "\"\<String\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Goto", "[", "\"\<ImportDone\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Scenario", " ", "3"}], ":", " ", 
       RowBox[{"Log", "-", " ", 
        RowBox[{"or", " ", "project", " ", "directory", " ", "given"}]}]}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"files", "=", 
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*.txt\>\"", ",", 
        RowBox[{"{", "input", "}"}], ",", "3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DirectoryQ", "[", "input", "]"}], "&&", 
        RowBox[{"files", "\[NotEqual]", 
         RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"import", "=", 
         RowBox[{"MergeLogs", "[", "input", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Goto", "[", "\"\<ImportDone\>\"", "]"}]}]}], "]"}], ";", 
     "\t\t", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Finding", " ", "log", " ", "failed"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"Message", "[", 
      RowBox[{"RefinedValues", "::", "log"}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"Goto", "[", "\"\<End\>\"", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Preparations", " ", "common", " ", "for", " ", "all", " ", "tasks"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<ImportDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", "Options", " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"constrained", "=", 
      RowBox[{"OptionValue", "[", "\"\<ConstrainedCell\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"uncertainties", "=", 
      RowBox[{"OptionValue", "[", "\"\<Uncertainties\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"units", "=", 
      RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Making", " ", "a", " ", "list", " ", "to", " ", "store", " ", "all", 
       " ", "the", " ", "values", " ", "in"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"allvalues", "=", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "label", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "'", 
       RowBox[{"Refinement", "'"}], " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Refinement\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Extracting", " ", "the", " ", "number", " ", "of", " ", 
        "reflections"}], ",", " ", 
       RowBox[{"initially", " ", "and", " ", "finally"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"n0", "=", 
      RowBox[{"First", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"import", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Shortest", "[", 
           RowBox[{
           "\"\<UB fit with \>\"", "~~", "__", "~~", "\"\<out of \>\"", "~~", 
            
            RowBox[{"n0", ":", 
             RowBox[{"DigitCharacter", ".."}]}], "~~", "\"\< \>\""}], "]"}], 
          "\[RuleDelayed]", "n0"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"n", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"import", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Shortest", "[", 
           RowBox[{"\"\<UB fit with \>\"", "~~", 
            RowBox[{"n", ":", 
             RowBox[{"DigitCharacter", ".."}]}], "~~", "\"\< \>\""}], "]"}], 
          "\[RuleDelayed]", "n"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n0", ",", "n"}], "}"}], "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"{", 
        RowBox[{"n0", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"allvalues", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<ReflectionsInitial\>\"", "\[Rule]", "n0"}], ",", 
         RowBox[{"\"\<ReflectionsFinal\>\"", "\[Rule]", "n"}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Extracting", " ", "the", " ", "latest", " ", "residue", " ", 
       "parameter"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"r", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"\"\<Resid:\>\"", "~~", 
          RowBox[{"\"\< \>\"", ".."}], "~~", 
          RowBox[{"r", ":", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"DigitCharacter", ",", "\"\<-\>\"", ",", "\"\<.\>\""}], 
             "}"}], ".."}]}]}], "\[RuleDelayed]", "r"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"r", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"RefinedValues", "::", "residue"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"r", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"Last", "@", "r"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", "Units"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"units", ",", 
       RowBox[{
        RowBox[{"r", "=", 
         RowBox[{"100", "*", "r"}]}], ";", 
        RowBox[{"r", "=", 
         RowBox[{"Quantity", "[", 
          RowBox[{"r", ",", "\"\<Percent\>\""}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"allvalues", ",", 
       RowBox[{"\"\<Rint\>\"", "\[Rule]", "r"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "allvalues"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "'", 
       RowBox[{"UnitCell", "'"}], " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<UnitCell\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Finding", " ", "and", " ", "extracting", " ", "the", " ", "lattice", 
       " ", "parameters"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Quiet", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"lattice", "=", 
        RowBox[{"StringCases", "[", 
         RowBox[{"import", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Shortest", "[", 
           RowBox[{
           "\"\<unit cell:\>\"", "~~", "__", "~~", "\"\<V\>\"", "~~", "__", "~~",
             "EndOfLine"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Constrained", " ", "or", " ", "non"}], "-", 
         RowBox[{"constrained", " ", "cell"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{"constrained", ",", 
         RowBox[{"take", "=", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"take", "=", 
          RowBox[{"-", "2"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"lattice", "=", 
        RowBox[{
         RowBox[{"StringCases", "[", 
          RowBox[{
           RowBox[{"lattice", "[", 
            RowBox[{"[", "take", "]"}], "]"}], ",", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "DigitCharacter", ",", "\"\<-\>\"", ",", "\"\<.\>\"", ",", 
              "\"\<(\>\"", ",", "\"\<)\>\""}], "}"}], ".."}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", "6"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"latticeU", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"X", "=", 
           RowBox[{"StringCases", "[", 
            RowBox[{
             RowBox[{"lattice", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"DigitCharacter", ",", "\"\<-\>\"", ",", "\"\<.\>\""}],
                "}"}], ".."}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
          
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "X", "]"}], "\[Equal]", "2"}], ",", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"Uncertainty", " ", "given"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{"x", "=", 
              RowBox[{"X", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\t\t\t", 
             RowBox[{"\[Delta]", "=", 
              RowBox[{"ToExpression", "@", 
               RowBox[{"X", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"temp", "=", 
              RowBox[{"StringLength", "@", 
               RowBox[{"First", "@", "\[IndentingNewLine]", "\t\t\t", 
                RowBox[{"StringCases", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{
                   RowBox[{"\"\<.\>\"", "~~", 
                    RowBox[{"n", ":", 
                    RowBox[{"(", 
                    RowBox[{"DigitCharacter", ".."}], ")"}]}]}], 
                   "\[RuleDelayed]", "n"}]}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"X", "=", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"N", "[", 
                 RowBox[{"\[Delta]", "*", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "temp"}], ")"}]}]}], "]"}]}], "}"}]}]}], ",",
             "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"No", " ", "uncertainty"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"X", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"X", ",", "0."}], "}"}], "]"}]}]}], 
           "\[IndentingNewLine]", "\t\t\t", "]"}], ";", "\[IndentingNewLine]",
           "\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"latticeU", ",", "X"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "lattice"}]}], "}"}]}], 
        "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Optional", ":", " ", "Units"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"temp", "=", 
        RowBox[{"<|", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\"", ",", 
             "\"\<\[Alpha]\>\"", ",", "\"\<\[Beta]\>\"", ",", 
             "\"\<\[Gamma]\>\""}], "}"}], "\[Rule]", "latticeU"}], "]"}], 
         "|>"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{"units", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"lattice", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Quantity", "[", 
              RowBox[{"#", ",", "\"\<Angstroms\>\""}], "]"}], "&"}], "/@", 
            RowBox[{"temp", "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\""}], 
               "}"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"angles", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Quantity", "[", 
              RowBox[{"#", ",", "\"\<Degrees\>\""}], "]"}], "&"}], "/@", 
            RowBox[{"temp", "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\[Alpha]\>\"", ",", "\"\<\[Beta]\>\"", ",", 
                "\"\<\[Gamma]\>\""}], "}"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"temp", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"lattice", ",", "angles"}], "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Optional", ":", " ", "Uncertainties"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "uncertainties"}], ",", 
         RowBox[{"temp", "=", 
          RowBox[{"temp", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", "\t", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "temp"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "'", 
       RowBox[{"Wavelength", "'"}], " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Wavelength\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"\"\<wavelength: \>\"", "~~", 
          RowBox[{"\[Lambda]", ":", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"DigitCharacter", ",", "\"\<.\>\""}], "}"}], ".."}]}]}], 
         "\[RuleDelayed]", "\[Lambda]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Exploit", " ", "that", " ", "UB", " ", "is", " ", "scaled", " ", 
         "by", " ", "wavelength"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       
       RowBox[{
        RowBox[{"UB", "=", 
         RowBox[{"RefinedValues", "[", 
          RowBox[{"input", ",", "\"\<UB\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"cInverse", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"QRDecomposition", "@", "UB"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"c", "=", 
         RowBox[{"ToExpression", "@", 
          RowBox[{
           RowBox[{"RefinedValues", "[", 
            RowBox[{"input", ",", "\"\<UnitCell\>\""}], "]"}], "[", 
           "\"\<c\>\"", "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"\[Lambda]", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"c", "*", "cInverse"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Extract", " ", "directly"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"First", "@", 
          RowBox[{"Flatten", "@", "temp"}]}]}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\t", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", "Units"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"units", ",", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"Quantity", "[", 
         RowBox[{"\[Lambda]", ",", "\"\<Angstroms\>\""}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "\[Lambda]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "'", 
       RowBox[{"InstrumentModel", "'"}], " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<InstrumentModel\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Finding", " ", "and", " ", "extracting", " ", "goniometer", " ", "and",
        " ", "detector", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"rotation", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
       "\"\<Cryst. Rot. X\>\"", ",", "\"\<Cryst. Rot. Y\>\"", ",", 
        "\"\<Cryst. Rot. Z\>\"", ",", "\[IndentingNewLine]", "\t\t", 
        "\"\<Cryst. Dance X\>\"", ",", "\"\<Cryst. Dance Y\>\"", ",", 
        "\"\<Cryst. Dance Z\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"goniometer", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
       "\"\<Beam. Rot. Y\>\"", ",", "\"\<Beam. Rot. Z\>\"", ",", 
        "\[IndentingNewLine]", "\t\t", "\"\<Alpha Value\>\"", ",", 
        "\"\<Beta Value\>\"", ",", "\[IndentingNewLine]", "\t\t", 
        "\"\<Omega Offset\>\"", ",", "\"\<Theta Offset\>\"", ",", 
        "\"\<Kappa Offset\>\"", ",", "\"\<Phi Offset\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"detector", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
       "\"\<Det. Rot. X\>\"", ",", "\"\<Det. Rot. Y\>\"", ",", 
        "\"\<Det. Rot. Z\>\"", ",", "\[IndentingNewLine]", "\t\t", 
        "\"\<Det. Offset X\>\"", ",", "\"\<Det. Offset Y\>\"", ",", 
        "\"\<Det. D. Scale\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"instrument", "=", 
      RowBox[{"{", 
       RowBox[{"rotation", ",", "goniometer", ",", "detector"}], "}"}]}], ";",
      "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"Quiet", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"parameters", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Last", "@", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"StringCases", "[", 
                RowBox[{"import", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"#", "~~", 
                   RowBox[{"\"\< \>\"", ".."}], "~~", "\[IndentingNewLine]", 
                   RowBox[{"v1", ":", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "DigitCharacter", ",", "\"\<-\>\"", ",", "\"\<.\>\""}], 
                    "}"}], ".."}]}], "~~", 
                   RowBox[{"\"\< \>\"", ".."}], "~~", "\[IndentingNewLine]", 
                   RowBox[{"v2", ":", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "DigitCharacter", ",", "\"\<-\>\"", ",", "\"\<.\>\""}], 
                    "}"}], ".."}]}]}], "\[RuleDelayed]", "v2"}]}], "]"}], ",",
                "\[IndentingNewLine]", "\t", 
               RowBox[{"x_", "/;", 
                RowBox[{
                 RowBox[{"StringLength", "[", "x", "]"}], "\[LessEqual]", 
                 "5"}]}]}], "]"}]}], "&"}], "/@", "#"}], "&"}], "/@", 
         "instrument"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"allvalues", ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<Rotation\>\"", "\[Rule]", 
          RowBox[{"Association", "@", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<r1\>\"", ",", "\"\<r2\>\"", ",", "\"\<r3\>\"", ",", 
               "\"\<w1\>\"", ",", "\"\<w2\>\"", ",", "\"\<w3\>\""}], "}"}], 
             "\[Rule]", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"parameters", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "\t", 
            "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"allvalues", ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<Goniometer\>\"", "\[Rule]", 
          RowBox[{"Association", "@", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<b2\>\"", ",", "\"\<b3\>\"", ",", "\"\<al\>\"", ",", 
               "\"\<be\>\"", ",", "\"\<o0\>\"", ",", "\"\<t0\>\"", ",", 
               "\"\<k0\>\"", ",", "\"\<p0\>\""}], "}"}], "\[Rule]", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"parameters", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", "\t", 
            "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"allvalues", ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"\"\<Detector\>\"", "\[Rule]", 
          RowBox[{"Association", "@", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<d1\>\"", ",", "\"\<d2\>\"", ",", "\"\<d3\>\"", ",", 
               "\"\<x0\>\"", ",", "\"\<y0\>\"", ",", "\"\<dd\>\""}], "}"}], 
             "\[Rule]", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"parameters", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", "\t", 
            "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "@", 
        RowBox[{"ToExpression", "@", "allvalues"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "'", 
       RowBox[{"UB", "'"}], " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<UB\>\"", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Extracting", " ", "the", " ", "UB", " ", "matrix"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"import", ",", 
         RowBox[{"\"\<UM S \>\"", "~~", 
          RowBox[{"{", 
           RowBox[{"\"\<-\>\"", ",", "DigitCharacter"}], "}"}]}]}], "]"}], 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Preferred", " ", "pattern"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"UB", "=", 
        RowBox[{"AlignUB", "@", 
         RowBox[{"Last", "@", "\[IndentingNewLine]", "\t", 
          RowBox[{"StringCases", "[", 
           RowBox[{"import", ",", 
            RowBox[{"Shortest", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<UM S \>\"", "~~", 
              RowBox[{"{", 
               RowBox[{"\"\<-\>\"", ",", "DigitCharacter"}], "}"}], "~~", 
              "__", "~~", "EndOfLine"}], "]"}]}], "]"}]}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Other", " ", "method"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"import", ",", "\"\<UB - matrix:\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"RefinedValues", "::", "matrix"}], ",", "\"\<UB\>\""}], 
            "]"}], ";", 
           RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"UB", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringCases", "[", 
             RowBox[{
              RowBox[{"Last", "@", "\[IndentingNewLine]", "\t", 
               RowBox[{"StringCases", "[", 
                RowBox[{"import", ",", 
                 RowBox[{
                  RowBox[{"Shortest", "[", 
                   RowBox[{
                   "\"\<UB - matrix:\>\"", "~~", "\[IndentingNewLine]", 
                    RowBox[{"m", ":", 
                    RowBox[{"(", 
                    RowBox[{"__", "~~", 
                    RowBox[{"Repeated", "[", 
                    RowBox[{
                    RowBox[{"EndOfLine", "~~", "__"}], ",", 
                    RowBox[{"{", "3", "}"}]}], "]"}]}], ")"}]}]}], "]"}], 
                  "\[RuleDelayed]", "m"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "DigitCharacter", ",", "\"\<.\>\"", ",", "\"\<-\>\""}], "}"}],
                ".."}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{
              "1", ",", "2", ",", "3", ",", "7", ",", "8", ",", "9", ",", 
               "13", ",", "14", ",", "15"}], "}"}], "]"}], "]"}], ",", "3"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"ToExpression", "@", "UB"}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "5"}]]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "'", 
       RowBox[{"U", "'"}], " ", 
       RowBox[{"or", " ", "'"}], 
       RowBox[{"B", "'"}], " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<U\>\"", "]"}], ";", 
     RowBox[{"Label", "[", "\"\<B\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", "label"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"import", ",", 
          RowBox[{"\"\< \>\"", "~~", "x", "~~", "\"\< - matrix\>\""}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"RefinedValues", "::", "matrix"}], ",", "x"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Extracting", " ", "the", " ", "matrix"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{
          "\"\< \>\"", "~~", "x", "~~", "\"\< - matrix:\>\"", "~~", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"m", ":", 
            RowBox[{"(", 
             RowBox[{"__", "~~", 
              RowBox[{"Repeated", "[", 
               RowBox[{
                RowBox[{"EndOfLine", "~~", "__"}], ",", 
                RowBox[{"{", "4", "}"}]}], "]"}]}], ")"}]}]}], "]"}], 
         "\[RuleDelayed]", "m"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{
        RowBox[{"Last", "@", "temp"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"DigitCharacter", ",", "\"\<.\>\"", ",", "\"\<-\>\""}], 
          "}"}], ".."}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"Partition", "[", 
        RowBox[{"temp", ",", "3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{"temp", ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "5"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "temp"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "'", 
       RowBox[{"Mosaicity", "'"}], " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Mosaicity\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Extracting", " ", "the", " ", "mosaicities"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"import", ",", "\"\<Profile size analysis\>\""}], "]"}]}], 
       ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"RefinedValues", "::", "mosaicity"}], ",", 
          RowBox[{"FileNameTake", "@", "input"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"import", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"Shortest", "[", 
          RowBox[{
          "\"\<Profile size analysis\>\"", "~~", "__", "~~", 
           "\"\<|\\n\\n\>\""}], "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringExtract", "[", 
       RowBox[{"temp", ",", 
        RowBox[{
         RowBox[{"-", "13"}], ";;"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"temp", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"DigitCharacter", ".."}], "~~", "\"\<.\>\"", "~~", 
         RowBox[{"DigitCharacter", ".."}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Flatten", "@", "temp"}], ",", "2"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", "Units"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Quantity", "[", 
       RowBox[{"temp", ",", "\"\<Degrees\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<e1\>\"", ",", "\"\<e2\>\"", ",", "\"\<e3\>\""}], "}"}],
          "\[Rule]", "temp"}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", "Uncertainties"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"OptionValue", "[", "\"\<Uncertainties\>\"", "]"}]}], ",", 
       RowBox[{"temp", "=", 
        RowBox[{"temp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "temp"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "'", 
       RowBox[{"Angles", "'"}], " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Angles\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Extracting", " ", "the", " ", "diffractometer", " ", "angles"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "@", 
         RowBox[{"Last", "@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"StringCases", "[", 
             RowBox[{"import", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"#", "~~", 
                RowBox[{"\"\< \>\"", ".."}], "~~", "\[IndentingNewLine]", 
                RowBox[{"v1", ":", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "DigitCharacter", ",", "\"\<-\>\"", ",", "\"\<.\>\""}], 
                   "}"}], ".."}]}], "~~", 
                RowBox[{"\"\< \>\"", ".."}], "~~", "\[IndentingNewLine]", 
                RowBox[{"v2", ":", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "DigitCharacter", ",", "\"\<-\>\"", ",", "\"\<.\>\""}], 
                   "}"}], ".."}]}]}], "\[RuleDelayed]", "v2"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{"StringLength", "[", "x", "]"}], "\[LessEqual]", 
              "5"}]}]}], "]"}]}]}], "&"}], "/@", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"{", 
        RowBox[{"\"\<Alpha Value\>\"", ",", "\"\<Beta Value\>\""}], "}"}]}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Extracting", " ", "the", " ", "goniometer", " ", "angles"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"num", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DigitCharacter", ",", "\"\<.\>\"", ",", "\"\<-\>\""}], "}"}],
        ".."}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"First", "@", 
         RowBox[{"StringCases", "[", 
          RowBox[{"import", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<om=\>\"", "~~", "Whitespace", "~~", 
             RowBox[{"\[Omega]", ":", "num"}], "~~", 
             RowBox[{"WhitespaceCharacter", "..."}], "\[IndentingNewLine]", 
             "~~", "\"\<th=\>\"", "~~", "Whitespace", "~~", 
             RowBox[{"\[Theta]", ":", "num"}], "~~", 
             RowBox[{"WhitespaceCharacter", "..."}], "\[IndentingNewLine]", 
             "~~", "\"\<ka=\>\"", "~~", "Whitespace", "~~", 
             RowBox[{"\[Kappa]", ":", "num"}], "~~", 
             RowBox[{"WhitespaceCharacter", "..."}], "\[IndentingNewLine]", 
             "~~", "\"\<ph=\>\"", "~~", "Whitespace", "~~", 
             RowBox[{"\[Phi]", ":", "num"}], "~~", 
             RowBox[{"WhitespaceCharacter", "..."}]}], "\[IndentingNewLine]", 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
             "\[Omega]", ",", "\[Theta]", ",", "\[Kappa]", ",", "\[Phi]"}], 
             "}"}]}]}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"temp", "=", 
      RowBox[{"Flatten", "@", "temp"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", "Units"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"units", ",", 
       RowBox[{"temp", "=", 
        RowBox[{"Quantity", "[", 
         RowBox[{"temp", ",", "\"\<Degrees\>\""}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Association", "@", "\[IndentingNewLine]", "\t", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<\[Alpha]\>\"", ",", "\"\<\[Beta]\>\"", ",", "\"\<\[Omega]\>\"",
            ",", "\"\<\[Theta]\>\"", ",", "\"\<\[Kappa]\>\"", ",", 
           "\"\<\[Phi]\>\""}], "}"}], "\[Rule]", "temp"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "temp"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "'", 
       RowBox[{"CorrelationMatrix", "'"}], " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<CorrelationMatrix\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"StringTrim", "@", 
        RowBox[{"StringCases", "[", 
         RowBox[{"import", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Shortest", "[", 
            RowBox[{
            "\"\<Correlation matrix:\>\"", "~~", "x__", "\[IndentingNewLine]",
              "\t", "~~", "\"\<                 \>\""}], "]"}], 
           "\[RuleDelayed]", "x"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"tags", "=", 
      RowBox[{"StringTrim", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"temp", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"x", ":", 
           RowBox[{"(", 
            RowBox[{"LetterCharacter", "~~", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "LetterCharacter", ",", "\"\< \>\"", ",", "\"\<.\>\"", ",", 
                "\"\<*\>\""}], "}"}], ".."}]}], ")"}]}], "\[RuleDelayed]", 
          "x"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"tags", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"tags", ",", 
        RowBox[{"{", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"\"\<Det. D. Scale\>\"", "\[Rule]", "\"\<dd\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Det. Offset X\>\"", "\[Rule]", "\"\<x0\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Det. Offset Y\>\"", "\[Rule]", "\"\<y0\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Det. Rot. X\>\"", "\[Rule]", "\"\<d1\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Det. Rot. Y\>\"", "\[Rule]", "\"\<d2\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Det. Rot. Z\>\"", "\[Rule]", "\"\<d3\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Beam. Rot. Y\>\"", "\[Rule]", "\"\<b2\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Beam. Rot. Z\>\"", "\[Rule]", "\"\<b3\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Cryst. Rot. X\>\"", "\[Rule]", "\"\<r1\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Cryst. Rot. Y\>\"", "\[Rule]", "\"\<r2\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Cryst. Rot. Z\>\"", "\[Rule]", "\"\<r3\>\""}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"\"\<Rec. latt. \>\"", "~~", "x__"}], "\[RuleDelayed]", 
           "x"}]}], "\[IndentingNewLine]", "\t", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringTrim", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"temp", ",", 
         RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<-\>\"", ",", "DigitCharacter"}], "}"}], "~~", "__", "~~",
            "EndOfLine"}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"ToExpression", "/@", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"temp", ",", "Whitespace"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"PadRight", "[", 
         RowBox[{"temp", ",", 
          RowBox[{"{", 
           RowBox[{"#", ",", "#"}], "}"}]}], "]"}], "&"}], "@", 
       RowBox[{"Length", "@", "tags"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"tags", ",", "m"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Return", " ", "message", " ", "and", 
       " ", "end", " ", "procedure", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667818182241951*^9, {3.66893915387926*^9, 
   3.6689391568541*^9}, {3.6689535682688227`*^9, 3.6689535723667727`*^9}, {
   3.668953742329031*^9, 3.668953767894533*^9}, {3.66895401343414*^9, 
   3.6689540146890287`*^9}, {3.668954095823165*^9, 3.668954202963657*^9}, {
   3.6689552776424713`*^9, 3.6689553523787317`*^9}, 3.668955402248642*^9, 
   3.668955544228961*^9, {3.668955656487473*^9, 3.6689556761029463`*^9}, 
   3.668955723137313*^9, {3.668955778069186*^9, 3.668955778844039*^9}, 
   3.668955851747817*^9, {3.668956797188327*^9, 3.668956800787648*^9}, {
   3.6689574672553*^9, 3.6689575413131104`*^9}, {3.66895757609718*^9, 
   3.668957606608177*^9}, {3.668958061977138*^9, 3.66895807570816*^9}, 
   3.668958262193424*^9, {3.6689582933769817`*^9, 3.668958298791482*^9}, {
   3.668960962636499*^9, 3.6689609941306477`*^9}, {3.6689610325778503`*^9, 
   3.6689610478971767`*^9}, {3.668961123824533*^9, 3.668961124598974*^9}, {
   3.668970746885648*^9, 3.668970747619759*^9}, {3.668971528258317*^9, 
   3.6689717380390673`*^9}, {3.668971776642324*^9, 3.668971907203095*^9}, {
   3.668972475934484*^9, 3.6689724801936407`*^9}, {3.6689739910823507`*^9, 
   3.668973994345357*^9}, {3.668974051645607*^9, 3.66897406018155*^9}, {
   3.6689752555944033`*^9, 3.668975277664154*^9}, {3.671743456672168*^9, 
   3.671743500621964*^9}, {3.6717435544554853`*^9, 3.671743741213606*^9}, {
   3.6717438164518547`*^9, 3.671743818931262*^9}, 3.671744975164258*^9, {
   3.671800749972239*^9, 3.671800888227201*^9}, {3.6718009403308067`*^9, 
   3.6718009411216173`*^9}, {3.671801053161522*^9, 3.6718010610165443`*^9}, {
   3.6718013962772093`*^9, 3.6718014372909307`*^9}, {3.67180149796432*^9, 
   3.671801674554243*^9}, {3.671801846334334*^9, 3.6718018977575417`*^9}, {
   3.6718019879256887`*^9, 3.671802036020062*^9}, 3.671802185692754*^9, 
   3.671802227794935*^9, {3.6718084447688303`*^9, 3.6718084471602793`*^9}, 
   3.67405750466054*^9, {3.674593413241393*^9, 3.674593416496729*^9}, {
   3.674593474563323*^9, 3.6745934753448687`*^9}, 3.6745935504087753`*^9, {
   3.67459480793622*^9, 3.674594812127016*^9}, 3.674594872575062*^9, {
   3.674596265695709*^9, 3.674596269806322*^9}, 3.674596350707733*^9, {
   3.674596499735421*^9, 3.6745965934923143`*^9}, {3.674596848471828*^9, 
   3.6745968761501703`*^9}, {3.6745969829886503`*^9, 3.674597091041081*^9}, {
   3.6745971405449057`*^9, 3.674597246278439*^9}, {3.674597317331833*^9, 
   3.674597397142655*^9}, {3.674597434336905*^9, 3.674597490642775*^9}, {
   3.674597522191773*^9, 3.6745976311390953`*^9}, {3.67459766362247*^9, 
   3.674597751761195*^9}, {3.674598342217937*^9, 3.674598521735631*^9}, 
   3.674598660276051*^9, {3.6745986921146383`*^9, 3.6745987098819647`*^9}, {
   3.674598939310384*^9, 3.67459894001403*^9}, {3.674599000857811*^9, 
   3.674599027393351*^9}, {3.6746459395369263`*^9, 3.674645972159151*^9}, {
   3.6746483761405983`*^9, 3.674648393010826*^9}, {3.674648603662313*^9, 
   3.67464860668504*^9}, {3.6858743666146803`*^9, 3.6858743722280493`*^9}, {
   3.685874428600627*^9, 3.6858744334758377`*^9}, {3.6858745279175673`*^9, 
   3.685874529249617*^9}, {3.685874957721805*^9, 3.685874985805862*^9}, {
   3.685875047585225*^9, 3.685875047828413*^9}, {3.685875081271357*^9, 
   3.685875085948098*^9}, {3.685875383606337*^9, 3.685875451016281*^9}, {
   3.685875502536851*^9, 3.6858755060995827`*^9}, {3.68587554629079*^9, 
   3.6858756052211933`*^9}, {3.685876084910796*^9, 3.68587609414709*^9}, {
   3.68587616864951*^9, 3.685876169466861*^9}, {3.685876293390209*^9, 
   3.68587644720024*^9}, {3.6858765288939323`*^9, 3.685876691278132*^9}, {
   3.68587685532941*^9, 3.685876949253998*^9}, 3.685877044547105*^9, {
   3.6858770785296183`*^9, 3.685877108295972*^9}, 3.685877160010292*^9, {
   3.68587724859991*^9, 3.685877250023253*^9}, {3.685877285168092*^9, 
   3.685877333578431*^9}, 3.6858774824296*^9, {3.6858775271693974`*^9, 
   3.685877533551222*^9}, {3.6858776393088493`*^9, 3.6858777102253113`*^9}, {
   3.685877745587963*^9, 3.6858777855455914`*^9}, {3.685877971918428*^9, 
   3.685878185208087*^9}, {3.685878234122458*^9, 3.6858783577844963`*^9}, {
   3.685878451235614*^9, 3.685878485134301*^9}, {3.68587853226553*^9, 
   3.685878643699811*^9}, {3.685878724407484*^9, 3.685878740449051*^9}, {
   3.6858787823850946`*^9, 3.685879179751277*^9}, {3.685879216804241*^9, 
   3.6858792988814373`*^9}, {3.685879332381937*^9, 3.685879332524156*^9}, {
   3.685879620701285*^9, 3.685879639371826*^9}, {3.685936754296199*^9, 
   3.685936828757168*^9}, {3.685937075742174*^9, 3.685937159798263*^9}, {
   3.6859372957238913`*^9, 3.6859373955874662`*^9}, {3.685937435555813*^9, 
   3.685937443655529*^9}, {3.685937547359518*^9, 3.6859375768306837`*^9}, {
   3.6859376337854567`*^9, 3.685937661595755*^9}, {3.6859380228224707`*^9, 
   3.685938107909132*^9}, {3.685938379602932*^9, 3.685938598833336*^9}, {
   3.685938752183744*^9, 3.685938882882948*^9}, {3.68593905373965*^9, 
   3.685939228236761*^9}, {3.685939258486649*^9, 3.685939261942576*^9}, {
   3.685939299638932*^9, 3.6859393236380997`*^9}, {3.685939358079637*^9, 
   3.6859393615028687`*^9}, {3.685939400349883*^9, 3.685939402852421*^9}, {
   3.6859394332294483`*^9, 3.685939512437005*^9}, {3.6859395474484863`*^9, 
   3.685939547583454*^9}, {3.685939590112442*^9, 3.685939628303574*^9}, {
   3.685939933557848*^9, 3.685939939326646*^9}, {3.685940737617918*^9, 
   3.6859407442990026`*^9}, {3.685940947399419*^9, 3.685941059629252*^9}, {
   3.685941126276173*^9, 3.685941244162122*^9}, {3.685941310981782*^9, 
   3.685941320878624*^9}, {3.6859415472358227`*^9, 3.6859415595929537`*^9}, {
   3.685941606586334*^9, 3.68594161288922*^9}, {3.685944406636078*^9, 
   3.685944514927621*^9}, {3.685944620536152*^9, 3.6859446233511677`*^9}, {
   3.685960757261829*^9, 3.6859607847351027`*^9}, {3.685960820088621*^9, 
   3.685960835342855*^9}, {3.685961031864623*^9, 3.685961200852539*^9}, {
   3.686022584819982*^9, 3.6860226015515833`*^9}, {3.686022653879841*^9, 
   3.686022675377027*^9}, {3.686022950021223*^9, 3.686023088422502*^9}, {
   3.686023121114601*^9, 3.686023236960445*^9}, {3.686023267319146*^9, 
   3.686023342354105*^9}, 3.6862995624474297`*^9, {3.687253456648411*^9, 
   3.687253490933877*^9}, {3.687253525543254*^9, 3.687253527897431*^9}, {
   3.687253616371193*^9, 3.687253616510745*^9}, {3.687254113534917*^9, 
   3.68725418952225*^9}, {3.687255538651263*^9, 3.687255598562874*^9}, {
   3.687255673176875*^9, 3.6872556737047453`*^9}, {3.6872557973504963`*^9, 
   3.6872558682286177`*^9}, {3.687255902340312*^9, 3.6872559277506437`*^9}, {
   3.687255993656146*^9, 3.687255997004445*^9}, {3.6872560347333393`*^9, 
   3.6872561070286818`*^9}, {3.687257493039791*^9, 3.6872574943823967`*^9}, {
   3.687257613983083*^9, 3.687257656239561*^9}, {3.687257687241078*^9, 
   3.687257776892557*^9}, {3.6872578581076183`*^9, 3.687257859021693*^9}, {
   3.6872578918491287`*^9, 3.687257897955031*^9}, {3.7136699159062*^9, 
   3.713669917769485*^9}, {3.713669948209055*^9, 3.713670001959654*^9}, {
   3.713670060137763*^9, 3.713670071854795*^9}, {3.7136708195594263`*^9, 
   3.7136708249319563`*^9}, {3.713671219478012*^9, 3.713671250299797*^9}, {
   3.713671284068367*^9, 3.713671284226981*^9}, 3.713671352441619*^9, {
   3.713671485269841*^9, 3.713671533138571*^9}, {3.7136715969458733`*^9, 
   3.713671604496458*^9}, 3.713671801662971*^9, {3.713672767407249*^9, 
   3.713672788188427*^9}, {3.713672914010313*^9, 3.713673048094618*^9}, {
   3.7136736665049553`*^9, 3.7136736685836287`*^9}, {3.713673699321306*^9, 
   3.713673711455546*^9}, {3.713673789212812*^9, 3.713673799990601*^9}, {
   3.7136750857001953`*^9, 3.713675183318901*^9}, {3.713675213758539*^9, 
   3.71367528873489*^9}, {3.713675405961273*^9, 3.7136754222796087`*^9}, {
   3.713675456448269*^9, 3.713675498557611*^9}, {3.7136755335921593`*^9, 
   3.713675593700807*^9}, {3.713675625292055*^9, 3.713675633794663*^9}, {
   3.7136757653933887`*^9, 3.713675836686082*^9}, {3.713675944979413*^9, 
   3.713676014780087*^9}, {3.7136760513962727`*^9, 3.7136760645373793`*^9}, {
   3.7136760967694197`*^9, 3.713676123015504*^9}, {3.713676200159346*^9, 
   3.7136762042332773`*^9}, {3.713676242821952*^9, 3.713676264401856*^9}, {
   3.7136765413436413`*^9, 3.71367654398393*^9}, {3.713676804713175*^9, 
   3.713676807553444*^9}, {3.713676995524881*^9, 3.7136769966364107`*^9}, {
   3.713677049646826*^9, 3.713677060386262*^9}, {3.713677096436474*^9, 
   3.713677114146543*^9}, {3.713679419617097*^9, 3.713679429194941*^9}, {
   3.7136795177576933`*^9, 3.713679517877891*^9}, {3.713686706958914*^9, 
   3.713686742658032*^9}, {3.713686804548905*^9, 3.71368682245063*^9}, {
   3.713687185202382*^9, 3.7136871884777317`*^9}, {3.7136872494816017`*^9, 
   3.713687250121623*^9}, {3.713692360194339*^9, 3.713692361400322*^9}, {
   3.713692453819728*^9, 3.713692486995563*^9}, {3.713692529177943*^9, 
   3.713692561778796*^9}, 3.7136926628970833`*^9, {3.713692707668895*^9, 
   3.7136928116204443`*^9}, {3.713692856940464*^9, 3.7136928578012943`*^9}, {
   3.7136933516396103`*^9, 3.713693387334593*^9}, {3.713802216315503*^9, 
   3.713802217726561*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[289]:=",ExpressionUUID->"7c947e04-1605-400b-bf12-4988e7bcc9ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RefinedValues", "[", 
   RowBox[{"input_String", ",", 
    RowBox[{"OptionsPattern", "@", "RefinedValues"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "log", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"log", "=", 
      RowBox[{"MergeLogs", "@", "input"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"#", "\[Rule]", 
          RowBox[{"RefinedValues", "[", 
           RowBox[{"log", ",", "#", ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<ConstrainedCell\>\"", "\[Rule]", 
             RowBox[{"OptionValue", "[", "\"\<ConstrainedCell\>\"", "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<Uncertainties\>\"", "\[Rule]", 
             RowBox[{"OptionValue", "[", "\"\<Uncertainties\>\"", "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<Units\>\"", "\[Rule]", 
             RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", "\t", 
        RowBox[{
        "\"\<Refinement\>\"", ",", "\"\<UnitCell\>\"", ",", 
         "\"\<Wavelength\>\"", ",", "\[IndentingNewLine]", "\t", 
         "\"\<InstrumentModel\>\"", ",", "\"\<UB\>\"", ",", "\"\<U\>\"", ",", 
         "\"\<B\>\"", ",", "\"\<Mosaicity\>\"", ",", "\[IndentingNewLine]", 
         "\t", "\"\<Angles\>\"", ",", "\"\<CorrelationMatrix\>\""}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713692081880583*^9, 3.713692313891738*^9}, {
   3.713692394746468*^9, 3.7136924149578743`*^9}, 3.713693518720646*^9, {
   3.713693708220636*^9, 3.713693723178986*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[290]:=",ExpressionUUID->"098360e2-ac3e-44bd-ad35-c18e4b0da9f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[291]:=",ExpressionUUID->"eb80ed6b-f5c8-45cc-ae64-ad2b87bb5f7f"]
}, Closed]],

Cell[CellGroupData[{

Cell["RoundSignificantFigures", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.684646660758275*^9, 
   3.684646660811885*^9}, {3.684679409191053*^9, 3.684679411222722*^9}, {
   3.6846811176191063`*^9, 3.684681119497213*^9}, {3.6846813101581917`*^9, 
   3.6846813119644547`*^9}, {3.684735312111738*^9, 3.684735315961302*^9}, {
   3.68473584376371*^9, 3.6847358475681477`*^9}, 
   3.7616532046980667`*^9},ExpressionUUID->"2dd21067-07a0-4cd8-805e-\
a8c7261b1d64"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[292]:=",ExpressionUUID->"6fa8b28f-536b-4288-adf1-eb4f91c5b73f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "RoundSignificantFigures"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<Prefix\>\"", "\[Rule]", "True"}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.761653204706108*^9},
 CellLabel->
  "In[293]:=",ExpressionUUID->"09fff4b7-4b95-4f2f-86fd-1f3fa694a9d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[294]:=",ExpressionUUID->"fe7a24ad-184c-4cba-ba1a-7b74a82e2f6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RoundSignificantFigures", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x_", "?", "NumericQ"}], ",", 
      RowBox[{"\[Delta]x_", "?", "NumericQ"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "RoundSignificantFigures"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "a", ",", "\[Delta]", ",", "\[Delta]1", ",", "\[Delta]2", ",", "p1", ",",
       "p2", ",", "d", ",", "X", ",", "\[Delta]X", ",", "postfix", ",", 
      "output", ",", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Extract", " ", "first", " ", "two", " ", "signigicant", " ", "figures", 
      " ", "of", " ", "uncertainty"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Delta]", "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{"\[Delta]x", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Delta]1", ",", "\[Delta]2"}], "}"}], "=", 
      RowBox[{"First", "@", 
       RowBox[{"RealDigits", "@", "\[Delta]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Determining", " ", "difference", " ", "in", " ", "order", " ", "of", 
       " ", "magnitude"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"RealDigits", "[", "#", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], ")"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"x", ",", "\[Delta]x"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"p1", "-", "p2", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Rounding", " ", "to", " ", "one", " ", "digit"}], " ", "+", 
        " ", "zero"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]1", "\[Equal]", "9"}], "&&", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"5", ",", "9"}], "]"}], ",", "\[Delta]2"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"X", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"x", ",", "d"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"\[Delta]X", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{"\[Delta]x", ",", 
             RowBox[{"10", "^", "p2"}]}], "]"}], ",", "2"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Rounding", " ", "to", " ", "two", " ", "digits"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Delta]1", "\[Equal]", "1"}], "&&", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "5"}], "]"}], ",", "\[Delta]2"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"X", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"x", ",", 
           RowBox[{"d", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"\[Delta]X", "=", "\[Delta]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Rounding", " ", "to", " ", "one", " ", "digit"}], " ", 
        "*)"}], "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"X", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"x", ",", "d"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"\[Delta]X", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"\[Delta]x", ",", "1"}], "]"}]}]}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Chopping", " ", "result"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"{", 
       RowBox[{"X", ",", "\[Delta]X"}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Replace", " ", "powers", " ", "with", " ", "appropriate", " ", "SI", 
        " ", "prefix"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Prefix\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Divisible", "[", 
           RowBox[{"p1", ",", "3"}], "]"}], "&&", 
          RowBox[{"p1", "\[NotEqual]", "0"}], "&&", 
          RowBox[{"d", "\[LessEqual]", "6"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"postfix", "=", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"p1", "\[Equal]", 
              RowBox[{"-", "12"}]}], ",", "\"\<pico\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"p1", "\[Equal]", 
              RowBox[{"-", "9"}]}], ",", "\"\<nano\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"p1", "\[Equal]", 
              RowBox[{"-", "6"}]}], ",", "\"\<mikro\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"p1", "\[Equal]", 
              RowBox[{"-", "3"}]}], ",", "\"\<milli\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"p1", "\[Equal]", "3"}], ",", "\"\<kilo\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"p1", "\[Equal]", "6"}], ",", "\"\<mega\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"p1", "\[Equal]", "9"}], ",", "\"\<giga\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"p1", "\[Equal]", "12"}], ",", "\"\<tera\>\""}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"X", "=", 
           RowBox[{"X", "/", 
            RowBox[{"10", "^", "p1"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Delta]X", "=", 
           RowBox[{"\[Delta]X", "/", 
            RowBox[{"10", "^", "p1"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"output", "=", 
           RowBox[{"\"\<(\>\"", "<>", 
            RowBox[{"ToString", "@", "X"}], "<>", "\"\< \[PlusMinus] \>\"", "<>", 
            RowBox[{"ToString", "@", "\[Delta]X"}], "<>", "\"\<) \>\"", "<>", 
            "postfix"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "output"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.71309104014808*^9, 3.713091065525038*^9}, {
   3.7130911402925177`*^9, 3.71309135424797*^9}, {3.713091392407091*^9, 
   3.71309179052686*^9}, {3.713092108438493*^9, 3.713092588236218*^9}, {
   3.7130926305244713`*^9, 3.713092630931327*^9}, {3.713092698130988*^9, 
   3.713092701657473*^9}, {3.713092776408547*^9, 3.713092819199215*^9}, {
   3.713092939893323*^9, 3.713093039482225*^9}, {3.713093070385338*^9, 
   3.713093105568389*^9}, {3.713093184647653*^9, 3.7130932217194157`*^9}, {
   3.7130933204608088`*^9, 3.713093324843099*^9}, {3.713093765730145*^9, 
   3.713093767225092*^9}, {3.713093832159378*^9, 3.7130938351915894`*^9}, 
   3.713093871504115*^9, {3.713093939927082*^9, 3.713093953900981*^9}, {
   3.7130944680409*^9, 3.71309449884906*^9}, {3.7130945302798347`*^9, 
   3.7130946157822104`*^9}, {3.713094649246682*^9, 3.713094671291792*^9}, {
   3.713094910879513*^9, 3.713094914542392*^9}, {3.713098887174562*^9, 
   3.713098936492216*^9}, {3.713099022090056*^9, 3.713099123055879*^9}, {
   3.713099236725995*^9, 3.713099254330511*^9}, {3.713099286324902*^9, 
   3.713099290460676*^9}, {3.7130993362035913`*^9, 3.713099350691886*^9}, {
   3.7130994306241293`*^9, 3.71309943751038*^9}, {3.71310129254068*^9, 
   3.713101301553968*^9}, {3.713101481232038*^9, 3.71310151853353*^9}, {
   3.713101741328989*^9, 3.71310178050406*^9}, {3.713101822239067*^9, 
   3.713101864056319*^9}, {3.71310189648588*^9, 3.713101911062029*^9}, {
   3.713101971691717*^9, 3.713101980355644*^9}, {3.713102143504184*^9, 
   3.713102162782456*^9}, {3.7131022895726213`*^9, 3.713102329082534*^9}, {
   3.713102404801784*^9, 3.713102434335906*^9}, {3.713102641052273*^9, 
   3.713102713779704*^9}, {3.7131028686316843`*^9, 3.713102887311252*^9}, {
   3.713103058658811*^9, 3.713103072106525*^9}, {3.713103140520859*^9, 
   3.713103172151176*^9}, {3.713103290549489*^9, 3.7131032906276217`*^9}, {
   3.713103340196616*^9, 3.713103359090212*^9}, {3.761653204712758*^9, 
   3.761653204718582*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[295]:=",ExpressionUUID->"c82810ed-77ca-4a80-a585-19963e5b611a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[296]:=",ExpressionUUID->"00227bdc-9cd6-40f4-ac5b-ed6878758ad9"]
}, Closed]],

Cell[CellGroupData[{

Cell["UnwarpLayerList", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 
   3.667818641980616*^9},ExpressionUUID->"ce349b9d-6982-4794-8985-\
62d9786c2820"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[297]:=",ExpressionUUID->"6f60cb0e-e142-4f9c-9308-3549b0a14e1c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UnwarpLayerList", "::", "dir"}], "=", 
   "\"\<The direction vector must be three-dimensional and numeric.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnwarpLayerList", "::", "dep"}], "=", 
   "\"\<The layer vectors are not linearly independent.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnwarpLayerList", "::", "dim"}], "=", 
   "\"\<One or both of the layer vectors are not three dimensional.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnwarpLayerList", "::", "extended"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] has been extended.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnwarpLayerList", "::", "jobs"}], "=", 
   "\"\<Some unwarping jobs are identical. Try increasing the range or step \
size.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnwarpLayerList", "::", "steps"}], "=", 
   "\"\<\!\(\*StyleBox[\"CrysAlis\",FontSlant->\"Italic\"]\) will only queue \
500 jobs at a time.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnwarpLayerList", "::", "small"}], "=", 
   "\"\<Some values are smaller than \!\(\*SuperscriptBox[\(10\), \
\(-6\)]\).\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnwarpLayerList", "::", "path"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is an invalid path.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnwarpLayerList", "::", "notfound"}], "=", 
    "\"\<No existing \!\(\*StyleBox[\".\", \
\"Program\"]\)\!\(\*StyleBox[\"dcunwarp\", \"Program\"]\) file was found in \
the export directory.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "UnwarpLayerList", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<ExportDirectory\>\"", "\[Rule]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"$HomeDirectory", ",", "\"\<Desktop\>\""}], "}"}], "]"}]}], 
     ",", 
     RowBox[{"\"\<AppendToExisting\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SeparationCommas\>\"", "\[Rule]", "True"}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.667818661555488*^9, {3.678788832925145*^9, 
   3.678788853508518*^9}, {3.679730176345752*^9, 3.6797301899949493`*^9}, {
   3.6797309670395813`*^9, 3.679731002636737*^9}, {3.679733372295627*^9, 
   3.6797334331570044`*^9}, {3.679734006976156*^9, 3.6797340119269238`*^9}, {
   3.679734046104413*^9, 3.6797340490782003`*^9}, {3.6797342428439207`*^9, 
   3.679734243889909*^9}, {3.679736548422727*^9, 3.67973655803654*^9}, 
   3.679736675868291*^9},
 CellLabel->
  "In[298]:=",ExpressionUUID->"ce0dad3f-7924-46f5-aaa9-cac6c1cd8b0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[308]:=",ExpressionUUID->"00c2ae64-08f8-40fc-838a-bab05634ccc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UnwarpLayerList", "[", "\[IndentingNewLine]", 
   RowBox[{
   "prefix_String", ",", "L1_List", ",", "L2_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"dir_List", ",", "start_", ",", "end_", ",", 
      RowBox[{"stepinput_", "?", "NumericQ"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "Res_", ",", 
    RowBox[{"OptionsPattern", "[", "UnwarpLayerList", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "steps", ",", "path", ",", "output", ",", "\[IndentingNewLine]", "len", 
      ",", "replacerule", ",", "\[Delta]", ",", "\[IndentingNewLine]", 
      "MakeValue", ",", "OriginVector", ",", "\[IndentingNewLine]", "const", 
      ",", "MakeName", ",", "\[IndentingNewLine]", "newL1", ",", "newL2", ",",
       "res", ",", "line", ",", "original", ",", "old", ",", "new", ",", "j", 
      ",", "valuestest", ",", "\[IndentingNewLine]", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Checking", " ", "input", " ", "vectors"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "/@", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"{", 
           RowBox[{"L1", ",", "L2"}], "}"}]}]}], "\[NotEqual]", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"UnwarpLayerList", "::", "dim"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Ascertaining", " ", "steps", " ", "or", " ", "stepsize"}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"stepinput", ">", "1"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"steps", "=", "stepinput"}], ",", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"steps", "=", 
        RowBox[{"Round", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"Abs", "[", 
            RowBox[{"end", "-", "start"}], "]"}], "stepinput"], "+", "1"}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "resolution", " ", "of", " ", "the", " ", "range"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"end", "-", "start"}], "]"}], "/", "steps"}], "<", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], "-", 
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]]}]}], ",", 
       RowBox[{"Message", "[", 
        RowBox[{"UnwarpLayerList", "::", "jobs"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"steps", ">", "500"}], ",", 
       RowBox[{"Message", "[", 
        RowBox[{"UnwarpLayerList", "::", "steps"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Path", " ", "check", " ", "and", " ", "setup"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"path", "=", 
      RowBox[{"OptionValue", "[", "\"\<ExportDirectory\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DirectoryQ", "@", "path"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"UnwarpLayerList", "::", "path"}], ",", "path"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"output", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"path", ",", 
         RowBox[{"prefix", "<>", "\"\<.dcunwarp\>\""}]}], "}"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Useful", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"len", "=", 
      RowBox[{"StringLength", "@", 
       RowBox[{"ToString", "@", "steps"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"replacerule", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<,\>\"", "\[Rule]", "\"\<  \>\""}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<{\>\"", ",", "\"\<}\>\""}], "}"}], "\[Rule]", 
         "\"\<\>\""}]}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"6", ",", 
        RowBox[{
         RowBox[{"StringLength", "@", 
          RowBox[{"ToString", "@", 
           RowBox[{"N", "[", 
            FractionBox[
             RowBox[{"end", "-", "start"}], 
             RowBox[{"steps", "-", "1"}]], "]"}]}]}], "-", "2"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "vectors", " ", "are", " ", "linearly", " ", 
       "independent"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Det", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"L1", ".", "L1"}], ",", 
             RowBox[{"L1", ".", "L2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"L2", ".", "L1"}], ",", 
             RowBox[{"L2", ".", "L2"}]}], "}"}]}], "}"}], "]"}], "\[Equal]", 
        "0"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"UnwarpLayerList", "::", "dep"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Making", " ", "the", " ", "origin", 
       " ", "vectors", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "input", " ", "form"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"dir", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"UnwarpLayerList", "::", "dir"}], "]"}], 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"MakeValue", "[", "i_", "]"}], ":=", 
      RowBox[{"start", "+", 
       RowBox[{
        FractionBox[
         RowBox[{"end", "-", "start"}], 
         RowBox[{"steps", "-", "1"}]], "*", 
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"OriginVector", "[", "i_", "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"dir", "*", 
          RowBox[{"MakeValue", "[", "i", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"AccountingForm", "@", 
          RowBox[{"NumberForm", "[", 
           RowBox[{
            RowBox[{"N", "[", "temp", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Infinity", ",", "6"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"ToString", "@", "temp"}], ",", "replacerule"}], "]"}]}]}],
        "\[IndentingNewLine]", "\t", ")"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "for", " ", "duplicates", " ", "and", " ", "values", " ", 
       "smaller", " ", "than", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"valuestest", "=", 
      RowBox[{"ToString", "/@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"MakeValue", "[", "j", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "steps"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DuplicateFreeQ", "@", "valuestest"}]}], ",", 
       RowBox[{"Message", "[", 
        RowBox[{"UnwarpLayerList", "::", "small"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Generating", " ", "names", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Integer", " ", "Miller", " ", "indices"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"const", "=", 
      RowBox[{
       RowBox[{"dir", "+", 
        RowBox[{"{", 
         RowBox[{"\"\<h\>\"", ",", "\"\<k\>\"", ",", "\"\<l\>\""}], "}"}]}], "/.", 
       RowBox[{
        RowBox[{"a_", "+", "b_"}], "\[Rule]", "0"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Procedure", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"MakeName", "[", "i_", "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"ToExpression", "@", 
          RowBox[{"StringSplit", "@", 
           RowBox[{"OriginVector", "[", "i", "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Delta]", "\[Equal]", "0"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"Integers", " ", 
            RowBox[{"only", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"temp", "=", 
           RowBox[{"Rationalize", "@", "temp"}]}], ",", "\[IndentingNewLine]",
           "\t", 
          RowBox[{"temp", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"NumberForm", "[", "\[IndentingNewLine]", "\t", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"Infinity", ",", "\[Delta]"}], "}"}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"ExponentFunction", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"Null", "&"}], ")"}]}]}], "]"}], "&"}], "/@", 
            "temp"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", "=", 
         RowBox[{
          RowBox[{"const", "+", "temp"}], "/.", 
          RowBox[{
           RowBox[{"x_String", "+", "y_"}], "\[RuleDelayed]", "x"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<SeparationCommas\>\"", "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Remove", " ", "separating", " ", 
            RowBox[{"commas", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"temp", "=", 
           RowBox[{"StringRiffle", "[", 
            RowBox[{
             RowBox[{"ToString", "/@", "temp"}], ",", "\"\<,\>\""}], "]"}]}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"temp", "=", 
           RowBox[{"ToString", "/@", "temp"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
         "\"\<\\\"\>\"", ",", "prefix", ",", "\"\<_(\>\"", ",", "temp", ",", 
          "\"\<)\\\"\>\""}], "]"}]}], "\[IndentingNewLine]", "\t", ")"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"The", " ", "L1", " ", "and", " ", "L2", " ", "vectors"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"newL1", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "@", 
         RowBox[{"NumberForm", "[", 
          RowBox[{"L1", ",", 
           RowBox[{"{", 
            RowBox[{"Infinity", ",", "6"}], "}"}]}], "]"}]}], ",", 
        "replacerule"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"newL2", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "@", 
         RowBox[{"NumberForm", "[", 
          RowBox[{"L2", ",", 
           RowBox[{"{", 
            RowBox[{"Infinity", ",", "6"}], "}"}]}], "]"}]}], ",", 
        "replacerule"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"The", " ", "resolution"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"res", "=", 
      RowBox[{"ToString", "@", 
       RowBox[{"NumberForm", "[", 
        RowBox[{"Res", ",", 
         RowBox[{"{", 
          RowBox[{"Infinity", ",", "6"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Function", " ", "that", " ", "writes", " ", "a", " ", "single", " ", 
       "line"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"line", "[", "i_", "]"}], ":=", 
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"MakeName", "[", "i", "]"}], ",", "\"\<   \>\"", ",", 
        RowBox[{"OriginVector", "[", "i", "]"}], ",", "\"\<     \>\"", ",", 
        "newL1", ",", "\"\<     \>\"", ",", "newL2", ",", "\"\<        \>\"", 
        ",", "res", ",", "\"\<       \>\"", ",", "\"\<0\>\"", ",", 
        "\"\<       \>\"", ",", "\"\<0\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Generating", " ", "and", " ", "exporting", " ", "table"}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<AppendToExisting\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"original", "=", 
         RowBox[{"FileNames", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<ExportDirectory\>\"", "]"}], 
           "<>", "\"\</*.dcunwarp\>\""}], "]"}]}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"original", "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"UnwarpLayerList", "::", "notfound"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"old", "=", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"First", "@", "original"}], ",", "\"\<String\>\""}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"new", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"line", "[", "i", "]"}], "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "<", "steps"}], ",", "\"\<\\n\>\"", ",", 
              "\"\<\>\""}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "steps"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Export", "[", 
         RowBox[{"original", ",", 
          RowBox[{"old", "<>", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"old", ",", 
                RowBox[{"-", "1"}]}], "]"}], "\[Equal]", "\"\<0\>\""}], ",", 
             "\"\<\\n\>\"", ",", "\"\<\>\""}], "]"}], "<>", "new"}], ",", 
          "\"\<String\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"UnwarpLayerList", "::", "extended"}], ",", 
          RowBox[{"FileNameTake", "@", 
           RowBox[{"First", "@", "original"}]}]}], "]"}]}], ",", "\t", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"Export", "[", 
        RowBox[{"output", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"line", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "steps"}], "}"}]}], "]"}], ",", 
         "\"\<Table\>\""}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667818655261512*^9, {3.67871002711523*^9, 
   3.678710082589615*^9}, {3.678710121181778*^9, 3.678710167699074*^9}, {
   3.678780241040431*^9, 3.678780276115664*^9}, {3.678788865190544*^9, 
   3.678788977540194*^9}, {3.6794823589229097`*^9, 3.679482378956861*^9}, {
   3.679482449116295*^9, 3.679482484210161*^9}, {3.6795535894308023`*^9, 
   3.679553594985097*^9}, {3.679730372990347*^9, 3.679730423732448*^9}, {
   3.679730469374566*^9, 3.679730566706032*^9}, {3.6797306009613237`*^9, 
   3.679730601472571*^9}, {3.6797316212190742`*^9, 3.679731659793439*^9}, {
   3.679731705602343*^9, 3.679731790317072*^9}, {3.679731847596982*^9, 
   3.6797318936910458`*^9}, {3.679731928852064*^9, 3.67973197783316*^9}, {
   3.679732253608233*^9, 3.679732257891107*^9}, {3.679732364864867*^9, 
   3.679732417504838*^9}, {3.67973299821957*^9, 3.6797330047850933`*^9}, {
   3.679733068591881*^9, 3.679733118223279*^9}, {3.679733347697291*^9, 
   3.679733367746338*^9}, 3.679733469912014*^9, {3.679733528839448*^9, 
   3.679733547949156*^9}, {3.679733685049611*^9, 3.6797336861133947`*^9}, {
   3.6797343002127247`*^9, 3.679734450408527*^9}, {3.6797345134559307`*^9, 
   3.679734558253223*^9}, {3.679734596654254*^9, 3.679734624339402*^9}, {
   3.679734659344974*^9, 3.6797346683065023`*^9}, {3.679734698787793*^9, 
   3.67973470587523*^9}, {3.679734748466054*^9, 3.679734811726412*^9}, 
   3.679734847175488*^9, {3.679734996460588*^9, 3.6797351021860027`*^9}, 
   3.6797351461141567`*^9, {3.6797353083576937`*^9, 3.679735324548381*^9}, {
   3.679735377692288*^9, 3.679735421274282*^9}, {3.679735573991074*^9, 
   3.67973561279739*^9}, {3.6797356502862177`*^9, 3.6797356546767893`*^9}, {
   3.679736345501027*^9, 3.6797363539167967`*^9}, 3.6797412343747263`*^9, {
   3.6797412788750467`*^9, 3.6797412863519373`*^9}, {3.679741724170665*^9, 
   3.6797417422643557`*^9}, {3.679744898512738*^9, 3.679744904462715*^9}, {
   3.7138025803583612`*^9, 3.713802585949602*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[309]:=",ExpressionUUID->"4aceb80c-8dc6-4699-93b5-9c4790b4bb36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[310]:=",ExpressionUUID->"a3d5f462-bf7c-445c-83cf-7f36cbad8d06"]
}, Closed]],

Cell[CellGroupData[{

Cell["WeightedMean", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.684646660758275*^9, 
   3.684646660811885*^9}, {3.684679409191053*^9, 3.684679411222722*^9}, {
   3.6846811176191063`*^9, 3.684681119497213*^9}, {3.6846813101581917`*^9, 
   3.6846813119644547`*^9}},ExpressionUUID->"8b512749-d75e-48ee-bf82-\
dd0f8b315513"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[311]:=",ExpressionUUID->"486e110b-ba9a-4b96-93d6-a0e49153a0de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WeightedMean", "::", "numeric"}], "=", 
   "\"\<Numeric input only.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WeightedMean", "::", "invalid"}], "=", 
   "\"\<Invalid input form.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[312]:=",ExpressionUUID->"248a947a-0a45-4065-9945-bfd59804bc97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[314]:=",ExpressionUUID->"48ecadeb-9d3a-4abd-94fd-aad2a72c50cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeightedMean", "[", "data_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "n", ",", "sum", ",", "x", ",", "d", ",", "\[Sigma]", ",", "m", ",", 
      "\[IndentingNewLine]", "w", ",", "sumw", ",", "sumxw", ",", "wx", ",", 
      "sumxn", ",", "\[Sigma]i", ",", "\[Sigma]e"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "Check", " ", "input"}], " ", "**)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "data"}], ",", "NumericQ"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"WeightedMean", "::", "numeric"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Depth", "[", "data", "]"}], "\[Equal]", "2"}], ",", 
       RowBox[{"Goto", "[", "\"\<WithoutWeights\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "data", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Goto", "[", "\"\<WithWeights\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"WeightedMean", "::", "invalid"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "Data", " ", "without", " ", "weights"}], " ", 
      "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<WithoutWeights\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Useful", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"First", "@", "data"}], ",", "Indeterminate", ",", 
          "Indeterminate"}], "}"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sum", "=", 
      RowBox[{"N", "@", 
       RowBox[{"Total", "@", "data"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"x", "=", 
      RowBox[{"sum", "/", "n"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"d", "=", 
      RowBox[{"data", "-", "x"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Standard", " ", "deviations"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Sigma]", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"d", "^", "2"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"m", "=", 
      RowBox[{"\[Sigma]", "/", 
       RowBox[{"Sqrt", "[", "n", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "\[Sigma]", ",", "m"}], "}"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "Data", " ", "with", " ", "weights"}], " ", "**)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<WithWeights\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Useful", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "Indeterminate", ",", 
          
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "\[Sigma]"}], "}"}], "=", 
      RowBox[{"N", "@", 
       RowBox[{"Transpose", "@", "data"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"w", "=", 
      RowBox[{"1", "/", 
       RowBox[{"\[Sigma]", "^", "2"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"sumw", "=", 
      RowBox[{"Total", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"sumxw", "=", 
      RowBox[{"x", ".", "w"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"wx", "=", 
      RowBox[{"sumxw", "/", "sumw"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Standard", " ", "deviation", " ", 
       RowBox[{"(", "internal", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"\[Sigma]i", "=", 
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", "sumw", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Standard", " ", "deviation", " ", 
       RowBox[{"(", "external", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"d", "=", 
      RowBox[{"x", "-", "wx"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"sumxn", "=", 
      RowBox[{"w", ".", 
       RowBox[{"d", "^", "2"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Sigma]e", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"sumxn", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "*", "sumw"}], ")"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"wx", ",", "\[Sigma]i", ",", "\[Sigma]e"}], "}"}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.684681126098569*^9, 3.68468113261707*^9}, {
   3.684681314799778*^9, 3.684681395619067*^9}, {3.684681505457395*^9, 
   3.684681556063126*^9}, {3.6846815878074408`*^9, 3.6846818093068333`*^9}, {
   3.684685030178719*^9, 3.684685100167528*^9}, {3.68468520231924*^9, 
   3.684685234012491*^9}, {3.684685281091477*^9, 3.684685439768339*^9}, {
   3.684685587884272*^9, 3.684685671506892*^9}, {3.684685805889974*^9, 
   3.684685908701192*^9}, {3.684685949581909*^9, 3.6846861238240957`*^9}, {
   3.684688760297517*^9, 3.684688760975606*^9}, {3.6846888319429092`*^9, 
   3.684688868964966*^9}, {3.684688936172331*^9, 3.6846889580267563`*^9}, {
   3.684689140823488*^9, 3.6846892517314787`*^9}, {3.6846893353940983`*^9, 
   3.684689347937306*^9}, {3.684689397904675*^9, 3.684689398176662*^9}, {
   3.6846894450874567`*^9, 3.6846895630529423`*^9}, {3.68468959606793*^9, 
   3.684689652778881*^9}, {3.684689724177442*^9, 3.684689740865003*^9}, 
   3.684689840439896*^9, 3.6846898903814*^9, {3.684690123408786*^9, 
   3.684690167350737*^9}, {3.684690205488257*^9, 3.6846902865736523`*^9}, {
   3.684690376428082*^9, 3.684690409930132*^9}, {3.684690573246892*^9, 
   3.6846905870395203`*^9}, {3.6846906279888163`*^9, 3.684690811367805*^9}, {
   3.684690904830155*^9, 3.6846909228530283`*^9}, {3.684691045330447*^9, 
   3.684691055954417*^9}, {3.6846910934271107`*^9, 3.6846911148174763`*^9}, {
   3.6846911666652813`*^9, 3.68469121004055*^9}, {3.684693544799094*^9, 
   3.68469360660434*^9}, 3.6847327226125917`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[315]:=",ExpressionUUID->"a52fc267-1e1b-4817-8047-b35fef3d6095"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[316]:=",ExpressionUUID->"7c59d3b9-6528-48ae-b568-435b7200446e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Package finalisation", "Chapter",
 CellChangeTimes->{{3.667810135289062*^9, 3.667810137240119*^9}, {
   3.675855449503755*^9, 3.675855450582547*^9}, 3.73528960274688*^9, {
   3.7617285333605328`*^9, 
   3.761728539480451*^9}},ExpressionUUID->"92919a8d-84f0-46e0-941f-\
8027cba814f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "End", " ", "previous", " ", "subcontext", " ", "and", " ", "Stians`", " ",
     "package"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EndPackage", "[", "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}, {3.761730412539352*^9, 3.7617304440480022`*^9}, {
   3.761731370445418*^9, 3.761731384275672*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[317]:=",ExpressionUUID->"67d5953b-10af-4324-9517-aed3d55c6ce6"]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowToolbars->{},
InitializationCellWarning->False,
WindowSize->{720, 795},
WindowMargins->{{Automatic, 467}, {Automatic, 171}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 715, 14, 98, "Title",ExpressionUUID->"7541a7b4-04fa-47dc-b2b7-c2bd1fca3320"],
Cell[CellGroupData[{
Cell[1320, 40, 160, 3, 69, "Chapter",ExpressionUUID->"d0a0010f-a336-45df-a4c7-71465c0f9d95"],
Cell[1483, 45, 2045, 40, 133, "Input",ExpressionUUID->"2c066dd9-52df-42ed-8147-417bdf0ac46d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[3565, 90, 438, 11, 58, "Chapter",ExpressionUUID->"07229cf0-bbfc-4e92-b7e5-091e773089e8"],
Cell[4006, 103, 752, 15, 70, "Input",ExpressionUUID->"5e9e07e8-1f40-4fa9-b1c6-804bd4605116",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[4783, 122, 335, 5, 65, "Subchapter",ExpressionUUID->"2a5a1051-bcd8-480b-b9f4-e251f62e61c5"],
Cell[5121, 129, 1214, 19, 49, "Input",ExpressionUUID->"b76214e5-5bd3-4296-aa39-c471e3cc3369",
 InitializationCell->True],
Cell[6338, 150, 2023, 51, 320, "Input",ExpressionUUID->"a8cd90d2-631c-4a56-b2e5-dc18c97676a2",
 InitializationCell->True],
Cell[8364, 203, 1137, 18, 46, "Input",ExpressionUUID->"fe11bf7b-aa2b-436d-a370-db26b99875ad",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[9538, 226, 384, 6, 49, "Subchapter",ExpressionUUID->"5b858855-77dd-48c1-b637-daa256a3fe40"],
Cell[9925, 234, 619, 11, 46, "Input",ExpressionUUID->"a405a0de-f70c-4f0e-9be4-113d00815b66",
 InitializationCell->True],
Cell[10547, 247, 1062, 30, 152, "Input",ExpressionUUID->"f4ae5828-5f42-4b99-90a8-293632c5a91d",
 InitializationCell->True],
Cell[11612, 279, 1215, 19, 49, "Input",ExpressionUUID->"3b53743d-ceb6-4df9-a05e-0f7e5e64420a",
 InitializationCell->True],
Cell[12830, 300, 4093, 104, 530, "Input",ExpressionUUID->"6183f809-4ba6-4931-a1a8-9a5fdfee4143",
 InitializationCell->True],
Cell[16926, 406, 2931, 74, 362, "Input",ExpressionUUID->"862bf631-f0d8-4afe-9f7c-06185f9d5c5e",
 InitializationCell->True],
Cell[19860, 482, 1138, 18, 46, "Input",ExpressionUUID->"a8c5019a-041f-4ec4-a6ae-b7612dc9c4de",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[21035, 505, 436, 7, 49, "Subchapter",ExpressionUUID->"1279a9a4-af7a-4f1f-af9b-188b4301c576"],
Cell[21474, 514, 620, 11, 46, "Input",ExpressionUUID->"f8b7589d-afc0-4747-a182-9965f74b1a25",
 InitializationCell->True],
Cell[22097, 527, 1677, 37, 299, "Input",ExpressionUUID->"0202cdc0-61f4-48b7-9504-79b68bdc7fb8",
 InitializationCell->True],
Cell[23777, 566, 1215, 19, 49, "Input",ExpressionUUID->"4674835c-c177-4047-a1ed-8053c51062a6",
 InitializationCell->True],
Cell[24995, 587, 17171, 383, 2336, "Input",ExpressionUUID->"070b3281-cdef-474f-b54b-4bd66db35919",
 InitializationCell->True],
Cell[42169, 972, 1138, 18, 46, "Input",ExpressionUUID->"563b92c1-6269-46a9-9224-ebb6c7b8c7b1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[43344, 995, 534, 8, 49, "Subchapter",ExpressionUUID->"cfa6d2e7-36a8-42ff-82d8-e1062e24114a"],
Cell[43881, 1005, 620, 11, 46, "Input",ExpressionUUID->"6ca97392-41ae-4505-8b02-5e3f61a3e826",
 InitializationCell->True],
Cell[44504, 1018, 1889, 38, 215, "Input",ExpressionUUID->"50a27b72-e3f2-4aa9-9d7d-e3011be4430d",
 InitializationCell->True],
Cell[46396, 1058, 1215, 19, 49, "Input",ExpressionUUID->"135ab9ba-eb1e-4f1f-a583-c351f1ed8116",
 InitializationCell->True],
Cell[47614, 1079, 35891, 668, 3155, "Input",ExpressionUUID->"25c668f6-23a5-478e-b009-e707374b07d5",
 InitializationCell->True],
Cell[83508, 1749, 1138, 18, 46, "Input",ExpressionUUID->"6c9d0217-78f7-4b48-a251-8f26cb6a0f7d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[84683, 1772, 162, 3, 49, "Subchapter",ExpressionUUID->"4b6fe57a-868d-479f-9b37-8245b81ab774"],
Cell[84848, 1777, 620, 11, 46, "Input",ExpressionUUID->"d828999e-bda7-4154-b732-6aa849687fbc",
 InitializationCell->True],
Cell[85471, 1790, 1822, 44, 257, "Input",ExpressionUUID->"02c55b43-9565-4a99-b029-5866e4fb8083",
 InitializationCell->True],
Cell[87296, 1836, 1111, 17, 49, "Input",ExpressionUUID->"fa91ebf0-85ca-4c3a-9ce4-8e1af93bfff0",
 InitializationCell->True],
Cell[88410, 1855, 12951, 287, 2210, "Input",ExpressionUUID->"3cd49a64-af23-44a1-8ef2-81330882a3d7",
 InitializationCell->True],
Cell[101364, 2144, 1138, 18, 46, "Input",ExpressionUUID->"36de6a3e-2be7-45c7-aba4-31d218903854",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[102539, 2167, 252, 4, 49, "Subchapter",ExpressionUUID->"a2a604c9-d4f7-4883-adb8-89d6af68a115"],
Cell[102794, 2173, 620, 11, 46, "Input",ExpressionUUID->"2cccd52c-ba03-413e-97cd-a4ef60ebfbe1",
 InitializationCell->True],
Cell[103417, 2186, 2339, 51, 257, "Input",ExpressionUUID->"868683c8-5bc6-4c3f-b12e-94765e65c2bc",
 InitializationCell->True],
Cell[105759, 2239, 1111, 17, 49, "Input",ExpressionUUID->"721e678e-1b30-42d4-8e23-7ba425cd27c9",
 InitializationCell->True],
Cell[106873, 2258, 22263, 462, 3407, "Input",ExpressionUUID->"b5ce9337-e4ed-4b5d-9673-338bd1a6554b",
 InitializationCell->True],
Cell[129139, 2722, 1138, 18, 46, "Input",ExpressionUUID->"e0577e5d-ded5-4286-aa05-c2701908bbff",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[130314, 2745, 162, 3, 49, "Subchapter",ExpressionUUID->"08c528c4-043f-447d-95c2-c97a6803f147"],
Cell[130479, 2750, 624, 12, 46, "Input",ExpressionUUID->"f4068f08-0f51-470c-b359-3d6b531da7c5",
 InitializationCell->True],
Cell[131106, 2764, 1399, 32, 215, "Input",ExpressionUUID->"92431e28-c7aa-48fa-a5d3-930454adc5fa",
 InitializationCell->True],
Cell[132508, 2798, 1214, 20, 49, "Input",ExpressionUUID->"e4196f15-913e-41d1-98df-53cfa57c58b3",
 InitializationCell->True],
Cell[133725, 2820, 18995, 404, 1790, "Input",ExpressionUUID->"20b1a9aa-e7c9-461b-95e8-f9df2d66982a",
 InitializationCell->True],
Cell[152723, 3226, 1142, 19, 46, "Input",ExpressionUUID->"1e0cc859-eda6-496b-99e5-bc8d64d89e4d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[153902, 3250, 180, 3, 49, "Subchapter",ExpressionUUID->"5194c2cd-c03e-4de2-af38-a14277dd947f"],
Cell[154085, 3255, 624, 12, 46, "Input",ExpressionUUID->"5d68380c-9c65-480a-af94-52c5ed212fd6",
 InitializationCell->True],
Cell[154712, 3269, 1585, 35, 236, "Input",ExpressionUUID->"e8797855-14f2-4d36-9640-8d463ab36a97",
 InitializationCell->True],
Cell[156300, 3306, 1214, 20, 49, "Input",ExpressionUUID->"56c35efc-7952-4d59-9f09-0137a7a34dbc",
 InitializationCell->True],
Cell[157517, 3328, 22044, 471, 3407, "Input",ExpressionUUID->"a22a9888-e852-4af6-bcc1-87d51dd82f81",
 InitializationCell->True],
Cell[179564, 3801, 3784, 79, 320, "Input",ExpressionUUID->"7afd61f7-3012-4bee-b413-42f75032eaf4",
 InitializationCell->True],
Cell[183351, 3882, 1142, 19, 46, "Input",ExpressionUUID->"e335e315-9998-4c1a-a5e7-d87940945360",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[184530, 3906, 254, 4, 49, "Subchapter",ExpressionUUID->"d448e25a-a41d-4a8f-ba86-076f5b6a4763"],
Cell[184787, 3912, 620, 11, 46, "Input",ExpressionUUID->"c1822f2a-dfc6-4aa4-83e4-292ef3d8e361",
 InitializationCell->True],
Cell[185410, 3925, 2867, 56, 425, "Input",ExpressionUUID->"00112fbd-3dbe-43fe-a0fc-70153541fff7",
 InitializationCell->True],
Cell[188280, 3983, 1210, 19, 49, "Input",ExpressionUUID->"6e57b0d0-75f5-4afc-bed4-fe5f78163d2a",
 InitializationCell->True],
Cell[189493, 4004, 18527, 405, 1643, "Input",ExpressionUUID->"6d916927-dcba-409b-ab03-6d75cf829143",
 InitializationCell->True],
Cell[208023, 4411, 5345, 95, 404, "Input",ExpressionUUID->"b3021758-00a9-4a62-b432-303279433fac",
 InitializationCell->True],
Cell[213371, 4508, 1138, 18, 46, "Input",ExpressionUUID->"045335f9-6570-44cb-8bb9-a2302903b6f5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[214546, 4531, 340, 5, 49, "Subchapter",ExpressionUUID->"aad9bf96-19cc-47ef-81b7-25edf00b2164"],
Cell[214889, 4538, 620, 11, 46, "Input",ExpressionUUID->"b87485ae-5487-4bc5-8055-c0e7c35d265c",
 InitializationCell->True],
Cell[215512, 4551, 3391, 61, 446, "Input",ExpressionUUID->"13d88144-50a3-4f62-a5bd-3ac43f40a60f",
 InitializationCell->True],
Cell[218906, 4614, 1210, 19, 49, "Input",ExpressionUUID->"c89539d3-3f27-4893-aef4-d2b39ee5c0d1",
 InitializationCell->True],
Cell[220119, 4635, 21324, 425, 2126, "Input",ExpressionUUID->"6a14548c-43ee-406c-bd45-2d8dc776d7c1",
 InitializationCell->True],
Cell[241446, 5062, 1138, 18, 46, "Input",ExpressionUUID->"0c298ca8-308a-4c7e-9d86-dbb808b7210b",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[242633, 5086, 435, 11, 58, "Chapter",ExpressionUUID->"031cd189-ad07-4a58-8b26-2a34f526d55c"],
Cell[243071, 5099, 1626, 29, 91, "Input",ExpressionUUID->"9a75a61b-e27a-4248-82e1-0522b17f5532",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[244722, 5132, 332, 5, 65, "Subchapter",ExpressionUUID->"35ec5c91-b82a-4fb9-b01f-5baa07ade9da"],
Cell[245057, 5139, 1215, 19, 49, "Input",ExpressionUUID->"a29b1c0b-a226-46a3-9c93-45ccea49f7dd",
 InitializationCell->True],
Cell[246275, 5160, 1378, 37, 152, "Input",ExpressionUUID->"a6c653eb-9598-4f07-a1fc-cbdef5c0332b",
 InitializationCell->True],
Cell[247656, 5199, 1636, 41, 173, "Input",ExpressionUUID->"22f61b9d-d884-43e5-b7a1-5d0df75b5e67",
 InitializationCell->True],
Cell[249295, 5242, 1138, 18, 46, "Input",ExpressionUUID->"0f1001a0-93b6-4c58-b52c-795087d5f7b8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[250470, 5265, 436, 7, 49, "Subchapter",ExpressionUUID->"92300b9d-429c-4a0f-be1c-1de4ae1e3834"],
Cell[250909, 5274, 1215, 19, 49, "Input",ExpressionUUID->"007cffbb-a74d-4a7b-b11f-7390234018e6",
 InitializationCell->True],
Cell[252127, 5295, 887, 23, 131, "Input",ExpressionUUID->"907b56a1-2874-4615-924f-e655be2bb1ee",
 InitializationCell->True],
Cell[253017, 5320, 1138, 18, 46, "Input",ExpressionUUID->"450fe546-f7ae-4701-b7ba-97e38254a885",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[254192, 5343, 489, 7, 49, "Subchapter",ExpressionUUID->"97e46d1e-3de0-40ca-a585-4fe99af8cb0a"],
Cell[254684, 5352, 1215, 19, 49, "Input",ExpressionUUID->"ee344522-37c4-48c8-a3b3-429e4185d7ed",
 InitializationCell->True],
Cell[255902, 5373, 1241, 31, 173, "Input",ExpressionUUID->"582e8cec-88e5-427a-87db-0b826ec90d62",
 InitializationCell->True],
Cell[257146, 5406, 1138, 18, 46, "Input",ExpressionUUID->"3c92d277-437f-4dae-9d71-13ecad4931cd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[258321, 5429, 532, 8, 49, "Subchapter",ExpressionUUID->"bfb7c721-7022-4fe5-a664-ab2bdbdce857"],
Cell[258856, 5439, 1215, 19, 49, "Input",ExpressionUUID->"99c0aae9-1463-48d4-9d97-14a149f6e309",
 InitializationCell->True],
Cell[260074, 5460, 1940, 50, 215, "Input",ExpressionUUID->"8addee6f-01b5-48f8-982c-a2ca3233ef46",
 InitializationCell->True],
Cell[262017, 5512, 1138, 18, 46, "Input",ExpressionUUID->"eb925385-b4b5-443d-b38e-deb0dccaad9e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[263192, 5535, 536, 8, 49, "Subchapter",ExpressionUUID->"32fa0a7d-f1e7-491c-825d-c70e7a703d2c"],
Cell[263731, 5545, 1215, 19, 49, "Input",ExpressionUUID->"66585b36-d120-4b18-b9de-8a3e4648de05",
 InitializationCell->True],
Cell[264949, 5566, 1616, 40, 257, "Input",ExpressionUUID->"39a94591-3a13-4a9f-9ea9-1e6d15255765",
 InitializationCell->True],
Cell[266568, 5608, 1142, 19, 46, "Input",ExpressionUUID->"249ed044-0854-4210-9f05-f54f98a2e813",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[267747, 5632, 543, 8, 49, "Subchapter",ExpressionUUID->"64f5e7f7-e605-4089-881a-ced52a6b4c20"],
Cell[268293, 5642, 624, 12, 46, "Input",ExpressionUUID->"fa6a26df-c1df-4782-9dc8-ec6c0891bf49",
 InitializationCell->True],
Cell[268920, 5656, 348, 9, 46, "Input",ExpressionUUID->"29cd17f2-b490-4ffd-bba1-e0fe5daf1499",
 InitializationCell->True],
Cell[269271, 5667, 1219, 20, 49, "Input",ExpressionUUID->"ce3d4d77-5135-4b7c-8329-401959344dbc",
 InitializationCell->True],
Cell[270493, 5689, 4270, 110, 509, "Input",ExpressionUUID->"c83cd064-7e35-40e3-8d7e-5af5944296d3",
 InitializationCell->True],
Cell[274766, 5801, 1142, 19, 46, "Input",ExpressionUUID->"3e49c63f-7c65-44c5-9a12-d4368f8efb0f",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[275957, 5826, 486, 12, 58, "Chapter",ExpressionUUID->"65cdd307-ec21-4d74-bf3e-e40115c97ccd"],
Cell[276446, 5840, 1635, 30, 91, "Input",ExpressionUUID->"ecc4b8aa-3769-4ff8-8330-be30c1367903",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[278106, 5874, 331, 5, 65, "Subchapter",ExpressionUUID->"ccd94346-d1f4-4ca0-9412-d512a67c61de"],
Cell[278440, 5881, 1219, 20, 49, "Input",ExpressionUUID->"e22e6b24-7055-461c-acaa-7da47cf3a532",
 InitializationCell->True],
Cell[279662, 5903, 1752, 48, 215, "Input",ExpressionUUID->"20b296de-f438-4325-ac49-9bf60af692a2",
 InitializationCell->True],
Cell[281417, 5953, 1142, 19, 46, "Input",ExpressionUUID->"19a75f88-c7ab-4e30-8190-f7bc74b76d11",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[282596, 5977, 385, 6, 49, "Subchapter",ExpressionUUID->"fc3c2336-ca65-4feb-a834-547ead5af758"],
Cell[282984, 5985, 624, 12, 46, "Input",ExpressionUUID->"8772d8a1-3eec-4848-8da5-7bc3a2902fb0",
 InitializationCell->True],
Cell[283611, 5999, 904, 25, 173, "Input",ExpressionUUID->"7ba9edb2-c7e5-415f-acd0-cb991d5c6369",
 InitializationCell->True],
Cell[284518, 6026, 1219, 20, 49, "Input",ExpressionUUID->"ef984816-196d-4b7c-89c0-439229f5a7f5",
 InitializationCell->True],
Cell[285740, 6048, 2484, 61, 320, "Input",ExpressionUUID->"ecbd883e-75b6-45f4-9e95-168130d6e30b",
 InitializationCell->True],
Cell[288227, 6111, 1845, 49, 236, "Input",ExpressionUUID->"a2771877-9a3b-46a5-ac0d-6fa15e51f878",
 InitializationCell->True],
Cell[290075, 6162, 1142, 19, 46, "Input",ExpressionUUID->"594756e5-fb88-4ace-a9df-5f9c6980b473",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[291254, 6186, 438, 7, 49, "Subchapter",ExpressionUUID->"ebb4e8b0-5423-4f87-964d-7a5715a28446"],
Cell[291695, 6195, 1219, 20, 49, "Input",ExpressionUUID->"67355dc3-d60e-440e-b415-f9628f95a406",
 InitializationCell->True],
Cell[292917, 6217, 7396, 190, 929, "Input",ExpressionUUID->"1e2ae640-8717-4bfb-9a1f-9e11f3e27eee",
 InitializationCell->True],
Cell[300316, 6409, 1142, 19, 46, "Input",ExpressionUUID->"abd293fc-619a-4a2b-ad23-559e0befedf6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[301495, 6433, 476, 7, 49, "Subchapter",ExpressionUUID->"3d6e5ad1-6873-49ab-bd1f-025e8d82f4d8"],
Cell[301974, 6442, 624, 12, 46, "Input",ExpressionUUID->"a0bd8bde-6054-47b2-aa19-d4d1ca7eb6b7",
 InitializationCell->True],
Cell[302601, 6456, 607, 15, 110, "Input",ExpressionUUID->"d7e85eec-611a-4ec3-b3b4-1ee29cf54391",
 InitializationCell->True],
Cell[303211, 6473, 1219, 20, 49, "Input",ExpressionUUID->"7354585a-c5f7-4ac9-9663-e4ab30468349",
 InitializationCell->True],
Cell[304433, 6495, 8254, 205, 1118, "Input",ExpressionUUID->"04ebf026-3db2-4ca4-9f83-57b380f9fb6b",
 InitializationCell->True],
Cell[312690, 6702, 1142, 19, 46, "Input",ExpressionUUID->"f0a42344-dee2-4535-ac39-77f15d37379a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[313869, 6726, 388, 6, 49, "Subchapter",ExpressionUUID->"f3d28b0a-561c-49f8-b704-da4ded58928a"],
Cell[314260, 6734, 624, 12, 46, "Input",ExpressionUUID->"9630139d-5025-4bfc-85d6-bb7b5b001c82",
 InitializationCell->True],
Cell[314887, 6748, 466, 12, 68, "Input",ExpressionUUID->"a59de8d9-7fca-4868-ae60-bea45fcb722c",
 InitializationCell->True],
Cell[315356, 6762, 1219, 20, 49, "Input",ExpressionUUID->"b18402e0-02ff-48f7-890c-e9ce6313c9c8",
 InitializationCell->True],
Cell[316578, 6784, 3996, 105, 677, "Input",ExpressionUUID->"00600fac-e3f2-42c7-a975-65c71166ba84",
 InitializationCell->True],
Cell[320577, 6891, 1142, 19, 46, "Input",ExpressionUUID->"05bffa84-cb80-4cf0-bc64-9833132bc9f0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[321756, 6915, 435, 7, 49, "Subchapter",ExpressionUUID->"f98a45b7-4927-4fc4-bf56-d9944cc9fe43"],
Cell[322194, 6924, 1219, 20, 49, "Input",ExpressionUUID->"8099dc39-3b0a-4f9e-9077-deef8e106d99",
 InitializationCell->True],
Cell[323416, 6946, 1641, 41, 236, "Input",ExpressionUUID->"15a7d11f-eb94-4de1-b10f-f58ead36be9b",
 InitializationCell->True],
Cell[325060, 6989, 1970, 49, 320, "Input",ExpressionUUID->"1ab72223-7cd8-443a-9f6a-49659eee15ac",
 InitializationCell->True],
Cell[327033, 7040, 1142, 19, 46, "Input",ExpressionUUID->"516f7241-69d4-43c3-b81b-3c65f465b202",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[328212, 7064, 565, 8, 49, "Subchapter",ExpressionUUID->"4f294354-0368-4de4-893f-7981240fcbea"],
Cell[328780, 7074, 624, 12, 46, "Input",ExpressionUUID->"f5cb846b-bd99-4722-8613-0f98c6d36bed",
 InitializationCell->True],
Cell[329407, 7088, 6982, 151, 593, "Input",ExpressionUUID->"68003f11-1ef2-49bb-86e1-47105996184f",
 InitializationCell->True],
Cell[336392, 7241, 1219, 20, 49, "Input",ExpressionUUID->"f97c46fd-a6ad-4fa6-9625-f7bbd8418a11",
 InitializationCell->True],
Cell[337614, 7263, 4804, 120, 677, "Input",ExpressionUUID->"75102219-1cfc-4b58-b675-0ade0f36216a",
 InitializationCell->True],
Cell[342421, 7385, 1142, 19, 46, "Input",ExpressionUUID->"78fb45d7-79ab-4bed-9248-0460d7c7c8c1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[343600, 7409, 336, 5, 49, "Subchapter",ExpressionUUID->"d8d3ac30-f2f1-4d60-94c6-ad406da96082"],
Cell[343939, 7416, 624, 12, 46, "Input",ExpressionUUID->"8111ab22-da75-4353-adc5-6269177643fb",
 InitializationCell->True],
Cell[344566, 7430, 339, 9, 46, "Input",ExpressionUUID->"6190833c-d470-4d17-b948-9f6105dc5920",
 InitializationCell->True],
Cell[344908, 7441, 1219, 20, 49, "Input",ExpressionUUID->"9d8e615d-e2ad-431b-821a-5a0984329df4",
 InitializationCell->True],
Cell[346130, 7463, 1335, 25, 110, "Input",ExpressionUUID->"06cc15eb-b4a3-4177-9c19-4292f3041c73",
 InitializationCell->True],
Cell[347468, 7490, 5128, 111, 698, "Input",ExpressionUUID->"0398eebc-aba4-4c6e-9bdf-20b8f9b3960e",
 InitializationCell->True],
Cell[352599, 7603, 4314, 92, 593, "Input",ExpressionUUID->"282ab0ec-84db-46df-8cab-80030fb56b43",
 InitializationCell->True],
Cell[356916, 7697, 1142, 19, 46, "Input",ExpressionUUID->"1dfc7237-8460-4e8b-ab6e-9150673cb96f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[358095, 7721, 208, 4, 49, "Subchapter",ExpressionUUID->"87680306-f2fe-4ef2-b043-927f71b4ff73"],
Cell[358306, 7727, 624, 12, 46, "Input",ExpressionUUID->"1ef94e97-295e-4171-b3d4-729b5cab0c10",
 InitializationCell->True],
Cell[358933, 7741, 931, 18, 89, "Input",ExpressionUUID->"8ad550a8-a9b7-4496-adde-be934771e0d9",
 InitializationCell->True],
Cell[359867, 7761, 1214, 20, 49, "Input",ExpressionUUID->"a76e4c86-c999-4c5a-bcce-b119c2ef84fe",
 InitializationCell->True],
Cell[361084, 7783, 17960, 391, 2294, "Input",ExpressionUUID->"c0a92156-a084-4c4c-93e1-99f660bdc78b",
 InitializationCell->True],
Cell[379047, 8176, 1142, 19, 46, "Input",ExpressionUUID->"f5b2a10b-5fa6-4cd0-ac63-d19dc8055bc3",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[380238, 8201, 522, 12, 58, "Chapter",ExpressionUUID->"3cfff641-c4ae-4011-a0ce-78efa62c8fa0"],
Cell[380763, 8215, 1670, 30, 91, "Input",ExpressionUUID->"ae97b002-5f40-4f0b-88ba-4b154393b33e",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[382458, 8249, 331, 5, 65, "Subchapter",ExpressionUUID->"a1caeef5-9fed-42bd-93a0-e0ab75b98add"],
Cell[382792, 8256, 624, 12, 46, "Input",ExpressionUUID->"1a7889c3-ed64-4f01-b35d-8a1ef55205f9",
 InitializationCell->True],
Cell[383419, 8270, 1632, 43, 278, "Input",ExpressionUUID->"5d16eb0a-beea-45f5-918b-5b26ca6bf27d",
 InitializationCell->True],
Cell[385054, 8315, 1219, 20, 49, "Input",ExpressionUUID->"273b815f-12b0-4039-8924-f7ae26ff86c3",
 InitializationCell->True],
Cell[386276, 8337, 2212, 56, 299, "Input",ExpressionUUID->"14d0f2a8-58eb-416c-85a4-49b2ed886f44",
 InitializationCell->True],
Cell[388491, 8395, 15115, 346, 1958, "Input",ExpressionUUID->"2f80f240-73b1-4762-bcee-5b8b2499c18b",
 InitializationCell->True],
Cell[403609, 8743, 1142, 19, 46, "Input",ExpressionUUID->"0a2d65ae-5fb3-4bd8-9ebd-c8ff4c69704c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[404788, 8767, 538, 8, 49, "Subchapter",ExpressionUUID->"b2f7cc32-c8e4-4b2d-8cde-ebd8dcac7cd5"],
Cell[405329, 8777, 624, 12, 46, "Input",ExpressionUUID->"48696907-3b24-47a0-903f-d94b7751a6be",
 InitializationCell->True],
Cell[405956, 8791, 451, 11, 89, "Input",ExpressionUUID->"9460cd00-5df4-48f0-bc51-73c46ee35dc7",
 InitializationCell->True],
Cell[406410, 8804, 1219, 20, 49, "Input",ExpressionUUID->"ce813654-42aa-415f-a40d-51ffea14f503",
 InitializationCell->True],
Cell[407632, 8826, 4624, 112, 656, "Input",ExpressionUUID->"a7b25da5-07b4-4378-bf30-7a8f3929fbda",
 InitializationCell->True],
Cell[412259, 8940, 1142, 19, 46, "Input",ExpressionUUID->"6c497642-3a44-41ca-8cc5-1c63241fccc2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[413438, 8964, 637, 9, 49, "Subchapter",ExpressionUUID->"f17bd351-2c38-4cb7-b6a8-689f9b80aec2"],
Cell[414078, 8975, 445, 9, 46, "Input",ExpressionUUID->"fcfa87a2-f589-419b-a19c-9a9b5bf918ae",
 InitializationCell->True],
Cell[414526, 8986, 1559, 26, 89, "Input",ExpressionUUID->"6868daab-8d21-4341-ad52-b145fc9fc377",
 InitializationCell->True],
Cell[416088, 9014, 1219, 20, 49, "Input",ExpressionUUID->"91248770-8752-41e1-89c7-44308304482b",
 InitializationCell->True],
Cell[417310, 9036, 60077, 1235, 13661, "Input",ExpressionUUID->"a2845ce7-71e0-4d6a-a6dc-87d3577e009d",
 InitializationCell->True],
Cell[477390, 10273, 1142, 19, 46, "Input",ExpressionUUID->"8c5c0c83-bc7b-4dfc-ab79-86a1bcf78685",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[478569, 10297, 540, 8, 49, "Subchapter",ExpressionUUID->"0c51ab41-fc34-4902-a0de-0408fceda32b"],
Cell[479112, 10307, 624, 12, 46, "Input",ExpressionUUID->"d8dc135c-e07e-4d83-8c2a-70ce4f08c8c9",
 InitializationCell->True],
Cell[479739, 10321, 1653, 33, 110, "Input",ExpressionUUID->"1bc27315-87d8-4633-a3b6-3c18a1916dce",
 InitializationCell->True],
Cell[481395, 10356, 1219, 20, 49, "Input",ExpressionUUID->"312c650b-6095-4009-969c-f4a73e2c6005",
 InitializationCell->True],
Cell[482617, 10378, 12254, 231, 866, "Input",ExpressionUUID->"48fe546b-6ac5-45ff-8ad0-dac7d2155695",
 InitializationCell->True],
Cell[494874, 10611, 1142, 19, 46, "Input",ExpressionUUID->"34740895-68e3-4d82-b51a-f67934b58b39",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[496053, 10635, 339, 5, 49, "Subchapter",ExpressionUUID->"14bf3578-8d9c-4cb7-b4c3-cebe0abb7317"],
Cell[496395, 10642, 624, 12, 46, "Input",ExpressionUUID->"23a68ca8-04b2-40e9-b5ba-26f20c00863a",
 InitializationCell->True],
Cell[497022, 10656, 3004, 60, 236, "Input",ExpressionUUID->"ca60526b-6186-4e3c-aeb5-3bdef76773b7",
 InitializationCell->True],
Cell[500029, 10718, 1219, 20, 49, "Input",ExpressionUUID->"0b6ccb59-b1ec-4444-96c8-1b1f9ddff73c",
 InitializationCell->True],
Cell[501251, 10740, 22886, 460, 2840, "Input",ExpressionUUID->"881eb084-ebad-421e-8706-db485fe279f4",
 InitializationCell->True],
Cell[524140, 11202, 7054, 158, 1118, "Input",ExpressionUUID->"6d5a08ba-f159-42c7-8316-e106aa2f1781",
 InitializationCell->True],
Cell[531197, 11362, 1142, 19, 46, "Input",ExpressionUUID->"41e844d4-8203-469f-a72c-bf026506bbdb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[532376, 11386, 331, 5, 49, "Subchapter",ExpressionUUID->"2acb6343-d992-441d-871b-f419ef3f6357"],
Cell[532710, 11393, 624, 12, 46, "Input",ExpressionUUID->"e72b781e-f33c-4f80-9775-6360fa993f33",
 InitializationCell->True],
Cell[533337, 11407, 2597, 60, 362, "Input",ExpressionUUID->"7aea4502-3660-4d26-9d7c-94fcde59e7d9",
 InitializationCell->True],
Cell[535937, 11469, 1219, 20, 49, "Input",ExpressionUUID->"414a1848-111c-4586-accb-b5005825f0aa",
 InitializationCell->True],
Cell[537159, 11491, 14483, 334, 1748, "Input",ExpressionUUID->"7cae0bb2-b056-4d96-8f9b-c61777a95838",
 InitializationCell->True],
Cell[551645, 11827, 1142, 19, 46, "Input",ExpressionUUID->"d69a9006-8db9-468b-be40-d6c7883c9970",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[552824, 11851, 490, 7, 49, "Subchapter",ExpressionUUID->"e964329e-9607-409f-b03e-c8db084f23da"],
Cell[553317, 11860, 624, 12, 46, "Input",ExpressionUUID->"12abebc3-3aa6-43db-8152-7448c37e04db",
 InitializationCell->True],
Cell[553944, 11874, 1219, 20, 49, "Input",ExpressionUUID->"7bbfa8ea-ec5e-4b48-b633-9a42cce8327e",
 InitializationCell->True],
Cell[555166, 11896, 10153, 188, 551, "Input",ExpressionUUID->"9f0223cb-811d-407b-b958-395d3f8efdee",
 InitializationCell->True],
Cell[565322, 12086, 1142, 19, 46, "Input",ExpressionUUID->"2a0bcbec-4d89-416a-99af-ae0164582584",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[566501, 12110, 288, 5, 49, "Subchapter",ExpressionUUID->"3b753f0e-2dc0-498e-9a94-d94051e92fc9"],
Cell[566792, 12117, 624, 12, 46, "Input",ExpressionUUID->"fa2bab8d-5625-4750-9c41-09c459feb749",
 InitializationCell->True],
Cell[567419, 12131, 472, 11, 89, "Input",ExpressionUUID->"5e4d63a7-a7ab-4687-890b-9360d007f30a",
 InitializationCell->True],
Cell[567894, 12144, 1219, 20, 49, "Input",ExpressionUUID->"b8ed105a-8270-42d1-bea6-f17597842c9d",
 InitializationCell->True],
Cell[569116, 12166, 22481, 510, 2462, "Input",ExpressionUUID->"638d2a72-b58f-4a7d-9b57-119c87ec7011",
 InitializationCell->True],
Cell[591600, 12678, 1142, 19, 46, "Input",ExpressionUUID->"075394b5-4d49-4717-b6fd-d16f1b704e2c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[592779, 12702, 331, 5, 49, "Subchapter",ExpressionUUID->"9d33350d-47b1-461d-8fba-ccef7867b6be"],
Cell[593113, 12709, 624, 12, 46, "Input",ExpressionUUID->"14e7319b-b2fd-4d3a-bbb3-f468c006f4c9",
 InitializationCell->True],
Cell[593740, 12723, 1026, 21, 110, "Input",ExpressionUUID->"927be788-9173-4973-8d48-731dcb8fee5f",
 InitializationCell->True],
Cell[594769, 12746, 1219, 20, 49, "Input",ExpressionUUID->"0ea00e5f-03c5-41c4-b110-bc29f235d719",
 InitializationCell->True],
Cell[595991, 12768, 12703, 277, 1244, "Input",ExpressionUUID->"cc51c18b-a55f-4500-ad28-b5397e609971",
 InitializationCell->True],
Cell[608697, 13047, 1142, 19, 46, "Input",ExpressionUUID->"753b6640-683f-4d8b-b37e-29314f731568",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[609876, 13071, 286, 5, 49, "Subchapter",ExpressionUUID->"b94621d0-6abe-4017-88a4-e922b74f41c2"],
Cell[610165, 13078, 624, 12, 46, "Input",ExpressionUUID->"a5eaf5c2-36e4-41cd-8c8c-5a90463d6966",
 InitializationCell->True],
Cell[610792, 13092, 628, 15, 131, "Input",ExpressionUUID->"23863b24-6390-47ab-8f7a-d06e0ff5d71e",
 InitializationCell->True],
Cell[611423, 13109, 1219, 20, 49, "Input",ExpressionUUID->"efc7281b-ee92-4798-9e85-ece211e89c35",
 InitializationCell->True],
Cell[612645, 13131, 8496, 205, 1034, "Input",ExpressionUUID->"886b4b1e-4367-460b-94fc-7c0b5d8f9797",
 InitializationCell->True],
Cell[621144, 13338, 1142, 19, 46, "Input",ExpressionUUID->"6e25b713-5087-4f31-80a3-aae947207983",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[622323, 13362, 519, 8, 49, "Subchapter",ExpressionUUID->"40a83651-223f-4c00-8dba-5817bf6e2b8d"],
Cell[622845, 13372, 624, 12, 46, "Input",ExpressionUUID->"9c3362de-47c4-4d14-85b1-a1bba4ffb688",
 InitializationCell->True],
Cell[623472, 13386, 1607, 35, 215, "Input",ExpressionUUID->"31cb6be3-296d-4b79-85af-33ae5e622e0f",
 InitializationCell->True],
Cell[625082, 13423, 1219, 20, 49, "Input",ExpressionUUID->"189e71a9-a784-427e-81aa-3fb2ebfa6d87",
 InitializationCell->True],
Cell[626304, 13445, 13367, 275, 1580, "Input",ExpressionUUID->"d22aa2e1-6f53-4d31-aeeb-8a976dd994d0",
 InitializationCell->True],
Cell[639674, 13722, 1142, 19, 46, "Input",ExpressionUUID->"1c351972-761d-478d-ae2a-8da7c68ef326",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[640853, 13746, 562, 8, 49, "Subchapter",ExpressionUUID->"c080b693-1415-4e12-ad21-98ca6f310069"],
Cell[641418, 13756, 624, 12, 46, "Input",ExpressionUUID->"ac3ba12c-ce0f-483a-8bd7-1773df80064d",
 InitializationCell->True],
Cell[642045, 13770, 537, 15, 89, "Input",ExpressionUUID->"6c6d91fb-134f-478a-b97e-1ee4ef8c17dc",
 InitializationCell->True],
Cell[642585, 13787, 1219, 20, 49, "Input",ExpressionUUID->"07ae68d6-d917-491a-88fc-8f9453463699",
 InitializationCell->True],
Cell[643807, 13809, 15314, 351, 1664, "Input",ExpressionUUID->"d09b283c-745c-4550-935c-17d2414fa3a0",
 InitializationCell->True],
Cell[659124, 14162, 1142, 19, 46, "Input",ExpressionUUID->"a66a5896-63cc-496e-96fa-25efeb768265",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[660303, 14186, 391, 6, 49, "Subchapter",ExpressionUUID->"a5381ce5-59b6-4b1c-86ed-5916e748fa74"],
Cell[660697, 14194, 1219, 20, 49, "Input",ExpressionUUID->"fe565d70-3102-4bc2-ab05-790cf46f56cc",
 InitializationCell->True],
Cell[661919, 14216, 1411, 35, 257, "Input",ExpressionUUID->"8ed0a971-3df3-4780-a433-b9020972b800",
 InitializationCell->True],
Cell[663333, 14253, 7978, 191, 971, "Input",ExpressionUUID->"977a2afe-c0ab-4804-9ddc-ed0525deb087",
 InitializationCell->True],
Cell[671314, 14446, 6202, 140, 635, "Input",ExpressionUUID->"e87295ad-15e5-46d5-bad5-5402c709f3b9",
 InitializationCell->True],
Cell[677519, 14588, 6461, 146, 740, "Input",ExpressionUUID->"f607695a-756f-4986-8172-219fec5dcd19",
 InitializationCell->True],
Cell[683983, 14736, 1142, 19, 46, "Input",ExpressionUUID->"6d3f9cc6-94d7-4dee-8de0-dd80efba362c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[685162, 14760, 562, 8, 49, "Subchapter",ExpressionUUID->"1c036039-a160-4350-b735-abc7d969c17f"],
Cell[685727, 14770, 624, 12, 46, "Input",ExpressionUUID->"4d108843-03ee-47eb-8d30-c541dd362226",
 InitializationCell->True],
Cell[686354, 14784, 7997, 162, 929, "Input",ExpressionUUID->"2512389a-7af0-4566-bf47-49fe0908ee7f",
 InitializationCell->True],
Cell[694354, 14948, 1219, 20, 49, "Input",ExpressionUUID->"220ccaa5-f6dc-4a1f-8aa2-afc3c7c23238",
 InitializationCell->True],
Cell[695576, 14970, 365, 9, 46, "Input",ExpressionUUID->"813abb72-097c-456a-a747-1295efb6ecaf",
 InitializationCell->True],
Cell[695944, 14981, 79909, 1720, 8618, "Input",ExpressionUUID->"3b83ef0b-0c8c-4ac7-9196-92cf80e66ed5",
 InitializationCell->True],
Cell[775856, 16703, 1142, 19, 46, "Input",ExpressionUUID->"1b3f4c1b-87f9-4af0-bdf7-c3f161486632",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[777035, 16727, 390, 6, 49, "Subchapter",ExpressionUUID->"9bd7a065-171d-467a-b863-5ea43593a2ec"],
Cell[777428, 16735, 624, 12, 46, "Input",ExpressionUUID->"19ab0f63-116c-4295-a827-64eec93fdeb6",
 InitializationCell->True],
Cell[778055, 16749, 506, 13, 89, "Input",ExpressionUUID->"eb758cc0-e57a-4769-b494-8d15ad3f0765",
 InitializationCell->True],
Cell[778564, 16764, 1219, 20, 49, "Input",ExpressionUUID->"521364a0-76d2-411d-bea3-66fb350aefde",
 InitializationCell->True],
Cell[779786, 16786, 90312, 1774, 12051, "Input",ExpressionUUID->"8b8f800f-b36e-4d1b-b4eb-afd5f8ee2586",
 InitializationCell->True],
Cell[870101, 18562, 1142, 19, 46, "Input",ExpressionUUID->"b4eec69b-5757-4449-be71-eb4a852bd7a3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[871280, 18586, 308, 5, 49, "Subchapter",ExpressionUUID->"7fa89887-046d-465b-ac16-eabca80de3bc"],
Cell[871591, 18593, 624, 12, 46, "Input",ExpressionUUID->"94bb2882-bd49-4931-9924-e7276221eeb2",
 InitializationCell->True],
Cell[872218, 18607, 1575, 42, 257, "Input",ExpressionUUID->"0b7ef6d9-16d7-4c78-b8de-39a0750838da",
 InitializationCell->True],
Cell[873796, 18651, 1219, 20, 49, "Input",ExpressionUUID->"62bd9d9f-872c-477f-b794-9a552e5f8dff",
 InitializationCell->True],
Cell[875018, 18673, 56641, 1215, 7195, "Input",ExpressionUUID->"7c947e04-1605-400b-bf12-4988e7bcc9ab",
 InitializationCell->True],
Cell[931662, 19890, 1999, 42, 299, "Input",ExpressionUUID->"098360e2-ac3e-44bd-ad35-c18e4b0da9f4",
 InitializationCell->True],
Cell[933664, 19934, 1142, 19, 46, "Input",ExpressionUUID->"eb80ed6b-f5c8-45cc-ae64-ad2b87bb5f7f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[934843, 19958, 620, 9, 49, "Subchapter",ExpressionUUID->"2dd21067-07a0-4cd8-805e-a8c7261b1d64"],
Cell[935466, 19969, 624, 12, 46, "Input",ExpressionUUID->"6fa8b28f-536b-4288-adf1-eb4f91c5b73f",
 InitializationCell->True],
Cell[936093, 19983, 393, 10, 89, "Input",ExpressionUUID->"09fff4b7-4b95-4f2f-86fd-1f3fa694a9d4",
 InitializationCell->True],
Cell[936489, 19995, 1219, 20, 49, "Input",ExpressionUUID->"fe7a24ad-184c-4cba-ba1a-7b74a82e2f6d",
 InitializationCell->True],
Cell[937711, 20017, 9239, 200, 1160, "Input",ExpressionUUID->"c82810ed-77ca-4a80-a585-19963e5b611a",
 InitializationCell->True],
Cell[946953, 20219, 1142, 19, 46, "Input",ExpressionUUID->"00227bdc-9cd6-40f4-ac5b-ed6878758ad9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[948132, 20243, 289, 5, 49, "Subchapter",ExpressionUUID->"ce349b9d-6982-4794-8985-62d9786c2820"],
Cell[948424, 20250, 624, 12, 46, "Input",ExpressionUUID->"6f60cb0e-e142-4f9c-9308-3549b0a14e1c",
 InitializationCell->True],
Cell[949051, 20264, 2914, 73, 425, "Input",ExpressionUUID->"ce0dad3f-7924-46f5-aaa9-cac6c1cd8b0b",
 InitializationCell->True],
Cell[951968, 20339, 1219, 20, 49, "Input",ExpressionUUID->"00c2ae64-08f8-40fc-838a-bab05634ccc4",
 InitializationCell->True],
Cell[953190, 20361, 18941, 446, 2345, "Input",ExpressionUUID->"4aceb80c-8dc6-4699-93b5-9c4790b4bb36",
 InitializationCell->True],
Cell[972134, 20809, 1142, 19, 46, "Input",ExpressionUUID->"a3d5f462-bf7c-445c-83cf-7f36cbad8d06",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[973313, 20833, 484, 7, 49, "Subchapter",ExpressionUUID->"8b512749-d75e-48ee-bf82-dd0f8b315513"],
Cell[973800, 20842, 624, 12, 46, "Input",ExpressionUUID->"486e110b-ba9a-4b96-93d6-a0e49153a0de",
 InitializationCell->True],
Cell[974427, 20856, 391, 11, 68, "Input",ExpressionUUID->"248a947a-0a45-4065-9945-bfd59804bc97",
 InitializationCell->True],
Cell[974821, 20869, 1219, 20, 49, "Input",ExpressionUUID->"48ecadeb-9d3a-4abd-94fd-aad2a72c50cb",
 InitializationCell->True],
Cell[976043, 20891, 8267, 186, 1160, "Input",ExpressionUUID->"a52fc267-1e1b-4817-8047-b35fef3d6095",
 InitializationCell->True],
Cell[984313, 21079, 1142, 19, 46, "Input",ExpressionUUID->"7c59d3b9-6528-48ae-b568-435b7200446e",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[985504, 21104, 289, 5, 58, "Chapter",ExpressionUUID->"92919a8d-84f0-46e0-941f-8027cba814f0"],
Cell[985796, 21111, 1572, 29, 89, "Input",ExpressionUUID->"67d5953b-10af-4324-9517-aed3d55c6ce6",
 InitializationCell->True]
}, Closed]]
}, Open  ]]
}
]
*)

