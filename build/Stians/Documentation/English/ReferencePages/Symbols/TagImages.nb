(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49642,       1387]
NotebookOptionsPosition[     40133,       1180]
NotebookOutlinePosition[     42359,       1237]
CellTagsIndexPosition[     42273,       1232]
WindowTitle->TagImages
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["STIANS SYMBOL", "PacletNameCell"], Cell[TextData[Cell[BoxData[
     ActionMenuBox[
      FrameBox[
       InterpretationBox[Cell[TextData[{
         "URL",
         StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
          StripOnInput->False]
        }]],
        TextCell[
         Row[{"URL", 
           Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
       StripOnInput->False], {"\<\"Stians/ref/TagImages\"\>":>
      None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
      Module[{DocumentationSearch`Private`nb$}, 
       DocumentationSearch`Private`nb$ = NotebookPut[
          Notebook[{
            Cell["Stians/ref/TagImages"]}, Visible -> False]]; 
       SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
       FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
       NotebookClose[DocumentationSearch`Private`nb$]; Null], 
      Delimiter, "\<\"Copy web URL\"\>":>
      Module[{DocumentationSearch`Private`nb$}, 
       DocumentationSearch`Private`nb$ = NotebookPut[
          Notebook[{
            Cell[
             BoxData[
              MakeBoxes[
               Hyperlink[
               "http://reference.wolfram.com/language/Stians/ref/TagImages.\
html"], StandardForm]], "Input", TextClipboardType -> "PlainText"]}, Visible -> 
           False]]; SelectionMove[
        DocumentationSearch`Private`nb$, All, Notebook]; 
       FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
       NotebookClose[DocumentationSearch`Private`nb$]; 
       Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
        NotebookLocate[{
          URL[
           StringJoin[
            If[
             TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$32911], 
             "http://reference.wolfram.com/system-modeler/", 
             "http://reference.wolfram.com/language/"], 
            "Stians/ref/TagImages", ".html"]], None}]}]},
      Appearance->None,
      MenuAppearance->Automatic,
      MenuStyle->"URLMenu"]],
     LineSpacing->{1.4, 0}]], "AnchorBar"]}
  }]], "AnchorBarGrid",
 GridBoxOptions->{GridBoxItemSize->{"Columns" -> {
     Scaled[0.65], {
      Scaled[0.34]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
   "RowsIndexed" -> {}}},
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 Cell["TagImages", "ObjectName"],
 Cell[BoxData[
  TemplateBox[{8},
   "Spacer1"]]],
 Cell[BoxData[""], "ObjectNameTranslation"]
}], "ObjectNameGrid"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["TagImages"]], "paclet:Stians/ref/TagImages"},
        "RefLink",
        BaseStyle->{"InlineFormula"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           StyleBox["image", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["image", "TI"], 
           StyleBox["2", "TR"]], ",", 
          StyleBox["\[Ellipsis]", "TR"], ",", 
          SubscriptBox[
           StyleBox["image", "TI"], 
           StyleBox["i", "TI"]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             StyleBox["ltag", "TI"], 
             StyleBox["1", "TR"]], ",", 
            SubscriptBox[
             StyleBox["rtag", "TI"], 
             StyleBox["1", "TR"]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             StyleBox["ltag", "TI"], 
             StyleBox["2", "TR"]], ",", 
            SubscriptBox[
             StyleBox["rtag", "TI"], 
             StyleBox["2", "TR"]]}], "}"}], ",", 
          RowBox[{
           StyleBox["\[Ellipsis]", "TR"], 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox[
              StyleBox["ltag", "TI"], 
              StyleBox["i", "TI"]], ",", 
             SubscriptBox[
              StyleBox["rtag", "TI"], 
              StyleBox["i", "TI"]]}], "}"}]}]}], "}"}]}], "]"}]], 
      "InlineFormula"],
     " \[LineSeparator]marks the lower left and right corners of ",
     Cell[BoxData[
      SubscriptBox[
       StyleBox["image", "TI"], 
       StyleBox["i", "TI"]]], "InlineFormula"],
     " with the tags ",
     Cell[BoxData[
      SubscriptBox[
       StyleBox["ltag", "TI"], 
       StyleBox["i", "TI"]]], "InlineFormula"],
     " and ",
     Cell[BoxData[
      SubscriptBox[
       StyleBox["rtag", "TI"], 
       StyleBox["i", "TI"]]], "InlineFormula"],
     "."
    }]]}
  }]], "Usage",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {{None}}}},
 CellID->982511436]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    TemplateBox[{6},
     "Spacer1"]]],
   "Details and Options"
  }], "NotesFrameText"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->"Preemptive"]]]], "NotesSection",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->1134968254],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[{
 Cell[BoxData[
  SubscriptBox[
   StyleBox["image", "TI"], 
   StyleBox["i", "TI"]]], "InlineFormula"],
 " may either be file paths to images or imported images. All tags must be \
strings."
}], "Notes",
 CellID->1943790018],

Cell[TextData[{
 "The marked images will be outputted in a folder named \
\[LeftGuillemet]Marked\[RightGuillemet], which will be placed in the \
directory of ",
 Cell[BoxData[
  SubscriptBox[
   StyleBox["image", "TI"], 
   StyleBox["1", "TR"]]], "InlineFormula"],
 "."
}], "Notes",
 CellID->2063448702],

Cell[BoxData[GridBox[{
   {Cell["      ", "TableRowIcon"], "\"\<ExportTo\>\"", 
    RowBox[{"(", 
     RowBox[{"input", " ", "directory"}], ")"}], Cell[
    "output directory", "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<Style\>\"", 
    RowBox[{"{", 
     RowBox[{"White", ",", "\"\<Inconsolata\>\"", ",", "54"}], "}"}], Cell[
    "tag styling", "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<ImageFormat\>\"", "\"\<png\>\"", 
    Cell["output image format", "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<NewName\>\"", 
    ButtonBox["False",
     BaseStyle->"Link",
     ButtonData->"paclet:ref/False"], Cell[
    "whether to use same file names as input or a number sequence", 
     "TableText"]}
  }]], "3ColumnTableMod",
 GridBoxOptions->{
 GridBoxBackground->{
  "Columns" -> {{None}}, "Rows" -> {None, None, None, {None}}},
 GridBoxDividers->{"Rows" -> {{True, True, True, True, True}}}},
 CellID->457306433],

Cell[TextData[{
 "The ",
 Cell[BoxData["\"\<NewName\>\""], "InlineFormula"],
 " option may also be set to a string that will represent the base file name \
of the output images. If the input is a list of imported images, the default \
setting will be ",
 Cell[BoxData[
  RowBox[{"\"\<NewName\>\"", "\[Rule]", "\"\<Output\>\""}]], 
  "InlineFormula"],
 "."
}], "Notes",
 CellID->583289301],

Cell[TextData[{
 "If the option ",
 Cell[BoxData["\"\<ExportTo\>\""], "InlineFormula"],
 " is not set to a directory, the function will proceed using the input \
directory (or the Desktop, if input is a list of images) as the output \
directory."
}], "Notes",
 CellID->1931014907]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(10)", "ExampleCount"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CellTags->"PrimaryExamplesSection",
 CellID->1461692324],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->1597451435],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Line", "=", "0"}], ";"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1617362692],

Cell[BoxData[
 RowBox[{
  RowBox[{"exampleimages", "=", 
   RowBox[{"FileNames", "@", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "$StiansExamples", ",", "\"\<Unwarps\>\"", ",", 
       "\"\<Crystal*.bmp\>\""}], "}"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->1702908692],

Cell[BoxData[
 RowBox[{
  RowBox[{"tags", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<A\>\"", ",", "\"\<1\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<B\>\"", ",", "\"\<2\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<C\>\"", ",", "\"\<3\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<D\>\"", ",", "\"\<4\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<E\>\"", ",", "\"\<5\>\""}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->"In[3]:=",
 CellID->98731120],

Cell[BoxData[
 RowBox[{
  RowBox[{"TagImages", "[", 
   RowBox[{"exampleimages", ",", "tags"}], "]"}], ";"}]], "Input",
 CellLabel->"In[4]:=",
 CellID->1255936733],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Import", "@", 
  RowBox[{"RandomChoice", "@", 
   RowBox[{"FileNames", "@", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "$StiansExamples", ",", "\"\<Unwarps\>\"", ",", "\"\<Output\>\"", ",", 
       "\"\<*.png\>\""}], "}"}], "]"}]}]}]}]], "Input",
 CellLabel->"In[5]:=",
 CellID->669921222],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[RawArray["UnsignedInteger8", $Failed], {{0, 1474}, {1680, 
    0}}, {0, 255},
    ColorFunction->RGBColor],
   BoxForm`ImageTag[
   "Byte", ColorSpace -> "RGB", Interleaving -> True, MetaInformation -> 
    Association[
     "Exif" -> Association[
       "Software" -> "Created with the Wolfram Language : www.wolfram.com"], 
      "Comments" -> 
      Association[
       "Software" -> "Created with the Wolfram Language : www.wolfram.com", 
        "Creation Time" -> DateObject[{2017, 9, 19}, 
          TimeObject[{14, 13, 40.}, TimeZone -> 2.], TimeZone -> 2.]]]],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSizeRaw->{1680, 1474},
  PlotRange->{{0, 1680}, {0, 1474}}]], "Output",
 CellLabel->"Out[5]=",
 CellID->130537934]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->1293636265],

Cell["Setup for example purposes:", "ExampleText",
 CellID->1488476289],

Cell[BoxData[
 RowBox[{
  RowBox[{"exampleimages", "=", 
   RowBox[{"FileNames", "@", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "$StiansExamples", ",", "\"\<Unwarps\>\"", ",", 
       "\"\<Crystal*.bmp\>\""}], "}"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1142536111],

Cell[BoxData[
 RowBox[{
  RowBox[{"images", "=", 
   RowBox[{"Import", "/@", "exampleimages"}]}], ";"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->734259842],

Cell[BoxData[
 RowBox[{
  RowBox[{"tags", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<A\>\"", ",", "\"\<1\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<B\>\"", ",", "\"\<2\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<C\>\"", ",", "\"\<3\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<D\>\"", ",", "\"\<4\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<E\>\"", ",", "\"\<5\>\""}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->"In[3]:=",
 CellID->1953129750],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell["\t", "ExampleDelimiter"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1889743428],

Cell["\<\
Recall that the input can either be a list of images or a list of file paths \
to images.\
\>", "ExampleText",
 CellID->1782138913],

Cell[BoxData[
 RowBox[{"TagImages", "[", 
  RowBox[{"images", ",", "tags"}], "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->2063115516],

Cell["\<\
Use a list of file paths if you want the output images to have the same file \
names.\
\>", "ExampleText",
 CellID->516776746]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Options",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->2061341341],

Cell[CellGroupData[{

Cell[TextData[{
 "\"ExportTo\"",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CellID->1757724783],

Cell[BoxData[
 RowBox[{"TagImages", "[", 
  RowBox[{"images", ",", "tags", ",", 
   RowBox[{"\"\<ExportTo\>\"", "\[Rule]", "$HomeDirectory"}]}], 
  "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->974508160]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "\"Style\"",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CellID->744098065],

Cell[BoxData[
 RowBox[{
  RowBox[{"TagImages", "[", 
   RowBox[{"images", ",", "tags", ",", 
    RowBox[{"\"\<Style\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Green", ",", "\"\<Zapfino\>\"", ",", "72"}], "}"}]}]}], "]"}], 
  ";"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1848353098],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Import", "@", 
  RowBox[{"RandomChoice", "@", 
   RowBox[{"FileNames", "@", 
    RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "$HomeDirectory", ",", "\"\<Desktop\>\"", ",", "\"\<Output\>\"", ",", 
       "\"\<*.png\>\""}], "}"}], "]"}]}]}]}]], "Input",
 CellLabel->"In[2]:=",
 CellID->1058330493],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[RawArray["UnsignedInteger8", $Failed], {{0, 1474}, {1680, 
    0}}, {0, 255},
    ColorFunction->RGBColor],
   BoxForm`ImageTag[
   "Byte", ColorSpace -> "RGB", Interleaving -> True, MetaInformation -> 
    Association[
     "Exif" -> Association[
       "Software" -> "Created with the Wolfram Language : www.wolfram.com"], 
      "Comments" -> 
      Association[
       "Software" -> "Created with the Wolfram Language : www.wolfram.com", 
        "Creation Time" -> DateObject[{2017, 9, 19}, 
          TimeObject[{14, 45, 45.}, TimeZone -> 2.], TimeZone -> 2.]]]],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSizeRaw->{1680, 1474},
  PlotRange->{{0, 1680}, {0, 1474}}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1570522134]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "\"ImageFormat\"",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CellID->1295379749],

Cell[BoxData[
 RowBox[{"TagImages", "[", 
  RowBox[{"images", ",", "tags", ",", 
   RowBox[{"\"\<ImageFormat\>\"", "\[Rule]", "\"\<jpg\>\""}]}], 
  "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1919564231]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Possible Issues",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->1305812373],

Cell["The images must be paths for existing images.", "ExampleText",
 CellID->524053424],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TagImages", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<image1\>\"", ",", "\"\<image2\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<A\>\"", ",", "\"\<1\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<B\>\"", ",", "\"\<2\>\""}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->366131535],

Cell[BoxData[
 TemplateBox[{
  "TagImages", "images", "\"Some of the images or file paths were invalid.\"",
    2, 1, 5, 26302011830121895607, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellLabel->"During evaluation of In[1]:=",
 CellID->694604812],

Cell[BoxData["$Aborted"], "Output",
 CellLabel->"Out[1]=",
 CellID->501970192]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell["\t", "ExampleDelimiter"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1533044263],

Cell[BoxData[
 RowBox[{
  RowBox[{"exampleimages", "=", 
   RowBox[{"FileNames", "@", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "$StiansExamples", ",", "\"\<Unwarps\>\"", ",", "\"\<*.bmp\>\""}], 
      "}"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1349495620],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", "exampleimages"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->1415525961],

Cell[BoxData["12"], "Output",
 CellLabel->"Out[2]=",
 CellID->1414037860]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TagImages", "[", 
  RowBox[{"exampleimages", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<A\>\"", ",", "\"\<1\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<B\>\"", ",", "\"\<2\>\""}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellLabel->"In[3]:=",
 CellID->194050688],

Cell[BoxData[
 TemplateBox[{
  "TagImages", "tags", "\"Invalid dimensions of tag list.\"", 2, 3, 6, 
   26302011830121895607, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellLabel->"During evaluation of In[3]:=",
 CellID->1680275318],

Cell[BoxData["$Aborted"], "Output",
 CellLabel->"Out[3]=",
 CellID->977311576]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell["\t", "ExampleDelimiter"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1238854659],

Cell[BoxData[
 RowBox[{
  RowBox[{"exampleimages", "=", 
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"FileNames", "@", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$StiansExamples", ",", "\"\<Unwarps\>\"", ",", "\"\<*.bmp\>\""}], 
        "}"}], "]"}]}], ",", "6"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1576296148],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TagImages", "[", 
  RowBox[{"exampleimages", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<A\>\"", ",", "\"\<1\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<B\>\"", ",", "\"\<2\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<C\>\"", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<D\>\"", ",", "\"\<4\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"E", ",", "\"\<5\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<F\>\"", ",", "\"\<6\>\""}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->1451090044],

Cell[BoxData[
 TemplateBox[{
  "TagImages", "tagstrings", "\"Some of the tags are not strings.\"", 2, 2, 7,
    26302011830121895607, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellLabel->"During evaluation of In[2]:=",
 CellID->576418332],

Cell[BoxData["$Aborted"], "Output",
 CellLabel->"Out[2]=",
 CellID->564174307]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " code",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->287437851],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TagImages", "::", "images"}], "=", 
   "\"\<Some of the images or file paths were invalid.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TagImages", "::", "tags"}], "=", 
   "\"\<Invalid dimensions of tag list.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TagImages", "::", "tagstrings"}], "=", 
   "\"\<Some of the tags are not strings.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TagImages", "::", "format"}], "=", 
    "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid output format.\>\
\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "TagImages"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<ExportTo\>\"", "\[Rule]", "\"\<InputDirectory\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Style\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"White", ",", "\"\<Inconsolata\>\"", ",", "54"}], "}"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"\"\<ImageFormat\>\"", "\[Rule]", "\"\<png\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<NewName\>\"", "\[Rule]", "False"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 CellLabel->"In[1]:=",
 CellID->1402862539],

Cell[BoxData[
 RowBox[{
  RowBox[{"TagImages", "[", 
   RowBox[{"input_", ",", "tags_List", ",", 
    RowBox[{"OptionsPattern", "@", "TagImages"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "images", ",", "type", ",", "L", ",", "\[IndentingNewLine]", "tagsLB", 
      ",", "tagsRB", ",", "progress", ",", "i", ",", "firstimage", ",", "dim",
       ",", "Lspace", ",", "Rspace", ",", "Bspace", ",", 
      "\[IndentingNewLine]", "oldbasename", ",", "newnamesf", ",", "newnames",
       ",", "nnOption", ",", "\[IndentingNewLine]", "inputdir", ",", 
      "outputdir", ",", "format", ",", "\[IndentingNewLine]", "s1", ",", "s2",
       ",", "s3", ",", "image", ",", "new1", ",", "new2"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Checking", " ", "input", " ", "form"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"images", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "input", "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"AllTrue", "[", 
        RowBox[{"images", ",", "ImageQ"}], "]"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"type", "=", "\"\<image\>\""}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"AllTrue", "[", 
        RowBox[{"images", ",", "FileExistsQ"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"type", "=", "\"\<string\>\""}], ",", "\t", 
       "\[IndentingNewLine]", "\t", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"TagImages", "::", "images"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "images"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "format", " ", "of", " ", "tags"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "tags", "]"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"L", ",", "2"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"TagImages", "::", "tags"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "tags"}], ",", "StringQ"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"TagImages", "::", "tagstrings"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "image", " ", "output", " ", "format"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"format", "=", 
      RowBox[{"ToLowerCase", "@", 
       RowBox[{"OptionValue", "[", "\"\<ImageFormat\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"format", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"format", ",", 
        RowBox[{"\"\<jpeg\>\"", "\[Rule]", "\"\<jpg\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<jpg\>\"", ",", "\"\<png\>\""}], "}"}], ",", 
          "format"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"TagImages", "::", "format"}], ",", "format"}], "]"}], ";", 
        
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Preparing", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"tagsLB", "=", 
      RowBox[{"tags", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"tagsRB", "=", 
      RowBox[{"tags", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"progress", "=", "0"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"firstimage", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"type", "\[Equal]", "\"\<string\>\""}], ",", 
        RowBox[{"Import", "@", 
         RowBox[{"First", "@", "images"}]}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"type", "\[Equal]", "\"\<image\>\""}], ",", 
        RowBox[{"First", "@", "images"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"dim", "=", 
      RowBox[{"ImageDimensions", "@", "firstimage"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Lspace", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"0.015", "*", 
        RowBox[{"First", "@", "dim"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Rspace", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"0.985", "*", 
        RowBox[{"First", "@", "dim"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Bspace", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"0.03", "*", 
        RowBox[{"Last", "@", "dim"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dynamic", " ", "status"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"PrintTemporary", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"Row", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Image conversion progress:\>\"", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
             "16"}], "]"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"Dynamic", "@", 
           RowBox[{"ProgressIndicator", "[", 
            RowBox[{"progress", "/", "L"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"Dynamic", "[", 
           RowBox[{"Text", "[", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"\"\<Converted: \>\"", "<>", 
               RowBox[{"ToString", "[", "progress", "]"}], "<>", 
               "\"\< of \>\"", "<>", 
               RowBox[{"ToString", "@", "L"}]}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
              "12"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", "\t", 
         "}"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"Alignment", "\[Rule]", "Center"}]}], "\[IndentingNewLine]", 
       "\t", "]"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{"New", " ", "names"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"newnamesf", "[", "old_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"old", "<>", "\"\<_\>\"", "<>", "\[IndentingNewLine]", "\t", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"#", ",", "10", ",", 
           RowBox[{"StringLength", "@", 
            RowBox[{"ToString", "@", "L"}]}]}], "]"}]}], "&"}], "/@", 
       RowBox[{"Range", "@", "L"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"nnOption", "=", 
      RowBox[{"OptionValue", "[", "\"\<NewName\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"type", "\[Equal]", "\"\<string\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"File", " ", "name", " ", "input"}], ",", " ", 
          RowBox[{"use", " ", "numeric", " ", "names"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"TrueQ", "@", "nnOption"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"oldbasename", "=", 
           RowBox[{"First", "@", 
            RowBox[{"StringCases", "[", 
             RowBox[{
              RowBox[{"StringTake", "\[IndentingNewLine]", "\t", "[", 
               RowBox[{
                RowBox[{"FileNameTake", "@", 
                 RowBox[{"First", "@", "images"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"__", "~~", "LetterCharacter"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"newnames", "=", 
           RowBox[{"newnamesf", "@", "oldbasename"}]}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
         RowBox[{"!", 
          RowBox[{"TrueQ", "@", "nnOption"}]}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"File", " ", "name", " ", "input"}], ",", " ", 
           RowBox[{"keep", " ", "old", " ", "names"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"newnames", "=", 
          RowBox[{"FileBaseName", "/@", 
           RowBox[{"FileNameTake", "/@", "images"}]}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
         RowBox[{"StringQ", "@", "nnOption"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"File", " ", "name", " ", "input"}], ",", " ", 
           RowBox[{"custom", " ", "base", " ", "name"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"newnames", "=", 
          RowBox[{"newnamesf", "@", "nnOption"}]}]}], "\[IndentingNewLine]", 
        "\t", "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"type", "\[Equal]", "\"\<image\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"StringQ", "@", "nnOption"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Image", " ", "intput"}], ",", " ", 
           RowBox[{"custom", " ", "base", " ", "name"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"newnames", "=", 
          RowBox[{"newnamesf", "@", "nnOption"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Image", " ", "input"}], ",", " ", 
           RowBox[{
            RowBox[{"defualt", " ", "'"}], 
            RowBox[{"Output", "'"}], " ", "name"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"newnames", "=", 
          RowBox[{"newnamesf", "[", "\"\<Output\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "\t", "]"}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Export", " ", "directory"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"DirectoryQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ExportTo\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Option", ":", " ", 
         RowBox[{"Custom", " ", "output", " ", "directory"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"outputdir", "=", 
        RowBox[{"OptionValue", "[", "\"\<ExportTo\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"type", "\[Equal]", "\"\<image\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "images"}], ",", " ", 
         RowBox[{"export", " ", "to", " ", "desktop"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"outputdir", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
          "$HomeDirectory", ",", "\"\<Desktop\>\"", ",", "\"\<Output\>\""}], 
          "}"}], "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"type", "\[Equal]", "\"\<string\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Use", " ", "input", " ", "directory"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"inputdir", "=", 
         RowBox[{"DirectoryName", "@", 
          RowBox[{"First", "@", "images"}]}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"outputdir", "=", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"inputdir", ",", "\"\<Output\>\""}], "}"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Quiet", "@", 
      RowBox[{"CreateDirectory", "@", "outputdir"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Procedure", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<StartProcedure\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Marking", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s1", ",", "s2", ",", "s3"}], "}"}], "=", 
      RowBox[{"OptionValue", "[", "\"\<Style\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"image", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"type", "\[Equal]", "\"\<string\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Import", "@", 
            RowBox[{"images", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"type", "\[Equal]", "\"\<image\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"images", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "\[IndentingNewLine]", "\t", 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"new1", "=", 
         RowBox[{"ImageCompose", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{"image", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"Text", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"tagsLB", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "s1", ",", 
                RowBox[{"FontFamily", "\[Rule]", "s2"}], ",", "s3"}], "]"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Left", ",", "Center"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Lspace", ",", "Bspace"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"new2", "=", 
         RowBox[{"ImageCompose", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{"new1", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Graphics", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"Text", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"tagsRB", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "s1", ",", 
                RowBox[{"FontFamily", "\[Rule]", "s2"}], ",", "s3"}], "]"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Right", ",", "Center"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Rspace", ",", "Bspace"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", "Export", " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"outputdir", ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"newnames", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<.\>\"", "<>", 
              "format"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
          "new2"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"progress", "++"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", "L"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "[", "progress", "]"}], "<>", "\"\< \>\"", "<>", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"L", "\[Equal]", "1"}], ",", "\"\<image\>\"", ",", 
         "\"\<images\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
       "\"\< were exported to \[LeftGuillemet]\>\"", "<>", 
       "\[IndentingNewLine]", 
       RowBox[{"ToString", "[", "outputdir", "]"}], "<>", 
       "\"\<\[RightGuillemet].\>\""}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[2]:=",
 CellID->964147766]
}, Closed]]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"TagImages",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "SymbolColor", "LinkTrails" -> 
  GridBox[{{
      RowBox[{
        ButtonBox[
        "Mathematica", ButtonData -> "paclet:Stians/guide/Stians", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "HasOptions" -> True, "ExampleCounter" -> 1, "NeedPlatMsgIn" -> 
  None, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2021, 4, 28, 13, 39, 59.072575}", 
    "history" -> {"0.3", "", "", ""}, "context" -> "Stians`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Stians Symbol", "language" -> "en", "paclet" -> "Stians", "status" -> 
    "None", "summary" -> 
    "TagImages[{image1, image2, ..., imagei}, {{ltag1, rtag1}, {ltag2, \
rtag2}, ... {ltagi, rtagi}}] marks the lower left and right corners of imagei \
with the tags ltagi and rtagi.", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "TagImages", "titlemodifier" -> "", "windowtitle" -> "TagImages", "type" -> 
    "Symbol", "uri" -> "Stians/ref/TagImages", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> "", "NewStyles" -> False},
CellContext->"Global`",
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "12.1 for Mac OS X x86 (64-bit) (June 19, 2020)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[8162, 256, 269, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"15d85073-1b14-4174-a7ec-f87b82f97e91",
   CellTags->"PrimaryExamplesSection",
   CellID->1461692324]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 42074, 1225}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[581, 21, 2265, 53, 70, "AnchorBarGrid",ExpressionUUID->"efb2992e-fbb2-4b16-84c3-68bd7040b039",
 CellID->1],
Cell[CellGroupData[{
Cell[2871, 78, 166, 6, 70, "ObjectNameGrid",ExpressionUUID->"f1056d6a-0f56-4bf7-883a-94e3db379025"],
Cell[3040, 86, 2200, 71, 70, "Usage",ExpressionUUID->"c2fdad76-865b-405a-8708-2fa64eabde58",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[5277, 162, 642, 19, 70, "NotesSection",ExpressionUUID->"1893b0f5-d5ff-4d86-bd5a-edcd62256700",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->1134968254],
Cell[5922, 183, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"e43f2244-e1d9-4341-a319-0b03cc148281"],
Cell[5956, 185, 240, 8, 70, "Notes",ExpressionUUID->"166fa76e-1219-474e-bee5-4b929e829ffc",
 CellID->1943790018],
Cell[6199, 195, 303, 10, 70, "Notes",ExpressionUUID->"6b2b1eb0-c5dd-477f-b051-2da3e73ee9b6",
 CellID->2063448702],
Cell[6505, 207, 946, 22, 70, "3ColumnTableMod",ExpressionUUID->"773fb50f-e8a6-494b-9b19-dfd5a47bf5ce",
 CellID->457306433],
Cell[7454, 231, 388, 11, 70, "Notes",ExpressionUUID->"e478c8d5-e121-4b8f-bcad-61b2a9fedfb8",
 CellID->583289301],
Cell[7845, 244, 280, 7, 70, "Notes",ExpressionUUID->"59b4969b-d85c-40a2-92e1-be63069917f5",
 CellID->1931014907]
}, Closed]],
Cell[CellGroupData[{
Cell[8162, 256, 269, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"15d85073-1b14-4174-a7ec-f87b82f97e91",
 CellTags->"PrimaryExamplesSection",
 CellID->1461692324],
Cell[CellGroupData[{
Cell[8456, 270, 196, 6, 70, "ExampleSection",ExpressionUUID->"c8823ef2-bcb0-43d7-b2bb-0e6b985fae63",
 CellID->1597451435],
Cell[8655, 278, 115, 4, 70, "Input",ExpressionUUID->"7400dc66-0d21-4b2b-9f66-a47ef820a47e",
 CellID->1617362692],
Cell[8773, 284, 321, 10, 70, "Input",ExpressionUUID->"7a39cc6e-8f5b-4585-8986-103d9658c993",
 CellID->1702908692],
Cell[9097, 296, 539, 17, 70, "Input",ExpressionUUID->"b30aebba-946d-45e8-9bb4-cbd845bc025f",
 CellID->98731120],
Cell[9639, 315, 163, 5, 70, "Input",ExpressionUUID->"9dffba47-7ee9-4c03-8b2a-12dc8882fee7",
 CellID->1255936733],
Cell[CellGroupData[{
Cell[9827, 324, 345, 10, 70, "Input",ExpressionUUID->"e3a5b2f0-db7a-4a6f-9319-88009a604560",
 CellID->669921222],
Cell[10175, 336, 798, 20, 70, "Output",ExpressionUUID->"f6ede74e-364c-40e3-96e5-9d59d165b4f4",
 CellID->130537934]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11022, 362, 187, 6, 70, "ExampleSection",ExpressionUUID->"d44feb53-cdeb-41fa-a0e8-26a6fd54756a",
 CellID->1293636265],
Cell[11212, 370, 71, 1, 70, "ExampleText",ExpressionUUID->"41b82d7e-3305-4777-9527-91742f0fd8d3",
 CellID->1488476289],
Cell[11286, 373, 321, 10, 70, "Input",ExpressionUUID->"bd0f0c92-0261-4f6d-8e56-fbdc948d9968",
 CellID->1142536111],
Cell[11610, 385, 157, 5, 70, "Input",ExpressionUUID->"413d6549-687d-4aea-b5e8-54e5ecfa8e1e",
 CellID->734259842],
Cell[11770, 392, 541, 17, 70, "Input",ExpressionUUID->"696f3e38-6e33-4f09-aa95-0ec3299cc7e1",
 CellID->1953129750],
Cell[CellGroupData[{
Cell[12336, 413, 126, 3, 70, "ExampleDelimiter",ExpressionUUID->"c62a58cc-1f13-4bad-9b56-c969016f35c1",
 CellID->1889743428],
Cell[12465, 418, 141, 4, 70, "ExampleText",ExpressionUUID->"db1749cd-c156-425d-b5cd-d931a90f024a",
 CellID->1782138913],
Cell[12609, 424, 137, 4, 70, "Input",ExpressionUUID->"8cdce5ef-7465-403d-81f1-63be14559a0e",
 CellID->2063115516],
Cell[12749, 430, 136, 4, 70, "ExampleText",ExpressionUUID->"cccfde5f-22dc-4db1-b098-be7fff87b59c",
 CellID->516776746]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[12934, 440, 189, 6, 70, "ExampleSection",ExpressionUUID->"d0a55f5b-d8d1-4f90-aa93-7529a83df571",
 CellID->2061341341],
Cell[CellGroupData[{
Cell[13148, 450, 200, 6, 70, "ExampleSubsection",ExpressionUUID->"67f7a9cc-4420-4087-9e66-072e6862dfb5",
 CellID->1757724783],
Cell[13351, 458, 207, 6, 70, "Input",ExpressionUUID->"be025da8-2918-4469-ac42-9dd64a99cc62",
 CellID->974508160]
}, Closed]],
Cell[CellGroupData[{
Cell[13595, 469, 196, 6, 70, "ExampleSubsection",ExpressionUUID->"0b8561d8-00d8-4097-be5a-d237269dd21a",
 CellID->744098065],
Cell[13794, 477, 294, 9, 70, "Input",ExpressionUUID->"632201db-8169-450a-91be-4e36c9915531",
 CellID->1848353098],
Cell[CellGroupData[{
Cell[14113, 490, 368, 10, 70, "Input",ExpressionUUID->"ea006ad2-7725-43b0-88aa-a5754d71978f",
 CellID->1058330493],
Cell[14484, 502, 799, 20, 70, "Output",ExpressionUUID->"b7519fa1-a05f-4868-80e2-566c4eec0b1c",
 CellID->1570522134]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[15332, 528, 203, 6, 70, "ExampleSubsection",ExpressionUUID->"3140805a-a123-4618-8174-32809d4f620c",
 CellID->1295379749],
Cell[15538, 536, 208, 6, 70, "Input",ExpressionUUID->"b1e9702b-fb87-4fb4-8bd8-400e37f195d1",
 CellID->1919564231]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[15795, 548, 197, 6, 70, "ExampleSection",ExpressionUUID->"9ddbf5ae-dc25-4ae0-b38e-2e961b405993",
 CellID->1305812373],
Cell[15995, 556, 88, 1, 70, "ExampleText",ExpressionUUID->"e3c5c9c7-47fc-4215-b2d8-555276667285",
 CellID->524053424],
Cell[CellGroupData[{
Cell[16108, 561, 393, 13, 70, "Input",ExpressionUUID->"1354a390-ef04-492a-9cb2-0e39f9a5f1d8",
 CellID->366131535],
Cell[16504, 576, 257, 6, 70, "Message",ExpressionUUID->"3b393195-b052-4da2-88ab-a47f18312723",
 CellID->694604812],
Cell[16764, 584, 78, 2, 70, "Output",ExpressionUUID->"a0c2c5a4-fd7c-4bea-92b0-0da93618fc23",
 CellID->501970192]
}, Open  ]],
Cell[CellGroupData[{
Cell[16879, 591, 126, 3, 70, "ExampleDelimiter",ExpressionUUID->"8327f945-fcc3-41d4-8d91-40e20e381322",
 CellID->1533044263],
Cell[17008, 596, 313, 10, 70, "Input",ExpressionUUID->"75e84c7b-1265-4b38-b95d-abcb1e2502c5",
 CellID->1349495620],
Cell[CellGroupData[{
Cell[17346, 610, 110, 3, 70, "Input",ExpressionUUID->"f2f0eb8a-d753-4c3d-8d2b-f23f46ff010c",
 CellID->1415525961],
Cell[17459, 615, 73, 2, 70, "Output",ExpressionUUID->"7a44e019-8ea5-48f0-b9a9-5b3334410c96",
 CellID->1414037860]
}, Open  ]],
Cell[CellGroupData[{
Cell[17569, 622, 330, 11, 70, "Input",ExpressionUUID->"5ee90631-3ac0-4b1b-b5ba-0f17e88665e0",
 CellID->194050688],
Cell[17902, 635, 241, 6, 70, "Message",ExpressionUUID->"80bb3c87-9843-49ab-8bc5-a3e4083d1b72",
 CellID->1680275318],
Cell[18146, 643, 78, 2, 70, "Output",ExpressionUUID->"8831e444-8f62-4e9e-b262-b9f2e609ef3e",
 CellID->977311576]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18273, 651, 126, 3, 70, "ExampleDelimiter",ExpressionUUID->"98ccc0b9-1fdc-4c7f-89c8-839e26462a90",
 CellID->1238854659],
Cell[18402, 656, 382, 12, 70, "Input",ExpressionUUID->"755f5626-8016-4141-a8c4-c0272b9b5365",
 CellID->1576296148],
Cell[CellGroupData[{
Cell[18809, 672, 631, 19, 70, "Input",ExpressionUUID->"24318287-6a26-4b36-a10d-7812f1d53407",
 CellID->1451090044],
Cell[19443, 693, 248, 6, 70, "Message",ExpressionUUID->"e58f9a90-d89f-445d-930d-91ecc1fdb1ec",
 CellID->576418332],
Cell[19694, 701, 78, 2, 70, "Output",ExpressionUUID->"76062dd7-09fb-4b49-ab43-ab543afa6e55",
 CellID->564174307]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[19833, 710, 235, 8, 70, "ExampleSection",ExpressionUUID->"6d4bd807-b658-4a19-aa3e-12c03eb63611",
 CellID->287437851],
Cell[20071, 720, 1364, 38, 70, "Input",ExpressionUUID->"ec4194e3-a4d5-412f-b41e-4b779425c679",
 CellID->1402862539],
Cell[21438, 760, 18641, 414, 70, "Input",ExpressionUUID->"3136ceb9-108a-40e2-81c6-257b89dea721",
 CellID->964147766]
}, Closed]]
}, Open  ]],
Cell[40106, 1178, 23, 0, 70, "FooterCell",ExpressionUUID->"3754f01d-1e30-4108-9aab-50662797ce93"]
}
]
*)

(* End of internal cache information *)
