(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29880,        836]
NotebookOptionsPosition[     23900,        698]
NotebookOutlinePosition[     26062,        756]
CellTagsIndexPosition[     25977,        751]
WindowTitle->ExtractUsage
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["STIANS SYMBOL", "PacletNameCell"], Cell[TextData[Cell[BoxData[
     ActionMenuBox[
      FrameBox[
       InterpretationBox[Cell[TextData[{
         "URL",
         StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
          StripOnInput->False]
        }]],
        TextCell[
         Row[{"URL", 
           Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
       StripOnInput->False], {"\<\"Stians/ref/ExtractUsage\"\>":>
      None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
      Module[{DocumentationSearch`Private`nb$}, 
       DocumentationSearch`Private`nb$ = NotebookPut[
          Notebook[{
            Cell["Stians/ref/ExtractUsage"]}, Visible -> False]]; 
       SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
       FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
       NotebookClose[DocumentationSearch`Private`nb$]; Null], 
      Delimiter, "\<\"Copy web URL\"\>":>
      Module[{DocumentationSearch`Private`nb$}, 
       DocumentationSearch`Private`nb$ = NotebookPut[
          Notebook[{
            Cell[
             BoxData[
              MakeBoxes[
               Hyperlink[
               "http://reference.wolfram.com/language/Stians/ref/ExtractUsage.\
html"], StandardForm]], "Input", TextClipboardType -> "PlainText"]}, Visible -> 
           False]]; SelectionMove[
        DocumentationSearch`Private`nb$, All, Notebook]; 
       FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
       NotebookClose[DocumentationSearch`Private`nb$]; 
       Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
        NotebookLocate[{
          URL[
           StringJoin[
            If[
             TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$12069], 
             "http://reference.wolfram.com/system-modeler/", 
             "http://reference.wolfram.com/language/"], 
            "Stians/ref/ExtractUsage", ".html"]], None}]}]},
      Appearance->None,
      MenuAppearance->Automatic,
      MenuStyle->"URLMenu"]],
     LineSpacing->{1.4, 0}]], "AnchorBar"]}
  }]], "AnchorBarGrid",
 GridBoxOptions->{GridBoxItemSize->{"Columns" -> {
     Scaled[0.65], {
      Scaled[0.34]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
   "RowsIndexed" -> {}}},
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 Cell["ExtractUsage", "ObjectName"],
 Cell[BoxData[
  TemplateBox[{8},
   "Spacer1"]]],
 Cell[BoxData[""], "ObjectNameTranslation"]
}], "ObjectNameGrid"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{Cell[
          TextData["ExtractUsage"]],"paclet:Xray/ref/ExtractUsage"},
        "RefLink",
        BaseStyle->{"InlineFormula"}], "[", 
       StyleBox["notebook", "TI"], "]"}]], "InlineFormula"],
     " \[LineSeparator]extracts usage messages found in ",
     Cell[BoxData[
      StyleBox["notebook", "TI"]], "InlineFormula"],
     "."
    }]]}
  }]], "Usage",
 GridBoxOptions->{
 GridBoxBackground->{
  "Columns" -> {{None}}, "ColumnsIndexed" -> {}, "Rows" -> {{None}}, 
   "RowsIndexed" -> {}}},
 CellID->982511436]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    TemplateBox[{6},
     "Spacer1"]]],
   "Details and Options"
  }], "NotesFrameText"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->"Preemptive"]]]], "NotesSection",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->23564218],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[{
 Cell[BoxData[
  StyleBox["notebook", "TI"]], "InlineFormula"],
 " must be a path to an undeployed documentation notebook made with Wolfram \
",
 StyleBox["Workbench",
  FontSlant->"Italic"],
 "."
}], "Notes",
 CellID->1067943069],

Cell[TextData[{
 "The option ",
 Cell[BoxData["\"\<Mode\>\""], "InlineFormula"],
 " has two settings:"
}], "Notes",
 CellID->1447623407],

Cell[BoxData[GridBox[{
   {Cell["      ", "TableRowIcon"], "\"\<Normal\>\"", Cell[
    "extracts the usage message only", "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<Full\>\"", Cell[
    "additionally extracts the application- and function names", 
     "TableText"]}
  }]], "2ColumnTableMod",
 GridBoxOptions->{
 GridBoxBackground->{
  "Columns" -> {{None}}, "ColumnsIndexed" -> {}, "Rows" -> {None, {None}}, 
   "RowsIndexed" -> {}},
 GridBoxDividers->{"Rows" -> {{True, True, True}}}},
 CellID->1736267949]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(4)", "ExampleCount"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CellTags->"PrimaryExamplesSection",
 CellID->906820878],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->247053787],

Cell[BoxData[
 RowBox[{
  RowBox[{"nb", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"$XrayExamples", ",", "\"\<ToMillerUndeployed.nb\>\""}], "}"}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->947226218],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExtractUsage", "@", "nb"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->797407652],

Cell[BoxData[
 RowBox[{"{", "\<\"ToMiller[\\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{StyleBox[\\\"h\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"k\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"l\\\", \\\"TI\\\"]}], \\\"}\\\"}]\\)] \
\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"converts reflection \\\\\\\"\\\", \
\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\*Cell[BoxData[StyleBox[\\\\\\\\\\\\\\\"\
hkl\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"TI\\\\\\\\\\\\\\\"]], \
\\\\\\\\\\\\\\\"InlineFormula\\\\\\\\\\\\\\\"]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\
\\\" to Miller index notation.\\\\\\\"\\\"], \\\"RowDefault\\\"]\\)\"\>", 
  "}"}]], "Output",
 ImageSize->{493, 16},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[2]=",
 CellID->1152830909]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell["\t", "ExampleDelimiter"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->704023370],

Cell[TextData[{
 "The function is ",
 Cell[BoxData[
  TemplateBox[{Cell[
     TextData["Listable"]],"paclet:ref/Listable"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "."
}], "ExampleText",
 CellID->2033368267],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nb1", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"$XrayExamples", ",", "\"\<ToMillerUndeployed.nb\>\""}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nb2", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"$XrayExamples", ",", "\"\<$CrystalsUndeployed.nb\>\""}], "}"}], 
    "]"}]}], ";"}]}], "Input",
 CellLabel->"In[1]:=",
 CellID->539362192],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExtractUsage", "[", 
  RowBox[{"{", 
   RowBox[{"nb1", ",", "nb2"}], "}"}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->1429191456],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
   "{", "\<\"ToMiller[\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"h\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"k\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\
\\\"l\\\", \\\"TI\\\"]}], \\\"}\\\"}]\\)] \
\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"converts reflection \\\\\\\"\\\", \
\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\*Cell[BoxData[StyleBox[\\\\\\\\\\\\\\\"\
hkl\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"TI\\\\\\\\\\\\\\\"]], \
\\\\\\\\\\\\\\\"InlineFormula\\\\\\\\\\\\\\\"]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\
\\\" to Miller index notation.\\\\\\\"\\\"], \\\"RowDefault\\\"]\\)\"\>", 
    "}"}], ",", 
   RowBox[{
   "{", "\<\"$Crystals \\!\\(\\*TemplateBox[List[\\\"\\\\\\\"returns a list \
of available crystals.\\\\\\\"\\\"], \\\"RowDefault\\\"]\\)\"\>", "}"}]}], 
  "}"}]], "Output",
 ImageSize->{507, 34},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[2]=",
 CellID->334096356]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Options",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->2061341341],

Cell[CellGroupData[{

Cell[TextData[{
 "\"Mode\"",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CellID->1757724783],

Cell[BoxData[
 RowBox[{
  RowBox[{"nb", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"$XrayExamples", ",", "\"\<ToMillerUndeployed.nb\>\""}], "}"}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1305933695],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExtractUsage", "[", 
  RowBox[{"nb", ",", 
   RowBox[{"\"\<Mode\>\"", "\[Rule]", "\"\<Normal\>\""}]}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->1544739525],

Cell[BoxData[
 RowBox[{"{", "\<\"ToMiller[\\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{StyleBox[\\\"h\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"k\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"l\\\", \\\"TI\\\"]}], \\\"}\\\"}]\\)] \
\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"converts reflection \\\\\\\"\\\", \
\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\*Cell[BoxData[StyleBox[\\\\\\\\\\\\\\\"\
hkl\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"TI\\\\\\\\\\\\\\\"]], \
\\\\\\\\\\\\\\\"InlineFormula\\\\\\\\\\\\\\\"]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\
\\\" to Miller index notation.\\\\\\\"\\\"], \\\"RowDefault\\\"]\\)\"\>", 
  "}"}]], "Output",
 ImageSize->{493, 16},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[2]=",
 CellID->1278430530]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExtractUsage", "[", 
  RowBox[{"nb", ",", 
   RowBox[{"\"\<Mode\>\"", "\[Rule]", "\"\<Full\>\""}]}], "]"}]], "Input",
 CellLabel->"In[3]:=",
 CellID->567351938],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Xray\"\>", ",", "\<\"ToMiller\"\>", ",", 
   RowBox[{
   "{", "\<\"ToMiller[\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"h\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"k\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\
\\\"l\\\", \\\"TI\\\"]}], \\\"}\\\"}]\\)] \
\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"converts reflection \\\\\\\"\\\", \
\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\*Cell[BoxData[StyleBox[\\\\\\\\\\\\\\\"\
hkl\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"TI\\\\\\\\\\\\\\\"]], \
\\\\\\\\\\\\\\\"InlineFormula\\\\\\\\\\\\\\\"]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\
\\\" to Miller index notation.\\\\\\\"\\\"], \\\"RowDefault\\\"]\\)\"\>", 
    "}"}]}], "}"}]], "Output",
 ImageSize->{508, 34},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[3]=",
 CellID->452895142]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " code",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->1709765717],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtractUsage", "::", "mode"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a recognised mode.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExtractUsage", "::", "link"}], "=", 
    "\"\<The function name \[LeftGuillemet]`1`\[RightGuillemet] needs to be a \
hyperlink.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ExtractUsage", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Mode\>\"", "\[Rule]", "\"\<Normal\>\""}], "}"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[1]:=",
 CellID->336740602],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractUsage", "[", 
   RowBox[{"notebook_String", ",", 
    RowBox[{"OptionsPattern", "@", "ExtractUsage"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nb", ",", "app", ",", "f", ",", "\[IndentingNewLine]", "found", ",", 
      "temp", ",", "t", ",", "s", ",", "\[IndentingNewLine]", "starts", ",", 
      "ends", ",", "m", ",", "mode", ",", "extramode"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Extracting", " ", "application"}], "-", " ", 
      RowBox[{"and", " ", "function", " ", "names"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"NotebookImport", "@", "notebook"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"app", "=", 
      RowBox[{"nb", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"f", "=", 
      RowBox[{"nb", "[", 
       RowBox[{"[", "24", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Finding", " ", "syntaxes"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"found", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"ToString", "@", 
          RowBox[{"nb", "[", 
           RowBox[{"[", 
            RowBox[{"25", ",", "1", ",", "i"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"t", ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Cell[BoxData[RowBox[{ButtonBox[\>\"", ",", 
              "\[IndentingNewLine]", "\t", 
              "\"\<Cell[BoxData[ButtonBox[\>\""}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"found", ",", "i"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", 
          RowBox[{"nb", "[", 
           RowBox[{"[", 
            RowBox[{"25", ",", "1"}], "]"}], "]"}]}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"No", " ", "syntaxes", " ", "found"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"found", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ExtractUsage", "::", "link"}], ",", "f"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Quiet", "@", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"nb", "[", 
          RowBox[{"[", 
           RowBox[{
           "25", ",", "1", ",", "found", ",", "1", ",", "1", ",", "1", ",", 
            "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"extramode", "=", 
          RowBox[{"OptionValue", "[", "\"\<Mode\>\"", "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"mode", "=", "\"\<Global\>\""}], ";", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"Goto", "[", "\"\<FindMessage\>\"", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"s", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"RawBoxes", "@", "#"}], ",", "StandardForm"}], "]"}], "&"}],
        "/@", "temp"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Finding", " ", "usage", " ", "messages"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<FindMessage\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"nb", "[", 
       RowBox[{"[", 
        RowBox[{"25", ",", "1", ",", "All"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"starts", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"ToString", "@", 
          RowBox[{"FullForm", "@", 
           RowBox[{"temp", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"t", ",", "\"\<\\\\[LineSeparator]\>\""}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"starts", ",", "i"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "temp"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"ends", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"StringTrim", "@", 
          RowBox[{"ToString", "@", 
           RowBox[{"temp", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"t", "\[Equal]", "\"\<\>\""}], ",", 
          RowBox[{"t", "=", "\"\< \>\""}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"t", ",", 
              RowBox[{"-", "1"}]}], "]"}], ",", "\"\<.\>\""}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"ends", ",", "i"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "temp"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"Thread", "[", 
        RowBox[{"starts", ";;", "ends"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Removing", " ", "line", " ", "separatos"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringDelete", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"ToString", "@", 
          RowBox[{"FullForm", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"{", 
          RowBox[{
          "\"\< \\\\[LineSeparator]\>\"", ",", "\"\<\\\\[LineSeparator]\>\"", 
           ",", "\"\<\\\\n\>\""}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Clearing", " ", "boxes"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"temp", "/.", 
       RowBox[{
        RowBox[{"x_StyleBox", "|", "x_Cell"}], "\[RuleDelayed]", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"RawBoxes", "@", "x"}], ",", "StandardForm"}], "]"}]}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"Row", "[", "#", "]"}], ",", "StandardForm"}], "]"}], "&"}],
        "/@", "temp"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Returning", " ", "information"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ValueQ", "@", "mode"}]}], ",", 
       RowBox[{"mode", "=", 
        RowBox[{"OptionValue", "[", "\"\<Mode\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"mode", "\[Equal]", "\"\<Normal\>\""}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"f", "<>", "\"\<[\>\"", "<>", 
          RowBox[{"s", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<] \>\"", "<>", 
          RowBox[{"m", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "s"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"mode", "\[Equal]", "\"\<Global\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"extramode", "\[Equal]", "\"\<Normal\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{"f", "<>", "\"\< \>\"", "<>", 
           RowBox[{"m", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"extramode", "\[Equal]", "\"\<Full\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{"app", ",", "f", ",", 
           RowBox[{"{", 
            RowBox[{"f", "<>", "\"\< \>\"", "<>", 
             RowBox[{"m", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"mode", "\[Equal]", "\"\<Full\>\""}], ",", 
       RowBox[{"{", 
        RowBox[{"app", ",", "f", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"f", "<>", "\"\<[\>\"", "<>", 
            RowBox[{"s", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<] \>\"", "<>", 
            RowBox[{"m", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "s"}]}], "}"}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", "\t", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ExtractUsage", "::", "mode"}], ",", "mode"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[2]:=",
 CellID->2072489787],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{"ExtractUsage", ",", "Listable"}], "]"}]], "Input",
 CellLabel->"In[3]:=",
 CellID->151095769]
}, Closed]]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"ExtractUsage",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "SymbolColor", "LinkTrails" -> 
  GridBox[{{
      RowBox[{
        ButtonBox[
        "Mathematica", ButtonData -> "paclet:Stians/guide/Stians", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "HasOptions" -> True, "ExampleCounter" -> 1, "NeedPlatMsgIn" -> 
  None, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2019, 3, 16, 9, 28, 23.351521}", 
    "history" -> {"0.3", "", "", ""}, "context" -> "Stians`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Stians Symbol", "language" -> "en", "paclet" -> "Stians", "status" -> 
    "None", "summary" -> 
    "ExtractUsage[notebook] extracts usage messages found in notebook.", 
    "synonyms" -> {}, "tabletags" -> {}, "title" -> "ExtractUsage", 
    "titlemodifier" -> "", "windowtitle" -> "ExtractUsage", "type" -> 
    "Symbol", "uri" -> "Stians/ref/ExtractUsage", "WorkflowDockedCell" -> ""},
   "SearchTextTranslated" -> "", "NewStyles" -> False},
CellContext->"Global`",
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> 
  "11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, 2018)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[5340, 168, 267, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"53244dd7-6877-4083-923a-527b44b3fe1e",
   CellTags->"PrimaryExamplesSection",
   CellID->906820878]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 25779, 744}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[584, 21, 2277, 53, 70, "AnchorBarGrid",ExpressionUUID->"4f11a3a6-ac01-4f2c-9207-770a22ead2c0",
 CellID->1],
Cell[CellGroupData[{
Cell[2886, 78, 169, 6, 70, "ObjectNameGrid",ExpressionUUID->"1e7d835a-d4bd-4e0a-88b5-ec34e53c37a3"],
Cell[3058, 86, 622, 19, 70, "Usage",ExpressionUUID->"1eaf33ef-59c6-4fcd-acd3-198206d7c1e5",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[3717, 110, 640, 19, 70, "NotesSection",ExpressionUUID->"63d36e2d-22e9-4dd9-8664-e3cacf872132",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->23564218],
Cell[4360, 131, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"6bf7938f-67db-4a69-8f56-5797b7abb2ee"],
Cell[4394, 133, 246, 9, 70, "Notes",ExpressionUUID->"5f694b69-3c76-4bac-9fa7-788d8ef44ee7",
 CellID->1067943069],
Cell[4643, 144, 136, 5, 70, "Notes",ExpressionUUID->"35f2178d-4943-48e3-b616-aaf239e34ed3",
 CellID->1447623407],
Cell[4782, 151, 521, 12, 70, "2ColumnTableMod",ExpressionUUID->"98d5de85-0a94-4900-ad43-5d7cb944c004",
 CellID->1736267949]
}, Closed]],
Cell[CellGroupData[{
Cell[5340, 168, 267, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"53244dd7-6877-4083-923a-527b44b3fe1e",
 CellTags->"PrimaryExamplesSection",
 CellID->906820878],
Cell[CellGroupData[{
Cell[5632, 182, 195, 6, 70, "ExampleSection",ExpressionUUID->"5b1ef7ca-e918-4639-845f-84ae70a08ec7",
 CellID->247053787],
Cell[5830, 190, 247, 8, 70, "Input",ExpressionUUID->"1d036b68-b0da-4166-bda4-291576d99c4a",
 CellID->947226218],
Cell[CellGroupData[{
Cell[6102, 202, 104, 3, 70, "Input",ExpressionUUID->"fa237b6d-4799-4a9e-b2ed-1b7fe5c6da03",
 CellID->797407652],
Cell[6209, 207, 742, 14, 70, "Output",ExpressionUUID->"7c93bde9-c0a7-4057-bcbf-a6d48a3e2d97",
 CellID->1152830909]
}, Open  ]],
Cell[CellGroupData[{
Cell[6988, 226, 125, 3, 70, "ExampleDelimiter",ExpressionUUID->"f576bf7c-70bc-4962-89fd-0d6f22c0ec2f",
 CellID->704023370],
Cell[7116, 231, 235, 9, 70, "ExampleText",ExpressionUUID->"404a2963-822d-4c0b-96bf-52f9e583e431",
 CellID->2033368267],
Cell[7354, 242, 457, 14, 70, "Input",ExpressionUUID->"f6b3afd3-8458-43c3-a381-cc5230167cf6",
 CellID->539362192],
Cell[CellGroupData[{
Cell[7836, 260, 160, 5, 70, "Input",ExpressionUUID->"e6e5d80a-6823-4822-ab6d-ee77d1c3e960",
 CellID->1429191456],
Cell[7999, 267, 956, 21, 70, "Output",ExpressionUUID->"d14e0817-52cc-4011-8240-589dc37b0fbe",
 CellID->334096356]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9016, 295, 189, 6, 70, "ExampleSection",ExpressionUUID->"2c645d34-3e3b-4ef5-ae42-16739fff8477",
 CellID->2061341341],
Cell[CellGroupData[{
Cell[9230, 305, 196, 6, 70, "ExampleSubsection",ExpressionUUID->"4afb26fe-5140-4059-b95e-afe00be0ea6a",
 CellID->1757724783],
Cell[9429, 313, 248, 8, 70, "Input",ExpressionUUID->"5b1388e0-fff4-4398-bd01-0b730e586b86",
 CellID->1305933695],
Cell[CellGroupData[{
Cell[9702, 325, 187, 5, 70, "Input",ExpressionUUID->"abc3dac8-bc55-45bc-b4c1-f632edba0923",
 CellID->1544739525],
Cell[9892, 332, 742, 14, 70, "Output",ExpressionUUID->"dfe6c40d-147b-4e4f-a467-ae97169ca984",
 CellID->1278430530]
}, Open  ]],
Cell[CellGroupData[{
Cell[10671, 351, 184, 5, 70, "Input",ExpressionUUID->"f71af426-ef8a-4058-8309-cb012f5c413b",
 CellID->567351938],
Cell[10858, 358, 830, 17, 70, "Output",ExpressionUUID->"cded3f80-0e15-4fec-94ed-18a35c5941ae",
 CellID->452895142]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[11749, 382, 236, 8, 70, "ExampleSection",ExpressionUUID->"c2930192-2354-4ea4-b48d-21bedd4ee37e",
 CellID->1709765717],
Cell[11988, 392, 661, 19, 70, "Input",ExpressionUUID->"79f1ee9d-404e-436d-99c3-0f1997772200",
 CellID->336740602],
Cell[12652, 413, 11041, 273, 70, "Input",ExpressionUUID->"8a286f1d-0442-4544-9bef-2c83b720ca99",
 CellID->2072489787],
Cell[23696, 688, 150, 4, 70, "Input",ExpressionUUID->"89069b78-90a6-43fa-a256-699f7d40276e",
 CellID->151095769]
}, Closed]]
}, Open  ]],
Cell[23873, 696, 23, 0, 70, "FooterCell",ExpressionUUID->"f0f06a10-6c15-4620-850c-9494d6da1504"]
}
]
*)

(* End of internal cache information *)
